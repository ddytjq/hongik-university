ID=F0991
URL=http://www.geocities.com/SiliconValley/Campus/9449/Tips/tip16.htm
SIZE=2126
DATE=09/07/2002
TIME=13:28:39
DATASET=Visual Basic
HTML=<HTML>
<HEAD>

<META NAME="Description" CONTENT="Making a form stay on top with Visual Basic">

<TITLE>Making a Form stay on Top</TITLE>

<STYLE  TYPE="text/css">

td {  font-family: Arial, Helvetica, sans-serif; font-size: 10pt}

</STYLE>

<SCRIPT SRC="Linker.js"></SCRIPT>
</HEAD>

<BODY TEXT="#000000" BGCOLOR="#66FF99" LINK="#0000EE" VLINK="#551A8B" ALINK="#FF0000">

&nbsp;

<CENTER><TABLE BORDER=0 WIDTH="550" BGCOLOR="#C0C0C0" >
<TR>
<TD>
<CENTER><B><FONT COLOR="#FF0000">
Making a Form Stay on Top
<BR><HR SIZE=1 WIDTH=200>
</FONT></B></CENTER>
<P>
Add the following code to a module:
<P>
<B>Public Const</B> HWND_TOPMOST = -1<BR>
<B>Public Const</B> HWND_NOTOPMOST = -2<BR>
<B>Public Const</B> SWP_NOMOVE = &H2<BR>
<B>Public Const</B> SWP_NOSIZE = &H1<BR>
<B>Public Const</B> SWP_NOACTIVATE = &H10<BR>
<B>Public Const</B> SWP_SHOWWINDOW = &H40<BR>
<B>Public Const</B> TOPMOST_FLAGS = SWP_NOMOVE Or SWP_NOSIZE<P>
<B>Public Declare Function</B> SetWindowPos Lib "user32" (ByVal hwnd As Long, ByVal hWndInsertAfter As Long, ByVal x As Long, y, ByVal cx As Long, ByVal cy As Long, ByVal wFlags As Long) As Long  <I><B>'All in one line</B></I>
<P>
'Now for the subs that will enable/disable the form's topmost condition:
<P>

<B>Public Sub MakeNormal(Handle As Long)</B><BR>
SetWindowPos Handle, HWND_NOTOPMOST, 0, 0, 0, 0, TOPMOST_FLAGS<BR>
<B>End Sub</B><P>

<B>Public Sub MakeTopMost(Handle As Long)</B><BR>
SetWindowPos Handle, HWND_TOPMOST, 0, 0, 0, 0, TOPMOST_FLAGS<BR>
<B>End Sub</B><P>

<SCRIPT>WriteLinkToTips();</SCRIPT>

</TD>
</TR>
</TABLE>

</CENTER>
</BODY>
</HTML>
<!-- text below generated by server. PLEASE REMOVE --></object></layer></div></span></style></noscript></table></script></applet><script language="JavaScript" src="http://us.i1.yimg.com/us.yimg.com/i/mc/mc.js"></script><script language="JavaScript" src="http://us.geocities.com/js_source/geov2.js"></script><script language="javascript">geovisit();</script><noscript><img src="http://visit.geocities.com/visit.gif?1026142931" border=0 width=1 height=1></noscript>
<IMG SRC="http://geo.yahoo.com/serv?s=76001067&t=1026142931" ALT=1 WIDTH=1 HEIGHT=1>

