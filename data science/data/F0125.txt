ID=F0125
URL=http://www.visualbasicbooks.com/begvbsqlsample/30640603.htm
SIZE=37210
DATE=09/07/2002
TIME=13:15:11
DATASET=Visual Basic
HTML=<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="filelist.xml">
<link rel=Edit-Time-Data href="editdata.mso">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->
<title>Visual Basic SQL Server 7.0</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Joy Armitage</o:Author>
  <o:Template>Normal</o:Template>
  <o:LastAuthor>Joy Armitage</o:LastAuthor>
  <o:Revision>2</o:Revision>
  <o:TotalTime>1</o:TotalTime>
  <o:Created>2000-03-29T08:51:00Z</o:Created>
  <o:LastSaved>2000-03-29T08:51:00Z</o:LastSaved>
  <o:Pages>12</o:Pages>
  <o:Words>2224</o:Words>
  <o:Characters>12682</o:Characters>
  <o:Company>Wrox Press Ltd</o:Company>
  <o:Lines>105</o:Lines>
  <o:Paragraphs>25</o:Paragraphs>
  <o:CharactersWithSpaces>15574</o:CharactersWithSpaces>
  <o:Version>9.2720</o:Version>
 </o:DocumentProperties>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
@font-face
	{font-family:Times;
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:Helvetica;
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:Courier;
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:modern;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:Palatino;
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:"ITC Franklin Gothic Book";
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:FrGothHeavy;
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-alt:"Arial Narrow";
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:FranklinGothic;
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:ZapfDingbats;
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:decorative;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:Arial;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
h1
	{mso-style-parent:"";
	mso-style-next:Normal;
	margin-top:22.0pt;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:1;
	font-size:19.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"ITC Franklin Gothic Book";
	color:black;
	mso-font-kerning:14.0pt;
	mso-bidi-font-weight:normal;}
h2
	{mso-style-parent:"";
	mso-style-next:Normal;
	margin-top:14.0pt;
	margin-right:0in;
	margin-bottom:8.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:2;
	font-size:16.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"ITC Franklin Gothic Book";
	color:black;
	mso-bidi-font-weight:normal;}
h3
	{mso-style-parent:"";
	mso-style-next:Normal;
	margin-top:11.0pt;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:3;
	font-size:13.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"ITC Franklin Gothic Book";
	mso-bidi-font-weight:normal;
	font-style:italic;
	mso-bidi-font-style:normal;}
h5
	{mso-style-parent:"";
	mso-style-next:Normal;
	margin-top:11.0pt;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	mso-outline-level:5;
	background:black;
	mso-shading:windowtext;
	mso-pattern:solid auto;
	border:none;
	mso-border-alt:solid black 2.25pt;
	padding:0in;
	mso-padding-alt:1.0pt 1.0pt 1.0pt 1.0pt;
	font-size:10.0pt;
	font-family:"ITC Franklin Gothic Book";
	mso-bidi-font-weight:normal;}
p.MsoIndex1, li.MsoIndex1, div.MsoIndex1
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:12.0pt;
	margin-bottom:.0001pt;
	text-indent:-12.0pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:Arial;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
span.MsoCommentReference
	{mso-ansi-font-size:8.0pt;
	mso-bidi-font-size:8.0pt;}
p.ChapterNumber, li.ChapterNumber, div.ChapterNumber
	{mso-style-name:"Chapter Number";
	mso-style-update:auto;
	mso-style-parent:"Chapter Title";
	margin-top:40.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:380.15pt;
	margin-bottom:.0001pt;
	text-align:center;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	font-size:48.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:FrGothHeavy;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	color:black;
	mso-font-kerning:14.0pt;}
p.ChapterTitle, li.ChapterTitle, div.ChapterTitle
	{mso-style-name:"Chapter Title";
	mso-style-update:auto;
	mso-style-parent:"";
	margin-top:40.0pt;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	text-align:center;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	font-size:26.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:FrGothHeavy;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	color:black;
	mso-font-kerning:14.0pt;}
span.ImportantWords
	{mso-style-name:"Important Words";
	mso-style-parent:"";
	mso-ansi-font-size:9.0pt;
	mso-ascii-font-family:Times;
	mso-hansi-font-family:Times;
	color:black;
	letter-spacing:.2pt;
	font-weight:bold;}
p.Bullet, li.Bullet, div.Bullet
	{mso-style-name:Bullet;
	mso-style-update:auto;
	mso-style-parent:"";
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:46.2pt;
	text-indent:-17.85pt;
	mso-pagination:widow-orphan;
	mso-list:l5 level1 lfo8;
	mso-hyphenate:none;
	tab-stops:list 46.35pt;
	font-size:9.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:Palatino;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	letter-spacing:.2pt;}
span.CodeinText
	{mso-style-name:"Code in Text";
	mso-style-parent:"";
	mso-ansi-font-size:9.0pt;
	mso-ascii-font-family:Courier;
	mso-hansi-font-family:Courier;
	color:black;
	letter-spacing:.2pt;}
p.CodeForeground, li.CodeForeground, div.CodeForeground
	{mso-style-name:"Code Foreground";
	mso-style-update:auto;
	mso-style-parent:"";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:17.3pt;
	margin-bottom:.0001pt;
	line-height:10.0pt;
	mso-pagination:widow-orphan;
	mso-hyphenate:none;
	tab-stops:56.9pt 84.95pt 141.85pt 169.9pt;
	background:#F2F2F2;
	mso-shading:windowtext;
	mso-pattern:gray-5 auto;
	font-size:8.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:Courier;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	color:black;
	mso-font-kerning:72.0pt;}
p.Background, li.Background, div.Background
	{mso-style-name:Background;
	mso-style-update:auto;
	mso-style-parent:"";
	margin-top:6.0pt;
	margin-right:33.85pt;
	margin-bottom:6.0pt;
	margin-left:33.85pt;
	mso-pagination:widow-orphan;
	mso-hyphenate:none;
	font-size:9.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:Palatino;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	color:black;
	letter-spacing:.2pt;
	mso-font-kerning:72.0pt;
	font-style:italic;
	mso-bidi-font-style:normal;}
span.Screentext
	{mso-style-name:Screentext;
	mso-style-parent:"";
	mso-ansi-font-size:9.0pt;
	mso-ascii-font-family:Helvetica;
	mso-hansi-font-family:Helvetica;
	letter-spacing:.2pt;}
p.NumberedBulletsUSETHIS, li.NumberedBulletsUSETHIS, div.NumberedBulletsUSETHIS
	{mso-style-name:"Numbered Bullets USE THIS";
	mso-style-update:auto;
	mso-style-parent:"";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:51.05pt;
	text-indent:-22.7pt;
	mso-pagination:widow-orphan;
	mso-list:l6 level1 lfo9;
	tab-stops:0in 28.35pt list 51.05pt;
	font-size:9.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:Palatino;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	letter-spacing:.2pt;}
p.NumberedBulletsnonumber, li.NumberedBulletsnonumber, div.NumberedBulletsnonumber
	{mso-style-name:"Numbered Bullets \(no number\)";
	mso-style-update:auto;
	mso-style-parent:"";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:51.05pt;
	mso-pagination:widow-orphan;
	tab-stops:0in 28.35pt;
	font-size:9.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:Palatino;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	letter-spacing:.2pt;}
p.LayoutNotes, li.LayoutNotes, div.LayoutNotes
	{mso-style-name:"Layout Notes";
	mso-style-update:auto;
	margin-top:0in;
	margin-right:-5.65pt;
	margin-bottom:0in;
	margin-left:28.1pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	mso-hyphenate:none;
	font-size:11.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:Palatino;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	color:red;
	letter-spacing:.2pt;
	font-style:italic;
	mso-bidi-font-style:normal;}
span.msoIns
	{mso-style-type:export-only;
	mso-style-name:"";
	text-decoration:underline;
	text-underline:single;
	color:teal;}
span.msoDel
	{mso-style-type:export-only;
	mso-style-name:"";
	text-decoration:line-through;
	color:red;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
 /* List Definitions */
@list l0
	{mso-list-id:-132;
	mso-list-type:simple;
	mso-list-template-ids:-1237918082;}
@list l0:level1
	{mso-level-tab-stop:74.6pt;
	mso-level-number-position:left;
	margin-left:74.6pt;
	text-indent:-.25in;}
@list l1
	{mso-list-id:-131;
	mso-list-type:simple;
	mso-list-template-ids:-84222848;}
@list l1:level1
	{mso-level-tab-stop:60.45pt;
	mso-level-number-position:left;
	margin-left:60.45pt;
	text-indent:-.25in;}
@list l2
	{mso-list-id:-130;
	mso-list-type:simple;
	mso-list-template-ids:-2114795724;}
@list l2:level1
	{mso-level-tab-stop:46.3pt;
	mso-level-number-position:left;
	margin-left:46.3pt;
	text-indent:-.25in;}
@list l3
	{mso-list-id:234583780;
	mso-list-type:simple;
	mso-list-template-ids:-1763806554;}
@list l3:level1
	{mso-level-tab-stop:51.05pt;
	mso-level-number-position:left;
	margin-left:51.05pt;
	text-indent:-22.7pt;
	mso-ansi-font-size:11.0pt;
	font-family:FranklinGothic;
	mso-ansi-font-weight:bold;
	mso-ansi-font-style:normal;}
@list l4
	{mso-list-id:274095209;
	mso-list-type:simple;
	mso-list-template-ids:-1455633370;}
@list l4:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F071;
	mso-level-tab-stop:70.9pt;
	mso-level-number-position:left;
	margin-left:70.9pt;
	text-indent:-32.65pt;
	mso-ansi-font-size:8.0pt;
	font-family:Wingdings;}
@list l5
	{mso-list-id:1148518419;
	mso-list-type:simple;
	mso-list-template-ids:-1362331118;}
@list l5:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F071;
	mso-level-tab-stop:46.35pt;
	mso-level-number-position:left;
	margin-left:46.2pt;
	text-indent:-17.85pt;
	mso-ansi-font-size:8.0pt;
	font-family:ZapfDingbats;}
@list l6
	{mso-list-id:1231842714;
	mso-list-type:simple;
	mso-list-template-ids:-1264430030;}
@list l6:level1
	{mso-level-tab-stop:51.05pt;
	mso-level-number-position:left;
	margin-left:51.05pt;
	text-indent:-22.7pt;
	mso-ansi-font-size:11.0pt;
	font-family:"ITC Franklin Gothic Book";
	mso-ansi-font-weight:bold;
	mso-ansi-font-style:normal;}
@list l7
	{mso-list-id:1673868784;
	mso-list-type:simple;
	mso-list-template-ids:242933782;}
@list l7:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F071;
	mso-level-tab-stop:46.35pt;
	mso-level-number-position:left;
	margin-left:46.2pt;
	text-indent:-17.85pt;
	mso-ansi-font-size:8.0pt;
	font-family:Wingdings;}
ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>
</head>

<body bgcolor="#6373B5" text="#000000" link="0000ff" vlink="#666666" alink="#CC9900" lang=EN-US style='tab-interval:.5in'>


<center>
<!-- BEGIN RICH-MEDIA BURST! CODE --> 
       <script language="JavaScript"> 
       <!-- /* © 1997-1999 BURST! Media, LLC. All Rights Reserved.*/ 
       var TheAdcode = 'ad5645a'; 
       var bN = navigator.appName; 
       var bV = parseInt(navigator.appVersion); 
       var base='http://www.burstnet.com/'; 
       var Tv=''; 
       var agt=navigator.userAgent.toLowerCase(); 
       if (bV>=4) 
         {ts=window.location.pathname+window.location.search; 
          i=0; Tv=0; while (i< ts.length) 
             { Tv=Tv+ts.charCodeAt(i); i=i+1; } Tv="/"+Tv;} 
         else   {Tv=escape(window.location.pathname); 
          if( Tv.charAt(0)!='/' ) Tv="/"+Tv; 
                 else if (Tv.charAt(1)=="/")
       Tv=""; 
         if( Tv.charAt(Tv.length-1) == "/") 
           Tv = Tv + "_";} 
       if (bN=='Netscape'){ 
            if ((bV>=4)&&(agt.indexOf("mac")==-1))
       {  document.write('<s'+'cript src="'+ 
             base+'cgi-bin/ads/'+TheAdcode+'.cgi/RETURN-CODE/JS' 
             +Tv+'">'); 
            document.write('</'+'script>');    
       } 
            else if (bV>=3) {document.write('<'+'a href="'+base+'ads/'+ 
               TheAdcode+'-map.cgi'+Tv+'"target=_top>'); 
               document.write('<img src="' + base + 'cgi-bin/ads/' + 
               TheAdcode + '.cgi' + Tv + '" ismap width=468 height=60' + 
               ' border=0 alt="Click Here"></a>');} 
        } 
       if (bN=='Microsoft Internet Explorer') 
        document.write('<ifr'+'ame id=BURST src="'+base+'cgi-bin/ads/'
       + 
         TheAdcode + '.cgi' + Tv + '/RETURN-CODE" width=468 height=60' + 
         'marginwidth=0 marginheight=0 hspace=0 vspace=0 ' + 
         'frameborder=0 scrolling=no></ifr'+'ame>'); 
       // --> 
       </script> 
       <noscript><a href="http://www.burstnet.com/ads/ad5645a-map.cgi" target=_top> 
       <img src="http://www.burstnet.com/cgi-bin/ads/ad5645a.cgi" 
        width=468 height=60 border=0 alt="Click Here"></a> 
       </noscript> 
       <!-- END BURST CODE --> 
</center>
<table border="0" bgcolor="" cellpadding="0" cellspacing="0">
<tr><td><p align="center"><img src="../images/vblogo.jpg" border="0" alt="vb logo"></td></tr>
<tr> 
<td rowspan="3" valign="top" height="1"> <p>&nbsp;</p>

<p align="left"><font face= "verdana" color="#000000"><b>Visual Basic Books</b></font><br>
<a href="../index.html" vlink="#666666"><font color="#FFFFFF">Home</font></a><br>
<a href="../beginner.html"><font color="#FFFFFF">Visual Basic Beginner Books</font></a><br>
<a href="../database.html"><font color="#FFFFFF">Visual Basic Database Books</font></a><br>
<a href="../activex.html"><font color="#FFFFFF">Visual Basic ActiveX Books</font></a><br>
<a href="../advanced.html"><font color="#FFFFFF">Visual Basic Advanced Books</font></a><br>
<a href="../vbinternet.html"><font color="#FFFFFF">VB Internet Programming Books</font></a><br>


</p>
<p><font face= "verdana" color="#000000"><b>Resources</b></font><br>
<a href="../links.html"><font color="#FFFFFF">Visual Basic Links</font></a><br>
<a href="../addlink.html"><font color="#FFFFFF">Add a Link</font></a><br>
<a href="../esubscribe.html"><font color="#FFFFFF">Subscribe to Mailing List</font></a>
</p>
</font>
</td>
<td bgcolor="#ffffff" valign="bottom"><h1 align="center"><img src="../images/anibook.gif" alt="" width="32" height="32"><font face="trebuchet ms, arial, helvetica" color="#000000"> Visual Basic Books </font><img src="../images/anibook.gif" alt="" width="32" height="32"></h1></td>
</tr><tr>
<td bgcolor="#ffffff" colspan="1" valign="top">



<table cellpadding="5"><tr><td width="600">


<font FACE="Verdana, Arial, Helvetica" SIZE="-1">

<P>
<CENTER>
<A HREF="30640602.htm"><IMG SRC="back.gif" WIDTH=65 HEIGHT=34 BORDER=0 ALT="Back"></A>
<A HREF="contents.htm"><IMG SRC="contents.gif" WIDTH=69 HEIGHT=34 BORDER=0 ALT="Contents"></A>
<A HREF="30640604.htm"><IMG SRC="next.gif" WIDTH=62 HEIGHT=34 BORDER=0 ALT="Next"></A>
</CENTER>
<HR>

<div class=Section1>

<h1>DSN-Less Connections</h1>

<p class=MsoNormal><a name=c5dsnless>Using a DSN connection in your code
requires </a><!--[if supportFields]><span style='mso-bookmark:c5dsnless'></span><span
style='mso-element:field-begin'></span><span style='mso-bookmark:c5dsnless'><span
style="mso-spacerun: yes"> </span>XE &quot;databases:connecting:DSN-less
connections&quot;<span style="mso-spacerun: yes">  </span>/r “c5dsnless”</span><![endif]--><span
style='mso-bookmark:c5dsnless'></span><!--[if supportFields]><span
style='mso-bookmark:c5dsnless'></span><span style='mso-element:field-end'></span><![endif]--><span
style='mso-bookmark:c5dsnless'>that a DSN</span><!--[if supportFields]><span
style='mso-bookmark:c5dsnless'></span><span style='mso-element:field-begin'></span><span
style='mso-bookmark:c5dsnless'> XE &quot;DSN-less connections&quot; /r
“c5dsnless”</span><![endif]--><span style='mso-bookmark:c5dsnless'></span><!--[if supportFields]><span
style='mso-bookmark:c5dsnless'></span><span style='mso-element:field-end'></span><![endif]--><span
style='mso-bookmark:c5dsnless'> be set up on the server or computer that your
program or server component is running on. SQL Server can be on the same
computer or on some other computer on the network. This scenario, while good in
some circumstances, restricts where your code can run. </span><span
style='mso-bookmark:c5dsnless'><span class=MsoCommentReference><span
style='font-size:9.0pt;mso-bidi-font-size:8.0pt'>Because a DSN-less connection
specifies all of the parameters necessary to connect to SQL Server, using a
DSN-less connection allows your program to be run on different machines without
having to set up a new DSN.<o:p></o:p></span></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsnless'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsnless'>This section explores
the </span><span style='mso-bookmark:c5dsnless'><span class=ImportantWords><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Times;color:black'>DSN-less
connection</span></span>. A DSN-less connection, as its names implies, uses no
DSN. What it does use is the required parameters that will </span><!--[if supportFields]><span
style='mso-bookmark:c5dsnless'></span><span style='mso-element:field-begin'></span><span
style='mso-bookmark:c5dsnless'><span style="mso-spacerun: yes"> </span>XE
&quot;Connection object:DSN-less connections&quot;<span style="mso-spacerun:
yes">  </span>/r “c5dsnless”</span><![endif]--><span style='mso-bookmark:c5dsnless'></span><!--[if supportFields]><span
style='mso-bookmark:c5dsnless'></span><span style='mso-element:field-end'></span><![endif]--><span
style='mso-bookmark:c5dsnless'>let the </span><span style='mso-bookmark:c5dsnless'><span
class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Courier;color:black'>Connection</span></span> object know how to
establish a connection to SQL Server. Using a DSN-less connection in your
server components helps to make your applications n-tier scalable, because your
server components are not restricted to running on one server. As your
components use a DSN-less connection, they can be moved from a server running
with your database, or from the computer running your program, to a server that
runs just the components. This spreads the workload among different servers and
your application has scaled from 2-tier to n-tier.</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsnless'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsnless'>Let's take a look at
some of the required parameters for a DSN-less connection. If you remember, in
the first step of setting up a DSN we specified what type of ODBC driver we
wanted to use. A DSN-less connection is no different and we must</span><!--[if supportFields]><span
style='mso-bookmark:c5dsnless'></span><span style='mso-element:field-begin'></span><span
style='mso-bookmark:c5dsnless'> XE &quot;ODBC:driver, specifying:for DSN-less
connections&quot; </span><![endif]--><span style='mso-bookmark:c5dsnless'></span><!--[if supportFields]><span
style='mso-bookmark:c5dsnless'></span><span style='mso-element:field-end'></span><![endif]--><span
style='mso-bookmark:c5dsnless'></span><!--[if supportFields]><span
style='mso-bookmark:c5dsnless'></span><span style='mso-element:field-begin'></span><span
style='mso-bookmark:c5dsnless'><span style="mso-spacerun: yes"> </span>XE
&quot;ODBC:driver, specifying&quot; </span><![endif]--><span style='mso-bookmark:
c5dsnless'></span><!--[if supportFields]><span style='mso-bookmark:c5dsnless'></span><span
style='mso-element:field-end'></span><![endif]--><span style='mso-bookmark:
c5dsnless'><span style="mso-spacerun: yes"> </span>specify the ODBC driver to
be used, in our case SQL Server. This is specified as </span><span
style='mso-bookmark:c5dsnless'><span class=CodeinText><span style='font-size:
9.0pt;mso-bidi-font-size:12.0pt;font-family:Courier;color:black'>Driver</span></span></span><span
style='mso-bookmark:c5dsnless'><span class=CodeinText><span style='font-size:
9.0pt;mso-bidi-font-size:12.0pt;font-family:Palatino;color:black'> </span></span></span><span
style='mso-bookmark:c5dsnless'><span class=CodeinText><span style='font-size:
9.0pt;mso-bidi-font-size:12.0pt;font-family:Courier;color:black'>=</span></span></span><span
style='mso-bookmark:c5dsnless'><span class=CodeinText><span style='font-size:
9.0pt;mso-bidi-font-size:12.0pt;font-family:Palatino;color:black'> </span></span></span><span
style='mso-bookmark:c5dsnless'><span class=CodeinText><span style='font-size:
9.0pt;mso-bidi-font-size:12.0pt;font-family:Courier;color:black'>SQL</span></span>
</span><span style='mso-bookmark:c5dsnless'><span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Courier;
color:black'>Server</span></span>.</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsnless'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsnless'>The next step when we
set up our DSN was to select the server where SQL Server was running – in our
case it was </span><span style='mso-bookmark:c5dsnless'><span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Courier;
color:black'>Local</span></span>. </span><span style='mso-bookmark:c5dsnless'><span
class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Courier;color:black'>Local</span></span> will not work here, so we
need to specify the actual name of our computer. For our DSN-less connection we
specify </span><span style='mso-bookmark:c5dsnless'><span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Courier;
color:black'>Server</span></span></span><span style='mso-bookmark:c5dsnless'><span
class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Palatino;color:black'> </span></span></span><span style='mso-bookmark:
c5dsnless'><span class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:
12.0pt;font-family:Courier;color:black'>=</span></span></span><span
style='mso-bookmark:c5dsnless'><span class=CodeinText><span style='font-size:
9.0pt;mso-bidi-font-size:12.0pt;font-family:Palatino;color:black'> </span></span></span><span
style='mso-bookmark:c5dsnless'><span class=CodeinText><span style='font-size:
9.0pt;mso-bidi-font-size:12.0pt;font-family:Courier;color:black'>WSDevelopment</span></span>,
where </span><span style='mso-bookmark:c5dsnless'><span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Courier;
color:black'>WSDevelopment</span></span> is my computer's name.</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsnless'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsnless'>Once we have specified
the server where SQL Server is running, we need to let our DSN-less connection
know which database in SQL Server we want to access, and we do so by specifying
</span><span style='mso-bookmark:c5dsnless'><span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Courier;
color:black'>Database</span></span></span><span style='mso-bookmark:c5dsnless'><span
class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Palatino;color:black'> </span></span></span><span style='mso-bookmark:
c5dsnless'><span class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:
12.0pt;font-family:Courier;color:black'>=</span></span></span><span
style='mso-bookmark:c5dsnless'><span class=CodeinText><span style='font-size:
9.0pt;mso-bidi-font-size:12.0pt;font-family:Palatino;color:black'> </span></span></span><span
style='mso-bookmark:c5dsnless'><span class=CodeinText><span style='font-size:
9.0pt;mso-bidi-font-size:12.0pt;font-family:Courier;color:black'>Wrox_Auto_Works</span></span>.</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsnless'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsnless'>The following code
fragment is what our </span><span style='mso-bookmark:c5dsnless'><span
class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Courier;color:black'>Connection</span></span> object looks like at
this point:</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsnless'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsnless'>objConn.Open
&quot;Driver=SQL Server;Server=WSDevelopment;Database=Wrox_Auto_Works&quot;</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsnless'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsnless'>If you are using a
Windows NT authentication login in SQL Server, then this is all the information
you need. You would be able to establish a connection at this point. For those
readers who are using a SQL Server authentication login you must also specify a
</span><span style='mso-bookmark:c5dsnless'><span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Palatino;
color:black'>user ID</span></span> and p</span><span style='mso-bookmark:c5dsnless'><span
class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Palatino;color:black'>assword,</span></span> as shown in the next
code fragment:</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsnless'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsnless'>objConn.Open
&quot;Driver=SQL Server;Server=WSDevelopment;Database=Wrox_Auto_Works;&quot;
&amp; _</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsnless'><span
style="mso-spacerun: yes">      </span>UID=margie;PWD=margie&quot;</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsnless'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsnless'>Now that we know how to
create a DSN-less connection, let's put this information to use in a hands-on
example.</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsnless'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<div style='border:solid black 2.25pt;padding:1.0pt 1.0pt 1.0pt 1.0pt;
background:black;mso-shading:windowtext;mso-pattern:solid auto'>

<h5><span style='mso-bookmark:c5dsnless'>Try It Out – Using a DSN-Less
Connection</span></h5>

</div>

<p class=MsoNormal><span style='mso-bookmark:c5dsnless'>We will create a
program similar</span><!--[if supportFields]><span style='mso-bookmark:c5dsnless'></span><span
style='mso-element:field-begin'></span><span style='mso-bookmark:c5dsnless'> XE
&quot;DSN-less connections:using&quot; </span><![endif]--><span
style='mso-bookmark:c5dsnless'></span><!--[if supportFields]><span
style='mso-bookmark:c5dsnless'></span><span style='mso-element:field-end'></span><![endif]--><span
style='mso-bookmark:c5dsnless'></span><!--[if supportFields]><span
style='mso-bookmark:c5dsnless'></span><span style='mso-element:field-begin'></span><span
style='mso-bookmark:c5dsnless'><span style="mso-spacerun: yes"> </span>XE
&quot;Connection object:DSN-less connections:using&quot; </span><![endif]--><span
style='mso-bookmark:c5dsnless'></span><!--[if supportFields]><span
style='mso-bookmark:c5dsnless'></span><span style='mso-element:field-end'></span><![endif]--><span
style='mso-bookmark:c5dsnless'><span style="mso-spacerun: yes"> </span>to the
last one, using a simple form to display the state name. This program should
use a DSN-less connection and select all data from the </span><span
style='mso-bookmark:c5dsnless'><span class=CodeinText><span style='font-size:
9.0pt;mso-bidi-font-size:12.0pt;font-family:Courier;color:black'>State_T</span></span>
table. We will display only the first state on the form.</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsnless'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=NumberedBulletsUSETHIS style='margin-left:51.05pt;text-indent:-22.7pt;
mso-list:l0 level1 lfo2;tab-stops:0in 28.35pt list 51.05pt'><span
style='mso-bookmark:c5dsnless'><![if !supportLists]><b style='mso-bidi-font-weight:
normal'><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;font-family:
"ITC Franklin Gothic Book"'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></b><![endif]>You will need to open a new </span><span
style='mso-bookmark:c5dsnless'><span class=Screentext><span style='font-family:
Helvetica'>Standard EXE</span></span> project and set a reference to the </span><span
style='mso-bookmark:c5dsnless'><span class=Screentext><span style='font-family:
Helvetica'>Microsoft ActiveX Data Objects Library</span></span>, as described in
the previous example. </span></p>

<p class=NumberedBulletsUSETHIS style='margin-left:51.05pt;text-indent:-22.7pt;
mso-list:l0 level1 lfo2;tab-stops:0in 28.35pt list 51.05pt'><span
style='mso-bookmark:c5dsnless'><![if !supportLists]><b style='mso-bidi-font-weight:
normal'><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;font-family:
"ITC Franklin Gothic Book"'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></b><![endif]>Change the name of the form to </span><span
style='mso-bookmark:c5dsnless'><span class=CodeinText><span style='font-family:
Courier;color:black'>frmTryItOut3</span></span> and change the form caption to </span><span
style='mso-bookmark:c5dsnless'><span class=CodeinText><span style='font-family:
Courier;color:black'>Try It Out #3 – DSN-less Connection</span></span> if you
want to.</span></p>

<p class=NumberedBulletsUSETHIS style='margin-left:51.05pt;text-indent:-22.7pt;
mso-list:l0 level1 lfo2;tab-stops:0in 28.35pt list 51.05pt'><span
style='mso-bookmark:c5dsnless'><![if !supportLists]><b style='mso-bidi-font-weight:
normal'><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;font-family:
"ITC Franklin Gothic Book"'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></b><![endif]>Place a label control on the form and use the
default name of </span><span style='mso-bookmark:c5dsnless'><span
class=Screentext><span style='font-family:Helvetica'>Label1</span></span>. The </span><span
style='mso-bookmark:c5dsnless'><span class=CodeinText><span style='font-family:
Courier;color:black'>Caption</span></span> property of the label can be left as
it is, or you can remove the text in the </span><span style='mso-bookmark:c5dsnless'><span
class=CodeinText><span style='font-family:Courier;color:black'>Caption property</span></span>.</span></p>

<p class=NumberedBulletsUSETHIS style='margin-left:51.05pt;text-indent:-22.7pt;
mso-list:l0 level1 lfo2;tab-stops:0in 28.35pt list 51.05pt'><span
style='mso-bookmark:c5dsnless'><![if !supportLists]><b style='mso-bidi-font-weight:
normal'><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;font-family:
"ITC Franklin Gothic Book"'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></b><![endif]>Enter the following code, which can be found in </span><span
style='mso-bookmark:c5dsnless'><span class=CodeinText><span style='font-family:
Courier;color:black'>frmTryItOut3.frm</span></span>. (Note that if you are
using SQL Server authentication you will need to add your</span><span
style='mso-bookmark:c5dsnless'><span class=CodeinText><span style='font-family:
Courier;color:black'> user ID</span></span> and p</span><span style='mso-bookmark:
c5dsnless'><span class=CodeinText><span style='font-family:Courier;color:black'>assword</span></span>
details to the connection string – refer to the <em>How It Works</em> section
below for more help with this.)</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsnless'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsnless'>Private Sub
Form_Load()</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsnless'><span
style="mso-spacerun: yes">   </span>'Use the standard Windows icon</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsnless'><span
style="mso-spacerun: yes">   </span>Me.Icon = Nothing</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsnless'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsnless'><span
style="mso-spacerun: yes">   </span>'Declare database objects</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsnless'><span
style="mso-spacerun: yes">   </span>Dim objConn As New ADODB.Connection</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsnless'><span
style="mso-spacerun: yes">   </span>Dim objRS As New ADODB.Recordset</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsnless'><span
style="mso-spacerun: yes">   </span>Dim objErr As ADODB.Error</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsnless'><span
style="mso-spacerun: yes">   </span></span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsnless'><span
style="mso-spacerun: yes">   </span>'Establish a database connection using NT
Authentication</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsnless'><span
style="mso-spacerun: yes">   </span>objConn.Open &quot;Driver=SQL
Server;Server=WSDevelopment;Database=Wrox_Auto_Works&quot;</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsnless'><span
style="mso-spacerun: yes">   </span></span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsnless'><span
style="mso-spacerun: yes">   </span>'Check the state of the connection to
ensure we are connected</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsnless'><span
style="mso-spacerun: yes">   </span>If objConn.State = adStateOpen Then</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsnless'><span
style="mso-spacerun: yes">   </span></span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsnless'><span
style="mso-spacerun: yes">      </span>'Open a recordset</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsnless'><span
style="mso-spacerun: yes">      </span>objRS.Open &quot;SELECT * FROM
State_T&quot;, objConn, adOpenForwardOnly, adLockReadOnly, adCmdText</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsnless'><span
style="mso-spacerun: yes">      </span>If Not objRS.EOF And Not objRS.BOF Then</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsnless'><span
style="mso-spacerun: yes">         </span>Label1.Caption = objRS!State_Name_VC</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsnless'><span
style="mso-spacerun: yes">      </span>End If</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsnless'><span
style="mso-spacerun: yes">      </span>objRS.Close</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsnless'><span
style="mso-spacerun: yes">      </span></span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsnless'><span
style="mso-spacerun: yes">   </span>Else</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsnless'><span
style="mso-spacerun: yes">      </span></span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsnless'><span
style="mso-spacerun: yes">      </span>'Display all errors</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsnless'><span
style="mso-spacerun: yes">      </span>For Each objErr In objConn.Errors</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsnless'><span
style="mso-spacerun: yes">         </span>Debug.Print objErr.Description</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsnless'><span
style="mso-spacerun: yes">      </span>Next</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsnless'><span
style="mso-spacerun: yes">      </span></span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsnless'><span
style="mso-spacerun: yes">   </span>End If</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsnless'><span
style="mso-spacerun: yes">   </span></span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsnless'><span
style="mso-spacerun: yes">   </span>'De-reference the database objects</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsnless'><span
style="mso-spacerun: yes">   </span>Set objRS = Nothing</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsnless'><span
style="mso-spacerun: yes">  </span><span style="mso-spacerun:
yes"> </span>objConn.Close</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsnless'><span
style="mso-spacerun: yes">   </span>Set objConn = Nothing</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsnless'>End Sub</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsnless'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=NumberedBulletsUSETHIS style='margin-left:0in;text-indent:0in;
mso-text-indent-alt:0in'><span style='mso-bookmark:c5dsnless'>Run the program
and you should see something like the following:</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsnless'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsnless'><!--[if gte vml 1]><v:shapetype
 id="_x0000_t75" coordsize="21600,21600" o:spt="75" o:preferrelative="t"
 path="m@4@5l@4@11@9@11@9@5xe" filled="f" stroked="f">
 <v:stroke joinstyle="miter"/>
 <v:formulas>
  <v:f eqn="if lineDrawn pixelLineWidth 0"/>
  <v:f eqn="sum @0 1 0"/>
  <v:f eqn="sum 0 0 @1"/>
  <v:f eqn="prod @2 1 2"/>
  <v:f eqn="prod @3 21600 pixelWidth"/>
  <v:f eqn="prod @3 21600 pixelHeight"/>
  <v:f eqn="sum @0 0 1"/>
  <v:f eqn="prod @6 1 2"/>
  <v:f eqn="prod @7 21600 pixelWidth"/>
  <v:f eqn="sum @8 21600 0"/>
  <v:f eqn="prod @7 21600 pixelHeight"/>
  <v:f eqn="sum @10 21600 0"/>
 </v:formulas>
 <v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/>
 <o:lock v:ext="edit" aspectratio="t"/>
</v:shapetype><v:shape id="_x0000_i1025" type="#_x0000_t75" style='width:201.75pt;
 height:110.25pt' fillcolor="window">
 <v:imagedata src="image001.png" o:title="Fig12_C5"/>
</v:shape><![endif]--><![if !vml]><img width=269 height=147
src="image002.jpg" v:shapes="_x0000_i1025"><![endif]></span></p>

<p class=LayoutNotes><span style='mso-bookmark:c5dsnless'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=HowItWorks><span style='mso-bookmark:c5dsnless'>How It Works – Using a
DSN-Less Connection</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsnless'>The first part of the
code in this example is the same as the last one. The difference comes when we
open our database connection using the </span><span style='mso-bookmark:c5dsnless'><span
class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Courier;color:black'>Connection</span></span> object. Here we are
using a DSN-less connection as we discussed above, and are using a SQL Server
login that uses NT authentication:</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsnless'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsnless'><span
style="mso-spacerun: yes">   </span>'Establish a database connection using NT
Authentication</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsnless'><span
style="mso-spacerun: yes">   </span>objConn.Open &quot;Driver=SQL
Server;Server=WSDevelopment;Database=Wrox_Auto_Works&quot;</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsnless'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsnless'>For those readers whose
SQL Server login uses SQL Server authentication, substitute one of the
following code fragments to connect. Don't forget to substitute your login ID
and password. The first code fragment uses one </span><span style='mso-bookmark:
c5dsnless'><span class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:
12.0pt;font-family:Courier;color:black'>ConnectString</span></span> that
specifies the </span><span style='mso-bookmark:c5dsnless'><span
class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Palatino;color:black'>user ID</span></span> and p</span><span
style='mso-bookmark:c5dsnless'><span class=CodeinText><span style='font-size:
9.0pt;mso-bidi-font-size:12.0pt;font-family:Palatino;color:black'>assword</span></span>.
The second code fragment is an alternative that uses a </span><span
style='mso-bookmark:c5dsnless'><span class=CodeinText><span style='font-size:
9.0pt;mso-bidi-font-size:12.0pt;font-family:Courier;color:black'>ConnectString</span></span>,
with the </span><span style='mso-bookmark:c5dsnless'><span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Palatino;
color:black'>user ID</span></span> and p</span><span style='mso-bookmark:c5dsnless'><span
class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Palatino;color:black'>assword</span></span> specified as separate
parameters:</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsnless'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsnless'><span
style="mso-spacerun: yes">   </span>'Establish a database connection using SQL
Server Authentication</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsnless'><span
style="mso-spacerun: yes">   </span>objConn.Open &quot;Driver=SQL
Server;Server=WSDevelopment;&quot; &amp; _</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsnless'><span
style="mso-spacerun: yes">     
</span>&quot;Database=Wrox_Auto_Works;UID=margie;PWD=margie&quot;</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsnless'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsnless'><span
style="mso-spacerun: yes">   </span>'Establish a database connection using SQL
Server Authentication</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsnless'><span
style="mso-spacerun: yes">   </span>objConn.Open &quot;Driver=SQL
Server;Server=WSDevelopment;&quot; &amp; _</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsnless'><span
style="mso-spacerun: yes">      </span>&quot;Database=Wrox_Auto_Works&quot;,
&quot;margie&quot;, &quot;margie&quot;</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsnless'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsnless'>This next part of code
is a little different from our last example, and shows an alternative way to
select data from the </span><span style='mso-bookmark:c5dsnless'><span
class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Courier;color:black'>State_T</span></span> table. While this change
is not necessary in your code, it does demonstrate another method of selecting
the same data. We are using an actual SQL statement instead of the table name
to select the state names. The rest of the parameters of the </span><span
style='mso-bookmark:c5dsnless'><span class=CodeinText><span style='font-size:
9.0pt;mso-bidi-font-size:12.0pt;font-family:Courier;color:black'>Open</span></span>
method are the same, except the last parameter. Since we are using a SQL
statement, we must specify the </span><span style='mso-bookmark:c5dsnless'><span
class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Courier;color:black'>adCmdText</span></span> constant from the </span><span
style='mso-bookmark:c5dsnless'><span class=CodeinText><span style='font-size:
9.0pt;mso-bidi-font-size:12.0pt;font-family:Courier;color:black'>CommandTypeEnum</span></span>
enumeration for the </span><span style='mso-bookmark:c5dsnless'><span
class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Courier;color:black'>Options</span></span> parameter:</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsnless'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsnless'><span
style="mso-spacerun: yes">      </span>'Open a recordset</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsnless'><span
style="mso-spacerun: yes">      </span>objRS.Open &quot;SELECT * FROM
State_T&quot;, objConn, adOpenForwardOnly, adLockReadOnly, adCmdText</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsnless'><span
style="mso-spacerun: yes">      </span>If Not objRS.EOF And Not objRS.BOF Then</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsnless'><span
style="mso-spacerun: yes">         </span>Label1.Caption = objRS!State_Name_VC</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsnless'><span
style="mso-spacerun: yes">      </span>End If</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsnless'><span
style="mso-spacerun: yes">      </span>objRS.Close</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsnless'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsnless'>As you can see, using a
DSN or DSN-less connection is very easy and very straightforward. These types
of connections are usually reserved for server components, but are often found
in front-end programs also.</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsnless'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsnless'>Either way, these types
of connections are quick to set up, and you can prompt the user for their </span><span
style='mso-bookmark:c5dsnless'><span class=CodeinText><span style='font-size:
9.0pt;mso-bidi-font-size:12.0pt;font-family:Palatino;color:black'>user ID</span></span>
and p</span><span style='mso-bookmark:c5dsnless'><span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Palatino;
color:black'>assword</span></span> before establishing a connection to the
database, instead of including them as part of the </span><span
style='mso-bookmark:c5dsnless'><span class=CodeinText><span style='font-size:
9.0pt;mso-bidi-font-size:12.0pt;font-family:Courier;color:black'>ConnectString</span></span>.</span></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

</div>

<HR>
<CENTER>
<A HREF="30640602.htm"><IMG SRC="back.gif" WIDTH=65 HEIGHT=34 BORDER=0 ALT="Back"></A><A HREF="contents.htm"><IMG SRC="contents.gif" WIDTH=69 HEIGHT=34 BORDER=0 ALT="Contents"></A><A HREF="30640604.htm"><IMG SRC="next.gif" WIDTH=62 HEIGHT=34 BORDER=0 ALT="Next"></A>
</CENTER>
<FONT SIZE=1>&copy;1999 <A HREF="http://www.wrox.com"> Wrox Press Limited</A>, US and UK.</FONT>
</td></tr></table></table><tr><td bgcolor="#991100"><center>
<font FACE="Verdana, Arial, Helvetica" SIZE="-1"><font color="#FFFFFF">Email us your comments:<a href="mailto:contact@vbbooks.freeservers.com"><img src="../images/emailed.gif"alt="mail" border=0></a><br>Fax: 1(916)404-7719<br>

 &copy;1999-2000 Visual Basic Books. All rights reserved.</font><br>

<img src="../images/vbbutton.gif">



</center>
</body>

</html>

