ID=F0398
URL=http://www.vbip.com/iphelper/get_tcp_table.asp
SIZE=39959
DATE=09/07/2002
TIME=13:20:09
DATASET=Visual Basic
HTML=
<html>

<head>
<title>Visual Basic and IP Helper API: Using the GetTcpTable function</title>
<meta name="description" content="The IP Helper API provides us with very useful function GetTcpTable that allows to get information on all the active TCP connections.">
<meta name="keywords" content="ip helper api, GetTcpTable, connection, IP address, TCP, IP, API, Visual Basic, function">
<meta name="ROBOTS" content="INDEX,FOLLOW">

	<link rel="stylesheet" type="text/css" href="../../vbip_nn.css">

</head>

<body bgcolor="#FFFFFF">
<form name="GlobalForm" ID="GlobalForm">
<table border="0" width="100%" cellspacing="0" cellpadding="0">
  <tr>
    <td width="100%">
      <table border="0" width="100%" cellspacing="0" cellpadding="0">
        <tr>
          <td width="120"><img border="0" src="../_borders/vbip_logo3.gif" width="132" height="50"></td>
          <td valign="middle">
				<p align="center">
              <!-- start BITS ad HTML -- top of page -- 468x60 banner www.bitsonthewire.com         --> 
               <iframe src="http://ads.bitsonthewire.com/admgriframe.asp?siteid=1126&ad_type=0" width=468 height=60 marginwidth=0 marginheight=0 hspace=0 vspace=0 frameborder=0 scrolling=no> 
                 <a href="http://ads.bitsonthewire.com/adrdrmanager.asp?loc=1">
                   <img border="0" src="http://ads.bitsonthewire.com/admanager.asp?loc=1&siteid=1126&ad_type=0">
                 </a></iframe> 
              <!-- stop BITS ad HTML -- top of page -- 468x60 banner                                --> 
				&nbsp;
              <a href="http://www.amazon.com/exec/obidos/redirect-home/vbipvisualbasici">
              <img border="0" src="../images/gnused120x60.gif" width="120" height="60"></a></p>
          </td>
        </tr>
      </table>
    </td>
  </tr>
  <tr>
    <td width="100%" height="1" valign="top">
      <hr noshade color="#FF9933">
    </td>
  </tr>
  <tr>
    <td width="100%" height="1" valign="top">
    <p class="barsidecaption">
    	<a href="../default.asp">Home</a> -
      	<a href="../whatsnew.asp"> What's New</a> - <a href="../tools.asp"> Tools&amp;Technologies</a> -
      	<a href="../resources.asp"> Resources</a> - <a href="../resources/books/default.asp">Books</a>
        - <a href="../forum/">Forum</a>
    </p>
    </td>
  </tr>
  <tr>
    <td width="100%" height="1" valign="top">
      <hr noshade color="#FF9933">
    </td>
  </tr>
</table>

<table width="100%" cellspacing="1" cellpadding="2" bordercolor="#800000" border="1">
  <tr>
    <td width="100%" bgcolor="#FF9933">
      <font color="#FFFFCC">
      <table border="0" width="100%" cellspacing="0" cellpadding="0">
        <tr>
          <td width="37%">
          <SCRIPT LANGUAGE=javascript>
          <!--
          if(navigator.appName.indexOf('Microsoft')>=0)
          {
          document.write('<a HREF="javascript:void(0);" class="tbcaption" onClick="window.external.AddFavorite(location.href, document.title);">Add to Favorites</a>');
          }
          // -->
          </SCRIPT>
          </td>
          <td width="63%">
            <p align="right" class="tbcaption"><a href="../default.asp" class="tbcaption">Home</a> -
            <a href="../tools.asp" class="tbcaption">Tools&amp;Technologies</a> - <a href="default.asp" class="tbcaption">Internet Protocol Helper API (IP Helper API)</a> - GetTcpTable</td>
        </tr>
      </table>
      </font>
    </td>
  </tr>
</table>
<table border="0" width="100%" cellspacing="0" cellpadding="0">

<!--table-->
    <td width="125" valign="top"  style="border-left: 1px solid #800000; border-right: 1px solid #800000; " bgcolor="#FF9933">

    <table border="0" width="100%">
     <tr>
        <td width="100%" bgcolor="#FFCC00" style="border-left: 1px solid #800000; border-right: 1px solid #FFFFCC; border-top: 1px solid #800000; border-bottom: 1px solid #FFFFCC; " height="20">
          <p align="center" class="barsidecaption">[Advertisement]</td>
      </tr>
      <tr>
        <td width="100%" style="border: 1px solid #800000; " height="120">
<!-- start BITS ad HTML -- first 125x125 banner www.bitsonthewire.com                 --> 
<iframe src="http://ads.bitsonthewire.com/admgriframe.asp?siteid=1126&ad_type=-6" width=125 height=125 marginwidth=0 marginheight=0 hspace=0 vspace=0 frameborder=0 scrolling=no>
<a href="http://ads.bitsonthewire.com/adrdrmanager.asp?loc=3"><img border="0" src="http://ads.bitsonthewire.com/admanager.asp?loc=3&siteid=1126&ad_type=-6"></a></iframe> 
<!-- stop BITS ad HTML -- 125x125 banner                                             --> 	
        </td>
      </tr>
         
      <tr>
        <td width="100%" style="border-left: 1px solid #800000; border-right: 1px solid #FFFFCC; border-top: 1px solid #800000; border-bottom: 1px solid #FFFFCC; " bgcolor="#FFCC00" height="21">
          <p align="center" class="barsidecaption">[Search vbip.com]</td>
      </tr>
      <tr>
      
        <td valign="top" width="100%" height="21">
        
			<input type="text" size="7" name="search_site">&nbsp;
			<input type="button"  value="Go" onclick='location.href="http://www.vbip.com/search2/search.asp?Realm=vbip.com&Match=1&Terms="+document.GlobalForm.search_site.value;'>	
		
        </td>
      </tr>
         
      <tr>
        <td width="100%" style="border-left: 1px solid #800000; border-right: 1px solid #FFFFCC; border-top: 1px solid #800000; border-bottom: 1px solid #FFFFCC; " bgcolor="#FFCC00" height="21">
          <p align="center" class="barsidecaption">[Search other VB sites]</td>
      </tr>
      <tr>
        <td valign="top" width="100%" height="21">
        
			<input type="text" size="7" name="search_web">&nbsp;
			<input type="button"  value="Go" onclick='location.href="http://www.vbip.com/search2/search.asp?Realm=Other+VB+Websites&Match=1&Terms="+document.GlobalForm.search_web.value;'>	
		      
      </tr>
     
      <tr>
        <td width="100%" style="border-left: 1px solid #800000; border-right: 1px solid #FFFFCC; border-top: 1px solid #800000; border-bottom: 1px solid #FFFFCC; " bgcolor="#FFCC00" height="21">
          <p align="center" class="barsidecaption">[Featured Book]</td>
      </tr>
      <tr>
        <td valign="top" width="100%" height="21">
<center><center>
<a href="http://www.vbip.com/appdev.asp">
<img src="http://www.vbip.com/images/appdev120x240.jpg">
</a>
</center></center>
        </td>
      </tr>
     
      <tr>
        <td width="100%" style="border-left: 1px solid #800000; border-right: 1px solid #FFFFCC; border-top: 1px solid #800000; border-bottom: 1px solid #FFFFCC; " bgcolor="#FFCC00" height="21">
          <p align="center" class="barsidecaption">[Newsletter]</td>
      </tr>
      <tr>
        <td width="100%" height="56">
          <form method="POST" action="../sub.asp" onSubmit="">
            <table border="0" width="100%" cellspacing="0">
              <tr>
                <td width="84%">
                <input type="text" name="T1" size="8" style="font-family: Tahoma; color: #800000; font-size: 8pt; background-color: #FFCC99; border-left: 1px solid #800000; border-right: 1px solid #FFFFCC; border-top: 1px solid #800000; border-bottom: 1px solid #FFFFCC; " value="your e-mail"></td>
                <td width="16%"><input type="submit" value="Sub" name="B1" style="font-family: Tahoma; font-size: 8pt; color: #800000"></td>
              </tr>
              <tr>
                <td width="100%" colspan="2"><input type="radio" value="V1" checked name="R1"><span class="barsidecaption">HTML</span>
                  <input type="radio" name="R1" value="V2"><span class="barsidecaption">Text</span></td>
              </tr>
            </table>
          </form>
        </td>
      </tr>

      <tr>
        <td width="100%" style="border-left: 1px solid #800000; border-right: 1px solid #FFFFCC; border-top: 1px solid #800000; border-bottom: 1px solid #FFFFCC; " bgcolor="#FFCC00" height="21">
      <p align="center" class="barsidecaption">
      [Partners]
      </tr>
	
  <tr>
        <td width="100%" height="22">
      <p align="center"><a href="http://www.vbcity.com" target="_blank"><img border="0" src="..//images/vbcity2_100x30.gif" width="100" height="30"></a>
  </tr>
  <tr>
        <td width="100%" height="22">
      <p align="center"><a href="http://www.vbweb.co.uk/" target="_blank"><img border="0" src="..//images/vbweb_button.gif" width="100" height="30"></a>
  </tr>  
      <tr>
        <td width="100%" height="12" align="center">
      <a href="http://www.vbwire.com" target="_blank"><img border="0" src="..//images/VBWire-btn.gif" width="100" height="30"></a>
      </tr>

  <tr>
        <td width="100%" height="22">
      <p align="center"><a href="http://www.developersdex.com/vb" target="_blank"><img border="0" src="..//images/vbdex.gif" width="100" height="30"></a>
  </tr>  
  <tr>
        <td width="100%" height="3">
        <center>
        <!-- BEGIN ACKY CODE -->
		<a href="http://www.acky.net" target="_blank"><img
		src="http://www.acky.net/banners/ackbut3.gif" width="88" height="31"
		border="0" alt="Acky.net is your one stop shop for all of your web
		developing needs"></a>
		<!-- END ACKY CODE -->
		</center>
  </tr>
    </table>

    </td>
    <td valign="top" bgcolor="#FFFFFF">
      <blockquote>
        <p><b><font face="Arial"><a href="../winsock_control.asp"><br>
        </a>
        </font></b><img border="0" src="iphelper-banner.gif"></p>
        <p class="ChapterTitle">How to get all the IP addresses and opened TCP ports on the local system</p>
    <table border="0" width="90%" cellspacing="0" cellpadding="0" height="44">
            <tr>
              <td width="100%" height="15" colspan="3">
        <hr noshade size="1" color="#FF9933">
              </td>
            </tr>
            <tr>
              <td width="16" bgcolor="#FFFFCC" height="21" valign="top" style="border: 1px solid #FF9933" class="tbcaption">
                <p align="center">
                <a href="files/GetTcpTable.zip">
                <img border="0" src="../images/download-icon4.gif" align="right"></a></td>
              <td width="40%" bgcolor="#FF9933" height="21" class="tbcaption">
                <p>&nbsp;<a class="tbcaption" href="files/GetTcpTable.zip">Download 
                TCP Table project</a></td>
              <td width="57%" bgcolor="#FF9933" height="21" class="tbcaption">
              &nbsp;</td>
            </tr>
            <tr>
              <td width="100%" height="15" colspan="3">
        <hr noshade size="1" color="#FF9933">
              </td>
            </tr>
          </table>
          <p>
    The IP Helper API provides us with very useful function GetTcpTable that
    allows to get information on all the active TCP connections. Just one call
    of the function gives the information that you can see in the screenshot of
    the sample:        
        </p>
        <p align="center">
    <img border="0" src="images/get_tcp_table_01.gif">        
        </p>
        <p>
    Using of the GetTcpTable function is not trivial, so I am going to describe
    the technique used in this example. Firstly, let's take a look at what the
    documentation tells us about that function.        
        </p>
        <blockquote>
        <p class="code">
    DWORD GetTcpTable(<br>
    &nbsp; PMIB_TCPTABLE pTcpTable, // buffer for the connection table<br>
    &nbsp; PDWORD pdwSize,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    // size of the buffer<br>
    &nbsp; BOOL
    bOrder&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    // sort the table?<br>
    );        
        </p>
        </blockquote>
        <p>Converting that function definition to the VB Declare statement, we
        could get the following:        
        </p>
        <blockquote>
          <p class="code"><font color="#000080">Declare Function</font>
          GetTcpTable <font color="#000080">Lib</font> &quot;iphlpapi.dll&quot;
          (<font color="#000080">ByRef</font> pTcpTable <font color="#000080">As</font>
          PMIB_TCPTABLE, _<br>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          <font color="#000080">ByRef</font> pdwSize <font color="#000080">As
          Long</font>, _<br>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          <font color="#000080">ByVal</font> bOrder <font color="#000080">As
          Long</font>) <font color="#000080">As Long</font>        
        </p>
        </blockquote>
        <p>
    Don't hurry up. Let's consider the PMIB_TCPTABLE structure.        
        </p>
        <blockquote>
        <p class="code">
    typedef struct _MIB_TCPTABLE {<br>
    &nbsp; DWORD dwNumEntries;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    // number of entries in the table<br>
    &nbsp; MIB_TCPROW table[ANY_SIZE]; // array of TCP connections<br>
    } MIB_TCPTABLE, *PMIB_TCPTABLE;        
        </p>
        </blockquote>
        <p>
    There is one more structure - MIB_TCPROW:        
        </p>
        <blockquote>
        <p class="code">
    typedef struct _MIB_TCPROW {<br>
    &nbsp; DWORD dwState;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // state of the
    connection<br>
    &nbsp; DWORD dwLocalAddr;&nbsp; // address on local computer<br>
    &nbsp; DWORD dwLocalPort;&nbsp; // port number on local computer<br>
    &nbsp; DWORD dwRemoteAddr; // address on remote computer<br>
    &nbsp; DWORD dwRemotePort; // port number on remote computer<br>
    } MIB_TCPROW, *PMIB_TCPROW;        
        </p>
        </blockquote>
        <p>
    that can be very easy converted into the VB user defined type:        
        </p>
        <blockquote>
        <p class="code">
    <font color="#000080">Type</font> MIB_TCPROW<br>
    &nbsp;&nbsp;&nbsp; dwState <font color="#000080">As Long</font><br>
    &nbsp;&nbsp;&nbsp; dwLocalAddr <font color="#000080">As Long</font><br>
    &nbsp;&nbsp;&nbsp; dwLocalPort <font color="#000080">As Long</font><br>
    &nbsp;&nbsp;&nbsp; dwRemoteAddr <font color="#000080">As Long</font><br>
    &nbsp;&nbsp;&nbsp; dwRemotePort <font color="#000080">As Long</font><br>
    <font color="#000080">End Type</font>        
        </p>
        </blockquote>
        <p>OK, but how to declare the MIB_TCPTABLE structure that is used as a
        parameter of the GetTcpTable function? A number of TCP connections is a
        dynamic value so using the MIB_TCPTABLE in VB doesn't make any sense.
        Instead we can consider the pTcpTable parameter of the function as a
        pointer&nbsp;        
        </p>
        <blockquote>
          <p class="code"><font color="#000080">Declare Function</font>
          GetTcpTable <font color="#000080">Lib</font> &quot;iphlpapi.dll&quot;
          (<font color="#000080">ByRef</font> pTcpTable <font color="#000080">As
          Any</font>, _<br>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          <font color="#000080">ByRef</font> pdwSize <font color="#000080">As
          Long</font>, _<br>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          <font color="#000080">ByVal</font> bOrder <font color="#000080">As
          Long</font>) <font color="#000080">As Long</font>        
        </p>
        </blockquote>
        <p>to some block of memory which is represented by the MIB_TCPTABLE
        structure. I think that memory block looks like this:        
        </p>
        <blockquote>
          <p align="center"><img border="0" src="images/get_tcp_table_02.gif">        
        </p>
        </blockquote>
        <p>Having figured out how the data located in the memory, we can use the
        CopyMemory Win32API function to copy that data to our VB variables. To
        understand how it really works just look at the actual source code of
        the button click event procedure:        
        </p>
        <blockquote>
          <table border='0' width='80%' bgcolor='#F8F8F8' cellspacing='0' cellpadding='2'>
  <tr>
    <td width='100%'>
      <p class='code'><font color="#000080">Private&nbsp;Sub&nbsp;</font>Command1_Click()&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">'&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">Dim&nbsp;</font>arrBuffer()&nbsp;<font color="#000080">As&nbsp;Byte&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">Dim&nbsp;</font>lngSize&nbsp;<font color="#000080">As&nbsp;Long&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">Dim&nbsp;</font>lngRetVal&nbsp;<font color="#000080">As&nbsp;Long&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">Dim&nbsp;</font>lngRows&nbsp;<font color="#000080">As&nbsp;Long&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">Dim&nbsp;</font>i&nbsp;<font color="#000080">As&nbsp;Long&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">Dim&nbsp;</font>TcpTableRow&nbsp;<font color="#000080">As&nbsp;</font>MIB_TCPROW&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">Dim&nbsp;</font>lvItem&nbsp;<font color="#000080">As&nbsp;</font>ListItem&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">'&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;ListView1.ListItems.Clear&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">'&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;lngSize&nbsp;=&nbsp;0&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">'&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">'Call&nbsp;the&nbsp;GetTcpTable&nbsp;just&nbsp;to&nbsp;get &nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">'the&nbsp;buffer&nbsp;size&nbsp;into&nbsp;the&nbsp;lngSize&nbsp;variable&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;lngRetVal&nbsp;=&nbsp;GetTcpTable(<font color="#000080">ByVal&nbsp;</font>0&,&nbsp;lngSize,&nbsp;0)&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">'&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">If&nbsp;</font>lngRetVal&nbsp;=&nbsp;ERROR_NOT_SUPPORTED&nbsp;<font color="#000080">Then&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">'&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">'This&nbsp;API&nbsp;works&nbsp;only&nbsp;on&nbsp;Win&nbsp;98//2000&nbsp;and&nbsp;NT4&nbsp;with&nbsp;SP4&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MsgBox&nbsp;<font color="#808080">"IP&nbsp;Helper&nbsp;is&nbsp;not&nbsp;supported&nbsp;by&nbsp;this&nbsp;system."</font>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">Exit&nbsp;Sub&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">'&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">End&nbsp;If&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">'&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">'Prepare&nbsp;the&nbsp;buffer&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">ReDim&nbsp;</font>arrBuffer(0&nbsp;<font color="#000080">To&nbsp;</font>lngSize&nbsp;-&nbsp;1)&nbsp;<font color="#000080">As&nbsp;Byte&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">'&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">'And&nbsp;call&nbsp;the&nbsp;function&nbsp;one&nbsp;more&nbsp;time&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;lngRetVal&nbsp;=&nbsp;GetTcpTable(arrBuffer(0),&nbsp;lngSize,&nbsp;0)&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">'&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">If&nbsp;</font>lngRetVal&nbsp;=&nbsp;ERROR_SUCCESS&nbsp;<font color="#000080">Then&nbsp;</font><br>
    &nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">'&nbsp;</font><br>
    &nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">'The&nbsp;first&nbsp;4&nbsp;bytes&nbsp;contain&nbsp;the&nbsp;quantity&nbsp;of&nbsp;the&nbsp;table&nbsp;rows&nbsp;</font><br>
    &nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">'Get&nbsp;that&nbsp;value&nbsp;to&nbsp;the&nbsp;lngRows&nbsp;variable&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CopyMemory&nbsp;lngRows,&nbsp;arrBuffer(0),&nbsp;4&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">'&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">For&nbsp;</font>i&nbsp;=&nbsp;1&nbsp;<font color="#000080">To&nbsp;</font>lngRows&nbsp;<br>
        &nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">'&nbsp;</font><br>
        &nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">'Copy&nbsp;the&nbsp;table&nbsp;row&nbsp;data&nbsp;to&nbsp;the&nbsp;TcpTableRow&nbsp;structure&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CopyMemory&nbsp;TcpTableRow,&nbsp;arrBuffer(4&nbsp;+&nbsp;(i&nbsp;-&nbsp;1)&nbsp;*&nbsp;_&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Len(TcpTableRow)),&nbsp;Len(TcpTableRow)&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">'&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">If&nbsp;Not&nbsp;</font>((Check1.Value&nbsp;=&nbsp;vbChecked)&nbsp;<font color="#000080">And&nbsp;</font>_&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(GetIpFromPtr(TcpTableRow.dwLocalAddr)&nbsp;=&nbsp;<font color="#808080">"0.0.0.0"</font>&nbsp;<font color="#000080">Or&nbsp;</font>_&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GetIpFromPtr(TcpTableRow.dwLocalAddr)&nbsp;=&nbsp;<font color="#808080">"127.0.0.1"</font>))&nbsp;<font color="#000080">Then&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">'&nbsp;</font><br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">'Add&nbsp;the&nbsp;data&nbsp;to&nbsp;the&nbsp;ListView&nbsp;control&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">With&nbsp;</font>TcpTableRow&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">Set&nbsp;</font>lvItem&nbsp;=&nbsp;ListView1.ListItems.Add(,&nbsp;,&nbsp;_&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GetIpFromLong(.dwLocalAddr))&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lvItem.SubItems(1)&nbsp;=&nbsp;GetTcpPortNumber(.dwLocalPort)&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lvItem.SubItems(2)&nbsp;=&nbsp;GetIpFromLong(.dwRemoteAddr)&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lvItem.SubItems(3)&nbsp;=&nbsp;GetTcpPortNumber(.dwRemotePort)&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lvItem.SubItems(4)&nbsp;=&nbsp;GetState(.dwState)&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">End&nbsp;With&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">'&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">End&nbsp;If&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">'&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">Next&nbsp;</font>i&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">'&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">End&nbsp;If&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">'&nbsp;</font><br>
<font color="#000080">End&nbsp;Sub&nbsp;</font>&nbsp;<br>
      </p>
    </td>
  </tr>
</table>
        </blockquote>
        <p>
    Notice that there is the GetIpFromLong function in the code. That
    fucntion converts a numeric value into the string that contains IP-address.        
        </p>
        <blockquote>
        <table border='0' width='80%' bgcolor='#F8F8F8' cellspacing='0' cellpadding='2'>
  <tr>
    <td width='100%'>
      <p class='code'><font color="#000080">Private&nbsp;Function&nbsp;</font>GetIpFromLong(lngIPAddress&nbsp;<font color="#000080">As&nbsp;Long</font>)&nbsp;<font color="#000080">As&nbsp;String&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">'&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">Dim&nbsp;</font>arrIpParts(3)&nbsp;<font color="#000080">As&nbsp;Byte&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">'&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;CopyMemory&nbsp;arrIpParts(0),&nbsp;lngIPAddress,&nbsp;4&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">'&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;GetIpFromLong&nbsp;=&nbsp;<font color="#000080">CStr</font>(arrIpParts(0))&nbsp;&&nbsp;<font color="#808080">"."</font>&nbsp;&&nbsp;_&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">CStr</font>(arrIpParts(1))&nbsp;&&nbsp;<font color="#808080">"."</font>&nbsp;&&nbsp;_&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">CStr</font>(arrIpParts(2))&nbsp;&&nbsp;<font color="#808080">"."</font>&nbsp;&&nbsp;_&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">CStr</font>(arrIpParts(3))&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">'&nbsp;</font><br>
<font color="#000080">End&nbsp;Function&nbsp;</font>&nbsp;<br>
      </p>
    </td>
  </tr>
</table>
        </blockquote>
        <p>
    In the Visual Basic the Long data type is a 32-bit integer, in other words
    it consists of 4 (32/8) bytes. An IP-address is a 4-bytes value as well, but
    it is represented as a string with numeric values of that bytes delimited by
    a dot symbol. So, the GetIpFromLong function just retrieves values of Long's
    bytes and then builds an IP-address string from that values.        
        </p>
        <p>
    The port numbers are retrieved from the DWORD value with the following
    function:        
        </p>
        <blockquote>
          <table border='0' width='80%' bgcolor='#F8F8F8' cellspacing='0' cellpadding='2'>
  <tr>
    <td width='100%'>
      <p class='code'><font color="#000080">Private&nbsp;Function&nbsp;</font>GetTcpPortNumber(DWord&nbsp;<font color="#000080">As&nbsp;Long</font>)&nbsp;<font color="#000080">As&nbsp;Long&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;GetTcpPortNumber&nbsp;=&nbsp;DWord&nbsp;/&nbsp;256&nbsp;+&nbsp;(DWord&nbsp;<font color="#000080">Mod&nbsp;</font>256)&nbsp;*&nbsp;256&nbsp;<br>
<font color="#000080">End&nbsp;Function&nbsp;</font>&nbsp;<br>
      </p>
    </td>
  </tr>
</table>
        </blockquote>
        <p>
    And the last thing. Each row in the TCP table contains the State field that
    let us know about the connection state. The connection state can be:
    &quot;established&quot;, &quot;closed&quot;, &quot;closing&quot; and so on.
    Below is the GetState function that just returns the string by numeric
    value:        
        </p>
        <blockquote>
        <table border='0' width='80%' bgcolor='#F8F8F8' cellspacing='0' cellpadding='2'>
  <tr>
    <td width='100%'>
      <p class='code'><font color="#000080">Private&nbsp;Function&nbsp;</font>GetState(lngState&nbsp;<font color="#000080">As&nbsp;Long</font>)&nbsp;<font color="#000080">As&nbsp;String&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">'&nbsp;</font><br>
   &nbsp;<font color="#000080">Select&nbsp;Case&nbsp;</font>lngState&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">Case&nbsp;</font>MIB_TCP_STATE_CLOSED:&nbsp;GetState&nbsp;=&nbsp;<font color="#808080">"CLOSED"</font>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">Case&nbsp;</font>MIB_TCP_STATE_LISTEN:&nbsp;GetState&nbsp;=&nbsp;<font color="#808080">"LISTEN"</font>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">Case&nbsp;</font>MIB_TCP_STATE_SYN_SENT:&nbsp;GetState&nbsp;=&nbsp;<font color="#808080">"SYN_SENT"</font>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">Case&nbsp;</font>MIB_TCP_STATE_SYN_RCVD:&nbsp;GetState&nbsp;=&nbsp;<font color="#808080">"SYN_RCVD"</font>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">Case&nbsp;</font>MIB_TCP_STATE_ESTAB:&nbsp;GetState&nbsp;=&nbsp;<font color="#808080">"ESTAB"</font>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">Case&nbsp;</font>MIB_TCP_STATE_FIN_WAIT1:&nbsp;GetState&nbsp;=&nbsp;<font color="#808080">"FIN_WAIT1"</font>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">Case&nbsp;</font>MIB_TCP_STATE_FIN_WAIT2:&nbsp;GetState&nbsp;=&nbsp;<font color="#808080">"FIN_WAIT2"</font>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">Case&nbsp;</font>MIB_TCP_STATE_CLOSE_WAIT:&nbsp;GetState&nbsp;=&nbsp;<font color="#808080">"CLOSE_WAIT"</font>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">Case&nbsp;</font>MIB_TCP_STATE_CLOSING:&nbsp;GetState&nbsp;=&nbsp;<font color="#808080">"CLOSING"</font>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">Case&nbsp;</font>MIB_TCP_STATE_LAST_ACK:&nbsp;GetState&nbsp;=&nbsp;<font color="#808080">"LAST_ACK"</font>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">Case&nbsp;</font>MIB_TCP_STATE_TIME_WAIT:&nbsp;GetState&nbsp;=&nbsp;<font color="#808080">"TIME_WAIT"</font>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">Case&nbsp;</font>MIB_TCP_STATE_DELETE_TCB:&nbsp;GetState&nbsp;=&nbsp;<font color="#808080">"DELETE_TCB"</font>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">End&nbsp;Select&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">'&nbsp;</font><br>
<font color="#000080">End&nbsp;Function&nbsp;</font>&nbsp;<br>
      </p>
    </td>
  </tr>
</table>
        <p class="code">
    &nbsp;</p>
        </blockquote>
        <p>
    &nbsp;        
        </p>
        <p>        
    <hr noshade color="#FF9933">
    <table width="90%" align="center" border="0">
      <tr>
        <td width="25%">
          <img border="0" src="../../images/comments.gif">
        </td>
        <td width="75%">
          Please, post here only feedback for the article/tutorial/sample you
          have read above.<br>
          If you have any question and like to get an answer, post your messages in the <a href="http://www.vbip.com/forum/">Forum</a>.
        <td>
      </tr>
    </table>
    
    
			<p><b><font face="Arial" size="2" color="#800000"><a href="../../comment.asp?254">Port values incorrect</a></font></b><br>
			<i><font color="#808080" face="Times New Roman" size="2">James Friday, January 19, 2001</font></i>	
			</p>
			
			<p><b><font face="Arial" size="2" color="#800000"><a href="../../comment.asp?256">Reply to 'Port values incorrect'</a></font></b><br>
			<i><font color="#808080" face="Times New Roman" size="2">Oleg Gdalevich Friday, January 19, 2001</font></i>	
			</p>
			
			<p><b><font face="Arial" size="2" color="#800000"><a href="../../comment.asp?330">port numbers</a></font></b><br>
			<i><font color="#808080" face="Times New Roman" size="2">toni Saturday, April 14, 2001</font></i>	
			</p>
			
			<p><b><font face="Arial" size="2" color="#800000"><a href="../../comment.asp?331">port numbers</a></font></b><br>
			<i><font color="#808080" face="Times New Roman" size="2">toni Saturday, April 14, 2001</font></i>	
			</p>
			
			<p><b><font face="Arial" size="2" color="#800000"><a href="../../comment.asp?334">RE: port numbers</a></font></b><br>
			<i><font color="#808080" face="Times New Roman" size="2">Oleg Gdalevich Thursday, April 26, 2001</font></i>	
			</p>
			
			<p><b><font face="Arial" size="2" color="#800000"><a href="../../comment.asp?372">Port Numbers, thanks!</a></font></b><br>
			<i><font color="#808080" face="Times New Roman" size="2">DB Monday, June 04, 2001</font></i>	
			</p>
			
			<p><b><font face="Arial" size="2" color="#800000"><a href="../../comment.asp?435">Converted sample to Access 2000</a></font></b><br>
			<i><font color="#808080" face="Times New Roman" size="2">Rick Wannall Thursday, July 26, 2001</font></i>	
			</p>
			
			<p><b><font face="Arial" size="2" color="#800000"><a href="../../comment.asp?543">Great Help</a></font></b><br>
			<i><font color="#808080" face="Times New Roman" size="2">Santosh Thursday, October 04, 2001</font></i>	
			</p>
			
			<p><b><font face="Arial" size="2" color="#800000"><a href="../../comment.asp?628">Closing Active Ports</a></font></b><br>
			<i><font color="#808080" face="Times New Roman" size="2">Andrew Powell Thursday, December 06, 2001</font></i>	
			</p>
			
			<p><b><font face="Arial" size="2" color="#800000"><a href="../../comment.asp?651">Remote Host name---is it possible?</a></font></b><br>
			<i><font color="#808080" face="Times New Roman" size="2">thirumal Wednesday, December 19, 2001</font></i>	
			</p>
			
			<p><b><font face="Arial" size="2" color="#800000"><a href="../../comment.asp?681">about tcp</a></font></b><br>
			<i><font color="#808080" face="Times New Roman" size="2">Mody Sunday, January 06, 2002</font></i>	
			</p>
			
			<p><b><font face="Arial" size="2" color="#800000"><a href="../../comment.asp?797">Get Ports on remote system</a></font></b><br>
			<i><font color="#808080" face="Times New Roman" size="2">John M Tuesday, April 02, 2002</font></i>	
			</p>
			
			<p><b><font face="Arial" size="2" color="#800000"><a href="../../comment.asp?854">tcptable</a></font></b><br>
			<i><font color="#808080" face="Times New Roman" size="2">Raed Sunday, May 12, 2002</font></i>	
			</p>
			
			<p><b><font face="Arial" size="2" color="#800000"><a href="../../comment.asp?884">GetUDPTable</a></font></b><br>
			<i><font color="#808080" face="Times New Roman" size="2">Robert Thursday, May 23, 2002</font></i>	
			</p>
			
			<p><b><font face="Arial" size="2" color="#800000"><a href="../../comment.asp?961">It's not working</a></font></b><br>
			<i><font color="#808080" face="Times New Roman" size="2">Santosh Friday, July 05, 2002</font></i>	
			</p>
			
        <p>
        <form name="newcomm" method="POST" action="../../add_comments.asp">
          <p><input align="right" border="0" src="../../images/addyours2.gif" name="I1" type="image"></p>
          <input type="hidden" name="page" value="/iphelper/get_tcp_table.asp">
          <input type="hidden" name="title">
	  <input type="hidden" name="actionID" value="add">
        </form>
        <SCRIPT LANGUAGE="JavaScript">
        	{document.newcomm.title.value = document.title}
        </SCRIPT>
	<br>
        <p>
        <hr noshade color="#FF9933">
</p>  
      </blockquote>    
<p><center>
<!-- start BITS ad HTML -- bottom of page 468x60 banner www.bitsonthewire.com         --> 
  <iframe src="http://ads.bitsonthewire.com/admgriframe.asp?siteid=1126&ad_type=2" width=468 height=60 marginwidth=0 marginheight=0 hspace=0 vspace=0 frameborder=0 scrolling=no> 
    <a href="http://ads.bitsonthewire.com/adrdrmanager.asp?loc=2">
      <p>
      <img border="0" src="http://ads.bitsonthewire.com/admanager.asp?loc=2&siteid=1126&ad_type=2">
    </a>
  </iframe> 
<!-- stop BITS ad HTML -- bottom of page 468x60 banner                                --> 
</center></p>
    </td>
</table>
<table border="1" width="100%" cellspacing="1" cellpadding="2" bordercolor="#800000">
  <tr>
    <td width="100%" bgcolor="#FF9933">
      <font color="#FFFFCC">
      <table border="0" width="100%" cellspacing="0" cellpadding="0">
        <tr>
          <td width="37%"></td>
          <td width="63%">
            <p align="right" class="tbcaption"><a href="../default.asp" class="tbcaption">Home</a> -
            <a href="../tools.asp" class="tbcaption">Tools&amp;Technologies</a> -
            <a href="default.asp" class="tbcaption">Internet Protocol Helper API (IP Helper API)</a> - GetTcpTable
          </td>
        </tr>
      </table>
      </font>
    </td>
  </tr>
</table>
&nbsp;<table border="0" width="100%" cellspacing="0" cellpadding="0">
  <tr>
    <td width="121" valign="top">
<!-- START OF WEBTRENDS LIVE TAG -->
<!-- Copyright 2001 NetIQ Corporation -->
<!--  For privacy concerns, check our Privacy Policy at http://www.webtrendslive.com/privacy_policy.htm -->
<SCRIPT LANGUAGE="JavaScript">
<!--
// Modification of this code is not allowed and will permanently disable your account!
// SiteName:  Visual Basic Internet Programming
function wtl_Tag4_27048()
{
	function D8( d)
	{
		var fwd=1, seed= new Date('01/01/2000'), key= "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";
		var s= key.charAt( d.getFullYear()-2000)+key.charAt( d.getMonth()+1)+key.charAt( d.getDate());
		s+= key.charAt( d.getHours())+key.charAt( d.getMinutes())+key.charAt( d.getSeconds());
		while( seed.getDay()!=fwd) seed= new Date(seed.getTime() + 86400000);
		var w= Math.floor( (d.getTime()-(seed.getTime()+86400000)) / 604800000 );
		s+= key.charAt( (w-(w%16))/16 );
		s+= key.charAt( w%16);
		return s;
	}

	var t = new Date();
	var W="tagver=4&si=27048&fw=1&bn=13";
	W+="&tz="+escape(t.getTimezoneOffset());
	W+="&ch="+escape(t.getHours());
	W+="&cl="+escape(D8(t));
	W+="&ti="+escape(document.title);
	W+="&url="+escape(window.document.URL);
	W+="&rf="+escape(window.document.referrer);
	W+="&js=Yes";
	W+="&ul="+(navigator.appName=="Netscape"?navigator.language:navigator.userLanguage);
	if(typeof(screen)=="object")
	{
	W+="&sr="+screen.width+"x"+screen.height;
	W+="&cd="+screen.colorDepth;
	W+="&jo="+(navigator.javaEnabled()?"Yes":"No");
	}
	
	
	document.write('<A TARGET="_blank" HREF="http://www.webtrendslive.com/redirect.asp?siteID=27048">');
	document.write('<IMG ID="WTL_TAG" BORDER="0" WIDTH="100" HEIGHT="30" ALT="This Site Tracked by WebTrendsLive." SRC="http://p.wtlive.com/S003-00-9-14-186109-27048/button4.asp?'+W+'">');
	document.write('</A>');
	
}	

wtl_Tag4_27048();
//-->
</SCRIPT>


<NOSCRIPT>
<A TARGET="_blank" HREF="http://www.webtrendslive.com/redirect.asp?siteID=27048">
<IMG BORDER="0" WIDTH="100" HEIGHT="30" ALT="This Site Tracked by WebTrendsLive." SRC="http://p.wtlive.com/S003-00-9-14-186109-27048/button4.asp?tagver=4&si=27048&fw=1&bn=13&js=No&"></A></NOSCRIPT>


<!-- END OF WEBTRENDS LIVE TAG -->

     
      </td>
    <td>
<p align="center" class="barsidecaption"><a href="../default.asp">Home</a> | <a href="../whatsnew.asp">What's
New</a> | <a href="../tools.asp"> Tools
&amp; Technologies</a> | <a href="../resources.asp">Resources</a> | <a href="../resources/books/default.asp">Books</a>
 | <a href="../forum/">Forum</a></p>
<p align="center" class="barsidecaption">Report about any problems and errors to <a href="mailto:webmaster@vbip.com">webmaster@vbip.com</a><br>
Copyright © 1998 - 2002 by <a href="mailto:oleg@vbip.com"> Oleg Gdalevich</a></p>
    </td>
    <td valign="top" width="140">
<p align="center">
<a target="_blank" href="http://www.amazon.com/exec/obidos/ASIN/B00005AFI2/vbipvisualbasici">
<img border="0" src="../images/frontpage_button.gif" align="right" width="100" height="38"></a>
    </td>
  </tr>
</table>
</body>

</html>
