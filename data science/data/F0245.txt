ID=F0245
URL=http://jadebox.dreamhost.com/vbprog/html/using_metafile.bas.html
SIZE=8210
DATE=09/07/2002
TIME=13:17:14
DATASET=Visual Basic
HTML=<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">

<HTML>
<HEAD>
<TITLE>Using METAFILE.BAS</TITLE>
<meta name="keywords" content="Visual Basic,VB,VB5,VB6,Programming,Application,Development,Debug,Debugging,Basic,Metafiles,WMF,JPEG,JPG,GIF,Image,Images">

<META NAME="Generator" CONTENT="NetObjects Fusion 2.0.2 for Windows">

</HEAD>

<BODY BGCOLOR="#FFFFFF" LINK="#800000" VLINK="#808080" TEXT="#000000">
<TABLE CELLPADDING=0 CELLSPACING=0 BORDER=0 WIDTH=1352>
<TR VALIGN="top" ALIGN="left">
<TD>

  <TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH=98>
   <TR VALIGN="top" ALIGN="left">
	<TD WIDTH=2 HEIGHT =75><IMG SRC="../assets/auto_generated_images/img_3dfbb805.gif" WIDTH =2 HEIGHT =1 BORDER=0></TD>
	<TD WIDTH=96><IMG SRC="../assets/auto_generated_images/img_3dfbb805.gif" WIDTH =96 HEIGHT =1 BORDER=0></TD>
   </TR>
   <TR VALIGN="top" ALIGN="left">
	<TD HEIGHT =230></TD>
	<TD WIDTH=96>
	  <TABLE BORDER=0 CELLSPACING=0 CELLPADDING=3 >
	 <TR VALIGN="top" ALIGN="left">
		<TD WIDTH=90 HEIGHT=40><A HREF="../index.html"><IMG HEIGHT=40 WIDTH=90 SRC="../assets/auto_generated_images/img_49ab4036.gif"  BORDER=0  ALT=" Home " ></A></TD>
	 </TR>
	 <TR VALIGN="top" ALIGN="left">
		<TD WIDTH=90 HEIGHT=40><A HREF="../html/meta_files.html"><IMG HEIGHT=40 WIDTH=90 SRC="../assets/auto_generated_images/img_49b45df1a.gif"  BORDER=0  ALT=" Meta Files " ></A></TD>
	 </TR>
	 <TR VALIGN="top" ALIGN="left">
		<TD WIDTH=90 HEIGHT=40><A HREF="../html/review__hardcore_visual_basic.html"><IMG HEIGHT=40 WIDTH=90 SRC="../assets/auto_generated_images/img_4c083bc1.gif"  BORDER=0  ALT=" Hardcore VB " ></A></TD>
	 </TR>
	 <TR VALIGN="top" ALIGN="left">
		<TD WIDTH=90 HEIGHT=40><A HREF="../html/what_s_wrong_with_vb_.html"><IMG HEIGHT=40 WIDTH=90 SRC="../assets/auto_generated_images/img_4c0841a2.gif"  BORDER=0  ALT=" What's Wrong? " ></A></TD>
	 </TR>
	 <TR VALIGN="top" ALIGN="left">
		<TD WIDTH=90 HEIGHT=40><A HREF="../html/jpg_and_gif_sizes.html"><IMG HEIGHT=40 WIDTH=90 SRC="../assets/auto_generated_images/img_5138a491.gif"  BORDER=0  ALT=" Image Sizes " ></A></TD>
	 </TR>
	  </TABLE></TD>
   </TR>
   <TR VALIGN="top" ALIGN="left">
	<TD COLSPAN=2 HEIGHT =1495></TD>
   </TR>
  </TABLE>
</TD>
<TD>

  <TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH=1254>
   <TR VALIGN="top" ALIGN="left">
	<TD HEIGHT =71></TD>
	<TD WIDTH=505 COLSPAN=3><A HREF="http://www.jadebox.com/arrow/"><IMG HEIGHT=60 WIDTH=468 SRC="../assets/images/aniarrow.gif"  BORDER=0  ALT="Arrow" ></A></TD>
	<TD></TD>
   </TR>
   <TR VALIGN="top" ALIGN="left">
	<TD WIDTH=12 HEIGHT =40><IMG SRC="../assets/auto_generated_images/img_3dfbb805.gif" WIDTH =12 HEIGHT =1 BORDER=0></TD>
	<TD WIDTH=310><IMG HEIGHT=40 WIDTH=310 SRC="../assets/auto_generated_images/img_4d6b4d610f.gif"  BORDER=0  ALT=" Using METAFILE.BAS " ></TD>
	<TD WIDTH=147><IMG SRC="../assets/auto_generated_images/img_3dfbb805.gif" WIDTH =147 HEIGHT =1 BORDER=0></TD>
	<TD WIDTH=48><IMG SRC="../assets/auto_generated_images/img_3dfbb805.gif" WIDTH =48 HEIGHT =1 BORDER=0></TD>
	<TD WIDTH=737><IMG SRC="../assets/auto_generated_images/img_3dfbb805.gif" WIDTH =737 HEIGHT =1 BORDER=0></TD>
   </TR>
   <TR VALIGN="top" ALIGN="left">
	<TD COLSPAN=5 HEIGHT =10></TD>
   </TR>
   <TR VALIGN="top" ALIGN="left">
	<TD HEIGHT =48></TD>
	<TD WIDTH=457 COLSPAN=2 ALIGN="left" VALIGN="top"><A HREF="../html/creating_placeable_windows_metafiles.html"><IMG HEIGHT=48 WIDTH=48 SRC="../assets/images/Hand_Icon_Left.gif"  BORDER=0  ALT="Picture" ></A></TD>
	<TD WIDTH=48 ALIGN="left" VALIGN="top"><A HREF="../html/enhanced_metafiles.html"><IMG HEIGHT=48 WIDTH=48 SRC="../assets/images/Hand_Icon_Right.gif"  BORDER=0  ALT="Picture" ></A></TD>
	<TD></TD>
   </TR>
  </TABLE>

  <TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH=1254>
   <TR VALIGN="top" ALIGN="left">
	<TD WIDTH=12 HEIGHT =2><IMG SRC="../assets/auto_generated_images/img_3dfbb805.gif" WIDTH =12 HEIGHT =1 BORDER=0></TD>
	<TD WIDTH=505><IMG SRC="../assets/auto_generated_images/img_3dfbb805.gif" WIDTH =505 HEIGHT =1 BORDER=0></TD>
	<TD WIDTH=737><IMG SRC="../assets/auto_generated_images/img_3dfbb805.gif" WIDTH =737 HEIGHT =1 BORDER=0></TD>
   </TR>
   <TR VALIGN="top" ALIGN="left">
	<TD></TD>
	<TD WIDTH=505><P><B><FONT SIZE="-1" FACE="Arial,Helvetica">METADEMO.FRM in </B></FONT><A HREF="../html/listing_4b_-_metademo.frm.html"><B><FONT SIZE="-1" FACE="Arial,Helvetica">Listing 4</B></FONT></A><B><FONT SIZE="-1" FACE="Arial,Helvetica"> is an example of the use of METAFILE.BAS. When “Create” is selected from the “File” menu, METADEMO uses functions in METAFILE.BAS and METAGDI2.BAS to create a simple metafile. The “Open” option of the “File” menu loads a metafile into the form’s picture box control (picture box controls support Placeable Metafiles). Listing 5 is the project file for METADEMO.</B></FONT></P><P><B><FONT SIZE="-1" FACE="Arial,Helvetica">The metafile created by METADEMO loads correctly into Microsoft Word and most other Windows programs that import metafiles.</B></FONT></P><P><B><FONT SIZE="-1" FACE="Arial,Helvetica">METADEMO calls the Meta_File_Create function and the Meta_File_Close subroutine in METAFILE.BAS to create the metafile. METADEMO passes the name of the file to Meta_File_Create. The rectangle surrounding the drawing is defined to be 1000 units by 1000 units in size with 1000 units per inch (if you load this metafile into Word for Windows, for example, the picture size will be one inch by one inch).</B></FONT></P><P><B><FONT SIZE="-1" FACE="Arial,Helvetica">In addition to METAFILE.BAS, METADEMO uses two modules called METAAPI2.BAS and METAGDI2.BAS. METAAPI2.BAS contains the declarations for the Windows Graphics Device Interface (GDI) functions and METAGDI2.BAS contains functions that act as “wrappers” for the GDI functions. GDI functions are used to create drawings in metafiles. Each of the wrapper functions is passed the index to the metafile (which was returned by the Meta_File_Create function) as the first parameter. If the GDI function requires the metafile’s handle, the wrapper function uses the index to look up the handle. Each wrapper function then calls the appropriate Windows GDI function.</B></FONT></P><P><B><FONT SIZE="-1" FACE="Arial,Helvetica">The names of the wrapper functions match the names of the corresponding Windows GDI functions prefaced with “Meta_”. For more information about the GDI functions, see Microsoft’s <U>Windows Version 3.1 Programmer's Reference Volume 2: Functions</U> and the Windows 3.1 SDK Help file which is included with the Professional Edition of Visual Basic.</B></FONT></P><P><B><FONT SIZE="-1" FACE="Arial,Helvetica">METAGDI2.BAS and METAAPI2.BAS only define the wrapper functions needed by METADEMO. METAGDI.BAS and METAAPI.BAS define wrapper functions for all of the applicable GDI functions. Because of their large sizes, METAGDI.BAS and METAAPI.BAS are not listed, but are available electronically in the source archive file - </B></FONT><A HREF="http://dreamhost.jadebox.com/files/rsmetafiles.zip"><B><FONT SIZE="-1" FACE="Arial,Helvetica">rsmetafiles.zip</B></FONT></A><B><FONT SIZE="-1" FACE="Arial,Helvetica">.</B></FONT></TD>

	<TD></TD>
   </TR>
  </TABLE>

  <TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0>
   <TR VALIGN="top" ALIGN="left">
	<TD WIDTH=19 HEIGHT =37><IMG SRC="../assets/auto_generated_images/img_3dfbb805.gif" WIDTH =19 HEIGHT =1 BORDER=0></TD>
	<TD WIDTH=431><IMG SRC="../assets/auto_generated_images/img_3dfbb805.gif" WIDTH =431 HEIGHT =1 BORDER=0></TD>
	<TD WIDTH=804><IMG SRC="../assets/auto_generated_images/img_3dfbb805.gif" WIDTH =804 HEIGHT =1 BORDER=0></TD>
   </TR>
   <TR VALIGN="top" ALIGN="left">
	<TD></TD>
	<TD NOWRAP> [<A HREF="../index.html">Home</A>]  [<A HREF="../html/meta_files.html">Meta&nbsp;Files</A>]  [<A HREF="../html/review__hardcore_visual_basic.html">Hardcore&nbsp;VB</A>]  [<A HREF="../html/what_s_wrong_with_vb_.html">What's&nbsp;Wrong?</A>]  [<A HREF="../html/jpg_and_gif_sizes.html">Image&nbsp;Sizes</A>] </TD>
	<TD></TD>
   </TR>
   <TR VALIGN="top" ALIGN="left">
	<TD COLSPAN=3 HEIGHT =975></TD>
   </TR>
  </TABLE>
</TD>
</TR>
</TABLE>
</BODY>
</HTML>

