ID=E0348
URL=http://msdn.microsoft.com/visualc/techinfo/training/tour5.asp
SIZE=42768
DATE=12/07/02
TIME=19:20:08
DATASET=C
HTML=
<html>
<head>
<title>Building the MFC Application</title>
<meta name="KEYWORDS" content=" " />
<meta name="DESCRIPTION" content="Microsoft Visual C++ Evaluation  Guide" />
<meta name="MS.LOCALE" content="EN-US" />
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1" />
<meta name="DTC_TEMPLATE" content="TEMPLATE=endnode" />

		          <link rel="stylesheet" href="/visualc/css.asp?template=EP" type="text/css" />
          

     <meta http-equiv="PICS-Label" CONTENT='(PICS-1.1 "http://www.rsac.org/ratingsv01.html" l comment "RSACi North America Server" by "inet@microsoft.com" r (n 0 s 0 v 0 l 0))' />
     <script src="/products/shared/global.js" type="text/javascript"></script>
     
<link rel="stylesheet" type="text/css" href="/library/flyoutmenu/default.css" />


	
	<script type="text/javascript"><!--
	
	sImgDefaultArrow = "/products/shared/images/imgArrwUp_VS.gif";
	sImgExpandedArrow = "/products/shared/images/imgArrwDwn_VS.gif";

	if (sImgDefaultArrow == ""){
		sImgDefaultArrow = "/products/shared/images/arrow_default.gif";
	}
	if (sImgExpandedArrow == ""){
		sImgExpandedArrow = "/products/shared/images/arrow_expand.gif";
	}
	
	//-->
	</script>
   
</head>
<body bgcolor="#ffffff" topmargin="0" leftmargin="0" marginheight="0" marginwidth="0">	


          <span id="donotprint">
<!-- Start: ToolBar V2.0-->
<script type="text/javascript" language="JavaScript" src="/library/toolbar/toolbar.js"></script>
<script type="text/javascript" language="JavaScript" src="/library/toolbar/en-us/globalMNP.js"></script>
<script type="text/javascript" language="JavaScript" src="/products/shared/toolbar_vstudio.js"></script>
<!-- Start: ToolBar for down-level browsers-->
<span id="TBDownLevelDiv">
	<table width="100%" cellpadding="0" cellspacing="0" border="0" bgcolor="#6699CC">
		<tr>
			<td bgcolor="#6699CC" valign="top" width="250" rowspan="2"><a href="/visualc/" target="_top"><img src="/products/shared/images/bnr_VisualStudio.gif" alt="Visual C++ Home" border="0" /></a></td>
			<td bgcolor="#6699CC" valign="top" height="20" width="19" align="right"><img src="/library/toolbar/images/curve.gif" /></td>
			<td bgcolor="#000000" valign="middle" height="20" align="right" nowrap colspan="2"><font color="#ffffff" face="Verdana, Arial, Helvetica" size="1">
					&nbsp;&nbsp;<a style="color:#ffffff;text-decoration:none;" href="http://www.microsoft.com/products/" target="_top"><font color="#ffffff">All Products</font></a>&nbsp;&nbsp;<font color="#ffffff">|</font>
					&nbsp;&nbsp;<a style="color:#ffffff;text-decoration:none;" href="http://www.microsoft.com/support/" target="_top"><font color="#ffffff">Support</font></a>&nbsp;&nbsp;<font color="#ffffff">|</font>
					&nbsp;&nbsp;<a style="color:#ffffff;text-decoration:none;" href="http://search.microsoft.com/" target="_top"><font color="#ffffff">Search</font></a>&nbsp;&nbsp;<font color="#ffffff">|</font>
					&nbsp;&nbsp;<a style="color:#ffffff;text-decoration:none;" href="http://www.microsoft.com/" target="_top"><font color="#ffffff">microsoft.com Guide</font></a>&nbsp;&nbsp;</font></td>
		</tr>
		<tr>
			<td bgcolor="#6699CC" valign="top" height="40" width="19"><img src="/library/Images/Gifs/General/Trans.gif" width="1" height="1" border="0" alt></td>
			<td valign="top" height="40" align="right" nowrap colspan="2"><a href="/isapi/gomscom.asp?target=/" target="_top"><img src="/library/toolbar/images/mslogo6699CC.gif" width="112" height="40" alt="microsoft.com home" border="0"></a></td>
		</tr>
		<tr>
	<!-- Start: Local menus -->
		<td bgcolor="#6699CC" height="20" VALIGN="MIDDLE" NOWRAP COLSPAN="4">
			<font color="#FFFFFF" class="fontSize1"><b>
				&nbsp;&nbsp;<a style="color:#FFFFFF;text-decoration:none;" href="/visualc/" target="_top"><font color="#FFFFFF">Visual C++ Home</font></a>&nbsp;&nbsp;<font color="#FFFFFF">|</font>
		
			</b></font>
		</td>
	<!-- End: Local menus -->
		</tr>
	</table>
</span>
<!-- End: ToolBar for old browsers-->

<script language="JavaScript" type="text/javascript">
<!--// Hide from old browsers

var ToolBar_Supported = ToolBar_Supported;
if (ToolBar_Supported != null && ToolBar_Supported == true && (navigator.platform=="Win32"))
{
	TBDownLevelDiv.style.display ='none';
	drawToolbar();
	var fBrowserOK = true;
}

//-->
</script>
<!-- End: ToolBar V2.0-->



</span>
          <a name="top"></a>
          <table border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td bgcolor="#ffffff" height="1"><img src="/products/shared/images/ts.gif" height="1" width="1" /></td>
			</tr>
		</table>
          <table cellpadding="0" cellspacing="0" border="0" width="100%">
               <tr valign="top">
                    <td valign="top">
                         <table cellpadding="0" cellspacing="0" border="0" width="100%">
                              <tr valign="top">
                                   <td width="178" valign="top" id="donotprint" > 

									<!-- start leftnav And search code -->
										<table border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#6699CC">
											<tr height="38">
												<td bgcolor="#6699CC" align="center">
													<!-- quick search-->
													<table cellpadding="0" cellspacing="0" border="0" width="179">
													
													<form action="http://search.microsoft.com/us/products/vs/visualc/advanced_search.asp" method="GET" id="form1" name="form1">
													
														<tr>
															<td><img src="/products/shared/images/Trans.gif" height="1" width="5"></td>
															<td>
														<!--[if IE ]><span class="fontSize1" style="color:#FFFFFF">Search This Site</span><br>														<input type="hidden" name="IntCat" value="0" />														<input type="hidden" name="Boolean" value="ALL" />																													<input type="hidden" name="Nq" value="new" />																													<input type="text" name="qu" size="14" maxlength="255" style="height:20 px; width: 125 px;" />																													<img src="/products/shared/images/trans.gif" height="1" width="2" border="0" />															<input alt="go" type="submit" name="finish" value="Go" class="btnSearch">														<![endif]-->
														<![if ! ie ]>
															<span class="fontSize1" style="color:#FFFFFF">Search This Site<br>
															<input type="HIDDEN" name="IntCat" value="0" />
															<input type="HIDDEN" name="Boolean" value="ALL" />
															<input type="HIDDEN" name="Nq" value="NEW" />
															<input type="TEXT" name="qu" size="10" maxlength="255" />
															<input alt="Go" type="SUBMIT" name="FINISH" value="Go" />
															</span>
														<![endif]>
														</td>
														</tr>
										      		</form>
													</table>
													<!--end quick search -->
												</td>
												<td width="1" bgcolor="#6699CC"><img src="/products/shared/images/Trans.gif" alt height="0" width="1" border="0"></td>
											</tr>
											<tr>
												<td>
													<table cellpadding="0" cellspacing="0" border="0" width="100%" bgcolor="#6699CC">
														<tr>
															<td><img src="/products/shared/images/Trans.gif" height="1" width="3"></td>
															<td VALIGN="TOP" class="AdvSearch"><a HREF="http://search.microsoft.com/us/products/vs/visualc/advanced_search.asp?IntCat=0">Advanced Search</a></td>
														</tr>
													</table>
												</td>
											</tr>
										</table>
										<table border="0" cellpadding="0" cellspacing="0" width="100%" onmouseover="if(document.readyState=='complete'&amp;&amp;fBrowserOK)delayRemove();" onmouseout="if (document.readyState=='complete'&amp;&amp;fBrowserOK)cancelDelay();">
										<tr>
										<td bgcolor="#6699CC"><img src="/products/shared/images/Trans.gif" alt height="9" width="179"></td>
										<td width="1" bgcolor="#6699CC"><img src="/products/shared/images/Trans.gif" alt height="0" width="1" border="0"></td>
										</tr>
										</table>

										<table cellpadding="0" cellspacing="0" border="0" width="100%">
										    <tr>
										         <td>
										         
<table class="flyoutMenu" menudata="/visualc/inc/MnpXmlDataGen.asp?subroot=techinfo" width="180" cellpadding="2" cellspacing="0" border="0" >
	<tr>
		<td>

			<table width="175" cellpadding="0" cellspacing="0" border="0">
				<tr>
				
					<td class="flyoutLink" ><a href="/vstudio/default.asp">Visual Studio Home</a></td>
				
				</tr>
			</table>

			<table width="175" cellpadding="0" cellspacing="0" border="0">
				<tr>
				
					<td class="flyoutLink" ><a href="/visualc/default.asp">Visual C++ Home</a></td>
				
				</tr>
			</table>

			<table width="175" cellpadding="0" cellspacing="0" border="0">
				<tr>
				
					<td class="flyoutLink" handle="1001"><a href="/visualc/productinfo/default.asp">Product Information</a></td>
				
				</tr>
			</table>

			<table width="175" cellpadding="0" cellspacing="0" border="0">
				<tr>
				
					<td class="flyoutLink" handle="1074"><a href="/visualc/howtobuy/default.asp">How to Buy</a></td>
				
				</tr>
			</table>

			<table width="175" cellpadding="0" cellspacing="0" border="0">
				<tr>
				
					<td class="flyoutLink" handle="1078"><a href="/visualc/techinfo/default.asp">Technical Resources</a></td>
				
				</tr>
			</table>

			<table width="175" cellpadding="0" cellspacing="0" border="0">
				<tr>
				
					<td class="flyoutLink" handle="1084"><a href="/visualc/downloads/default.asp">Downloads</a></td>
				
				</tr>
			</table>

			<table width="175" cellpadding="0" cellspacing="0" border="0">
				<tr>
				
					<td class="flyoutLink" handle="1082"><a href="/visualc/support/default.asp">Support</a></td>
				
				</tr>
			</table>

			<table width="175" cellpadding="0" cellspacing="0" border="0">
				<tr>
				
					<td class="flyoutLink" handle="1142"><a href="/visualc/community/default.asp">Community</a></td>
				
				</tr>
			</table>
			
		</td>
	</tr>
</table>

<table class="flyoutMenu" menudata="/vstudio/templateMembers.xml" width="180" cellpadding="2" cellspacing="0" border="0" >
	<tr>
		<td>

			<table width="175" cellpadding="0" cellspacing="0" border="0">
				<tr>
				
					<td class="flyoutLink" handle="0420"><a href="/vstudio/">Developer Tools</a></td>
				
				</tr>
			</table>


<html>
<head>
<!--TOOLBAR_START-->
<!--TOOLBAR_EXEMPT-->
<!--TOOLBAR_END-->
</head>
<body>
</body>
</html>			
		</td>
	</tr>
</table>

												</td>
												</tr>
											</table>
										<!-- end leftnav And search code -->
									<table cellpadding="0" cellspacing="0" border="0" width="100%">
									    <tr>
									         <td><br>

     <!-- -->

		
                                                  </td>
                                             </tr>
                                        </table>
                                   </td>
                                   <td width="100%"> 
								<table cellpadding="20" cellspacing="0" border="0" width="100%">
                                             <tr>
                                                  <td style="padding: 11px 20px 20px 20px;">
<!-- -->

                              <table cellpadding="0" cellspacing="0" border="0" width="100%">
		                         <tr>
		                    		<td><span id="donotprint" class="fontSize1" style="color: #0066cc;"><a href="/visualc/productinfo/default.asp" class="eyebrow" TARGET="_top">Visual C++ .NET Product Information</a>
			
			&nbsp;&gt;&nbsp;<a href="/visualc/productinfo/previous/default.asp" class="eyebrow" TARGET="_top">Visual C++ 6.0</a>
			
			&nbsp;&gt;&nbsp;<a href="/visualc/techinfo/training/tour.asp" class="eyebrow" TARGET="_top">Tour</a>
			
			</span></td>
		                    	</tr>
		                    	<tr>
		                    		<td><span id="donotprint"><img src="/products/shared/images/ts.gif" width="1" height="5" alt=""></span></td>
		                     	</tr>
		                    	<tr>
		                    		<td><h1>Building the MFC Application</h1></td>
		                    	</tr>
		                     	<tr>
		                     		<td><h2 class="Subtitle"></h2></td>
		                     	</tr>
		                     	<tr>
		                    		<td><img src="/products/shared/images/ts.gif" width="1" height="5" alt=""></td>
		                     	</tr>
		                     	<tr>
		                    		<td height="1" bgcolor="#cccccc" width="100%"><img src="/products/shared/images/ts.gif" width="1" height="1" alt=""></td>
		                    	</tr>
		                    	<tr>
		                    		<td>
		                    			<table cellpadding="0" cellspacing="0" border="0" width="100%">
		                    				<tr>
		                    					<td align="left">
		                    						<table cellpadding="0" cellspacing="0" border="0">
		                    							<tr>
		                    								
		                    								<td><img src="/products/shared/images/ts.gif" width="28" height="20" alt=""></td>
		                    							</tr>
		                    						</table>		
		                    					</td>							 
		                    					<td align="right" >
		                    						
		                    					</td>
		                    				</tr>
		                    			</table>
		                    		</td>						
		                    	</tr>
		                     	<tr>
		                    		<td height="1" bgcolor="#CCCCCC" width="100%"><img src="/products/shared/images/ts.gif" width="1" height="1" alt=""></td>
		                    	</tr>
		                    </table>
		                    <table cellspacing="0" cellpadding="0" border="0" width="100%">
		                    	<tr>
		                    		<td><img src="/products/shared/images/ts.gif" height="10" width="1" alt=""></td>
		                    	</tr>
		                    </table>
                                                       <table cellpadding="0" cellspacing="0" border="0" width="100%">
                                                            <tr>
                                                                 <td align="left" valign="top">		                    
	                                                             		                    	                                           
<!-- -->
<!-- Main Content Area START -->


     <table id="donotprint" align="right" cellpadding="0" cellspacing="0" border="0" width="175">
          <tr><td><img src="/products/shared/images/ts.gif" width="1" height="4" alt></td><td><img src="/products/shared/images/ts.gif" width="1" height="1" alt></td></tr>
          <tr>
               <td><img src="/products/shared/images/ts.gif" width="10" height="1" alt></td>
               <td>

    
		<table cellpadding="0" cellspacing="0" border="0" width="175">
			<tr>
				<td width="175" height="19" class="componentHeader"><img src="/products/shared/images/ts.gif" width="8" border="0">Read Document</td>
			</tr>
			<tr>
				<td><img src="/products/shared/images/ts.gif" width="1" height="5" border="0"></td>
			</tr>
		</table>

		<table cellpadding="0" cellspacing="0" border="0" width="175">
			
               <tr style="padding-top:0;padding-left:0;">
				<td width="8" class="componentBodyText"><img src="/products/shared/images/ts.gif" width="8" height="1" border="0"></td>
                    <td class="componentBodyText" style="width:175px"><a href="http://download.microsoft.com/download/vc60pro/Update/6.0/WIN98Me/EN-US/VC6GuidedTour.exe"><img src="/products/shared/images/wordIcon.gif" border="0" width="20" height="13" alt="Read Document"></a><a href="http://download.microsoft.com/download/vc60pro/Update/6.0/WIN98Me/EN-US/VC6GuidedTour.exe">VC6GuidedTour.exe</a></td>
               </tr>
               <tr>
				<td width="8" class="componentBodyText"><img src="/products/shared/images/ts.gif" width="8" height="1" border="0"></td>
                    <td class="componentBodyText">780 KB  Microsoft Word file</td>
			</tr>
			
               <tr>
				<td width="8" class="componentBodyText"><img src="/products/shared/images/ts.gif" width="8" height="1" border="0"></td>
                    <td class="componentBodyText">4 min @ 28.8 Kbps</td>
			</tr>
			
			<tr><td><img src="/products/shared/images/ts.gif" width="8" height="15" border="0"></td></tr>
		</table>

		<table cellpadding="0" cellspacing="0" border="0" width="175">
			<tr>
				<td width="8" class="componentBodyText"><img src="/products/shared/images/ts.gif" width="8" height="1" border="0"></td> <!-- this is a gutter -->
                    <td class="componentBodyText"><a href="http://go.microsoft.com/fwlink/?LinkId=6450">Get Office file viewers</a></td>
               </tr>
			<tr><td><img src="/products/shared/images/ts.gif" width="8" height="15" border="0"></td></tr>
		</table>

          <table cellpadding="0" cellspacing="0" border="0">
               <tr valign="top" align="left">
                    <td width="175" class="componentFooter"><img src="/products/shared/images/ts.gif" height="2"></td>
               </tr>
          </table>
		<br>

     
                         <span id="donotprint">
                         <table cellpadding="0" cellspacing="0" border="0">
                              <tr valign="top" align="left">
                                   <td bgcolor="#66CCFF">
                                        <table cellpadding="3" cellspacing="0" border="0" width="175">
                                             <tr>
                                                  <td class="componentHeader" width="175">
                                                       <img src="/products/shared/images/ts.gif" width="6" border="0">
                                                       In This Article
                                                  </td>
                                             </tr>
                                        </table>
                                   </td>
                              </tr>
                         </table>
                         <table cellpadding="9" cellspacing="0" border="0">
                              <tr valign="top" align="left">
                                   <td width="175">

                                        <table cellpadding="0" cellspacing="0" border="0" width="100%">
                                             <tr>
                                                  <td valign="top"><img src="/products/shared/images/reLink2.gif" width="11" border="0" height="11"></td>
                                                  <td class="componentBodyText"><a href="/visualc/techinfo/training/tour.asp">Getting Started</a></td>
                                             </tr>
                                             <tr>
                                                  <td width="11"><img src="/products/shared/images/ts.gif" width="1" border="0" height="11"></td>
                                                  <td width="139"><img src="/products/shared/images/ts.gif" width="1" border="0" height="11"></td>
                                             </tr>
                                        </table>

                                        <table cellpadding="0" cellspacing="0" border="0" width="100%">
                                             <tr>
                                                  <td valign="top"><img src="/products/shared/images/reLink2.gif" width="11" border="0" height="11"></td>
                                                  <td class="componentBodyText"><a href="/visualc/techinfo/training/tour1.asp">Setup Instructions</a></td>
                                             </tr>
                                             <tr>
                                                  <td width="11"><img src="/products/shared/images/ts.gif" width="1" border="0" height="11"></td>
                                                  <td width="139"><img src="/products/shared/images/ts.gif" width="1" border="0" height="11"></td>
                                             </tr>
                                        </table>

                                        <table cellpadding="0" cellspacing="0" border="0" width="100%">
                                             <tr>
                                                  <td valign="top"><img src="/products/shared/images/reLink2.gif" width="11" border="0" height="11"></td>
                                                  <td class="componentBodyText"><a href="/visualc/techinfo/training/tour2.asp">Creating the Project and Adding Components</a></td>
                                             </tr>
                                             <tr>
                                                  <td width="11"><img src="/products/shared/images/ts.gif" width="1" border="0" height="11"></td>
                                                  <td width="139"><img src="/products/shared/images/ts.gif" width="1" border="0" height="11"></td>
                                             </tr>
                                        </table>

                                        <table cellpadding="0" cellspacing="0" border="0" width="100%">
                                             <tr>
                                                  <td valign="top"><img src="/products/shared/images/reLink2.gif" width="11" border="0" height="11"></td>
                                                  <td class="componentBodyText"><a href="/visualc/techinfo/training/tour3.asp">Linking and Implementing Controls</a></td>
                                             </tr>
                                             <tr>
                                                  <td width="11"><img src="/products/shared/images/ts.gif" width="1" border="0" height="11"></td>
                                                  <td width="139"><img src="/products/shared/images/ts.gif" width="1" border="0" height="11"></td>
                                             </tr>
                                        </table>

                                        <table cellpadding="0" cellspacing="0" border="0" width="100%">
                                             <tr>
                                                  <td valign="top"><img src="/products/shared/images/reLink2.gif" width="11" border="0" height="11"></td>
                                                  <td class="componentBodyText"><a href="/visualc/techinfo/training/tour4.asp">Running and Testing the Control</a></td>
                                             </tr>
                                             <tr>
                                                  <td width="11"><img src="/products/shared/images/ts.gif" width="1" border="0" height="11"></td>
                                                  <td width="139"><img src="/products/shared/images/ts.gif" width="1" border="0" height="11"></td>
                                             </tr>
                                        </table>

                                        <table cellpadding="0" cellspacing="0" border="0" width="100%">
                                             <tr>
                                                  <td valign="top"><img src="/products/shared/images/reLink2.gif" width="11" border="0" height="11"></td>
                                                  <td class="componentBodyText"><a href="/visualc/techinfo/training/tour5.asp">Building the MFC Application</a></td>
                                             </tr>
                                             <tr>
                                                  <td width="11"><img src="/products/shared/images/ts.gif" width="1" border="0" height="11"></td>
                                                  <td width="139"><img src="/products/shared/images/ts.gif" width="1" border="0" height="11"></td>
                                             </tr>
                                        </table>

                                        <table cellpadding="0" cellspacing="0" border="0" width="100%">
                                             <tr>
                                                  <td valign="top"><img src="/products/shared/images/reLink2.gif" width="11" border="0" height="11"></td>
                                                  <td class="componentBodyText"><a href="/visualc/techinfo/training/tour6.asp">Advanced Debugging</a></td>
                                             </tr>
                                             <tr>
                                                  <td width="11"><img src="/products/shared/images/ts.gif" width="1" border="0" height="11"></td>
                                                  <td width="139"><img src="/products/shared/images/ts.gif" width="1" border="0" height="11"></td>
                                             </tr>
                                        </table>

                                        <table cellpadding="0" cellspacing="0" border="0" width="100%">
                                             <tr>
                                                  <td valign="top"><img src="/products/shared/images/reLink2.gif" width="11" border="0" height="11"></td>
                                                  <td class="componentBodyText"><a href="/visualc/techinfo/training/tour7.asp">Taking it to the Web</a></td>
                                             </tr>
                                             <tr>
                                                  <td width="11"><img src="/products/shared/images/ts.gif" width="1" border="0" height="11"></td>
                                                  <td width="139"><img src="/products/shared/images/ts.gif" width="1" border="0" height="11"></td>
                                             </tr>
                                        </table>

                                   </td>
                              </tr>
                         </table>
                         <table cellpadding="0" cellspacing="0" border="0">
                              <tr valign="top" align="left">
                                   <td width="175" class="componentFooter"><img src="/products/shared/images/ts.gif" height="2"></td>
                              </tr>
                         </table><br>
                         </span>

      
               </td>
               <td><img src="/products/shared/images/ts.gif" width="10" height="1" alt></td>
          </tr>
          <tr><td><img src="/products/shared/images/ts.gif" width="1" height="4" alt></td><td><img src="/products/shared/images/ts.gif" width="1" height="1" alt></td></tr>          
     </table>




<p>Now you&#146;re ready to move on to the MFC application that will host the control you just built, serve up PowerPoint slides, and provide security through a logon dialog.</p>

<h2>Using the Composite Control in the Interface of the MFC Application</h2>
<p>Since the UI in the MFC application comes mainly from the Composite Control and Dynamic HTML, and since the control was newly created, it is necessary to paste the Composite Control&#146;s unique identifier into the HTML file that will be loaded by the MFC application. </p>
<ol>

<li>In the CourseIntro Project, double-click the <b>ICourseCtl</b> interface (right above the Globals) in ClassView.</li>
<li>Scroll down to the bottom of the IDL file that is displayed and look for the line that begins <i>uuid, </i>just above the coclass definition.</li>
<li>Select and copy the long string of characters inside the parentheses after <i>uuid.</li>
</i><li>In Visual C++ from the <b>File </b>menu click <b>Open </b>and navigate to <b>C:\Visual C++ 6.0 Guided Tour\</b>. Select all of the files that are <i>Web Files</i> and open the file <i>top.htm.</li>
</i><li>Find the CLASSID near the bottom of this file and paste the uuid string you copied in step 3 above over the number you see after <i>clsid:.</li>
</i><li>From the <b>File</b> menu click <b>Close</b> and save your changes to top.htm.</li>
</ol>

<h2>Adding an MFC Project to the Existing Workspace</h2>

<p>To keep your files in a central location where they can be easily managed, you can add the MFC project to the workspace that contains the ATL Composite Control project. </p>
<ol>

<li>Switch to FileView in Visual C++ and right-click on the workspace at the top of FileView. Select <b>Add New Project</b> to Workspace.</li>
<li>From the New window, select MFC AppWizard (exe) from the <b>Projects</b> tab. In the <b>Project Name</b> box, enter <i>CourseProg </i>and click <b>OK.</li></b>
<li>In step 1 of the wizard, choose <b>Single Document Interface</b> (SDI).
<br><br>
<b>Note:</b> In Visual C++ 6.0 the Document/View architecture is optional, allowing further customization and tuning of MFC applications. 
<br><br>
<li>Click Next.</li>
<li>For steps 2 through 5 in the wizard, the default options are acceptable. Click <b>Next</b> for these steps.
<br><br>
<b>Note:</b> New features in Visual C++ 6.0 include: new Active Document Containment support in step 3, new Internet Explorer 4.0 support in step 4, and new Windows Explorer look-and-feel option in step 5.
<br><br>
<li>In step 6, you should change the Base View class from the default CView to the new <i>CHtmlView</i><b> </b>and click <b>Finish.</b>
<br><br>By using CHtmlView, you can display HTML and Dynamic HTML while still providing rich content from ActiveX controls or other MFC user interface elements.
<br><br>
<li>Click <b>OK </b>if the project information displayed by Visual C++ matches what you want to generate. Otherwise, click <b>Cancel</b> and start over from step 2 above.</li>
<li>From ClassView, expand the <b>CourseProg</b> classes and then the <b>CCourseProgView</b> class. Double-click the <b>OnInitialUpdate</b> function. Inside this function you&#146;ll see that a call is made to Navigate2. </li>
<br><br>
Navigate2 directs the Web browser control to a particular URL. By default, the URL is the Visual C++ home page. In this case, you want to replace the text between the double quotes with a file URL to the HTML page that will provide the user interface for your MFC application.
<br><br>
<li>Replace the URL between the quotation marks with:
<pre>
file://c:\\Visual C++ 6.0 Guided Tour\\main.htm
</pre>
<li>You can build and test the MFC application at this point. To build and execute the application, select<b> Execute CourseProg.exe </b>from the <b>Build</b> menu.</li>
</ol>


<p>Since you are now running in your MFC application (as opposed to the ActiveX Control Test Container), you should see the PowerPoint slides display in the bottom pane of the application after you&#146;ve chosen a course title from the list box. You can resize the bottom pane to enlarge the slides if you choose. To advance the slides, use the scroll bar in the bottom pane or use the PgUp (page up) and PgDn (page down) keys.</p>

<h2>Adding the Logon Dialog</h2>
<p>You now have the opportunity to take advantage of the enhanced integration between MFC and ATL present in Visual C++ 6.0 by adding a verification component to your implementation of the Fitch &amp; Mather Online Educational System. You&#146;ll add a dialog box for the username and password and use OLE DB consumer templates from within MFC to verify log-on information with the employee records stored in the database.</p>
<ol>

<li>In the ResourceView, select the CourseProg resources and navigate to the Dialog folder. Right-click on the <b>Dialog</b> folder and select <b>Insert Dialog.</b> Visual C++ will add a dialog called &quot;IDD_DIALOG1&quot;.</li>
<li>Using the Controls Palette as before, add a static text field and change the caption text to read &quot;User ID&quot; by selecting the text and typing over it.
<br><br>
While you are in the Controls Palette, you may notice several additions. The new Common Controls made available with Internet Explorer 4.0 are part of MFC with Visual C++ 6.0 and are in the palette. These controls include the Date/Time Picker, the Month Calendar control, the IP Address control and the <b>Extended Combo</b> box. If you want to experiment with these controls, drag them onto your dialog box and put the dialog box in test mode by selecting <b>Test</b> from the <b>Layout </b>menu. However, make sure to select and delete (or Edit | Cut) the controls before moving on.
<br><br>
<li>Add an edit box below the static text. Edit its properties to change its ID to <i>IDC_USERID</i> (see Figure 9).
<br><br><img SRC="Image90.gif" WIDTH="400" HEIGHT="145"><br><br>
<i>Figure 9: Change the ID of the UserID edit box to&quot;IDC_USERID.&quot;
</i><br><br>
<li>Add a static text field and change the caption text to read <i>Password</i>.</li>
<li>Add an edit box below the static text. Edit its properties to change its ID to <i>IDC_PASSWORD.</i> From the <b>Styles</b> tab, place a check next to <i>Password</i> so that entered characters appear as asterisks.</li>
<li>Edit the properties for the dialog box, change its ID to <i>IDD_LOGON</i> and change the caption to &quot;Logon&quot;. Figure 10 shows the look of the completed dialog box.
<br><br><img SRC="Image91.gif" WIDTH="381" HEIGHT="222"><br><br>
<i>Figure 10: The completed logon dialog.
<br><br></i>
<li>Right-click on the dialog box and select <b>ClassWizard</b> from the <b>Pop-up</b> menu. When prompted to create a new class, click <b>OK.</b> </li>
<li>Name the new class <b>CLogonDlg </b>and click <b>OK.</li></b>
<li>Select the <b>Member Variables</b> tab of the ClassWizard and add a variable for the password edit box (IDC_PASSWORD) with the default category and variable type. Call it <i>m_Password</i> (see Figure 11).</li>
<li>Do the same for the User ID edit box, but call the variable <i>m_UserID.</i> The variables have been bound to the edit boxes (see Figure 11).
<br><br><img SRC="Image107.gif" WIDTH="400" HEIGHT="261"><br><br>
<i>Figure 11: Using ClassWizard to add UserID and password variables.
<br><br>
</i>
<li>Switch to the <b>Message Maps</b> tab in the ClassWizard and select <b>IDOK</b> from Object IDs. Then select <b>BN_CLICKED</b> as the message and click <b>Add Function</b> to create the <i>OnOK </i>function. Click <b>OK</b> to confirm creation of the OnOK function (see Figure 12).
<br><br><img SRC="image92.gif" WIDTH="400" HEIGHT="261"><br><br>
<i>Figure 12: Using ClassWizard to create a function associated with the <b>OK</b> button.
<br><br>
</i>
<li>Click <b>OK</b> to close the ClassWizard.</li>
</ol>

<h2>Adding the Data Verification</h2>
<p>You&#146;ll now use the ATL Object Wizard to add ATL support to the MFC project. Before Visual C++ 6.0, integrating MFC and ATL was more difficult, but now the benefits of mixing ATL and MFC are available to the broadest range of Visual C++ users through the wizard.</p>
<ol>

<li>Make sure your MFC project (CourseProg) is active in the ClassView (right-click and use the menu to make it active if it is not). Then, select <b>New ATL Object</b> from the <b>Insert</b> menu.</li>
<li>Visual C++ will ask you to confirm whether or not you want to add ATL support to your MFC project. Click <b>Yes</b> to add the ATL support (see Figure 13).
<br><br><img SRC="Image93.gif" WIDTH="351" HEIGHT="118"><br><br>
<i>Figure 13: Adding ATL support to MFC projects.
<br><br>
</i>
<li>Select <b>Consumer from the Data Access </b>category of the ATL Object Wizard and click <b>Next.</li></b>
<li>Select the <b>Training</b> database as the OLE DB datasource (for more information see section 4, <i>Adding Data Support to the Control</i>) and click <b>OK.</b> Select the <b>Employees</b> table from the Select Database Table window. The OLE DB consumer templates automatically create column maps and make the database contents easy to access from Visual C++.</li>
<li>Leave the Type setting at Command. In this case you will be running a parameterized query and will thus need the extra support provided by the Command type. Click <b>OK.</li></b>
<li>From ClassView, navigate to the <b>CEmployees</b> class under CourseProg classes and double-click on it.</li>
<li>Scroll up to the DEFINE_COMMAND and locate the select statement (the select statement is spread across several lines for enhanced readability). At the end of the select statement add a space immediately after the letter &quot;s&quot; in &quot;Employees&quot; and type:
<pre>
WHERE UserID = ?
</pre>
The WHERE inserted above makes this database operation a parameterized query, which is more complex than simple selects on whole tables. A parameter map must also be included here to map the parameter from the database to a project variable. 
<li>Below the COLUMN_MAP and above DEFINE_COMMAND, a PARAM_MAP needs to be added as follows:
<pre>
BEGIN_PARAM_MAP(CEmployeesAccessor)
	COLUMN_ENTRY(1, m_UserID)
END_PARAM_MAP()
</pre>
<li>From ClassView, navigate to the <b>OnOK</b> function of the CLogonDlg class under CourseProg classes, and remove the following line of code:
<pre>
Cdialog::OnOK();
</pre>
Removing this line of code ensures the <b>Logon </b>dialog box doesn&#146;t default to letting people log on, as it would if this code were included.
<br><br>
<li>Overwrite the TODO line in OnOK with the following code (which purposely has a bug in it to illustrate Edit and Continue):
<pre>
CEmployees emp;

// Read in the data from the dialog and set the parameter
UpdateData(TRUE);
lstrcpy(emp.m_UserID, m_UserID);

HRESULT hr = emp.Open();
if (SUCCEEDED(hr))
{
	hr = emp.MoveNext();
	if (hr != S_OK &amp;&amp; lstrcmp(emp.m_Password,
	 m_Password) == 0)
	{
		CDialog::OnOK();
		return;
	}
}
AfxMessageBox(&quot;Incorrect username or password entered&quot;);
</pre>
This code creates a recordset object based on the contents of the Employees table. The records are iterated by using MoveNext and the passwords are checked based on the UserID. If an incorrect user ID or password is entered, a MessageBox appears to notify the user. 
<li>At the top of this file (logonDlg.cpp), add the following line of code below the already present <i>#includes:
</i>
<pre>
#include &quot;employees.h&quot;
</pre>
<li>From <b>FileView</b> under CourseProg files under Source files, double-click on <b>CourseProg.cpp</b> and add the following code below the already present <i>#includes:</i>
<pre>
#include &quot;logondlg.h&quot;
</pre>
<li>From <b>ClassView,</b> under CourseProg classes under CcourseProgApp, double-click on the <b>InitInstance </b>method and add the following code below<i> return FALSE;</i> and above <i>AfxEnableControlContainer();:</i>
<pre>
CLogonDlg dlg;
int id = dlg.DoModal();
if (id == IDCANCEL)
	return FALSE;
</pre>
<li>Build and execute the application by selecting <b>Execute CourseProg.exe</b> from the <b>Build </b>menu. 
<br><br>
The valid user IDs and passwords stored in the database are:
<br><br>
<table class="tblMatrix" border="1" frame="below" bordercolorlight="#FFFFFF" bordercolordark="#999999" cellspacing="0" cellpadding="5" width="99%">
<tr>
	<td WIDTH="33%" VALIGN="TOP" class="tblheader">Name</td>
	<td WIDTH="33%" VALIGN="TOP" class="tblheader">UserID</td>
	<td WIDTH="33%" VALIGN="TOP" class="tblheader">Password</td>
</tr>
<tr>
	<td WIDTH="33%" VALIGN="TOP" class="tblcolone">John Doe</td>
	<td WIDTH="33%" VALIGN="TOP" class="tbldata">JohnD</td>
	<td WIDTH="33%" VALIGN="TOP" class="tbldata">john</td>
</tr>
<tr>
	<td WIDTH="33%" VALIGN="TOP" class="tblcolone">Jane Doe</td>
	<td WIDTH="33%" VALIGN="TOP" class="tbldata">JaneD</td>
	<td WIDTH="33%" VALIGN="TOP" class="tbldata">jane</td>
</tr>
<tr>
	<td WIDTH="33%" VALIGN="TOP" class="tblcolone">Jim Smith</td>
	<td WIDTH="33%" VALIGN="TOP" class="tbldata">JimS</td>
	<td WIDTH="33%" VALIGN="TOP" class="tbldata">jim</td>
</tr>
</table>
<br>
You can add your own names by editing the database from Microsoft Access.
<br><br>
<li>Try various valid and invalid names and passwords. None of these will let you in.</li>
</ol>




<!-- Main Content Area END -->


													</td>
                                                            </tr>
                                                            <tr>
                                                                 <td>				
				<br>
				<table cellpadding="0" cellspacing="0" border="0" width="100%" id="donotprint">
					<tr valign="bottom">
						<td align="left"><a href="#top"><img src="/products/shared/images/top_v1.gif" width="40" height="20" alt="To top of page" border="0" /></a></td>
						<td align="right">	
										
						</td>
					</tr>
				</table>
                                                                 </td>
                                                            </tr>  
                                                       </table>					
<!-- -->

										</td>
                                             </tr>
                                        </table>
     
                                   </td> 
                              </tr>
                         </table>
                    </td>
               </tr>
               <tr valign="top">
                    <td>
                         <table border="0" cellpadding="0" cellspacing="0" width="100%">
                              <tr>
                                   <td width="100%">
                                        <span id="donotprint">
	<span id="pgFooter">

		<table cellpadding="0" cellspacing="0" width="100%" height="20" border="0" class="FooterBranding">
			<tr>
				<td align="left">
					<table cellpadding="0" cellspacing="0" border="0" height="100%">
						<tr class="MNPFooterRow1">
							<td width="10">&nbsp;&nbsp;</td>

							<td nowrap><a href="/isapi/goregwiz.asp?target=/contactus30/contactus.asp?domain=devtools/vc" target="_top">Contact Us</a></td>
							<td width="10">&nbsp;&nbsp;</td>

						<script language="javascript"  type="text/javascript">
							var sItemURL = "mailto:?subject=A link from Microsoft&body=This link is from the Visual C++ Web site" + " "  + top.parent.location.href
							document.write('<td nowrap><a href="' + sItemURL + '"  target=>E-Mail This Page</a></td>')
							document.write ('<td>&nbsp;&nbsp;</td>')
						</script>
	
						</tr>
					</table>
				</td>
			</tr>
		</table>

		<table cellpadding="0" cellspacing="0" width="100%" height="30" border="0" class="FooterBranding">
			<tr>
				<td align="left">
					<table cellpadding="0" cellspacing="0" border="0" height="100%">
						<tr class="MNPFooterRow2">
							<td width="10">&nbsp;&nbsp;</td>

							<td nowrap><a href="http://www.microsoft.com/info/cpyright.htm" target="_top">© 2002 Microsoft Corporation. All rights reserved.  Terms of Use.</a></td>
							<td width="10">&nbsp;&nbsp;</td>

							<td nowrap><a href="http://www.microsoft.com/info/privacy.htm" target="_top">Privacy Statement</a></td>
							<td width="10">&nbsp;&nbsp;</td>

							<td nowrap><a href="http://www.microsoft.com/enable/" target="_top">Accessibility</a></td>
							<td width="10">&nbsp;&nbsp;</td>

						</tr>
					</table>
				</td>
			</tr>
		</table>

	</span>
</span>
                                   </td>
                              </tr>
                         </table>
                    </td>
               </tr>
          </table>     
     

</body>
</html>

