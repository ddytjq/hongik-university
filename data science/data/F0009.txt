ID=F0009
URL=http://www.visualbasicbooks.com/begvbsqlsample/30640601.htm
SIZE=86929
DATE=09/07/2002
TIME=13:11:52
DATASET=Visual Basic
HTML=<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="filelist.xml">
<link rel=Edit-Time-Data href="editdata.mso">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->
<title>Visual Basic SQL Server 7.0</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Joy Armitage</o:Author>
  <o:Template>Normal</o:Template>
  <o:LastAuthor>Joy Armitage</o:LastAuthor>
  <o:Revision>2</o:Revision>
  <o:TotalTime>1</o:TotalTime>
  <o:Created>2000-03-29T08:51:00Z</o:Created>
  <o:LastSaved>2000-03-29T08:51:00Z</o:LastSaved>
  <o:Pages>12</o:Pages>
  <o:Words>2224</o:Words>
  <o:Characters>12682</o:Characters>
  <o:Company>Wrox Press Ltd</o:Company>
  <o:Lines>105</o:Lines>
  <o:Paragraphs>25</o:Paragraphs>
  <o:CharactersWithSpaces>15574</o:CharactersWithSpaces>
  <o:Version>9.2720</o:Version>
 </o:DocumentProperties>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
@font-face
	{font-family:Times;
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:Helvetica;
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:Courier;
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:modern;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:Palatino;
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:"ITC Franklin Gothic Book";
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:FrGothHeavy;
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-alt:"Arial Narrow";
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:FranklinGothic;
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:ZapfDingbats;
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:decorative;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:Arial;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
h1
	{mso-style-parent:"";
	mso-style-next:Normal;
	margin-top:22.0pt;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:1;
	font-size:19.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"ITC Franklin Gothic Book";
	color:black;
	mso-font-kerning:14.0pt;
	mso-bidi-font-weight:normal;}
h2
	{mso-style-parent:"";
	mso-style-next:Normal;
	margin-top:14.0pt;
	margin-right:0in;
	margin-bottom:8.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:2;
	font-size:16.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"ITC Franklin Gothic Book";
	color:black;
	mso-bidi-font-weight:normal;}
h3
	{mso-style-parent:"";
	mso-style-next:Normal;
	margin-top:11.0pt;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:3;
	font-size:13.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"ITC Franklin Gothic Book";
	mso-bidi-font-weight:normal;
	font-style:italic;
	mso-bidi-font-style:normal;}
h5
	{mso-style-parent:"";
	mso-style-next:Normal;
	margin-top:11.0pt;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	mso-outline-level:5;
	background:black;
	mso-shading:windowtext;
	mso-pattern:solid auto;
	border:none;
	mso-border-alt:solid black 2.25pt;
	padding:0in;
	mso-padding-alt:1.0pt 1.0pt 1.0pt 1.0pt;
	font-size:10.0pt;
	font-family:"ITC Franklin Gothic Book";
	mso-bidi-font-weight:normal;}
p.MsoIndex1, li.MsoIndex1, div.MsoIndex1
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:12.0pt;
	margin-bottom:.0001pt;
	text-indent:-12.0pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:Arial;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
span.MsoCommentReference
	{mso-ansi-font-size:8.0pt;
	mso-bidi-font-size:8.0pt;}
p.ChapterNumber, li.ChapterNumber, div.ChapterNumber
	{mso-style-name:"Chapter Number";
	mso-style-update:auto;
	mso-style-parent:"Chapter Title";
	margin-top:40.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:380.15pt;
	margin-bottom:.0001pt;
	text-align:center;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	font-size:48.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:FrGothHeavy;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	color:black;
	mso-font-kerning:14.0pt;}
p.ChapterTitle, li.ChapterTitle, div.ChapterTitle
	{mso-style-name:"Chapter Title";
	mso-style-update:auto;
	mso-style-parent:"";
	margin-top:40.0pt;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	text-align:center;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	font-size:26.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:FrGothHeavy;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	color:black;
	mso-font-kerning:14.0pt;}
span.ImportantWords
	{mso-style-name:"Important Words";
	mso-style-parent:"";
	mso-ansi-font-size:9.0pt;
	mso-ascii-font-family:Times;
	mso-hansi-font-family:Times;
	color:black;
	letter-spacing:.2pt;
	font-weight:bold;}
p.Bullet, li.Bullet, div.Bullet
	{mso-style-name:Bullet;
	mso-style-update:auto;
	mso-style-parent:"";
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:46.2pt;
	text-indent:-17.85pt;
	mso-pagination:widow-orphan;
	mso-list:l5 level1 lfo8;
	mso-hyphenate:none;
	tab-stops:list 46.35pt;
	font-size:9.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:Palatino;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	letter-spacing:.2pt;}
span.CodeinText
	{mso-style-name:"Code in Text";
	mso-style-parent:"";
	mso-ansi-font-size:9.0pt;
	mso-ascii-font-family:Courier;
	mso-hansi-font-family:Courier;
	color:black;
	letter-spacing:.2pt;}
p.CodeForeground, li.CodeForeground, div.CodeForeground
	{mso-style-name:"Code Foreground";
	mso-style-update:auto;
	mso-style-parent:"";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:17.3pt;
	margin-bottom:.0001pt;
	line-height:10.0pt;
	mso-pagination:widow-orphan;
	mso-hyphenate:none;
	tab-stops:56.9pt 84.95pt 141.85pt 169.9pt;
	background:#F2F2F2;
	mso-shading:windowtext;
	mso-pattern:gray-5 auto;
	font-size:8.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:Courier;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	color:black;
	mso-font-kerning:72.0pt;}
p.Background, li.Background, div.Background
	{mso-style-name:Background;
	mso-style-update:auto;
	mso-style-parent:"";
	margin-top:6.0pt;
	margin-right:33.85pt;
	margin-bottom:6.0pt;
	margin-left:33.85pt;
	mso-pagination:widow-orphan;
	mso-hyphenate:none;
	font-size:9.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:Palatino;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	color:black;
	letter-spacing:.2pt;
	mso-font-kerning:72.0pt;
	font-style:italic;
	mso-bidi-font-style:normal;}
span.Screentext
	{mso-style-name:Screentext;
	mso-style-parent:"";
	mso-ansi-font-size:9.0pt;
	mso-ascii-font-family:Helvetica;
	mso-hansi-font-family:Helvetica;
	letter-spacing:.2pt;}
p.NumberedBulletsUSETHIS, li.NumberedBulletsUSETHIS, div.NumberedBulletsUSETHIS
	{mso-style-name:"Numbered Bullets USE THIS";
	mso-style-update:auto;
	mso-style-parent:"";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:51.05pt;
	text-indent:-22.7pt;
	mso-pagination:widow-orphan;
	mso-list:l6 level1 lfo9;
	tab-stops:0in 28.35pt list 51.05pt;
	font-size:9.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:Palatino;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	letter-spacing:.2pt;}
p.NumberedBulletsnonumber, li.NumberedBulletsnonumber, div.NumberedBulletsnonumber
	{mso-style-name:"Numbered Bullets \(no number\)";
	mso-style-update:auto;
	mso-style-parent:"";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:51.05pt;
	mso-pagination:widow-orphan;
	tab-stops:0in 28.35pt;
	font-size:9.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:Palatino;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	letter-spacing:.2pt;}
p.LayoutNotes, li.LayoutNotes, div.LayoutNotes
	{mso-style-name:"Layout Notes";
	mso-style-update:auto;
	margin-top:0in;
	margin-right:-5.65pt;
	margin-bottom:0in;
	margin-left:28.1pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	mso-hyphenate:none;
	font-size:11.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:Palatino;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	color:red;
	letter-spacing:.2pt;
	font-style:italic;
	mso-bidi-font-style:normal;}
span.msoIns
	{mso-style-type:export-only;
	mso-style-name:"";
	text-decoration:underline;
	text-underline:single;
	color:teal;}
span.msoDel
	{mso-style-type:export-only;
	mso-style-name:"";
	text-decoration:line-through;
	color:red;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
 /* List Definitions */
@list l0
	{mso-list-id:-132;
	mso-list-type:simple;
	mso-list-template-ids:-1237918082;}
@list l0:level1
	{mso-level-tab-stop:74.6pt;
	mso-level-number-position:left;
	margin-left:74.6pt;
	text-indent:-.25in;}
@list l1
	{mso-list-id:-131;
	mso-list-type:simple;
	mso-list-template-ids:-84222848;}
@list l1:level1
	{mso-level-tab-stop:60.45pt;
	mso-level-number-position:left;
	margin-left:60.45pt;
	text-indent:-.25in;}
@list l2
	{mso-list-id:-130;
	mso-list-type:simple;
	mso-list-template-ids:-2114795724;}
@list l2:level1
	{mso-level-tab-stop:46.3pt;
	mso-level-number-position:left;
	margin-left:46.3pt;
	text-indent:-.25in;}
@list l3
	{mso-list-id:234583780;
	mso-list-type:simple;
	mso-list-template-ids:-1763806554;}
@list l3:level1
	{mso-level-tab-stop:51.05pt;
	mso-level-number-position:left;
	margin-left:51.05pt;
	text-indent:-22.7pt;
	mso-ansi-font-size:11.0pt;
	font-family:FranklinGothic;
	mso-ansi-font-weight:bold;
	mso-ansi-font-style:normal;}
@list l4
	{mso-list-id:274095209;
	mso-list-type:simple;
	mso-list-template-ids:-1455633370;}
@list l4:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F071;
	mso-level-tab-stop:70.9pt;
	mso-level-number-position:left;
	margin-left:70.9pt;
	text-indent:-32.65pt;
	mso-ansi-font-size:8.0pt;
	font-family:Wingdings;}
@list l5
	{mso-list-id:1148518419;
	mso-list-type:simple;
	mso-list-template-ids:-1362331118;}
@list l5:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F071;
	mso-level-tab-stop:46.35pt;
	mso-level-number-position:left;
	margin-left:46.2pt;
	text-indent:-17.85pt;
	mso-ansi-font-size:8.0pt;
	font-family:ZapfDingbats;}
@list l6
	{mso-list-id:1231842714;
	mso-list-type:simple;
	mso-list-template-ids:-1264430030;}
@list l6:level1
	{mso-level-tab-stop:51.05pt;
	mso-level-number-position:left;
	margin-left:51.05pt;
	text-indent:-22.7pt;
	mso-ansi-font-size:11.0pt;
	font-family:"ITC Franklin Gothic Book";
	mso-ansi-font-weight:bold;
	mso-ansi-font-style:normal;}
@list l7
	{mso-list-id:1673868784;
	mso-list-type:simple;
	mso-list-template-ids:242933782;}
@list l7:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F071;
	mso-level-tab-stop:46.35pt;
	mso-level-number-position:left;
	margin-left:46.2pt;
	text-indent:-17.85pt;
	mso-ansi-font-size:8.0pt;
	font-family:Wingdings;}
ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>
</head>

<body bgcolor="#6373B5" text="#000000" link="0000ff" vlink="#666666" alink="#CC9900" lang=EN-US style='tab-interval:.5in'>


<center>
<!-- BEGIN RICH-MEDIA BURST! CODE --> 
       <script language="JavaScript"> 
       <!-- /* © 1997-1999 BURST! Media, LLC. All Rights Reserved.*/ 
       var TheAdcode = 'ad5645a'; 
       var bN = navigator.appName; 
       var bV = parseInt(navigator.appVersion); 
       var base='http://www.burstnet.com/'; 
       var Tv=''; 
       var agt=navigator.userAgent.toLowerCase(); 
       if (bV>=4) 
         {ts=window.location.pathname+window.location.search; 
          i=0; Tv=0; while (i< ts.length) 
             { Tv=Tv+ts.charCodeAt(i); i=i+1; } Tv="/"+Tv;} 
         else   {Tv=escape(window.location.pathname); 
          if( Tv.charAt(0)!='/' ) Tv="/"+Tv; 
                 else if (Tv.charAt(1)=="/")
       Tv=""; 
         if( Tv.charAt(Tv.length-1) == "/") 
           Tv = Tv + "_";} 
       if (bN=='Netscape'){ 
            if ((bV>=4)&&(agt.indexOf("mac")==-1))
       {  document.write('<s'+'cript src="'+ 
             base+'cgi-bin/ads/'+TheAdcode+'.cgi/RETURN-CODE/JS' 
             +Tv+'">'); 
            document.write('</'+'script>');    
       } 
            else if (bV>=3) {document.write('<'+'a href="'+base+'ads/'+ 
               TheAdcode+'-map.cgi'+Tv+'"target=_top>'); 
               document.write('<img src="' + base + 'cgi-bin/ads/' + 
               TheAdcode + '.cgi' + Tv + '" ismap width=468 height=60' + 
               ' border=0 alt="Click Here"></a>');} 
        } 
       if (bN=='Microsoft Internet Explorer') 
        document.write('<ifr'+'ame id=BURST src="'+base+'cgi-bin/ads/'
       + 
         TheAdcode + '.cgi' + Tv + '/RETURN-CODE" width=468 height=60' + 
         'marginwidth=0 marginheight=0 hspace=0 vspace=0 ' + 
         'frameborder=0 scrolling=no></ifr'+'ame>'); 
       // --> 
       </script> 
       <noscript><a href="http://www.burstnet.com/ads/ad5645a-map.cgi" target=_top> 
       <img src="http://www.burstnet.com/cgi-bin/ads/ad5645a.cgi" 
        width=468 height=60 border=0 alt="Click Here"></a> 
       </noscript> 
       <!-- END BURST CODE --> 
</center>
<table border="0" bgcolor="" cellpadding="0" cellspacing="0">
<tr><td><p align="center"><img src="../images/vblogo.jpg" border="0" alt="vb logo"></td></tr>
<tr> 
<td rowspan="3" valign="top" height="1"> <p>&nbsp;</p>

<p align="left"><font face= "verdana" color="#000000"><b>Visual Basic Books</b></font><br>
<a href="../index.html" vlink="#666666"><font color="#FFFFFF">Home</font></a><br>
<a href="../beginner.html"><font color="#FFFFFF">Visual Basic Beginner Books</font></a><br>
<a href="../database.html"><font color="#FFFFFF">Visual Basic Database Books</font></a><br>
<a href="../activex.html"><font color="#FFFFFF">Visual Basic ActiveX Books</font></a><br>
<a href="../advanced.html"><font color="#FFFFFF">Visual Basic Advanced Books</font></a><br>
<a href="../vbinternet.html"><font color="#FFFFFF">VB Internet Programming Books</font></a><br>


</p>
<p><font face= "verdana" color="#000000"><b>Resources</b></font><br>
<a href="../links.html"><font color="#FFFFFF">Visual Basic Links</font></a><br>
<a href="../addlink.html"><font color="#FFFFFF">Add a Link</font></a><br>
<a href="../esubscribe.html"><font color="#FFFFFF">Subscribe to Mailing List</font></a>
</p>
</font>
</td>
<td bgcolor="#ffffff" valign="bottom"><h1 align="center"><img src="../images/anibook.gif" alt="" width="32" height="32"><font face="trebuchet ms, arial, helvetica" color="#000000"> Visual Basic Books </font><img src="../images/anibook.gif" alt="" width="32" height="32"></h1></td>
</tr><tr>
<td bgcolor="#ffffff" colspan="1" valign="top">



<table cellpadding="5"><tr><td>


<font FACE="Verdana, Arial, Helvetica" SIZE="-1">

<P>
<CENTER>
<A HREF="contents.htm"><IMG SRC="back.gif" WIDTH=65 HEIGHT=34 BORDER=0 ALT="Back"></A>
<A HREF="contents.htm"><IMG SRC="contents.gif" WIDTH=69 HEIGHT=34 BORDER=0 ALT="Contents"></A>
<A HREF="30640602.htm"><IMG SRC="next.gif" WIDTH=62 HEIGHT=34 BORDER=0 ALT="Next"></A>
</CENTER>
<HR>

<div class=Section1>

<p class=ChapterNumber>6</p>

<p class=ChapterTitle><b style='mso-bidi-font-weight:normal'>Database
Connections<o:p></o:p></b></p>

<p class=MsoNormal>The last five chapters have focused on SQL Server and
getting you familiar with the environment. We have installed the Desktop
edition of SQL Server, created our database and logins, and have explored the
Query Analyzer. We are now <!--[if supportFields]><span style='mso-element:
field-begin'></span><span style="mso-spacerun: yes"> </span>XE
&quot;databases:connecting&quot; <![endif]--><!--[if supportFields]><span
style='mso-element:field-end'></span><![endif]-->ready to get back to familiar
territory by writing some Visual Basic code.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>This chapter explores the various methods available to
establish a connection from your VB client program to a SQL Server database.
Once you have a connection to the database you can start working with the data
it contains. There are several methods to connect to SQL Server and we will
explore just some of the more popular methods here.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>Before we can jump into writing some code we need to have a
quick look at the <span class=ImportantWords><span style='font-size:9.0pt;
mso-bidi-font-size:12.0pt;font-family:Palatino;color:black;font-weight:normal'>ActiveX
Data Objects</span></span><b style='mso-bidi-font-weight:normal'> </b>(<span
class=ImportantWords><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Palatino;color:black;font-weight:normal'>ADO</span></span>) object
model. The release of ADO that we will be working with in this book is version
2.5. This latest release has introduced some new objects and we just want to
make you aware of them.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>So, in this chapter we will:</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Bullet style='text-indent:-46.2pt;mso-text-indent-alt:-17.85pt;
mso-list:l5 level1 lfo8;mso-list-change:\F071 "Thearon Willis" 19991216T0525'><![if !supportLists]><span
style='font-size:8.0pt;mso-bidi-font-size:10.0pt;font-family:ZapfDingbats'>q<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><![endif]>Look
at the new ADO object model</p>

<p class=Bullet style='text-indent:-46.2pt;mso-text-indent-alt:-17.85pt;
mso-list:l5 level1 lfo8;mso-list-change:\F071 "Thearon Willis" 19991216T0525'><![if !supportLists]><span
style='font-size:8.0pt;mso-bidi-font-size:10.0pt;font-family:ZapfDingbats'>q<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><![endif]>Discuss
DSN connections</p>

<p class=Bullet style='mso-list:l5 level1 lfo8;mso-list-change:\F071 "Thearon Willis" 19991216T0525'><![if !supportLists]><span
style='font-size:8.0pt;mso-bidi-font-size:10.0pt;font-family:ZapfDingbats'>q<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><![endif]>Discuss
DSN-less connections</p>

<p class=Bullet style='text-indent:-46.2pt;mso-text-indent-alt:-17.85pt;
mso-list:l5 level1 lfo8;mso-list-change:\F071 "Thearon Willis" 19991216T0525'><![if !supportLists]><span
style='font-size:8.0pt;mso-bidi-font-size:10.0pt;font-family:ZapfDingbats'>q<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><![endif]>Discuss
the Microsoft Data Environment Designer</p>

<h1>Overview of the ADO 2.5 Object Model</h1>

<p class=MsoNormal>As we briefly discussed in<!--[if supportFields]><span
style='mso-element:field-begin'></span> XE &quot;ADO&quot; <![endif]--><!--[if supportFields]><span
style='mso-element:field-end'></span><![endif]--><!--[if supportFields]><span
style='mso-element:field-begin'></span><span style="mso-spacerun:
yes"> </span>XE &quot;ADO:object model&quot; <![endif]--><!--[if supportFields]><span
style='mso-element:field-end'></span><![endif]--><!--[if supportFields]><span
style='mso-element:field-begin'></span><span style="mso-spacerun:
yes"> </span>XE &quot;object model:ADO&quot; <![endif]--><!--[if supportFields]><span
style='mso-element:field-end'></span><![endif]--><span style="mso-spacerun:
yes"> </span>Chapter 1, <span class=ImportantWords><span style='font-size:9.0pt;
mso-bidi-font-size:12.0pt;font-family:Times;color:black'>ActiveX Data Objects</span></span>
(<span class=ImportantWords><span style='font-size:9.0pt;mso-bidi-font-size:
12.0pt;font-family:Times;color:black'>ADO</span></span>) is part of the <span
class=ImportantWords><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Times;color:black'>Microsoft Data Access Components</span></span> (<span
class=ImportantWords><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Times;color:black'>MDAC</span></span>), <!--[if supportFields]><span
style='mso-element:field-begin'></span><span style="mso-spacerun:
yes"> </span>XE &quot;MDAC&quot; <![endif]--><!--[if supportFields]><span
style='mso-element:field-end'></span><![endif]--><!--[if supportFields]><span
style='mso-element:field-begin'></span><span style="mso-spacerun:
yes"> </span>XE &quot;Microsoft Data Access Components. See MDAC&quot; <![endif]--><!--[if supportFields]><span
style='mso-element:field-end'></span><![endif]-->which also <!--[if supportFields]><span
style='mso-element:field-begin'></span><span style="mso-spacerun:
yes"> </span>XE &quot;RDS&quot; <![endif]--><!--[if supportFields]><span
style='mso-element:field-end'></span><![endif]--><!--[if supportFields]><span
style='mso-element:field-begin'></span><span style="mso-spacerun:
yes"> </span>XE &quot;Remote Data Services. See RDS&quot; <![endif]--><!--[if supportFields]><span
style='mso-element:field-end'></span><![endif]--><!--[if supportFields]><span
style='mso-element:field-begin'></span><span style="mso-spacerun:
yes"> </span>XE &quot;OLE DB&quot; <![endif]--><!--[if supportFields]><span
style='mso-element:field-end'></span><![endif]--><!--[if supportFields]><span
style='mso-element:field-begin'></span><span style="mso-spacerun:
yes"> </span>XE &quot;ODBC&quot; <![endif]--><!--[if supportFields]><span
style='mso-element:field-end'></span><![endif]-->include Remote Data Services
(RDS), OLE DB<span class=msoIns><ins cite="mailto:Dianne%20Parker"
datetime="1999-12-17T13:17">,</ins></span> and Open Database Connectivity
(ODBC). These components together make up Microsoft's <span
class=ImportantWords><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Times;color:black'>Universal Data Access</span></span> (<span
class=ImportantWords><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Times;color:black'>UDA</span></span>) strategy <!--[if supportFields]><span
style='mso-element:field-begin'></span><span style="mso-spacerun:
yes"> </span>XE &quot;Universal Data Access&quot; <![endif]--><!--[if supportFields]><span
style='mso-element:field-end'></span><![endif]-->that allows access to
relational and non-relational data across the enterprise.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>ADO provides a lightweight object with high-performance
access to data. Designed to provide access to any type of data store, ADO has
replaced<!--[if supportFields]><span style='mso-element:field-begin'></span> XE
&quot;RDO&quot; <![endif]--><!--[if supportFields]><span style='mso-element:
field-end'></span><![endif]--><!--[if supportFields]><span style='mso-element:
field-begin'></span><span style="mso-spacerun: yes"> </span>XE &quot;DAO&quot; <![endif]--><!--[if supportFields]><span
style='mso-element:field-end'></span><![endif]--><span style="mso-spacerun:
yes"> </span>Data Access Objects (DAO) and Remote Data Objects (RDO) as the
preferred data access method. ADO was designed to be easy to learn and use, as
is evident from its programming model. It can be used throughout your n-tier
and client-server applications, and in your Web applications.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>As we mentioned above, this release of ADO has introduced
some new objects into the ADO object model. At the time of writing, ADO 2.5 is
still in beta but should be released very soon. The object model has also been
restructured, so let's take a look at the <em>new</em> model:</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><!--[if gte vml 1]><v:shapetype id="_x0000_t75" coordsize="21600,21600"
 o:spt="75" o:preferrelative="t" path="m@4@5l@4@11@9@11@9@5xe" filled="f"
 stroked="f">
 <v:stroke joinstyle="miter"/>
 <v:formulas>
  <v:f eqn="if lineDrawn pixelLineWidth 0"/>
  <v:f eqn="sum @0 1 0"/>
  <v:f eqn="sum 0 0 @1"/>
  <v:f eqn="prod @2 1 2"/>
  <v:f eqn="prod @3 21600 pixelWidth"/>
  <v:f eqn="prod @3 21600 pixelHeight"/>
  <v:f eqn="sum @0 0 1"/>
  <v:f eqn="prod @6 1 2"/>
  <v:f eqn="prod @7 21600 pixelWidth"/>
  <v:f eqn="sum @8 21600 0"/>
  <v:f eqn="prod @7 21600 pixelHeight"/>
  <v:f eqn="sum @10 21600 0"/>
 </v:formulas>
 <v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/>
 <o:lock v:ext="edit" aspectratio="t"/>
</v:shapetype><v:shape id="_x0000_i1025" type="#_x0000_t75" style='width:123pt;
 height:243pt' fillcolor="window">
 <v:imagedata src="image001.png" o:title="Fig1_C5"/>
</v:shape><![endif]--><![if !vml]><img width=164 height=324
src="image002.jpg" v:shapes="_x0000_i1025"><![endif]></p>

<h2>ADO Objects and Collections</h2>

<p class=MsoNormal>If you are already familiar with the ADO object model, at
first glance you might think that the <span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Courier;
color:black'>Properties</span></span> collection is new. But it has always
existed – it was just never shown as part of the object model before. </p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>The <span class=CodeinText><span style='font-size:9.0pt;
mso-bidi-font-size:12.0pt;font-family:Courier;color:black'>Properties</span></span>
collection is <!--[if supportFields]><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes"> </span>XE &quot;Properties collection:Connection
object&quot; <![endif]--><!--[if supportFields]><span style='mso-element:field-end'></span><![endif]--><!--[if supportFields]><span
style='mso-element:field-begin'></span><span style="mso-spacerun:
yes"> </span>XE &quot;Connection object:Properties collection&quot; <![endif]--><!--[if supportFields]><span
style='mso-element:field-end'></span><![endif]-->a collection that is applied
to all ADO objects. Each object has a <span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Courier;
color:black'>Properties</span></span> collection, which is made up of <span
class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Courier;color:black'>Property</span></span> objects. Each <span
class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Courier;color:black'>Property</span></span> object represents a
characteristic of an ADO object that is defined by the provider.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>What are new are the <span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Courier;
color:black'>Record</span></span> and <span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Courier;
color:black'>Stream</span></span> objects. Let's take a look at each of the
major objects in turn.</p>

<h3>Connection Object</h3>

<p class=MsoNormal>The <span class=CodeinText><span style='font-size:9.0pt;
mso-bidi-font-size:12.0pt;font-family:Courier;color:black'>Connection</span></span>
object<!--[if supportFields]><span style='mso-element:field-begin'></span> XE
&quot;ADO:Connection object&quot; <![endif]--><!--[if supportFields]><span
style='mso-element:field-end'></span><![endif]--><!--[if supportFields]><span
style='mso-element:field-begin'></span><span style="mso-spacerun:
yes"> </span>XE &quot;Connection object&quot; <![endif]--><!--[if supportFields]><span
style='mso-element:field-end'></span><![endif]--><span style="mso-spacerun:
yes"> </span>is at the very heart of the model and allows you to connect to the
data store. We'll be studying this object in greater detail in this chapter.
All other objects in this model are derived from the <span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Courier;
color:black'>Connection</span></span> object. Once a connection is made, it is
used to execute commands and transactions.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>The <span class=CodeinText><span style='font-size:9.0pt;
mso-bidi-font-size:12.0pt;font-family:Courier;color:black'>Errors</span></span>
collection<!--[if supportFields]><span style='mso-element:field-begin'></span>
XE &quot;Connection object:Errors collection&quot; <![endif]--><!--[if supportFields]><span
style='mso-element:field-end'></span><![endif]--><!--[if supportFields]><span
style='mso-element:field-begin'></span><span style="mso-spacerun:
yes"> </span>XE &quot;Errors collection:Connection object&quot; <![endif]--><!--[if supportFields]><span
style='mso-element:field-end'></span><![endif]--><span style="mso-spacerun:
yes"> </span>is derived from the <span class=CodeinText><span style='font-size:
9.0pt;mso-bidi-font-size:12.0pt;font-family:Courier;color:black'>Connection</span></span>
object, as all errors are returned from the underlying data store or from OLE
DB to ADO. This collection contains any errors returned as a result of
executing a method or setting a property of any of the ADO objects.<span
class=msoIns><ins cite="mailto:Thearon%20Willis" datetime="1999-12-16T05:25"><o:p></o:p></ins></span></p>

<h3>Command Object</h3>

<p class=MsoNormal>The <span class=CodeinText><span style='font-size:9.0pt;
mso-bidi-font-size:12.0pt;font-family:Courier;color:black'>Command</span></span>
object<!--[if supportFields]><span style='mso-element:field-begin'></span> XE
&quot;Command object, ADO&quot; <![endif]--><!--[if supportFields]><span
style='mso-element:field-end'></span><![endif]--><!--[if supportFields]><span
style='mso-element:field-begin'></span><span style="mso-spacerun:
yes"> </span>XE &quot;ADO:Command object&quot; <![endif]--><!--[if supportFields]><span
style='mso-element:field-end'></span><![endif]--><span style="mso-spacerun:
yes"> </span>executes stored procedures and in-line SQL statements. We'll see
much more of this in Chapter 8. The <span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Courier;
color:black'>Command</span></span> object is an optional object in the model as
not all data sources support command execution. The <span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Courier;
color:black'>Command</span></span> object can execute stored procedures and
in-line SQL statements that return records and those that do not. Associated
with the <span class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:
12.0pt;font-family:Courier;color:black'>Command</span></span> object is <!--[if supportFields]><span
style='mso-element:field-begin'></span><span style="mso-spacerun:
yes"> </span>XE &quot;Command object, ADO:Parameters collection&quot; <![endif]--><!--[if supportFields]><span
style='mso-element:field-end'></span><![endif]--><!--[if supportFields]><span
style='mso-element:field-begin'></span><span style="mso-spacerun:
yes"> </span>XE &quot;Parameters collection:Command object&quot; <![endif]--><!--[if supportFields]><span
style='mso-element:field-end'></span><![endif]-->the <span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Courier;
color:black'>Parameters</span></span> collection, which allows you to add
parameters that are required for a stored procedure or in-line SQL statements.</p>

<h3>Recordset Object</h3>

<p class=MsoNormal>The <span class=CodeinText><span style='font-size:9.0pt;
mso-bidi-font-size:12.0pt;font-family:Courier;color:black'>Recordset</span></span>
object<!--[if supportFields]><span style='mso-element:field-begin'></span> XE
&quot;Recordset object&quot; <![endif]--><!--[if supportFields]><span
style='mso-element:field-end'></span><![endif]--><!--[if supportFields]><span
style='mso-element:field-begin'></span><span style="mso-spacerun:
yes"> </span>XE &quot;ADO:Recordset object&quot; <![endif]--><!--[if supportFields]><span
style='mso-element:field-end'></span><![endif]--><span style="mso-spacerun:
yes"> </span>should be familiar to everyone who has done any database
programming with ADO before. While the <span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Courier;
color:black'>Recordset</span></span> object represents the entire collection of
records from a table, or the results of executing a stored procedure or SQL
statement, you can only access one row of data in the <span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Courier;
color:black'>Recordset</span></span> object at a time. </p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>The <span class=CodeinText><span style='font-size:9.0pt;
mso-bidi-font-size:12.0pt;font-family:Courier;color:black'>Recordset</span></span>
object now supports the new <span class=CodeinText><span style='font-size:9.0pt;
mso-bidi-font-size:12.0pt;font-family:Courier;color:black'>Record</span></span>
object, which makes programming with the <span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Courier;
color:black'>Recordset</span></span> object easier. The <span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Courier;
color:black'>Record</span></span> object is covered next but basically
represents a row of data in the <span class=CodeinText><span style='font-size:
9.0pt;mso-bidi-font-size:12.0pt;font-family:Courier;color:black'>Recordset</span></span>
object. </p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>The <span class=CodeinText><span style='font-size:9.0pt;
mso-bidi-font-size:12.0pt;font-family:Courier;color:black'>Fields</span></span>
collection <!--[if supportFields]><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes"> </span>XE &quot;Recordset object:Fields
collection&quot; <![endif]--><!--[if supportFields]><span style='mso-element:
field-end'></span><![endif]-->contains all the information about each field in
the recordset, such as the field name in the database, the data type,
attributes, and the actual value of the field. A field in the <span
class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Courier;color:black'>Recordset</span></span> object corresponds to
a column in the database.</p>

<h3>Record Object</h3>

<p class=MsoNormal>The <span class=CodeinText><span style='font-size:9.0pt;
mso-bidi-font-size:12.0pt;font-family:Courier;color:black'>Record</span></span>
object can represent a row <!--[if supportFields]><span style='mso-element:
field-begin'></span><span style="mso-spacerun: yes"> </span>XE &quot;Record
object&quot; <![endif]--><!--[if supportFields]><span style='mso-element:field-end'></span><![endif]--><!--[if supportFields]><span
style='mso-element:field-begin'></span><span style="mso-spacerun:
yes"> </span>XE &quot;ADO:Record object&quot; <![endif]--><!--[if supportFields]><span
style='mso-element:field-end'></span><![endif]-->of data in a <span
class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Courier;color:black'>Recordset</span></span> object, a file, or a
directory in a file system, or folders and messages in an e-mail system. Using
the <span class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:
12.0pt;font-family:Courier;color:black'>Record</span></span> object, you can
represent each directory on your computer as a parent <span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Courier;
color:black'>Record</span></span> and each file within the directories as a
child <span class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:
12.0pt;font-family:Courier;color:black'>Record</span></span>. You can manage
files on your computer that are represented by a <span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Courier;
color:black'>Record</span></span> object by using <!--[if supportFields]><span
style='mso-element:field-begin'></span><span style="mso-spacerun:
yes"> </span>XE &quot;CopyRecord method:Record object&quot; <![endif]--><!--[if supportFields]><span
style='mso-element:field-end'></span><![endif]--><!--[if supportFields]><span
style='mso-element:field-begin'></span><span style="mso-spacerun:
yes"> </span>XE &quot;MoveRecord method:Record object&quot; <![endif]--><!--[if supportFields]><span
style='mso-element:field-end'></span><![endif]--><!--[if supportFields]><span
style='mso-element:field-begin'></span><span style="mso-spacerun:
yes"> </span>XE &quot;DeleteRecord method:Record object&quot; <![endif]--><!--[if supportFields]><span
style='mso-element:field-end'></span><![endif]-->the <span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Courier;
color:black'>CopyRecord</span></span>, <span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Courier;
color:black'>MoveRecord</span></span>, and <span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Courier;
color:black'>DeleteRecord</span></span> methods. As one might imagine, this can
be a powerful tool when working with the VB TreeView control, which provides
parent and child nodes.<span class=MsoCommentReference><span style='font-size:
8.0pt;display:none;mso-hide:all'> </span></span></p>

<h3>Stream Object</h3>

<p class=MsoNormal>The <span class=CodeinText><span style='font-size:9.0pt;
mso-bidi-font-size:12.0pt;font-family:Courier;color:black'>Stream</span></span>
object represents <!--[if supportFields]><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes"> </span>XE &quot;Stream object&quot; <![endif]--><!--[if supportFields]><span
style='mso-element:field-end'></span><![endif]--><!--[if supportFields]><span
style='mso-element:field-begin'></span><span style="mso-spacerun:
yes"> </span>XE &quot;ADO:Stream object&quot; <![endif]--><!--[if supportFields]><span
style='mso-element:field-end'></span><![endif]-->a stream of text or binary
data. When used in conjunction with the <span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Courier;
color:black'>Record</span></span> object, the <span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Courier;
color:black'>Stream</span></span> object can be used to open a file, read and
write data to and from the file, and close the file represented by the <span
class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Courier;color:black'>Record</span></span> object.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>The complete ADO object model is listed in Appendix B, along
with the methods and properties of each object.</p>

<h1>Connection Object</h1>

<p class=MsoNormal><a name=c5connection>Now that we have </a><!--[if supportFields]><span
style='mso-bookmark:c5connection'></span><span style='mso-element:field-begin'></span><span
style='mso-bookmark:c5connection'><span style="mso-spacerun: yes"> </span>XE
&quot;databases:connecting:Connection object&quot; \r “c5connection”</span><![endif]--><span
style='mso-bookmark:c5connection'></span><!--[if supportFields]><span
style='mso-bookmark:c5connection'></span><span style='mso-element:field-end'></span><![endif]--><span
style='mso-bookmark:c5connection'>had a</span><!--[if supportFields]><span
style='mso-bookmark:c5connection'></span><span style='mso-element:field-begin'></span><span
style='mso-bookmark:c5connection'> XE &quot;ADO:Connection object&quot; \r
“c5connection” </span><![endif]--><span style='mso-bookmark:c5connection'></span><!--[if supportFields]><span
style='mso-bookmark:c5connection'></span><span style='mso-element:field-end'></span><![endif]--><span
style='mso-bookmark:c5connection'></span><!--[if supportFields]><span
style='mso-bookmark:c5connection'></span><span style='mso-element:field-begin'></span><span
style='mso-bookmark:c5connection'><span style="mso-spacerun: yes"> </span>XE
&quot;Connection object&quot; \r “c5connection” </span><![endif]--><span
style='mso-bookmark:c5connection'></span><!--[if supportFields]><span
style='mso-bookmark:c5connection'></span><span style='mso-element:field-end'></span><![endif]--><span
style='mso-bookmark:c5connection'><span style="mso-spacerun: yes"> </span>quick
look at the objects in the ADO object model, let's turn our attention to the
one that is the focus of this chapter – the </span><span style='mso-bookmark:
c5connection'><span class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:
12.0pt;font-family:Courier;color:black'>Connection</span></span> object. The </span><span
style='mso-bookmark:c5connection'><span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Courier;
color:black'>Connection</span></span> object establishes a connection to the
database so that we can access and manipulate data using the other objects in
ADO.</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5connection'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5connection'>We use the </span><span
style='mso-bookmark:c5connection'><span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Courier;
color:black'>Open</span></span> method</span><!--[if supportFields]><span
style='mso-bookmark:c5connection'></span><span style='mso-element:field-begin'></span><span
style='mso-bookmark:c5connection'> XE &quot;Connection object:Open method&quot;
</span><![endif]--><span style='mso-bookmark:c5connection'></span><!--[if supportFields]><span
style='mso-bookmark:c5connection'></span><span style='mso-element:field-end'></span><![endif]--><span
style='mso-bookmark:c5connection'></span><!--[if supportFields]><span
style='mso-bookmark:c5connection'></span><span style='mso-element:field-begin'></span><span
style='mso-bookmark:c5connection'><span style="mso-spacerun: yes"> </span>XE
&quot;Open method:Connection object&quot; </span><![endif]--><span
style='mso-bookmark:c5connection'></span><!--[if supportFields]><span
style='mso-bookmark:c5connection'></span><span style='mso-element:field-end'></span><![endif]--><span
style='mso-bookmark:c5connection'><span style="mso-spacerun: yes"> </span>of
the </span><span style='mso-bookmark:c5connection'><span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Courier;
color:black'>Connection</span></span> object to actually</span><!--[if supportFields]><span
style='mso-bookmark:c5connection'></span><span style='mso-element:field-begin'></span><span
style='mso-bookmark:c5connection'> XE &quot;SQL Server:connecting to&quot; </span><![endif]--><span
style='mso-bookmark:c5connection'></span><!--[if supportFields]><span
style='mso-bookmark:c5connection'></span><span style='mso-element:field-end'></span><![endif]--><span
style='mso-bookmark:c5connection'></span><!--[if supportFields]><span
style='mso-bookmark:c5connection'></span><span style='mso-element:field-begin'></span><span
style='mso-bookmark:c5connection'><span style="mso-spacerun: yes"> </span>XE
&quot;Connection object:SQL Server, connecting to&quot; </span><![endif]--><span
style='mso-bookmark:c5connection'></span><!--[if supportFields]><span
style='mso-bookmark:c5connection'></span><span style='mso-element:field-end'></span><![endif]--><span
style='mso-bookmark:c5connection'><span style="mso-spacerun:
yes"> </span>establish and open the connection to SQL Server. The </span><span
style='mso-bookmark:c5connection'><span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Courier;
color:black'>Open</span></span> method has the following syntax:</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5connection'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=CodeForeground><span style='mso-bookmark:c5connection'>objConn.Open
(ConnectString, UserID, Password, Options)</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5connection'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5connection'>The </span><span
style='mso-bookmark:c5connection'><span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Courier;
color:black'>objConn</span></span> in the syntax represents a valid </span><span
style='mso-bookmark:c5connection'><span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Courier;
color:black'>Connection</span></span> object defined by you, using this code:</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5connection'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=CodeForeground><span style='mso-bookmark:c5connection'>Dim objConn as
New ADODB.Connection</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5connection'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5connection'>The </span><span
style='mso-bookmark:c5connection'><span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Courier;
color:black'>ConnectString</span></span> parameter</span><!--[if supportFields]><span
style='mso-bookmark:c5connection'></span><span style='mso-element:field-begin'></span><span
style='mso-bookmark:c5connection'> XE &quot;Connection object:ConnectString
parameter&quot; </span><![endif]--><span style='mso-bookmark:c5connection'></span><!--[if supportFields]><span
style='mso-bookmark:c5connection'></span><span style='mso-element:field-end'></span><![endif]--><span
style='mso-bookmark:c5connection'></span><!--[if supportFields]><span
style='mso-bookmark:c5connection'></span><span style='mso-element:field-begin'></span><span
style='mso-bookmark:c5connection'><span style="mso-spacerun: yes"> </span>XE
&quot;ConnectString parameter:Connection object&quot; </span><![endif]--><span
style='mso-bookmark:c5connection'></span><!--[if supportFields]><span
style='mso-bookmark:c5connection'></span><span style='mso-element:field-end'></span><![endif]--><span
style='mso-bookmark:c5connection'></span><!--[if supportFields]><span
style='mso-bookmark:c5connection'></span><span style='mso-element:field-begin'></span><span
style='mso-bookmark:c5connection'><span style="mso-spacerun: yes"> </span>XE
&quot;Options parameter:Connection object&quot; </span><![endif]--><span
style='mso-bookmark:c5connection'></span><!--[if supportFields]><span
style='mso-bookmark:c5connection'></span><span style='mso-element:field-end'></span><![endif]--><span
style='mso-bookmark:c5connection'></span><!--[if supportFields]><span
style='mso-bookmark:c5connection'></span><span style='mso-element:field-begin'></span><span
style='mso-bookmark:c5connection'><span style="mso-spacerun: yes"> </span>XE
&quot;Connection object:Options parameter&quot; </span><![endif]--><span
style='mso-bookmark:c5connection'></span><!--[if supportFields]><span
style='mso-bookmark:c5connection'></span><span style='mso-element:field-end'></span><![endif]--><span
style='mso-bookmark:c5connection'><span style="mso-spacerun:
yes"> </span>contains the information that is used to establish a connection
with the database. It can contain information such as the ODBC driver, OLE DB
provider, or the </span><span style='mso-bookmark:c5connection'><span
class=ImportantWords><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Palatino;color:black;font-weight:normal'>Data Source Name </span></span>being
used</span><span style='mso-bookmark:c5connection'><span class=ImportantWords><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Palatino;
color:black;font-weight:normal'> (which will be covered shortly)</span></span>.
</span><span style='mso-bookmark:c5connection'><span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Courier;
color:black'>UserID</span></span> and </span><span style='mso-bookmark:c5connection'><span
class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Courier;color:black'>Password</span></span> are self-explanatory
and contain your logon to SQL Server and your password. </span><span
style='mso-bookmark:c5connection'><span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Courier;
color:black'>Options</span></span> specifies whether the </span><span
style='mso-bookmark:c5connection'><span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Courier;
color:black'>Connection</span></span> should be returned </span><!--[if supportFields]><span
style='mso-bookmark:c5connection'></span><span style='mso-element:field-begin'></span><span
style='mso-bookmark:c5connection'><span style="mso-spacerun: yes"> </span>XE
&quot;Connection object:synchronous/asynchronous connections&quot; </span><![endif]--><span
style='mso-bookmark:c5connection'></span><!--[if supportFields]><span
style='mso-bookmark:c5connection'></span><span style='mso-element:field-end'></span><![endif]--><span
style='mso-bookmark:c5connection'></span><!--[if supportFields]><span
style='mso-bookmark:c5connection'></span><span style='mso-element:field-begin'></span><span
style='mso-bookmark:c5connection'><span style="mso-spacerun: yes"> </span>XE
&quot;synchronous connections&quot; </span><![endif]--><span style='mso-bookmark:
c5connection'></span><!--[if supportFields]><span style='mso-bookmark:c5connection'></span><span
style='mso-element:field-end'></span><![endif]--><span style='mso-bookmark:
c5connection'></span><!--[if supportFields]><span style='mso-bookmark:c5connection'></span><span
style='mso-element:field-begin'></span><span style='mso-bookmark:c5connection'><span
style="mso-spacerun: yes"> </span>XE &quot;asynchronous connections&quot; </span><![endif]--><span
style='mso-bookmark:c5connection'></span><!--[if supportFields]><span
style='mso-bookmark:c5connection'></span><span style='mso-element:field-end'></span><![endif]--><span
style='mso-bookmark:c5connection'>asynchronously or synchronously. </span></p>

<p class=MsoNormal><span style='mso-bookmark:c5connection'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=Background><span style='mso-bookmark:c5connection'>A synchronous
connection is when the method being executed must complete before the next
method can be executed. Asynchronous connections allows your code to perform
other tasks while a method is executing. When this parameter is not specified,
a synchronous connection is established by default.</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5connection'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5connection'>Once all processing
has been completed, we close the database connection using the </span><span
style='mso-bookmark:c5connection'><span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Courier;
color:black'>Close</span></span> method of the </span><span style='mso-bookmark:
c5connection'><span class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:
12.0pt;font-family:Courier;color:black'>Connection</span></span> object:</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5connection'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=CodeForeground><span style='mso-bookmark:c5connection'>objConn.Close</span></p>

<h2><span style='mso-bookmark:c5connection'>Setting Up a Data Source Name</span></h2>

<p class=MsoNormal><span style='mso-bookmark:c5connection'>A </span><span
style='mso-bookmark:c5connection'><span class=ImportantWords><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Times;color:black'>Data
Source Name</span></span> (</span><span style='mso-bookmark:c5connection'><span
class=ImportantWords><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Times;color:black'>DSN</span></span>) provides</span><!--[if supportFields]><span
style='mso-bookmark:c5connection'></span><span style='mso-element:field-begin'></span><span
style='mso-bookmark:c5connection'> XE &quot;DSNs&quot; </span><![endif]--><span
style='mso-bookmark:c5connection'></span><!--[if supportFields]><span
style='mso-bookmark:c5connection'></span><span style='mso-element:field-end'></span><![endif]--><span
style='mso-bookmark:c5connection'></span><!--[if supportFields]><span
style='mso-bookmark:c5connection'></span><span style='mso-element:field-begin'></span><span
style='mso-bookmark:c5connection'><span style="mso-spacerun: yes"> </span>XE
&quot;Data Source Names. See DSNs&quot; </span><![endif]--><span
style='mso-bookmark:c5connection'></span><!--[if supportFields]><span
style='mso-bookmark:c5connection'></span><span style='mso-element:field-end'></span><![endif]--><span
style='mso-bookmark:c5connection'></span><!--[if supportFields]><span
style='mso-bookmark:c5connection'></span><span style='mso-element:field-begin'></span><span
style='mso-bookmark:c5connection'><span style="mso-spacerun: yes"> </span>XE
&quot;Connection object:DSNs&quot; </span><![endif]--><span style='mso-bookmark:
c5connection'></span><!--[if supportFields]><span style='mso-bookmark:c5connection'></span><span
style='mso-element:field-end'></span><![endif]--><span style='mso-bookmark:
c5connection'><span style="mso-spacerun: yes"> </span>all the information
needed for the </span><span style='mso-bookmark:c5connection'><span
class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Courier;color:black'>Connection</span></span> object to establish a
connection with the database. The DSN provides information such as what type of
ODBC driver should be used, what the name of the database is, where the
database resides, and various other information which will be covered shortly.</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5connection'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5connection'>A DSN can be set up
to be </span><!--[if supportFields]><span style='mso-bookmark:c5connection'></span><span
style='mso-element:field-begin'></span><span style='mso-bookmark:c5connection'><span
style="mso-spacerun: yes"> </span>XE &quot;User DSNs&quot; </span><![endif]--><span
style='mso-bookmark:c5connection'></span><!--[if supportFields]><span
style='mso-bookmark:c5connection'></span><span style='mso-element:field-end'></span><![endif]--><span
style='mso-bookmark:c5connection'></span><!--[if supportFields]><span
style='mso-bookmark:c5connection'></span><span style='mso-element:field-begin'></span><span
style='mso-bookmark:c5connection'><span style="mso-spacerun: yes"> </span>XE
&quot;File DSNs&quot; </span><![endif]--><span style='mso-bookmark:c5connection'></span><!--[if supportFields]><span
style='mso-bookmark:c5connection'></span><span style='mso-element:field-end'></span><![endif]--><span
style='mso-bookmark:c5connection'></span><!--[if supportFields]><span
style='mso-bookmark:c5connection'></span><span style='mso-element:field-begin'></span><span
style='mso-bookmark:c5connection'><span style="mso-spacerun: yes"> </span>XE
&quot;System DSNs&quot; </span><![endif]--><span style='mso-bookmark:c5connection'></span><!--[if supportFields]><span
style='mso-bookmark:c5connection'></span><span style='mso-element:field-end'></span><![endif]--><span
style='mso-bookmark:c5connection'>either a </span><span style='mso-bookmark:
c5connection'><span class=ImportantWords><span style='font-size:9.0pt;
mso-bidi-font-size:12.0pt;font-family:Times;color:black'>User</span></span> type,
</span><span style='mso-bookmark:c5connection'><span class=ImportantWords><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Times;color:black'>System</span></span>
type, or </span><span style='mso-bookmark:c5connection'><span
class=ImportantWords><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Times;color:black'>File</span></span> type. A User DSN is specific
to the user who created it and cannot be shared. The System DSN can be created
on a machine and all users can access it. A File DSN is similar to the System
DSN, except that it is stored by default as a text file in the</span><span
style='mso-bookmark:c5connection'><span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Palatino;
color:black'> </span></span></span><span style='mso-bookmark:c5connection'><span
class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Courier;color:black'>$\Program</span></span></span><span
style='mso-bookmark:c5connection'><span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Palatino;
color:black'> </span></span></span><span style='mso-bookmark:c5connection'><span
class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Courier;color:black'>Files\Common</span></span></span><span
style='mso-bookmark:c5connection'><span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Palatino;
color:black'> </span></span></span><span style='mso-bookmark:c5connection'><span
class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Courier;color:black'>Files\ODBC\Data</span></span></span><span
style='mso-bookmark:c5connection'><span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Palatino;
color:black'> </span></span></span><span style='mso-bookmark:c5connection'><span
class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Courier;color:black'>Sources</span></span> directory, whereas the
User and System DSN are stored in the registry. A File DSN is easier to port to
other machines; thus it can be created and moved with your programs that use
the DSN.</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5connection'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<div style='border:solid black 2.25pt;padding:1.0pt 1.0pt 1.0pt 1.0pt;
background:black;mso-shading:windowtext;mso-pattern:solid auto'>

<h5><span style='mso-bookmark:c5connection'>Try It Out – Create a DSN</span></h5>

</div>

<p class=MsoNormal><span style='mso-bookmark:c5connection'><a name=c5dsncreate>We
will create a System DSN</a></span><!--[if supportFields]><span
style='mso-bookmark:c5connection'><span style='mso-bookmark:c5dsncreate'></span></span><span
style='mso-element:field-begin'></span><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'> XE &quot;DSNs:creating&quot; \r “c5dsncreate”</span></span><![endif]--><span
style='mso-bookmark:c5connection'><span style='mso-bookmark:c5dsncreate'></span></span><!--[if supportFields]><span
style='mso-bookmark:c5connection'><span style='mso-bookmark:c5dsncreate'></span></span><span
style='mso-element:field-end'></span><![endif]--><span style='mso-bookmark:
c5connection'><span style='mso-bookmark:c5dsncreate'></span></span><!--[if supportFields]><span
style='mso-bookmark:c5connection'><span style='mso-bookmark:c5dsncreate'></span></span><span
style='mso-element:field-begin'></span><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'> XE &quot;Connection
object:DSNs:creating&quot;<span style="mso-spacerun: yes">  </span>\r
“c5dsncreate”</span></span><![endif]--><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'></span></span><!--[if supportFields]><span
style='mso-bookmark:c5connection'><span style='mso-bookmark:c5dsncreate'></span></span><span
style='mso-element:field-end'></span><![endif]--><span style='mso-bookmark:
c5connection'><span style='mso-bookmark:c5dsncreate'></span></span><!--[if supportFields]><span
style='mso-bookmark:c5connection'><span style='mso-bookmark:c5dsncreate'></span></span><span
style='mso-element:field-begin'></span><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'> XE &quot;System DSNs:creating&quot; \r
“c5dsncreate” </span></span><![endif]--><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'></span></span><!--[if supportFields]><span
style='mso-bookmark:c5connection'><span style='mso-bookmark:c5dsncreate'></span></span><span
style='mso-element:field-end'></span><![endif]--><span style='mso-bookmark:
c5connection'><span style='mso-bookmark:c5dsncreate'><span style="mso-spacerun:
yes"> </span>called Wrox Auto Works that will allow us to access our database.
We will be using a login that was created in Chapter 4 that uses SQL Server
authentication. </span></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></span></p>

<p class=NumberedBulletsUSETHIS style='text-indent:-51.05pt;mso-text-indent-alt:
-22.7pt;mso-list:l6 level1 lfo9;mso-list-change:"%1\:1\:0\:\." "Thearon Willis" 19991216T0525'><span
style='mso-bookmark:c5connection'><span style='mso-bookmark:c5dsncreate'><![if !supportLists]><b
style='mso-bidi-font-weight:normal'><span style='font-size:11.0pt;mso-bidi-font-size:
10.0pt;font-family:"ITC Franklin Gothic Book"'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></b><![endif]>We start by opening the </span></span><span
style='mso-bookmark:c5connection'><span style='mso-bookmark:c5dsncreate'><span
class=Screentext><span style='font-family:Helvetica'>Control Panel</span></span><span
style='color:black'> (from the </span></span></span><span style='mso-bookmark:
c5connection'><span style='mso-bookmark:c5dsncreate'><span class=Screentext><span
style='font-family:Helvetica'>Settings</span></span><span style='color:black'>
sub-menu in the Windows </span></span></span><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><span class=Screentext><span style='font-family:
Helvetica'>Start</span></span><span style='color:black'> menu), </span>and
double clicking on the </span></span><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><span class=Screentext><span style='font-family:
Helvetica'>ODBC Data Sources (32bit)</span></span> icon to invoke<span
style='color:black'> </span></span></span><!--[if supportFields]><span
style='mso-bookmark:c5connection'><span style='mso-bookmark:c5dsncreate'></span></span><span
style='mso-element:field-begin'></span><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><span style='color:black'><span
style="mso-spacerun: yes"> </span>XE &quot;ODBC:Data Source Administrator&quot;
</span></span></span><![endif]--><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'></span></span><!--[if supportFields]><span
style='mso-bookmark:c5connection'><span style='mso-bookmark:c5dsncreate'></span></span><span
style='mso-element:field-end'></span><![endif]--><span style='mso-bookmark:
c5connection'><span style='mso-bookmark:c5dsncreate'><span style='color:black'>the
</span></span></span><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><span class=Screentext><span style='font-family:
Helvetica'>ODBC Data Source Administrator</span></span><span style='color:black'>,
</span>as shown in the figure below. </span></span></p>

<p class=NumberedBulletsnonumber><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'>Click on the </span></span><span
style='mso-bookmark:c5connection'><span style='mso-bookmark:c5dsncreate'><span
class=Screentext><span style='font-family:Helvetica'>System DSN</span></span>
tab, as this is the type of <span style='color:black'>DSN</span> that we want
to create. Click the </span></span><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><span class=Screentext><span style='font-family:
Helvetica'>Add</span></span> button to start the series of dialogs that walks you
through setting up a <span style='color:black'>DSN</span>:</span></span></p>

<p class=NumberedBulletsnonumber><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><!--[if gte vml 1]><v:shape id="_x0000_i1026"
 type="#_x0000_t75" style='width:366pt;height:272.25pt' fillcolor="window">
 <v:imagedata src="image003.png" o:title="Fig2_C5"/>
</v:shape><![endif]--><![if !vml]><img width=488 height=363
src="image004.jpg" v:shapes="_x0000_i1026"><![endif]></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></span></p>

<p class=LayoutNotes><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></span></p>

<p class=LayoutNotes><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></span></p>

<p class=NumberedBulletsUSETHIS style='text-indent:-51.05pt;mso-text-indent-alt:
-22.7pt;mso-list:l6 level1 lfo9;mso-list-change:"%1\:2\:0\:\." "Thearon Willis" 19991216T0525'><span
style='mso-bookmark:c5connection'><span style='mso-bookmark:c5dsncreate'><![if !supportLists]><b
style='mso-bidi-font-weight:normal'><span style='font-size:11.0pt;mso-bidi-font-size:
10.0pt;font-family:"ITC Franklin Gothic Book"'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></b><![endif]>The first dialog you see prompts you to select the <span
style='color:black'>ODBC </span></span></span><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><span class=Screentext><span style='font-family:
Helvetica'>driver</span></span> you </span></span><!--[if supportFields]><span
style='mso-bookmark:c5connection'><span style='mso-bookmark:c5dsncreate'></span></span><span
style='mso-element:field-begin'></span><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><span style="mso-spacerun: yes"> </span>XE
&quot;ODBC:driver, specifying:for DSN connections&quot; </span></span><![endif]--><span
style='mso-bookmark:c5connection'><span style='mso-bookmark:c5dsncreate'></span></span><!--[if supportFields]><span
style='mso-bookmark:c5connection'><span style='mso-bookmark:c5dsncreate'></span></span><span
style='mso-element:field-end'></span><![endif]--><span style='mso-bookmark:
c5connection'><span style='mso-bookmark:c5dsncreate'>want to use to access your
database. Since we are dealing with SQL Server, our driver is going to be </span></span><span
style='mso-bookmark:c5connection'><span style='mso-bookmark:c5dsncreate'><span
class=Screentext><span style='font-family:Helvetica'>SQL Server</span></span>.
Select this and then click the </span></span><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><span class=Screentext><span style='font-family:
Helvetica'>Finish</span></span> button to start the wizard for setting up a <span
style='color:black'>SQL Server DSN</span>:</span></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><!--[if gte vml 1]><v:shape id="_x0000_i1027"
 type="#_x0000_t75" style='width:373.5pt;height:251.25pt' fillcolor="window">
 <v:imagedata src="image005.png" o:title="Fig3_C5"/>
</v:shape><![endif]--><![if !vml]><img width=498 height=335
src="image006.jpg" v:shapes="_x0000_i1027"><![endif]></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></span></p>

<p class=LayoutNotes><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></span></p>

<p class=NumberedBulletsUSETHIS style='text-indent:-51.05pt;mso-text-indent-alt:
-22.7pt;mso-list:l6 level1 lfo9;mso-list-change:"%1\:3\:0\:\." "Thearon Willis" 19991216T0525'><span
style='mso-bookmark:c5connection'><span style='mso-bookmark:c5dsncreate'><![if !supportLists]><b
style='mso-bidi-font-weight:normal'><span style='font-size:11.0pt;mso-bidi-font-size:
10.0pt;font-family:"ITC Franklin Gothic Book"'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></b><![endif]>The first dialog prompts you to enter a </span></span><span
style='mso-bookmark:c5connection'><span style='mso-bookmark:c5dsncreate'><span
class=Screentext><span style='font-family:Helvetica'>Name</span></span> for
your <span style='color:black'>DSN</span> and a </span></span><span
style='mso-bookmark:c5connection'><span style='mso-bookmark:c5dsncreate'><span
class=Screentext><span style='font-family:Helvetica'>Description</span></span>.
Enter the name shown in the next figure and any description you want. If you
installed the Desktop edition of SQL Server on your workstation, then your
server should appear in the drop down list as </span></span><span
style='mso-bookmark:c5connection'><span style='mso-bookmark:c5dsncreate'><span
class=Screentext><span style='font-family:Helvetica'>(local)</span></span>. If
you are using a SQL Server installed on your network, select or enter the
appropriate server name where SQL Server is installed. Click </span></span><span
style='mso-bookmark:c5connection'><span style='mso-bookmark:c5dsncreate'><span
class=Screentext><span style='font-family:Helvetica'>Next</span></span> to
advance to the next dialog:</span></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><!--[if gte vml 1]><v:shape id="_x0000_i1028"
 type="#_x0000_t75" style='width:382.5pt;height:242.25pt' fillcolor="window">
 <v:imagedata src="image007.gif" o:title="Fig4_C5"/>
</v:shape><![endif]--><![if !vml]><img width=510 height=323
src="image007.gif" v:shapes="_x0000_i1028"><![endif]></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></span></p>

<p class=LayoutNotes><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></span></p>

<p class=NumberedBulletsUSETHIS style='mso-list:l6 level1 lfo9;mso-list-change:
"%1\:4\:0\:\." "Thearon Willis" 19991216T0525'><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><![if !supportLists]><b style='mso-bidi-font-weight:
normal'><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;font-family:
"ITC Franklin Gothic Book"'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></b><![endif]>Experience has shown that the best method to use
for authentication is SQL Server authentication. This provides the most secure <span
style='color:black'>DSN</span> connections. If you use NT authentication and
your <span style='color:black'>login ID</span> is set up for NT authentication
in SQL Server, then anyone using your machine while you are logged on can
access SQL Server with your permissions. Even if the user specifies another <span
style='color:black'>login ID and password,</span> NT authentication will
override it. For this reason and to provide a more </span></span><!--[if supportFields]><span
style='mso-bookmark:c5connection'><span style='mso-bookmark:c5dsncreate'></span></span><span
style='mso-element:field-begin'></span><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><span style="mso-spacerun: yes"> </span>XE
&quot;SQL Server:security:DSN connections&quot; </span></span><![endif]--><span
style='mso-bookmark:c5connection'><span style='mso-bookmark:c5dsncreate'></span></span><!--[if supportFields]><span
style='mso-bookmark:c5connection'><span style='mso-bookmark:c5dsncreate'></span></span><span
style='mso-element:field-end'></span><![endif]--><span style='mso-bookmark:
c5connection'><span style='mso-bookmark:c5dsncreate'></span></span><!--[if supportFields]><span
style='mso-bookmark:c5connection'><span style='mso-bookmark:c5dsncreate'></span></span><span
style='mso-element:field-begin'></span><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><span style="mso-spacerun: yes"> </span>XE
&quot;DSNs:SQL Server authentication&quot; </span></span><![endif]--><span
style='mso-bookmark:c5connection'><span style='mso-bookmark:c5dsncreate'></span></span><!--[if supportFields]><span
style='mso-bookmark:c5connection'><span style='mso-bookmark:c5dsncreate'></span></span><span
style='mso-element:field-end'></span><![endif]--><span style='mso-bookmark:
c5connection'><span style='mso-bookmark:c5dsncreate'></span></span><!--[if supportFields]><span
style='mso-bookmark:c5connection'><span style='mso-bookmark:c5dsncreate'></span></span><span
style='mso-element:field-begin'></span><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><span style="mso-spacerun: yes"> </span>XE
&quot;System DSNs:SQL Server authentication&quot; </span></span><![endif]--><span
style='mso-bookmark:c5connection'><span style='mso-bookmark:c5dsncreate'></span></span><!--[if supportFields]><span
style='mso-bookmark:c5connection'><span style='mso-bookmark:c5dsncreate'></span></span><span
style='mso-element:field-end'></span><![endif]--><span style='mso-bookmark:
c5connection'><span style='mso-bookmark:c5dsncreate'>secure <span
style='color:black'>DSN</span>, use SQL Server authentication.</span></span></p>

<p class=NumberedBulletsnonumber><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'>You will need to select the </span></span><span
style='mso-bookmark:c5connection'><span style='mso-bookmark:c5dsncreate'><span
class=Screentext><span style='font-family:Helvetica'>With SQL Server
authentication</span></span> radio button and then enter a </span></span><span
style='mso-bookmark:c5connection'><span style='mso-bookmark:c5dsncreate'><span
class=Screentext><span style='font-family:Helvetica'>Login ID</span></span> and
</span></span><span style='mso-bookmark:c5connection'><span style='mso-bookmark:
c5dsncreate'><span class=Screentext><span style='font-family:Helvetica'>Password</span></span>
that uses SQL Server authentication. If you used NT authentication to setup
your own <span style='color:black'>login ID,</span> then enter one of the two
users that were set up for the <span style='color:black'>Sales Staff and
Management roles in Chapter 4.</span> Clicking on the </span></span><span
style='mso-bookmark:c5connection'><span style='mso-bookmark:c5dsncreate'><span
class=Screentext><span style='font-family:Helvetica'>Client Configuration</span></span>
button lets you define the connection protocol, although this is outside the
realms of this book. Click </span></span><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><span class=Screentext><span style='font-family:
Helvetica'>Next</span></span> to continue on to the next step:</span></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><!--[if gte vml 1]><v:shape id="_x0000_i1029"
 type="#_x0000_t75" style='width:406.5pt;height:234.75pt' fillcolor="window">
 <v:imagedata src="image008.png" o:title="Fig5_C5"/>
</v:shape><![endif]--><![if !vml]><img width=542 height=313
src="image009.jpg" v:shapes="_x0000_i1029"><![endif]></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></span></p>

<p class=LayoutNotes><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></span></p>

<p class=NumberedBulletsUSETHIS style='text-indent:-51.05pt;mso-text-indent-alt:
-22.7pt;mso-list:l6 level1 lfo9;mso-list-change:"%1\:5\:0\:\." "Thearon Willis" 19991216T0525'><span
style='mso-bookmark:c5connection'><span style='mso-bookmark:c5dsncreate'><![if !supportLists]><b
style='mso-bidi-font-weight:normal'><span style='font-size:11.0pt;mso-bidi-font-size:
10.0pt;font-family:"ITC Franklin Gothic Book"'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></b><![endif]>Check the </span></span><span style='mso-bookmark:
c5connection'><span style='mso-bookmark:c5dsncreate'><span class=Screentext><span
style='font-family:Helvetica'>Change the default database to:</span></span>
checkbox and select the </span></span><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><span class=Screentext><span style='font-family:
Helvetica'>Wrox_Auto_Works</span></span> database. Accept all other defaults on
this dialog, as shown below, and click </span></span><span style='mso-bookmark:
c5connection'><span style='mso-bookmark:c5dsncreate'><span class=Screentext><span
style='font-family:Helvetica'>Next</span></span> to proceed:</span></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><!--[if gte vml 1]><v:shape id="_x0000_i1030"
 type="#_x0000_t75" style='width:406.5pt;height:234.75pt' fillcolor="window">
 <v:imagedata src="image010.png" o:title="Fig6_C5"/>
</v:shape><![endif]--><![if !vml]><img width=542 height=313
src="image011.jpg" v:shapes="_x0000_i1030"><![endif]></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></span></p>

<p class=LayoutNotes><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></span></p>

<p class=NumberedBulletsUSETHIS style='text-indent:-51.05pt;mso-text-indent-alt:
-22.7pt;mso-list:l6 level1 lfo9;mso-list-change:"%1\:6\:0\:\." "Thearon Willis" 19991216T0525'><span
style='mso-bookmark:c5connection'><span style='mso-bookmark:c5dsncreate'><![if !supportLists]><b
style='mso-bidi-font-weight:normal'><span style='font-size:11.0pt;mso-bidi-font-size:
10.0pt;font-family:"ITC Franklin Gothic Book"'>6.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></b><![endif]>Unless you want to change your default language or
turn on logging, click the </span></span><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><span class=Screentext><span style='font-family:
Helvetica'>Finish</span></span> button to proceed to the next dialog:</span></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><!--[if gte vml 1]><v:shape id="_x0000_i1031"
 type="#_x0000_t75" style='width:406.5pt;height:234.75pt' fillcolor="window">
 <v:imagedata src="image012.png" o:title="Fig7_C5"/>
</v:shape><![endif]--><![if !vml]><img width=542 height=313
src="image013.jpg" v:shapes="_x0000_i1031"><![endif]></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></span></p>

<p class=LayoutNotes><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></span></p>

<p class=NumberedBulletsUSETHIS style='text-indent:-51.05pt;mso-text-indent-alt:
-22.7pt;mso-list:l6 level1 lfo9;mso-list-change:"%1\:7\:0\:\." "Thearon Willis" 19991216T0525'><span
style='mso-bookmark:c5connection'><span style='mso-bookmark:c5dsncreate'><![if !supportLists]><b
style='mso-bidi-font-weight:normal'><span style='font-size:11.0pt;mso-bidi-font-size:
10.0pt;font-family:"ITC Franklin Gothic Book"'>7.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></b><![endif]>It is always a good idea to test your <span
style='color:black'>DSN</span> at this point and you can do so by clicking on
the </span></span><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><span class=Screentext><span style='font-family:
Helvetica'>Test Data Source</span></span> button:</span></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><!--[if gte vml 1]><v:shape id="_x0000_i1032"
 type="#_x0000_t75" style='width:292.5pt;height:276.75pt' fillcolor="window">
 <v:imagedata src="image014.png" o:title="Fig8_C5"/>
</v:shape><![endif]--><![if !vml]><img width=390 height=369
src="image015.jpg" v:shapes="_x0000_i1032"><![endif]></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></span></p>

<p class=LayoutNotes><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></span></p>

<p class=NumberedBulletsUSETHIS style='text-indent:-51.05pt;mso-text-indent-alt:
-22.7pt;mso-list:l6 level1 lfo9;mso-list-change:"%1\:8\:0\:\." "Thearon Willis" 19991216T0525'><span
style='mso-bookmark:c5connection'><span style='mso-bookmark:c5dsncreate'><![if !supportLists]><b
style='mso-bidi-font-weight:normal'><span style='font-size:11.0pt;mso-bidi-font-size:
10.0pt;font-family:"ITC Franklin Gothic Book"'>8.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></b><![endif]>If your tests were successful you will see the next
dialog:</span></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><!--[if gte vml 1]><v:shape id="_x0000_i1033"
 type="#_x0000_t75" style='width:292.5pt;height:276.75pt' fillcolor="window">
 <v:imagedata src="image016.png" o:title="Fig9_C5"/>
</v:shape><![endif]--><![if !vml]><img width=390 height=369
src="image017.jpg" v:shapes="_x0000_i1033"><![endif]></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></span></p>

<p class=LayoutNotes><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></span></p>

<p class=MsoNormal style='margin-left:51.05pt'><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'>If they were not, go back and repeat the steps
above, verifying that the information you have entered is correct. Click the </span></span><span
style='mso-bookmark:c5connection'><span style='mso-bookmark:c5dsncreate'><span
class=Screentext><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Helvetica'>OK</span></span> button to dismiss the dialog and you
will be returned back to the previous dialog.</span></span></p>

<p class=NumberedBulletsUSETHIS style='text-indent:-51.05pt;mso-text-indent-alt:
-22.7pt;mso-list:l6 level1 lfo9;mso-list-change:"%1\:9\:0\:\." "Thearon Willis" 19991216T0525'><span
style='mso-bookmark:c5connection'><span style='mso-bookmark:c5dsncreate'><![if !supportLists]><b
style='mso-bidi-font-weight:normal'><span style='font-size:11.0pt;mso-bidi-font-size:
10.0pt;font-family:"ITC Franklin Gothic Book"'>9.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></b><![endif]>This is the last step in creating your DSN, and
clicking the </span></span><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><span class=Screentext><span style='font-family:
Helvetica'>OK</span></span> button will finalize the DSN and write it to the
registry. You will be returned to the original screen seen at the beginning of
this example, but this time the </span></span><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><span class=Screentext><span style='font-family:
Helvetica'>Wrox_Auto_Works</span></span> DSN will appear. You can now close the
</span></span><span style='mso-bookmark:c5connection'><span style='mso-bookmark:
c5dsncreate'><span class=Screentext><span style='font-family:Helvetica'>Data
Source Administrator</span></span> dialog.</span></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'>At this point our DSN is ready for use. For
those of you who are security conscious, don't worry. As we stated earlier,
anyone who can log on to this machine can access and use this DSN, however
there is one small catch – they will need a valid login ID and password in SQL
Server before they can use it. While creating the DSN, you supplied a login ID
and password, but only so that the dialog could establish a connection with SQL
Server to gather some information and to validate the DSN. Your password is not
stored as part of the DSN.</span></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'>The registry entries defining this DSN are shown
in the next figure. If you want to view the information for the DSN that you
have just set up, start the Registry Editor by clicking on the </span></span><span
style='mso-bookmark:c5connection'><span style='mso-bookmark:c5dsncreate'><span
class=Screentext><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Helvetica'>Start</span></span> button and choosing </span></span><span
style='mso-bookmark:c5connection'><span style='mso-bookmark:c5dsncreate'><span
class=Screentext><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Helvetica'>Run</span></span>. Enter </span></span><span
style='mso-bookmark:c5connection'><span style='mso-bookmark:c5dsncreate'><span
class=Screentext><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Helvetica'>RegEdit</span></span> and click </span></span><span
style='mso-bookmark:c5connection'><span style='mso-bookmark:c5dsncreate'><span
class=Screentext><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Helvetica'>OK</span></span>. Once the Registry Editor is open,
expand the </span></span><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><span class=Screentext><span style='font-size:
9.0pt;mso-bidi-font-size:12.0pt;font-family:Helvetica'>HKEY_LOCAL_MACHINE</span></span>
hive and then expand the </span></span><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><span class=Screentext><span style='font-size:
9.0pt;mso-bidi-font-size:12.0pt;font-family:Helvetica'>Software</span></span>
folder. Find </span></span><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><span class=Screentext><span style='font-size:
9.0pt;mso-bidi-font-size:12.0pt;font-family:Helvetica'>ODBC</span></span> and
expand that, then expand </span></span><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><span class=Screentext><span style='font-size:
9.0pt;mso-bidi-font-size:12.0pt;font-family:Helvetica'>odbc.ini</span></span>.
Click on the </span></span><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><span class=Screentext><span style='font-size:
9.0pt;mso-bidi-font-size:12.0pt;font-family:Helvetica'>Wrox Auto Works</span></span>
folder to display the information:</span></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><!--[if gte vml 1]><v:shape id="_x0000_i1034"
 type="#_x0000_t75" style='width:462pt;height:322.5pt' fillcolor="window">
 <v:imagedata src="image018.png" o:title="Fig10_C5_new"/>
</v:shape><![endif]--><![if !vml]><img width=616 height=430
src="image019.jpg" v:shapes="_x0000_i1034"><![endif]></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></span></p>

<p class=LayoutNotes><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'>Should you ever want to remove the </span></span><!--[if supportFields]><span
style='mso-bookmark:c5connection'><span style='mso-bookmark:c5dsncreate'></span></span><span
style='mso-element:field-begin'></span><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><span style="mso-spacerun: yes"> </span>XE
&quot;System DSNs:removing&quot; </span></span><![endif]--><span
style='mso-bookmark:c5connection'><span style='mso-bookmark:c5dsncreate'></span></span><!--[if supportFields]><span
style='mso-bookmark:c5connection'><span style='mso-bookmark:c5dsncreate'></span></span><span
style='mso-element:field-end'></span><![endif]--><span style='mso-bookmark:
c5connection'><span style='mso-bookmark:c5dsncreate'></span></span><!--[if supportFields]><span
style='mso-bookmark:c5connection'><span style='mso-bookmark:c5dsncreate'></span></span><span
style='mso-element:field-begin'></span><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><span style="mso-spacerun: yes"> </span>XE
&quot;DSNs:removing&quot; </span></span><![endif]--><span style='mso-bookmark:
c5connection'><span style='mso-bookmark:c5dsncreate'></span></span><!--[if supportFields]><span
style='mso-bookmark:c5connection'><span style='mso-bookmark:c5dsncreate'></span></span><span
style='mso-element:field-end'></span><![endif]--><span style='mso-bookmark:
c5connection'><span style='mso-bookmark:c5dsncreate'>DSN that you have just
created from your system, you need to click on the </span></span><span
style='mso-bookmark:c5connection'><span style='mso-bookmark:c5dsncreate'><span
class=Screentext><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Helvetica'>ODBC Data Sources (32bit)</span></span> icon in the </span></span><span
style='mso-bookmark:c5connection'><span style='mso-bookmark:c5dsncreate'><span
class=Screentext><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Helvetica'>Control Panel</span></span> to invoke the </span></span><span
style='mso-bookmark:c5connection'><span style='mso-bookmark:c5dsncreate'><span
class=Screentext><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Helvetica'>ODBC Data Source Administrator</span></span>. Then
highlight the DSN to be deleted and click on the </span></span><span
style='mso-bookmark:c5connection'><span style='mso-bookmark:c5dsncreate'><span
class=Screentext><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Helvetica'>Remove</span></span> button:</span></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><!--[if gte vml 1]><v:shape id="_x0000_i1035"
 type="#_x0000_t75" style='width:366pt;height:272.25pt' fillcolor="window">
 <v:imagedata src="image020.png" o:title="Fig10b_C5"/>
</v:shape><![endif]--><![if !vml]><img width=488 height=363
src="image021.jpg" v:shapes="_x0000_i1035"><![endif]></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></span></p>

<p class=LayoutNotes><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></span></p>

<p class=MsoNormal style='text-indent:0in;mso-text-indent-alt:0in;mso-list:
none;mso-list-ins:"Thearon Willis" 19991216T0624'><span style='mso-bookmark:
c5connection'><span style='mso-bookmark:c5dsncreate'>Should you ever need to
reconfigure the DSN to point it to a SQL Server on another machine, you would
click the </span></span><span style='mso-bookmark:c5connection'><span
style='mso-bookmark:c5dsncreate'><span class=Screentext><span style='font-size:
9.0pt;mso-bidi-font-size:12.0pt;font-family:Helvetica'>Configure</span></span>
button in the dialog above. This would take you to the dialog shown in step 3
above, and you would repeat the same steps described above to reconfigure the
DSN.</span></span></p>

<span style='mso-bookmark:c5connection'></span>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

</div>

<HR>
<CENTER>
<A HREF="contents.htm"><IMG SRC="back.gif" WIDTH=65 HEIGHT=34 BORDER=0 ALT="Back"></A>
<A HREF="contents.htm"><IMG SRC="contents.gif" WIDTH=69 HEIGHT=34 BORDER=0 ALT="Contents"></A>
<A HREF="30640602.htm"><IMG SRC="next.gif" WIDTH=62 HEIGHT=34 BORDER=0 ALT="Next"></A>
</CENTER>
<FONT SIZE=1>&copy;1999 <A HREF="http://www.wrox.com"> Wrox Press Limited</A>, US and UK.</FONT><p>
</td></tr></table></table><tr><td bgcolor="#991100"><center>
<font FACE="Verdana, Arial, Helvetica" SIZE="-1"><font color="#FFFFFF">Email us your comments:<a href="mailto:contact@vbbooks.freeservers.com"><img src="../images/emailed.gif"alt="mail" border=0></a><br>Fax: 1(916)404-7719<br>

 &copy;1999-2000 Visual Basic Books. All rights reserved.</font><br>

<img src="../images/vbbutton.gif">



</center>
</body>

</html>

