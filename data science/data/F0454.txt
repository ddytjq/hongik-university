ID=F0454
URL=http://www.vbip.com/itc/itc-binary-download-01.asp
SIZE=38316
DATE=09/07/2002
TIME=13:20:56
DATASET=Visual Basic
HTML=
<html>

<head>
<title>Binary download with the Internet transfer control</title>
<meta name="description" content="Have you ever wanted to retrieve information automatically from another web page and display it on your own web page? There are a couple of ways to do this. One way, which I am going to show you in this article, is using the Microsoft Internet Transfer Control, also known as the Inet Control.">
<meta name="GENERATOR" content="Microsoft FrontPage 5.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<meta name="ROBOTS" content="INDEX,FOLLOW">

	<link rel="stylesheet" type="text/css" href="../../vbip_nn.css">

</head>

<body bgcolor="#FFFFFF">
<form name="GlobalForm" ID="GlobalForm">
<table border="0" width="100%" cellspacing="0" cellpadding="0">
  <tr>
    <td width="100%">
      <table border="0" width="100%" cellspacing="0" cellpadding="0">
        <tr>
          <td width="120"><img border="0" src="../_borders/vbip_logo3.gif" width="132" height="50"></td>
          <td valign="middle">
				<p align="center">
              <!-- start BITS ad HTML -- top of page -- 468x60 banner www.bitsonthewire.com         --> 
               <iframe src="http://ads.bitsonthewire.com/admgriframe.asp?siteid=1126&ad_type=0" width=468 height=60 marginwidth=0 marginheight=0 hspace=0 vspace=0 frameborder=0 scrolling=no> 
                 <a href="http://ads.bitsonthewire.com/adrdrmanager.asp?loc=1">
                   <img border="0" src="http://ads.bitsonthewire.com/admanager.asp?loc=1&siteid=1126&ad_type=0">
                 </a></iframe> 
              <!-- stop BITS ad HTML -- top of page -- 468x60 banner                                --> 
				&nbsp;
              <a href="http://www.amazon.com/exec/obidos/redirect-home/vbipvisualbasici">
              <img border="0" src="../images/gnused120x60.gif" width="120" height="60"></a></p>
          </td>
        </tr>
      </table>
    </td>
  </tr>
  <tr>
    <td width="100%" height="1" valign="top">
      <hr noshade color="#FF9933">
    </td>
  </tr>
  <tr>
    <td width="100%" height="1" valign="top">
    <p class="barsidecaption">
    	<a href="../default.asp">Home</a> -
      	<a href="../whatsnew.asp"> What's New</a> - <a href="../tools.asp"> Tools&amp;Technologies</a> -
      	<a href="../resources.asp"> Resources</a> - <a href="../resources/books/default.asp">Books</a>
        - <a href="../forum/">Forum</a>
    </p>
    </td>
  </tr>
  <tr>
    <td width="100%" height="1" valign="top">
      <hr noshade color="#FF9933">
    </td>
  </tr>
</table>

<table width="100%" cellspacing="1" cellpadding="2" bordercolor="#800000" border="1">
  <tr>
    <td width="100%" bgcolor="#FF9933">
      <font color="#FFFFCC">
      <table border="0" width="100%" cellspacing="0" cellpadding="0">
        <tr>
          <td width="37%">
          <SCRIPT LANGUAGE=javascript>
          <!--
          if(navigator.appName.indexOf('Microsoft')>=0)
          {
          document.write('<a HREF="javascript:void(0);" class="tbcaption" onClick="window.external.AddFavorite(location.href, document.title);">Add to Favorites</a>');
          }
          // -->
          </SCRIPT>
          </td>
          <td width="63%">
            <p align="right" class="tbcaption">
            <a href="../default.asp" class="tbcaption">Home</a> -
            <a href="../tools.asp" class="tbcaption">Tools&amp;Technologies</a> -
            <a class="tbcaption" href="../itc">ITC</a> - 
            HTTP Transfer Component
          </td>
        </tr>
      </table>
      </font>
    </td>
  </tr>
</table>
<table border="0" width="100%" cellspacing="0" cellpadding="0">

<!--table-->
    <td width="125" valign="top"  style="border-left: 1px solid #800000; border-right: 1px solid #800000; " bgcolor="#FF9933">

    <table border="0" width="100%">
     <tr>
        <td width="100%" bgcolor="#FFCC00" style="border-left: 1px solid #800000; border-right: 1px solid #FFFFCC; border-top: 1px solid #800000; border-bottom: 1px solid #FFFFCC; " height="20">
          <p align="center" class="barsidecaption">[Advertisement]</td>
      </tr>
      <tr>
        <td width="100%" style="border: 1px solid #800000; " height="120">
<!-- start BITS ad HTML -- first 125x125 banner www.bitsonthewire.com                 --> 
<iframe src="http://ads.bitsonthewire.com/admgriframe.asp?siteid=1126&ad_type=-6" width=125 height=125 marginwidth=0 marginheight=0 hspace=0 vspace=0 frameborder=0 scrolling=no>
<a href="http://ads.bitsonthewire.com/adrdrmanager.asp?loc=3"><img border="0" src="http://ads.bitsonthewire.com/admanager.asp?loc=3&siteid=1126&ad_type=-6"></a></iframe> 
<!-- stop BITS ad HTML -- 125x125 banner                                             --> 	
        </td>
      </tr>
         
      <tr>
        <td width="100%" style="border-left: 1px solid #800000; border-right: 1px solid #FFFFCC; border-top: 1px solid #800000; border-bottom: 1px solid #FFFFCC; " bgcolor="#FFCC00" height="21">
          <p align="center" class="barsidecaption">[Search vbip.com]</td>
      </tr>
      <tr>
      
        <td valign="top" width="100%" height="21">
        
			<input type="text" size="7" name="search_site">&nbsp;
			<input type="button"  value="Go" onclick='location.href="http://www.vbip.com/search2/search.asp?Realm=vbip.com&Match=1&Terms="+document.GlobalForm.search_site.value;'>	
		
        </td>
      </tr>
         
      <tr>
        <td width="100%" style="border-left: 1px solid #800000; border-right: 1px solid #FFFFCC; border-top: 1px solid #800000; border-bottom: 1px solid #FFFFCC; " bgcolor="#FFCC00" height="21">
          <p align="center" class="barsidecaption">[Search other VB sites]</td>
      </tr>
      <tr>
        <td valign="top" width="100%" height="21">
        
			<input type="text" size="7" name="search_web">&nbsp;
			<input type="button"  value="Go" onclick='location.href="http://www.vbip.com/search2/search.asp?Realm=Other+VB+Websites&Match=1&Terms="+document.GlobalForm.search_web.value;'>	
		      
      </tr>
     
      <tr>
        <td width="100%" style="border-left: 1px solid #800000; border-right: 1px solid #FFFFCC; border-top: 1px solid #800000; border-bottom: 1px solid #FFFFCC; " bgcolor="#FFCC00" height="21">
          <p align="center" class="barsidecaption">[Featured Book]</td>
      </tr>
      <tr>
        <td valign="top" width="100%" height="21">
<center><script src="http://rcm.amazon.com/e/cm?t=vbipvisualbasici&l=st1&search=vb%20net&mode=books&p=8&o=1" type="text/JavaScript"></script><noscript>
<MAP NAME="boxmap"><AREA SHAPE="RECT" COORDS="14, 200, 103, 207" HREF="http://rcm.amazon.com/e/cm/privacy-policy.html?o=1"><AREA COORDS="0,0,10000,10000" HREF="http://www.amazon.com/exec/obidos/redirect-home/vbipvisualbasici"></MAP><img src="http://rcm-images.amazon.com/images/G/01/rcm/120x240.gif" width="120" height="240" border="0" usemap="#boxmap" alt="Shop at Amazon.com">

</noscript>

</center>
        </td>
      </tr>
     
      <tr>
        <td width="100%" style="border-left: 1px solid #800000; border-right: 1px solid #FFFFCC; border-top: 1px solid #800000; border-bottom: 1px solid #FFFFCC; " bgcolor="#FFCC00" height="21">
          <p align="center" class="barsidecaption">[Newsletter]</td>
      </tr>
      <tr>
        <td width="100%" height="56">
          <form method="POST" action="../sub.asp" onSubmit="">
            <table border="0" width="100%" cellspacing="0">
              <tr>
                <td width="84%">
                <input type="text" name="T1" size="8" style="font-family: Tahoma; color: #800000; font-size: 8pt; background-color: #FFCC99; border-left: 1px solid #800000; border-right: 1px solid #FFFFCC; border-top: 1px solid #800000; border-bottom: 1px solid #FFFFCC; " value="your e-mail"></td>
                <td width="16%"><input type="submit" value="Sub" name="B1" style="font-family: Tahoma; font-size: 8pt; color: #800000"></td>
              </tr>
              <tr>
                <td width="100%" colspan="2"><input type="radio" value="V1" checked name="R1"><span class="barsidecaption">HTML</span>
                  <input type="radio" name="R1" value="V2"><span class="barsidecaption">Text</span></td>
              </tr>
            </table>
          </form>
        </td>
      </tr>

      <tr>
        <td width="100%" style="border-left: 1px solid #800000; border-right: 1px solid #FFFFCC; border-top: 1px solid #800000; border-bottom: 1px solid #FFFFCC; " bgcolor="#FFCC00" height="21">
      <p align="center" class="barsidecaption">
      [Partners]
      </tr>
	
  <tr>
        <td width="100%" height="22">
      <p align="center"><a href="http://www.vbcity.com" target="_blank"><img border="0" src="..//images/vbcity2_100x30.gif" width="100" height="30"></a>
  </tr>
  <tr>
        <td width="100%" height="22">
      <p align="center"><a href="http://www.vbweb.co.uk/" target="_blank"><img border="0" src="..//images/vbweb_button.gif" width="100" height="30"></a>
  </tr>  
      <tr>
        <td width="100%" height="12" align="center">
      <a href="http://www.vbwire.com" target="_blank"><img border="0" src="..//images/VBWire-btn.gif" width="100" height="30"></a>
      </tr>

  <tr>
        <td width="100%" height="22">
      <p align="center"><a href="http://www.developersdex.com/vb" target="_blank"><img border="0" src="..//images/vbdex.gif" width="100" height="30"></a>
  </tr>  
  <tr>
        <td width="100%" height="3">
        <center>
        <!-- BEGIN ACKY CODE -->
		<a href="http://www.acky.net" target="_blank"><img
		src="http://www.acky.net/banners/ackbut3.gif" width="88" height="31"
		border="0" alt="Acky.net is your one stop shop for all of your web
		developing needs"></a>
		<!-- END ACKY CODE -->
		</center>
  </tr>
    </table>

    </td>
    <td valign="top" bgcolor="#FFFFFF">
      <blockquote>
        <p><b><font face="Arial"><a href="../winsock_control.asp"><br>
        </a><img border="0" src="itc-banner.gif">
        </font></b></p>
        <p class="ChapterTitle">Binary download with the Internet transfer 
        control</p>
          <table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="90%" id="AutoNumber1">
            <tr>
              <td width="62%"><b><font face="Arial" size="2" color="#800000">
              Using Internet Transfer Control in ASP and VB</font></b></td>
              <td width="38%">
              <p align="right"><b><font face="Arial" size="2" color="#800000">
              Written By Mikael &Ouml;stberg</font></b></td>
            </tr>
        </table>
          <table border="0" width="90%" cellspacing="0" cellpadding="0" height="44">
            <tr>
              <td width="100%" height="15" colspan="3">
        <hr noshade size="1" color="#FF9933">
              </td>
            </tr>
            <tr>
              <td width="16" bgcolor="#FFFFCC" height="21" valign="top" style="border: 1px solid #FF9933" class="tbcaption">
                <p align="center">
                <a href="itc-binary.zip">
                <img border="0" src="../images/download-icon4.gif" align="right"></a></td>
              <td width="40%" bgcolor="#FF9933" height="21" class="tbcaption">
                <p>&nbsp;<a class="tbcaption" href="itc-binary.zip">Download
                <span lang="en-us">ITC Binary</span> sample project</a></td>
              <td width="57%" bgcolor="#FF9933" height="21" class="tbcaption">
              <p align="right" class="tbcaption">
              &nbsp;</td>
            </tr>
            <tr>
              <td width="100%" height="15" colspan="3">
        <hr noshade size="1" color="#FF9933">
              </td>
            </tr>
          </table>
        <p class="ArticleH2">Introduction</p>
        <blockquote>
        <p align="justify">Have you ever wanted to retrieve information 
        automatically from another web page and display it on your own web page? 
        There are a couple of ways to do this. One way, which I am going to show 
        you in this article, is using the Microsoft Internet Transfer Control, 
        also known as the Inet Control. It is extremely easy to use and if you 
        want to retrieve textual data only, you do not even need any compiled 
        component, you could use this directly in your ASP application.</p>
        </blockquote>
        <p align="justify" class="ArticleH2">Requirements</p>
        <blockquote>
        <p>You do not need any special software to follow the enclosed examples. 
        The required software is:</p>
          <ul type="square">
            <li>Windows 9x/2000, any version </li>
            <li>A web server such as PWS(personal web server) or IIS(Internet 
            information server) </li>
            <li>TCP/IP protocol </li>
            <li>Visual Studio with Visual Basic, version 5 or higher. Version 6 
            is recommended, since version 5 of Internet transfer control has a 
            couple of known bugs. </li>
          </ul>
        </blockquote>
        <p class="ArticleH2">What is the Internet transfer control?</p>
        <blockquote>
        <p align="justify">When Microsoft released Visual Basic 5 they included 
        an ActiveX control that made communication with Internet servers in 
        applications a fairly easy task. The Internet transfer control. It is 
        actually an OLE interface to an underlying dynamic link library (dll) 
        named wininet.dll. This dll is a part of the Win32 Application 
        Programming Interface (API). This makes the Internet transfer control an 
        interface to a core part of Windows. Before the release of Visual Basic 
        5 and the introduction of this ActiveX control, Microsoft platform 
        developers had to dig in deep in the complex world of TCP/IP, Windows 
        sockets and C source code. Fortunately Microsoft gave us the Internet 
        transfer control which made communication with Internet in our 
        applications really easy. It supports both the http and the ftp 
        protocol, but in this article we will only talk about http 
        communication.</p>
        </blockquote>
        <p class="ArticleH2">Why Internet transfer control?</p>
        <blockquote>
          <p align="justify">Why did I choose the Internet Transfer Control to 
          do this? First of all, it is really easy to use. In the most simple 
          example there are only two lines of code which actually let you 
          download the source code of almost any web page. You can also, with 
          the use of some nice compiled Visual Basic code, retrieve binary data 
          such as images or other documents that you might find in a web page.
          </p>
          <p align="justify">There are some commercial components that do this 
          as well, but as you know, they are not free and sometimes there is not 
          even any possibility to register any third part components on the 
          server, then in that case, this is the solution. </p>
        </blockquote>
        <p class="ArticleH2">Possible uses</p>
        <blockquote>
          <p align="justify">This sounds excellent, but what can I use this for?
          </p>
          <p align="justify">As mentioned, you can retrieve the source code of 
          almost any web page. This gives you many possibilities right there. 
          Download the code and then do some string handling and you have 
          whatever you want. </p>
          <p align="justify">Another really interesting thing with the Internet 
          Transfer Control is that you can retrieve binary data, if you use it 
          in a Visual Basic component. Imagine that you search your downloaded 
          source code for image tags and store those image links in an array. 
          Then run a function that downloads all images as well. You have built 
          an application that is capable of downloading an entire page with 
          images and other documents with it. </p>
          <p align="justify">The ultimate application using this technology 
          would be one that automatically contacts a remote system to check for 
          updates and then downloads all the new content or what ever updates 
          there might be. In such a solution it would be excellent to use the 
          FTP capabilities of the Internet transfer control. Follow the 
          reference links for more information on programming with the FTP 
          protocol. </p>
        </blockquote>
        <p class="ArticleH2">Proxy</p>
        <blockquote>
        <p align="justify">If you are behind a proxy server, you have to set the 
        proxy property of the Internet transfer control to make it able to 
        communicate with the Internet. You have to follow two simple steps to 
        make it use the proxy property. First of all you have to set the <b>
        <font face="Courier New">AccessType</font></b> property to use proxy. 
        There are three different options on the <b><font face="Courier New">
        AccessType</font></b> property. The first one, which is also the default 
        value, <b><font face="Courier New">icUseDefault(0)</font></b>, does 
        exactly what it sounds like. It uses the default settings found in the 
        registry on your computer to access the Internet. The second one, <b>
        <font face="Courier New">icDirect(1)</font></b>, means that the control 
        has direct connection to the Internet. The third and last one, <b>
        <font face="Courier New">icNamedProxy</font></b>, is the one you have to 
        use if you are using a specific proxy server.</p>
        <p align="justify" class="code">ObjInet.AccesType = icNamedProxy</p>
        <p align="justify">If you are using the <b><font face="Courier New">
        AccessType</font></b> property with the <b><font face="Courier New">
        icNamedProxy</font></b> value, you indicate that you will provide the 
        name of the proxy server. Set the proxy property to the name of the 
        server to use.</p>
        <p align="justify" class="code">ObjInet.Proxy = “Proxy1”</p>
        <p align="justify">In this case the name of the proxy server would be 
        “Proxy1”.</p>
        </blockquote>
        <p align="justify" class="ArticleH2">Using the Internet transfer control 
        in pure ASP</p>
        <blockquote>
          <p align="justify">Before we start I suggest you to download the file 
          package attached to this article and put the files on your web server. 
          That will give you a great advantage when you read the following 
          examples. You might have to change some paths in the files, since I 
          wanted to keep the code as clean as possible, without any <b>
          <font face="Courier New">server.mappath()</font></b> or equivalent. 
          Everything is designed to be located in a root folder. Well, let us 
          get started! </p>
          <p align="justify">The following example let you download the source 
          code of any valid URL, but in this example you will only be able to 
          download textual data. The binary download will be described later in 
          the article. The source code of this example can be found in 
          example01.asp </p>
          <p align="justify">The first thing you should do is to create an 
          instance of the Internet Transfer Control Object. </p>
          <p align="justify" class="code">Set objInet = 
          Server.CreateObject(&quot;InetCtls.Inet&quot;) </p>
          <p align="justify">Let us download the source code of the sample page 
          that is included in the file package (test.html). The file is stored 
          locally, but we are getting it through the http protocol from your web 
          server, so it will work as the real thing. To do this we are using the
          <b><font face="Courier New">OpenURL</font></b> method. This method 
          takes one parameter, a valid URL of subtype string. It also has an 
          optional parameter, data type, which sets which datatype we want as 
          return value. The default value is 0(<b><font face="Courier New">icString</font></b>), 
          which means that we are getting a string as the return value. The 
          other possible value is 1(<b><font face="Courier New">icByteArray</font></b>), 
          which makes the <b><font face="Courier New">OpenURL</font></b> method 
          return a byte array, which I will describe what to do with later in 
          the article. Let us take a look at the code that downloads the remote 
          source code: </p>
          <p align="justify" class="code">strDownloadedCode = 
          objInet.OpenURL(&quot;http://localhost/test.html&quot;) </p>
          <p align="justify">What happens now is that the Internet Transfer 
          Control is sending a request to your web server and asks for the test 
          file (test.html). Like your browser it receives the code, but unlike 
          your browser it does not do anything more with it. The downloaded code 
          remains in the variable and we can do whatever we want with it. To 
          display it, we could either use the <b><font face="Courier New">
          Server.HTMLEncode()</font></b> or as in the example, use a textarea. 
          The result should look like this: </p>
          <p align="center">
          <span lang="EN-US" style="font-size: 10.0pt; font-family: Times New Roman">
          <img width="472" height="310" src="itc-bi1.jpg" v:shapes="_x0000_i1025"></span></p>
        </blockquote>
        <p align="justify" class="ArticleH2">Doing this in Visual Basic</p>
        <blockquote>
          <p align="justify">To do this in Visual Basic is more or less the same 
          thing. I have enclosed a Visual Basic project with a single form that 
          does exactly the same thing as the ASP application described above. To 
          try this out, just open the project (Vbexample01.vbp) in Visual Basic 
          and run it. It is made as a standard exe, to make things easier for 
          you. The only thing you should know is that there is no <b>
          <font face="Courier New">CreateObject()</font></b> as we saw in the 
          ASP version. The object is drawn in Visual Basic style and is ready to 
          use. The object appears in your toolbox because I have added the 
          Microsoft Internet Transfer Control 6.0 control component. To check or 
          alter the included control components in Visual Basic, go to the 
          project menu and then choose components. This opens the components 
          dialog and will display a list with all the possible control 
          components you can choose to include. Make sure the Microsoft Internet 
          Transfer Control 6.0 checkbox is checked. This should already have 
          been done in the projects in the enclosed file package, but if you 
          encounter any problems, this should be the first thing to check. </p>
          <p align="justify">I will not describe it more than this, the comments 
          in the code will describe what is happening. You find the project 
          files for this example in the file package (VBexample01.vbp). </p>
        </blockquote>
        <p align="justify" class="ArticleH2">The binary download</p>
        <blockquote>
          <p align="justify">To complete the task of downloading an entire web 
          page, we have to be able to download images and other documents, 
          binary data. I prefer to do this in Visual Basic, since it is very 
          easy to use all the powerful built-in functionality in Visual Basic. 
          To do this we need a byte array and an integer for storing the <b>
          <font face="Courier New">FreeFile()</font></b> number. </p>
          <table border='0' width='80%' bgcolor='#F8F8F8' cellspacing='0' cellpadding='2'>
  <tr>
    <td width='100%'>
      <p class='code'><font color="#000080">Dim&nbsp;</font>byteData()&nbsp;<font color="#000080">As&nbsp;Byte&nbsp;</font>&nbsp;<br>
<font color="#000080">Dim&nbsp;</font>intFile&nbsp;<font color="#000080">As&nbsp;Integer&nbsp;</font>&nbsp;<br>
      </p>
    </td>
  </tr>
</table>
          <p>Choose a valid url. In this example we are using the image included 
          in the file package, </p>
          <table border='0' width='80%' bgcolor='#F8F8F8' cellspacing='0' cellpadding='2'>
  <tr>
    <td width='100%'>
      <p class='code'>strUrl&nbsp;=&nbsp;“http://localhost/Image01.jpg”&nbsp;&nbsp;<br>
      </p>
    </td>
  </tr>
</table>
          <p>Using the <b><font face="Courier New">FreeFile()</font></b> 
          function gives us the first available file. </p>
          <table border='0' width='80%' bgcolor='#F8F8F8' cellspacing='0' cellpadding='2'>
  <tr>
    <td width='100%'>
      <p class='code'>intFile&nbsp;=&nbsp;FreeFile()&nbsp;&nbsp;<br>
      </p>
    </td>
  </tr>
</table>
          <p align="justify">We are still using the <b><font face="Courier New">
          OpenURL</font></b> method, but since we are using the constant <b>
          <font face="Courier New">icByteArray</font></b> it will return a byte 
          array. This ensures that no binary information is lost, which is 
          particularly important when we are dealing with binary files, such as 
          images or other documents. The binary data is streamed into the byte 
          array. </p>
          <table border='0' width='80%' bgcolor='#F8F8F8' cellspacing='0' cellpadding='2'>
  <tr>
    <td width='100%'>
      <p class='code'>byteData() = ObjInet.OpenURL(strUrl, icByteArray)</p>
    </td>
  </tr>
</table>
          <p>When the data is received we have to open a local file for binary 
          access, write the content of the byte array and then close it. </p>
          <table border='0' width='80%' bgcolor='#F8F8F8' cellspacing='0' cellpadding='2'>
  <tr>
    <td width='100%'>
      <p class='code'><font color="#000080">Open&nbsp;</font>“c:\temp\newFile.jpg”&nbsp;<font color="#000080">For&nbsp;Binary&nbsp;Access&nbsp;Write&nbsp;As&nbsp;</font>#intFile&nbsp;&nbsp;<br>
<font color="#000080">Put&nbsp;</font>#intFile,&nbsp;,&nbsp;byteData()&nbsp;&nbsp;<br>
<font color="#000080">Close&nbsp;</font>#intFileb&nbsp;&nbsp;<br>
      </p>
    </td>
  </tr>
</table>
          <p>The file is now written to the path specified, in this case 
          c:\temp. Try this example on your own with any binary file on the 
          Internet. You find the project files for this example in the file 
          package (VBexample02.vbp). </p>
        </blockquote>
        <p align="justify" class="ArticleH2">Sample application called from ASP</p>
        <blockquote>
          <p align="justify">To show you how you can combine the two previous 
          methods of downloading data I have enclosed a Visual Basic example 
          (Vbexample03.vbp). This example is a very simple application that 
          downloads the source code of the second html file, test2.html, and 
          searches the code for image tags. When it finds an image tag it 
          resolves the filename and downloads the image binary. To make this 
          application accessible from an ASP page it is made as an ActiveX dll 
          and not as a standard exe, as the two previous Visual Basic examples. 
          This class has only one method, which is the <b>
          <font face="Courier New">GetWebPage</font></b> method. It takes two 
          parameters, the url to download and the target path on your machine, 
          both as string. </p>
          <p align="justify">This sample application is just a small example of 
          how you can combine the two ways of downloading data. It has some 
          limitations in the search function. I you are planning to use this 
          technology you have to improve that search function. </p>
        </blockquote>
        <p align="justify" class="ArticleH2">Execute method and asynchronous 
        transmission</p>
        <blockquote>
          <p align="justify">One major drawback with the <b>
          <font face="Courier New">OpenURL</font></b> method is that it results 
          in synchronous transmission of data. This means that the transfer 
          operation occurs before any other procedures are executed. The result 
          of this is that all data transfer has to be completed before any other 
          code can be executed. That causes no problem when we are downloading 
          source code from one single page, but if we want to download a 2Mb 
          binary file, this would cause problems. Everything would work, but we 
          all know how a User reacts when an application is “stuck” for more 
          than 10 seconds, or even worse, 2 minutes. The User is sure something 
          is wrong and will probably try to “solve” the problem by closing the 
          application. What we have to do is to give some kind of output of the 
          progress. If no other code can be executed while downloading, what 
          shall we do? Fortunately, there is a solution to this, the Internet 
          transfer controls <b><font face="Courier New">Execute</font></b> 
          method. When this method is invoked it results in an asynchronous 
          transmission and the transfer operation occurs independently of other 
          procedures. This means that other code can be executed while data is 
          received in the background. </p>
          <p align="justify">What does this mean to us, the developers? The <b>
          <font face="Courier New">OpenURL</font></b> resulted a direct stream 
          of data that we could save to disk or view directly in a textarea or 
          TextBox, if it was textual data. With the <b><font face="Courier New">
          Execute</font></b> method, on the other hand, we have to monitor the 
          control’s connection state using the <b><font face="Courier New">
          stateChange</font></b> event. When a certain state is reached, we have 
          to invoke the <b><font face="Courier New">getChunk</font></b> method 
          to retrieve the data from the control’s buffer. </p>
          <p align="justify">I have enclosed an example (Vbexample04.vbp) that 
          will show you how to use the Execute method. The example will also 
          show that you can execute other code while downloading the data. The 
          code and the comments will describe how it works. </p>
        </blockquote>
        <p class="ArticleH2">Summary </p>
        <blockquote>
          <p>In this article we saw how to use the Internet transfer control to 
          download textual data like remote source code from a very simple ASP 
          application. We also saw how to download binary data using Visual 
          Basic. Hopefully trough this article, you have learned how easy it is 
          to reuse information on remote server in your applications. Of course, 
          if you are planning to use this technology to grab anything, make sure 
          you have the author’s permission to do this. </p>
        </blockquote>
        <p>&nbsp;</p>
<p>        
    <hr noshade color="#FF9933">
    <table width="90%" align="center" border="0">
      <tr>
        <td width="25%">
          <img border="0" src="../../images/comments.gif">
        </td>
        <td width="75%">
          Please, post here only feedback for the article/tutorial/sample you
          have read above.<br>
          If you have any question and like to get an answer, post your messages in the <a href="http://www.vbip.com/forum/">Forum</a>.
        <td>
      </tr>
    </table>
    
    
			<p><b><font face="Arial" size="2" color="#800000"><a href="../../comment.asp?736">Use ServerXMLHTTP instead</a></font></b><br>
			<i><font color="#808080" face="Times New Roman" size="2">Renato Takashi Tuesday, February 19, 2002</font></i>	
			</p>
			
			<p><b><font face="Arial" size="2" color="#800000"><a href="../../comment.asp?772">Comment om </a></font></b><br>
			<i><font color="#808080" face="Times New Roman" size="2">Mark Dalsaso Thursday, March 14, 2002</font></i>	
			</p>
			
			<p><b><font face="Arial" size="2" color="#800000"><a href="../../comment.asp?850">Very useful article</a></font></b><br>
			<i><font color="#808080" face="Times New Roman" size="2">Koroush Wednesday, May 08, 2002</font></i>	
			</p>
			
			<p><b><font face="Arial" size="2" color="#800000"><a href="../../comment.asp?851">Who can i resume a broken download</a></font></b><br>
			<i><font color="#808080" face="Times New Roman" size="2">Nuno Moreira Friday, May 10, 2002</font></i>	
			</p>
			
			<p><b><font face="Arial" size="2" color="#800000"><a href="../../comment.asp?815">Internet Transfer control</a></font></b><br>
			<i><font color="#808080" face="Times New Roman" size="2">Nitin Sunday, April 14, 2002</font></i>	
			</p>
			
			<p><b><font face="Arial" size="2" color="#800000"><a href="../../comment.asp?828">POST/GET/HEAD links?</a></font></b><br>
			<i><font color="#808080" face="Times New Roman" size="2">Richard Alford Thursday, April 18, 2002</font></i>	
			</p>
			
			<p><b><font face="Arial" size="2" color="#800000"><a href="../../comment.asp?863">This example only for local web page ??</a></font></b><br>
			<i><font color="#808080" face="Times New Roman" size="2">Pasquale Wednesday, May 15, 2002</font></i>	
			</p>
			
			<p><b><font face="Arial" size="2" color="#800000"><a href="../../comment.asp?869">ITC & Proxy Authorization</a></font></b><br>
			<i><font color="#808080" face="Times New Roman" size="2">Ciro Verde Friday, May 17, 2002</font></i>	
			</p>
			
			<p><b><font face="Arial" size="2" color="#800000"><a href="../../comment.asp?870">An another way instead of ASP..</a></font></b><br>
			<i><font color="#808080" face="Times New Roman" size="2">Pete Monday, May 20, 2002</font></i>	
			</p>
			
			<p><b><font face="Arial" size="2" color="#800000"><a href="../../comment.asp?901">The Execute method</a></font></b><br>
			<i><font color="#808080" face="Times New Roman" size="2">Sebastien Nadeau Friday, May 31, 2002</font></i>	
			</p>
			
			<p><b><font face="Arial" size="2" color="#800000"><a href="../../comment.asp?930">Authenticating</a></font></b><br>
			<i><font color="#808080" face="Times New Roman" size="2">KDX Saturday, June 15, 2002</font></i>	
			</p>
			
			<p><b><font face="Arial" size="2" color="#800000"><a href="../../comment.asp?940">VB6 Inet Control to VB.NET</a></font></b><br>
			<i><font color="#808080" face="Times New Roman" size="2">TL Saturday, June 22, 2002</font></i>	
			</p>
			
        <p>
        <form name="newcomm" method="POST" action="../../add_comments.asp">
          <p><input align="right" border="0" src="../../images/addyours2.gif" name="I1" type="image"></p>
          <input type="hidden" name="page" value="/itc/itc-binary-download-01.asp">
          <input type="hidden" name="title">
	  <input type="hidden" name="actionID" value="add">
        </form>
        <SCRIPT LANGUAGE="JavaScript">
        	{document.newcomm.title.value = document.title}
        </SCRIPT>
	<br>
        <p>
        <hr noshade color="#FF9933">
</p>   
      </blockquote>
<p><center>
<!-- start BITS ad HTML -- bottom of page 468x60 banner www.bitsonthewire.com         --> 
  <iframe src="http://ads.bitsonthewire.com/admgriframe.asp?siteid=1126&ad_type=2" width=468 height=60 marginwidth=0 marginheight=0 hspace=0 vspace=0 frameborder=0 scrolling=no> 
    <a href="http://ads.bitsonthewire.com/adrdrmanager.asp?loc=2">
      <p>
      <img border="0" src="http://ads.bitsonthewire.com/admanager.asp?loc=2&siteid=1126&ad_type=2">
    </a>
  </iframe> 
<!-- stop BITS ad HTML -- bottom of page 468x60 banner                                --> 
</center></p>
    </td>
</table>
<table border="1" width="100%" cellspacing="1" cellpadding="2" bordercolor="#800000">
  <tr>
    <td width="100%" bgcolor="#FF9933">
      <font color="#FFFFCC">
      <table border="0" width="100%" cellspacing="0" cellpadding="0">
        <tr>
          <td width="37%"></td>
          <td width="63%">
      <font color="#FFFFCC">
            <p align="right" class="tbcaption">
            <a href="../default.asp" class="tbcaption">Home</a> -
            <a href="../tools.asp" class="tbcaption">Tools&amp;Technologies</a> -
            <a class="tbcaption" href="../itc">ITC</a> - 
            HTTP Transfer Component
          </font>
          </td>
        </tr>
      </table>
      </font>
    </td>
  </tr>
</table>
&nbsp;<table border="0" width="100%" cellspacing="0" cellpadding="0">
  <tr>
    <td width="121" valign="top">
<!-- START OF WEBTRENDS LIVE TAG -->
<!-- Copyright 2001 NetIQ Corporation -->
<!--  For privacy concerns, check our Privacy Policy at http://www.webtrendslive.com/privacy_policy.htm -->
<SCRIPT LANGUAGE="JavaScript">
<!--
// Modification of this code is not allowed and will permanently disable your account!
// SiteName:  Visual Basic Internet Programming
function wtl_Tag4_27048()
{
	function D8( d)
	{
		var fwd=1, seed= new Date('01/01/2000'), key= "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";
		var s= key.charAt( d.getFullYear()-2000)+key.charAt( d.getMonth()+1)+key.charAt( d.getDate());
		s+= key.charAt( d.getHours())+key.charAt( d.getMinutes())+key.charAt( d.getSeconds());
		while( seed.getDay()!=fwd) seed= new Date(seed.getTime() + 86400000);
		var w= Math.floor( (d.getTime()-(seed.getTime()+86400000)) / 604800000 );
		s+= key.charAt( (w-(w%16))/16 );
		s+= key.charAt( w%16);
		return s;
	}

	var t = new Date();
	var W="tagver=4&si=27048&fw=1&bn=13";
	W+="&tz="+escape(t.getTimezoneOffset());
	W+="&ch="+escape(t.getHours());
	W+="&cl="+escape(D8(t));
	W+="&ti="+escape(document.title);
	W+="&url="+escape(window.document.URL);
	W+="&rf="+escape(window.document.referrer);
	W+="&js=Yes";
	W+="&ul="+(navigator.appName=="Netscape"?navigator.language:navigator.userLanguage);
	if(typeof(screen)=="object")
	{
	W+="&sr="+screen.width+"x"+screen.height;
	W+="&cd="+screen.colorDepth;
	W+="&jo="+(navigator.javaEnabled()?"Yes":"No");
	}
	
	
	document.write('<A TARGET="_blank" HREF="http://www.webtrendslive.com/redirect.asp?siteID=27048">');
	document.write('<IMG ID="WTL_TAG" BORDER="0" WIDTH="100" HEIGHT="30" ALT="This Site Tracked by WebTrendsLive." SRC="http://p.wtlive.com/S003-00-9-14-186109-27048/button4.asp?'+W+'">');
	document.write('</A>');
	
}	

wtl_Tag4_27048();
//-->
</SCRIPT>


<NOSCRIPT>
<A TARGET="_blank" HREF="http://www.webtrendslive.com/redirect.asp?siteID=27048">
<IMG BORDER="0" WIDTH="100" HEIGHT="30" ALT="This Site Tracked by WebTrendsLive." SRC="http://p.wtlive.com/S003-00-9-14-186109-27048/button4.asp?tagver=4&si=27048&fw=1&bn=13&js=No&"></A></NOSCRIPT>


<!-- END OF WEBTRENDS LIVE TAG -->

     
      </td>
    <td>
<p align="center" class="barsidecaption"><a href="../default.asp">Home</a> | <a href="../whatsnew.asp">What's
New</a> | <a href="../tools.asp"> Tools
&amp; Technologies</a> | <a href="../resources.asp">Resources</a> | <a href="../resources/books/default.asp">Books</a>
 | <a href="../forum/">Forum</a></p>
<p align="center" class="barsidecaption">Report about any problems and errors to <a href="mailto:webmaster@vbip.com">webmaster@vbip.com</a><br>
Copyright © 1998 - 2002 by <a href="mailto:oleg@vbip.com"> Oleg Gdalevich</a></p>
    </td>
    <td valign="top" width="140">
<p align="center">
<a target="_blank" href="http://www.amazon.com/exec/obidos/ASIN/B00005AFI2/vbipvisualbasici">
<img border="0" src="../images/frontpage_button.gif" align="right" width="100" height="38"></a>
    </td>
  </tr>
</table>
</body>

</html>
