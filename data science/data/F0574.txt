ID=F0574
URL=http://www.visualbasicbooks.com/advVB6samplepg22.html
SIZE=10961
DATE=09/07/2002
TIME=13:22:39
DATASET=Visual Basic
HTML=<html>

<head>



<meta name="description"
content="Visual Basic books for all levels of visual basic programmers are featured and reviewed regularly. Only those Visual Basic books of highest quality appear on this site.">
<meta name="keywords" content="visual basic books,visual basic,vb books,visual basic sites,programming,win32 api,database,beginner,amazon,bookstore">

<title>Visual Basic Books</title>
</head>

<body bgcolor="#6373B5" text="#616161" link="#0000ff" vlink="#666666" alink="#CC9900">
<center>
<!-- BEGIN RICH-MEDIA BURST! CODE --> 
       <script language="JavaScript"> 
       <!-- /* © 1997-1999 BURST! Media, LLC. All Rights Reserved.*/ 
       var TheAdcode = 'ad5645a'; 
       var bN = navigator.appName; 
       var bV = parseInt(navigator.appVersion); 
       var base='http://www.burstnet.com/'; 
       var Tv=''; 
       var agt=navigator.userAgent.toLowerCase(); 
       if (bV>=4) 
         {ts=window.location.pathname+window.location.search; 
          i=0; Tv=0; while (i< ts.length) 
             { Tv=Tv+ts.charCodeAt(i); i=i+1; } Tv="/"+Tv;} 
         else   {Tv=escape(window.location.pathname); 
          if( Tv.charAt(0)!='/' ) Tv="/"+Tv; 
                 else if (Tv.charAt(1)=="/")
       Tv=""; 
         if( Tv.charAt(Tv.length-1) == "/") 
           Tv = Tv + "_";} 
       if (bN=='Netscape'){ 
            if ((bV>=4)&&(agt.indexOf("mac")==-1))
       {  document.write('<s'+'cript src="'+ 
             base+'cgi-bin/ads/'+TheAdcode+'.cgi/RETURN-CODE/JS' 
             +Tv+'">'); 
            document.write('</'+'script>');    
       } 
            else if (bV>=3) {document.write('<'+'a href="'+base+'ads/'+ 
               TheAdcode+'-map.cgi'+Tv+'"target=_top>'); 
               document.write('<img src="' + base + 'cgi-bin/ads/' + 
               TheAdcode + '.cgi' + Tv + '" ismap width=468 height=60' + 
               ' border=0 alt="Click Here"></a>');} 
        } 
       if (bN=='Microsoft Internet Explorer') 
        document.write('<ifr'+'ame id=BURST src="'+base+'cgi-bin/ads/'
       + 
         TheAdcode + '.cgi' + Tv + '/RETURN-CODE" width=468 height=60' + 
         'marginwidth=0 marginheight=0 hspace=0 vspace=0 ' + 
         'frameborder=0 scrolling=no></ifr'+'ame>'); 
       // --> 
       </script> 
       <noscript><a href="http://www.burstnet.com/ads/ad5645a-map.cgi" target=_top> 
       <img src="http://www.burstnet.com/cgi-bin/ads/ad5645a.cgi" 
        width=468 height=60 border=0 alt="Click Here"></a> 
       </noscript> 
       <!-- END BURST CODE --> 
</center>


<table border="0" bgcolor="" cellpadding="0" cellspacing="0">
<tr><td><p align="center"><img src="images/vblogo.jpg" border="0" alt="vb logo"></td></tr>
<tr> 
<td rowspan="3" valign="top" height="1"> <p>&nbsp;</p>

<p align="left"><font face= "verdana" color="#000000"><b>Visual Basic Books</b></font><br>
<a href="index.html"><font color="#ffffff">Home</font></a><br>
<a href="beginner.html"><font color="#ffffff">Visual Basic Beginner Books</font></a><br>
<a href="database.html"><font color="#ffffff">Visual Basic Database Books</font></a><br>
<a href="activex.html"><font color="#ffffff">Visual Basic ActiveX Books</font></a><br>
<a href="advanced.html"><font color="#ffffff">Visual Basic Advanced Books</font></a><br>
<a href="vbinternet.html"><font color="#ffffff">VB Internet Programming Books</font></a><br>


</p>
<p><font color="#000000" face="verdana"><b>Resources</b></font><br>
<a href="links.html"><font color="#FFFFFF">Visual Basic Links</font></a><br>
<a href="addlink.html"><font color="#FFFFFF">Add a Link</font></a><br>
<a href="esubscribe.html"><font color="#FFFFFF">Subscribe to Mailing List</font></a>

</p>

<p>


</font>


<td bgcolor="#ffffff" valign="middle"><h1 align="center"><img src="../images/anibook.gif" alt="" width="32" height="32"><font face="trebuchet ms, arial, helvetica" color="#000000"> Visual Basic Books </font><img src="../images/anibook.gif" alt="" width="32" height="32"></h1>

</td>






</tr><tr>
<td bgcolor="#ffffff" colspan="1" valign="top">



<table border="0" cellpadding="5"><tr><td>


<font  color="#000000" FACE="Verdana, Arial, Helvetica" SIZE="-1">

<center><H1> Advanced Microsoft Visual Basic 6 Chapter 1</h1></center>



<B><FONT FACE="Arial" SIZE=5><P>Tip 15: Don’t test your own <BR>
software or write your own test plans.</P>
</B></FONT><P>Do you have dedicated testers where you work? Possibly not—not many companies do. Many companies say they &quot;can’t afford such a luxury.&quot; Well, in my opinion, they’re a luxury that’s really worth it (as many of the leading software development companies in the world already know).</P>
<P> Independent testers should (and often do) exhibit the following characteristics:</P>

<UL>
<LI>Are impartial</LI>
<LI>Are less informed about the usage and the type of input your code expects</LI>
<LI>Are usually more knowledgeable about the usage and the type of input your code doesn’t expect</LI>
<LI>Are more likely than you to spend time trying to break code</LI>
<LI>Are typically more leery of your interfaces and more critical of your coupling</LI>
<LI>Are into doing you damage and breaking your code</LI>
<LI>Are more informed than you about system limits</LI>
<LI>Unlike you, actually want to find bugs in your software.</LI></UL>

<P>From time to time, Microsoft talks about its ratio of developers to testers: around 1:1. You do the math; for every programmer there’s a tester. In fact, rumor has it that some developers occasionally get shifted to being testers. This could happen if a developer consistently develops very buggy software. Nothing like a shift to testing to improve one’s knowledge and appreciation of what good solid code involves.</P>
<B><FONT FACE="Arial" SIZE=5><P>Tip 16: Stress test your applications.</P>
</B></FONT><P>Years ago, the Windows SDK (Software Development Kit) shipped with an applet named SHAKER.EXE. This applet simply ran around allocating and releasing memory blocks. When and what it actually allocated or released was random!</P>
<P>What was it for, then? Well, before the days of protect mode and virtual memory addressing, you could access any arbitrary memory location through a simple pointer (using C as a programming language, of course). Often, and erroneously, these pointers would be stored in nonrefreshed static variables as an application yielded control to the operating system. This access—or similar access—would cause the problems for which SHAKER.EXE was used to try to uncover.</P>
<P>In between handling one event and a subsequent one, Windows could move (as it can now) both your code and data around. If you’d used a static pointer to, say, point to some data, you’d quickly discover that it was no longer pointing to what you intended. (Modern virtual addressing methods make this problem go away.) So what was the point of SHAKER.EXE? It turned out that, back then, even though your application was being naughty and had stored a static pointer, you didn’t know it most of the time; the Windows memory manager hadn’t moved your data around between your handling of two events. The bottom line was that you didn’t really know you had a problem until memory moved, and on your machine, that rarely, if ever, happened. Customers, however, did see the problem because they were running both your application and others and had loaded their systems to a point that the memory manager was starting to move memory blocks around to accommodate everyone. The whole thing was like attempting to hold a party in a small closet. Initially, everyone had plenty of room. As more people arrived and the closet filled up, however, some of the guests were bound to get their feet stepped on sooner or later. SHAKER.EXE shook the operating system on the developer’s machine until something fell off!</P>
<P>OK, so why the history lesson? Basically, the lesson is a good one and one we can still use. In fact, an associated application, named STRESS.EXE, still ships in Visual C++. (See Figure 1-6.)</P>
<B><FONT FACE="Arial"><P><img src="../images/F01AI06.gif"> </P>
<P>Figure 1-6</P>
</B></FONT><I><P>Stress me (STRESS.EXE) </P>
</I><P>Like SHAKER.EXE, STRESS.EXE is used to make the operating system appear more loaded or busy than it actually is. For example, by using STRESS.EXE you can allocate all of your machine’s free memory, making it look really loaded—or, reading from Tip 6 on, you can find out what happens when you run out of file handles.</P>
<P>Tools such as STRESS.EXE can present your code with a more realistic, perhaps even hostile, environment in which to work. Such conditions can cause many hidden problems to rise to the surface—problems you can fix at that point instead of later in response to a client’s frustrated phone call. I’d certainly recommend using them.</P>
<B><FONT FACE="Arial" SIZE=5><P>Tip 17: Use automated testing tools.</P>
</B></FONT><P>See Chapter 9, &quot;Well, At Least It Compiled OK!&quot; for coverage of this broad and very important subject.</P>
<B><FONT FACE="Arial" SIZE=5><P>Tip 18: Consider error values.</P>
</B></FONT><P>Let’s suppose you still want to return an indication of success from a function (instead of using exceptions). What values would you use to indicate whether or not something worked?</P>
<P>Normally, 0 (or False) is returned for failure, and -1 (True) for success. What are the alternatives? Some programmers like to return 0 for success and some other value for failure—the reason for failure is encoded in the value being returned. Other programmers prefer to return a negative value for failure that again encodes the reason.</P>
<P>By using the first alternative, we can quickly come up with some pretty weird-looking code:</P><DIR>

<FONT FACE="Courier New" SIZE=2><P>If CreateThing() &lt;&gt; True Then ' It worked!</P></DIR>

</FONT><P>or</P><DIR>

<FONT FACE="Courier New" SIZE=2><P>If Not CreateThing() Then ' It worked!</P></DIR>

</FONT><P>or</P><DIR>

<FONT FACE="Courier New" SIZE=2><P>If CreateThing() = False Then ' It worked!</P></DIR>

</FONT><P>or</P><DIR>

<FONT FACE="Courier New" SIZE=2><P>If CreateThing() = SUCCESS Then ' It worked!</P></DIR>

</FONT><I><P>SUCCESS</I>, of course, is defined as 0.</P>
<P>To capture failure, you can’t just do the same, though:</P><DIR>

<FONT FACE="Courier New" SIZE=2><P>If Not CreateThing() Then ' It worked!<BR>
Else<BR>
    ' Failed!<BR>
    ' What do we do?   <BR>
End If</P></DIR>

</FONT><P>Here the reason for failure is lost. We need to hold it in some variable:</P><DIR>

<FONT FACE="Courier New" SIZE=2><P>nResult = CreateThing()<BR>
<BR>
If nResult &lt;&gt; SUCCESS Then<BR>
    ' Failed!<BR>
    ' What do we do?   <BR>
End If</P></DIR>

</FONT><P>All very messy, especially where the language lacks the ability to do an assignment in a conditional expression (as is the case in Visual Basic and is <I>not</I> the case in C).</P>
<P>Consider someone writing the test using implicit expression evaluation:</P><DIR>

<FONT FACE="Courier New" SIZE=2><P>If CreateThing() Then</P></DIR>

</FONT><P> If <I>CreateThing</I> works, it returns 0, which causes the conditional <I>not</I> to execute any code in the body of the compound statement. Yikes! Imagine what code fails to execute all because someone forgot to test against <I>SUCCESS</I>.</P>
<P>Because any nonzero value is evaluated as True (in an <I>If</I>), using a value other than 0 (say, a negative value) to indicate failure can be equally dangerous. Given that in any conditional expression you don’t have to test against an explicit value and that nonzero means execute the compound statement, the language conspires against you here not to use 0 as a code indicating success.</P>
<P>I’d advise sticking to True meaning success and False meaning failure. In the case of failure, I’d implement a mechanism such as the one used in C (<I>errno</I>) or perhaps Win32’s <I>GetLastError</I>. The latter returns the value of the last error (easily implemented in a project—you could even add a history feature or automatic logging of errors).</P>

<center><a href="advVB6samplepg23.html">next page....</a></center>

</td></tr></table></table><tr><td bgcolor="#991100"><center>
<font FACE="Verdana, Arial, Helvetica" SIZE="-1"><font color="#FFFFFF">Email us your comments:<a href="mailto:contact@vbbooks.freeservers.com"><img src="../images/emailed.gif"alt="mail" border=0></a><br>Fax: 1(916)404-7719<br>&copy;1999 Valassis Enterprises. All rights reserved.</font>

<P>

</center>


</body>
</html>

