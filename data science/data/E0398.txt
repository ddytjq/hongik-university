ID=E0398
URL=http://msdn.microsoft.com/visualc/productinfo/news/introducing.asp
SIZE=41075
DATE=12/07/02
TIME=19:20:38
DATASET=C
HTML=
<html>
<head>
<title>Reviews for Visual C++ 6.0</title>
<meta name="KEYWORDS" content="reviews, evaluation, press" />
<meta name="DESCRIPTION" content="Microsoft Visual C++ 6.0 product reviews" />
<meta name="MS.LOCALE" content="EN-US" />
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1" />
<meta name="DTC_TEMPLATE" content="TEMPLATE=navpage" />

		          <link rel="stylesheet" href="/visualc/css.asp?template=EP" type="text/css" />
          

     <meta http-equiv="PICS-Label" CONTENT='(PICS-1.1 "http://www.rsac.org/ratingsv01.html" l comment "RSACi North America Server" by "inet@microsoft.com" r (n 0 s 0 v 0 l 0))' />
     <script src="/products/shared/global.js" type="text/javascript"></script>
     
<link rel="stylesheet" type="text/css" href="/library/flyoutmenu/default.css" />


	
	<script type="text/javascript"><!--
	
	sImgDefaultArrow = "/products/shared/images/imgArrwUp_VS.gif";
	sImgExpandedArrow = "/products/shared/images/imgArrwDwn_VS.gif";

	if (sImgDefaultArrow == ""){
		sImgDefaultArrow = "/products/shared/images/arrow_default.gif";
	}
	if (sImgExpandedArrow == ""){
		sImgExpandedArrow = "/products/shared/images/arrow_expand.gif";
	}
	
	//-->
	</script>
   
</head>
<body bgcolor="#ffffff" topmargin="0" leftmargin="0" marginheight="0" marginwidth="0">	

          <span id="donotprint">
<!-- Start: ToolBar V2.0-->
<script type="text/javascript" language="JavaScript" src="/library/toolbar/toolbar.js"></script>
<script type="text/javascript" language="JavaScript" src="/library/toolbar/en-us/globalMNP.js"></script>
<script type="text/javascript" language="JavaScript" src="/products/shared/toolbar_vstudio.js"></script>
<!-- Start: ToolBar for down-level browsers-->
<span id="TBDownLevelDiv">
	<table width="100%" cellpadding="0" cellspacing="0" border="0" bgcolor="#6699CC">
		<tr>
			<td bgcolor="#6699CC" valign="top" width="250" rowspan="2"><a href="/visualc/" target="_top"><img src="/products/shared/images/bnr_VisualStudio.gif" alt="Visual C++ Home" border="0" /></a></td>
			<td bgcolor="#6699CC" valign="top" height="20" width="19" align="right"><img src="/library/toolbar/images/curve.gif" /></td>
			<td bgcolor="#000000" valign="middle" height="20" align="right" nowrap colspan="2"><font color="#ffffff" face="Verdana, Arial, Helvetica" size="1">
					&nbsp;&nbsp;<a style="color:#ffffff;text-decoration:none;" href="http://www.microsoft.com/products/" target="_top"><font color="#ffffff">All Products</font></a>&nbsp;&nbsp;<font color="#ffffff">|</font>
					&nbsp;&nbsp;<a style="color:#ffffff;text-decoration:none;" href="http://www.microsoft.com/support/" target="_top"><font color="#ffffff">Support</font></a>&nbsp;&nbsp;<font color="#ffffff">|</font>
					&nbsp;&nbsp;<a style="color:#ffffff;text-decoration:none;" href="http://search.microsoft.com/" target="_top"><font color="#ffffff">Search</font></a>&nbsp;&nbsp;<font color="#ffffff">|</font>
					&nbsp;&nbsp;<a style="color:#ffffff;text-decoration:none;" href="http://www.microsoft.com/" target="_top"><font color="#ffffff">microsoft.com Guide</font></a>&nbsp;&nbsp;</font></td>
		</tr>
		<tr>
			<td bgcolor="#6699CC" valign="top" height="40" width="19"><img src="/library/Images/Gifs/General/Trans.gif" width="1" height="1" border="0" alt></td>
			<td valign="top" height="40" align="right" nowrap colspan="2"><a href="/isapi/gomscom.asp?target=/" target="_top"><img src="/library/toolbar/images/mslogo6699CC.gif" width="112" height="40" alt="microsoft.com home" border="0"></a></td>
		</tr>
		<tr>
	<!-- Start: Local menus -->
		<td bgcolor="#6699CC" height="20" VALIGN="MIDDLE" NOWRAP COLSPAN="4">
			<font color="#FFFFFF" class="fontSize1"><b>
				&nbsp;&nbsp;<a style="color:#FFFFFF;text-decoration:none;" href="/visualc/" target="_top"><font color="#FFFFFF">Visual C++ Home</font></a>&nbsp;&nbsp;<font color="#FFFFFF">|</font>
		
			</b></font>
		</td>
	<!-- End: Local menus -->
		</tr>
	</table>
</span>
<!-- End: ToolBar for old browsers-->

<script language="JavaScript" type="text/javascript">
<!--// Hide from old browsers

var ToolBar_Supported = ToolBar_Supported;
if (ToolBar_Supported != null && ToolBar_Supported == true && (navigator.platform=="Win32"))
{
	TBDownLevelDiv.style.display ='none';
	drawToolbar();
	var fBrowserOK = true;
}

//-->
</script>
<!-- End: ToolBar V2.0-->



</span>
          <a name="top"></a>
          <table border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td bgcolor="#ffffff" height="1"><img src="/products/shared/images/ts.gif" height="1" width="1" /></td>
			</tr>
		</table>
          <table cellpadding="0" cellspacing="0" border="0" width="100%">
               <tr valign="top">
                    <td valign="top">
                         <table cellpadding="0" cellspacing="0" border="0" width="100%">
                              <tr valign="top">
                                   <td width="178" valign="top" id="donotprint" > 

									<!-- start leftnav And search code -->
										<table border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#6699CC">
											<tr height="38">
												<td bgcolor="#6699CC" align="center">
													<!-- quick search-->
													<table cellpadding="0" cellspacing="0" border="0" width="179">
													
													<form action="http://search.microsoft.com/us/products/vs/visualc/advanced_search.asp" method="GET" id="form1" name="form1">
													
														<tr>
															<td><img src="/products/shared/images/Trans.gif" height="1" width="5"></td>
															<td>
														<!--[if IE ]><span class="fontSize1" style="color:#FFFFFF">Search This Site</span><br>														<input type="hidden" name="IntCat" value="0" />														<input type="hidden" name="Boolean" value="ALL" />																													<input type="hidden" name="Nq" value="new" />																													<input type="text" name="qu" size="14" maxlength="255" style="height:20 px; width: 125 px;" />																													<img src="/products/shared/images/trans.gif" height="1" width="2" border="0" />															<input alt="go" type="submit" name="finish" value="Go" class="btnSearch">														<![endif]-->
														<![if ! ie ]>
															<span class="fontSize1" style="color:#FFFFFF">Search This Site<br>
															<input type="HIDDEN" name="IntCat" value="0" />
															<input type="HIDDEN" name="Boolean" value="ALL" />
															<input type="HIDDEN" name="Nq" value="NEW" />
															<input type="TEXT" name="qu" size="10" maxlength="255" />
															<input alt="Go" type="SUBMIT" name="FINISH" value="Go" />
															</span>
														<![endif]>
														</td>
														</tr>
										      		</form>
													</table>
													<!--end quick search -->
												</td>
												<td width="1" bgcolor="#6699CC"><img src="/products/shared/images/Trans.gif" alt height="0" width="1" border="0"></td>
											</tr>
											<tr>
												<td>
													<table cellpadding="0" cellspacing="0" border="0" width="100%" bgcolor="#6699CC">
														<tr>
															<td><img src="/products/shared/images/Trans.gif" height="1" width="3"></td>
															<td VALIGN="TOP" class="AdvSearch"><a HREF="http://search.microsoft.com/us/products/vs/visualc/advanced_search.asp?IntCat=0">Advanced Search</a></td>
														</tr>
													</table>
												</td>
											</tr>
										</table>
										<table border="0" cellpadding="0" cellspacing="0" width="100%" onmouseover="if(document.readyState=='complete'&amp;&amp;fBrowserOK)delayRemove();" onmouseout="if (document.readyState=='complete'&amp;&amp;fBrowserOK)cancelDelay();">
										<tr>
										<td bgcolor="#6699CC"><img src="/products/shared/images/Trans.gif" alt height="9" width="179"></td>
										<td width="1" bgcolor="#6699CC"><img src="/products/shared/images/Trans.gif" alt height="0" width="1" border="0"></td>
										</tr>
										</table>

										<table cellpadding="0" cellspacing="0" border="0" width="100%">
										    <tr>
										         <td>
										         
<table class="flyoutMenu" menudata="/visualc/inc/MnpXmlDataGen.asp?subroot=productinfo" width="180" cellpadding="2" cellspacing="0" border="0" >
	<tr>
		<td>

			<table width="175" cellpadding="0" cellspacing="0" border="0">
				<tr>
				
					<td class="flyoutLink" ><a href="/vstudio/default.asp">Visual Studio Home</a></td>
				
				</tr>
			</table>

			<table width="175" cellpadding="0" cellspacing="0" border="0">
				<tr>
				
					<td class="flyoutLink" ><a href="/visualc/default.asp">Visual C++ Home</a></td>
				
				</tr>
			</table>

			<table width="175" cellpadding="0" cellspacing="0" border="0">
				<tr>
				
					<td class="flyoutLink" handle="1001"><a href="/visualc/productinfo/default.asp">Product Information</a></td>
				
				</tr>
			</table>

			<table width="175" cellpadding="0" cellspacing="0" border="0">
				<tr>
				
					<td class="flyoutLink" handle="1074"><a href="/visualc/howtobuy/default.asp">How to Buy</a></td>
				
				</tr>
			</table>

			<table width="175" cellpadding="0" cellspacing="0" border="0">
				<tr>
				
					<td class="flyoutLink" handle="1078"><a href="/visualc/techinfo/default.asp">Technical Resources</a></td>
				
				</tr>
			</table>

			<table width="175" cellpadding="0" cellspacing="0" border="0">
				<tr>
				
					<td class="flyoutLink" handle="1084"><a href="/visualc/downloads/default.asp">Downloads</a></td>
				
				</tr>
			</table>

			<table width="175" cellpadding="0" cellspacing="0" border="0">
				<tr>
				
					<td class="flyoutLink" handle="1082"><a href="/visualc/support/default.asp">Support</a></td>
				
				</tr>
			</table>

			<table width="175" cellpadding="0" cellspacing="0" border="0">
				<tr>
				
					<td class="flyoutLink" handle="1142"><a href="/visualc/community/default.asp">Community</a></td>
				
				</tr>
			</table>
			
		</td>
	</tr>
</table>

<table class="flyoutMenu" menudata="/vstudio/templateMembers.xml" width="180" cellpadding="2" cellspacing="0" border="0" >
	<tr>
		<td>

			<table width="175" cellpadding="0" cellspacing="0" border="0">
				<tr>
				
					<td class="flyoutLink" handle="0420"><a href="/vstudio/">Developer Tools</a></td>
				
				</tr>
			</table>


<html>
<head>
<!--TOOLBAR_START-->
<!--TOOLBAR_EXEMPT-->
<!--TOOLBAR_END-->
</head>
<body>
</body>
</html>			
		</td>
	</tr>
</table>

												</td>
												</tr>
											</table>
										<!-- end leftnav And search code -->
									<table cellpadding="0" cellspacing="0" border="0" width="100%">
									    <tr>
									         <td><br>

     <!-- -->
<!-- Below LeftNav Area START -->
<!-- Below LeftNav Area END -->
		
                                                  </td>
                                             </tr>
                                        </table>
                                   </td>
                                   <td width="100%"> 
								<table cellpadding="20" cellspacing="0" border="0" width="100%">
                                             <tr>
                                                  <td style="padding: 11px 20px 20px 20px;">
<!-- -->

                              <table cellpadding="0" cellspacing="0" border="0" width="100%">
		                         <tr>
		                    		<td><span id="donotprint" class="fontSize1" style="color: #0066cc;"><a href="/visualc/productinfo/default.asp" class="eyebrow" TARGET="_top">Visual C++ .NET Product Information</a>
			
			&nbsp;&gt;&nbsp;<a href="/visualc/productinfo/news/default.asp" class="eyebrow" TARGET="_top">News & Reviews</a>
			
			</span></td>
		                    	</tr>
		                    	<tr>
		                    		<td><span id="donotprint"><img src="/products/shared/images/ts.gif" width="1" height="5" alt=""></span></td>
		                     	</tr>
		                    	<tr>
		                    		<td><h1>Reviews for Visual C++ 6.0</h1></td>
		                    	</tr>
		                     	<tr>
		                     		<td><h2 class="Subtitle"></h2></td>
		                     	</tr>
		                     	<tr>
		                    		<td><img src="/products/shared/images/ts.gif" width="1" height="5" alt=""></td>
		                     	</tr>
		                     	<tr>
		                    		<td height="1" bgcolor="#cccccc" width="100%"><img src="/products/shared/images/ts.gif" width="1" height="1" alt=""></td>
		                    	</tr>
		                    	<tr>
		                    		<td>
		                    			<table cellpadding="0" cellspacing="0" border="0" width="100%">
		                    				<tr>
		                    					<td align="left">
		                    						<table cellpadding="0" cellspacing="0" border="0">
		                    							<tr>
		                    								
		                    								<td><img src="/products/shared/images/ts.gif" width="28" height="20" alt=""></td>
		                    							</tr>
		                    						</table>		
		                    					</td>							 
		                    					<td align="right" >
		                    						
		                    					</td>
		                    				</tr>
		                    			</table>
		                    		</td>						
		                    	</tr>
		                     	<tr>
		                    		<td height="1" bgcolor="#CCCCCC" width="100%"><img src="/products/shared/images/ts.gif" width="1" height="1" alt=""></td>
		                    	</tr>
		                    </table>
		                    <table cellspacing="0" cellpadding="0" border="0" width="100%">
		                    	<tr>
		                    		<td><img src="/products/shared/images/ts.gif" height="10" width="1" alt=""></td>
		                    	</tr>
		                    </table>
                                                       <table cellpadding="0" cellspacing="0" border="0" width="100%">
                                                            <tr>
                                                                 <td align="left" valign="top">		                    
	                                                             		                    	                                           
<!-- -->

<!-- Main Content Area START -->
<script language="JavaScript">
<!--
function Launch1()
	{
window.open('/visualc/art/newvc1_sm.gif','newvc','width=750,height=560,status=no');
	}

//-->
</script>

<p><i>The following article was originally published in the September 1998 printed issue of Visual C++ Developer Magazine.</i></p>

<h2>Introducing Visual C++ 6.0</h2>
<p><i>Mike Blaszczak</i></p>

<p>On July 1st, Microsoft released Visual C++ 6.0 to manufacturing. The product contains several innovative features aimed at improving developer productivity and streamlining the software design lifecycle. Further, the product continues to be the first to deliver high-performance access to new strategic systems features from Microsoft. Mike, who heads the MFC team, introduces you to the newest release.</p>

<p>What's new in Visual C++ 6.0? A lot. You'll see new IDE features, a faster compiler that produces faster code, a faster linker, MFC support for new SDK features (including new controls you might recognize from other Microsoft products,) new AppWizard options, easier ATL, and a brand new Test Container for your controls. </p>

<h3>New Features in the IDE</h3>
<p>Two of the most exciting features added to Visual C++ 6.0 are Edit and Continue and Automatic Statement Completion. While you won&#146;t see these features represented on any menus, their power and facility will undoubtedly help you spend more time actually writing code and less time working with your tools.</p>

<p>Most developers do their work in an iterative fashion. They edit, build, and debug over and over again until their code is just right. Of course, some developers spend longer on a given step than others, but the repetition of the process is inescapable. The Visual C++ IDE, by seamlessly incorporating tools to perform each of those three steps, goes a long way toward making the iterations less tedious than it would otherwise be.</p>

<p>But some parts of the process are still difficult. Debugging, for example, often requires you to run the application and then work with the application for some time in order to reproduce a bug. (Perhaps you need to open a specific file, fill out a sequence of dialogs, or in some other way follow many steps to get to the place where the bug occurs.) If you realize that one tiny change will significantly improve the undesirable behavior, you must stop the application, make the change, and completely rebuild the application. Worse yet, you then have to go through all the steps again to confirm that you have fixed the problem.</p>

<p>Visual C++ 6.0 includes Edit and Continue, which allows you to make changes to code while your application is stopped at a breakpoint in the debugger. If your build settings allow for edit and continue, the environment will automatically prompt you to allow a quick build to take place. In such a build, the system will build only the changed files and reload the code so that the execution state isn&#146;t destroyed but the new code is brought into memory, ready to execute. You don&#146;t have to do a full build, and you don&#146;t have to worry about getting the application ready to debug&#151;just do it!</p>

<p>While there are some situations where Edit and Continue can&#146;t reload code and allow it to continue executing (for example, if you make a change to a function which requires a destructor call), you&#146;ll find that it saves you an immense amount of time in your debugging sessions.</p>

<p>Visual C++ users are also treated to online fly-by help for structure and class members. This is the first half of a feature called Automatic Statement Completion: the editor will provide a list of members in a class just after you type enough code to indicate which class or structure you&#146;re going to use.  For example, imagine that you&#146;re typing this code: </p>

<pre><code>
	CString str;
	str.	// cursor here
</pre></code>

<p><a HREF="javascript:Launch1()">Click here to view Figure 1</a>
<br>
<i>Figure 1. Choose your member variable or function from a list presented as you type</i></p>

<p>Just as you type the dot operator, the editor will quickly provide a dropdown list box (see Figure 1) which allows you to choose any member of the CString class by selecting its name! If you don&#146;t want to pick a member, you can just keep typing - the list box doesn&#146;t intercept keystrokes.</p>

<p>The other half of Automatic Statement Completion is parameter help. As you paw through the list, the editor will examine the definition of the class or structure for appropriate comments and show you the comment as a brief description for the member you&#146;re about to select.</p>

<p>If you finished the above example by selecting the FindOneOf() member, for example, the editor would insert the function name and the open parenthesis into your source - and then show a tool tip window with the names of all the parameters in the function call. As you start typing, the tool tip will embolden the current parameter name so that you know which parameter you&#146;re about to enter. The tool tip supports function overloading by showing the appropriate overload based on the type you&#146;ve entered (if it&#146;s discernable), or by allowing you to scroll through the similar function overrides.</p>

<p>Automatic Statement Completion eases your reliance on the help subsystem by putting the information you most frequently need in front of you instead of forcing a trip to the online help. Best of all: it works for your own classes, as well as the types supplied in all the headers with the product! If you derive your own classes, or start from scratch, Automatic Statement Completion is there to help. </p>

<p>Automatic Statement Completion is a part of a wave of new features in Visual C++ all aimed at bringing Microsoft IntelliSense to the language tools. You're probably familiar with IntelliSense - it&#146;s the technology that helps you work with Microsoft Office applications by having them react to the work you&#146;re doing as you do it, without your worrying about the right command to invoke or button to press. The IntelliSense features in Visual C++ expand to several areas, including some existing features, like the fly-by DataTips that you&#146;re used to seeing in the debugger. The new features include TypeTips: the Visual C++ source editor will show you the type of a variable in a pop-up window if you park the cursor near the variable name.</p>

<p>The debugger also has some new features - perhaps the most pleasant is the Module List window. By using the Module... command in the Debug menu, you can pop up a dialog that looks like Figure 2. It enumerates the modules in the process you&#146;re debugging. The name of the module is shown, along with the logical address within your process. But best of all, the dialog also shows the full path name for the module you&#146;re viewing - which is a handy way to see what you&#146;ve loaded and where it came from!</p>

<p><img src="/visualc/art/newvc2.gif"><br>
<i>Figure 2. The module list shows all the modules you have loaded</i></p>

<h3>The Compiler</h3>
<p>The compiler shipped with Visual C++ 6.0 again continues to improve support for the ANSI conformance in the language implementation. The compiler now supports member templates, and has improved its overall template support significantly. Also, the compiler has tightened-up support for handling exceptions thrown during the allocation of an object - when a constructor for an object created with operator new throws an exception, an appropriate override of operator delete will be called.</p>

<p>The back-end of the compiler also features new optimizations that can improve code performance by five to twenty percent - with only a recompilation! The new optimizations are centered on better inlining. The compiler also provides a new keyword, __assume, which allows you to provide more information to the optimizer so it can make assumptions about how your code really works - and therefore generate a better translation. You can also use the new __forceinline keyword to make a function inline - always, no matter what the compiler might otherwise decide.</p>

<p>To support the theme of developer productivity, the compiler features a new command-line option: /GZ. This switch has the compiler generate more aggressive error checking at runtime. Such error checking will bring to light some bugs that were only readily evident in release-mode builds in debug builds, as well. For example, a bad cast of a function pointer using one calling convention to another calling convention always causes a runtime fault in a module built with /GZ, while modules built with /Od (normally used for debug builds) silently let the code work.</p>

<p>The use of the /GZ switch also causes local variables within a function to be initialized to a constant value - which can often make detecting the use of an uninitialized variable easier. /GZ isn&#146;t appropriate for release builds because it does emit less efficient code in order to afford the tests for problems. But the compiler detects most of the same problems in release builds anyway because the optimizer causes the compiler to do far more aggressive analysis of variables and their usage. For example, a release build detects an uninitialized variable by attempting to optimize its storage and accessibility characteristics - while a /GZ build notices an uninitialized variable at runtime because it&#146;s been flood-filled with a value that is guaranteed to point at memory not owned by the running process.</p> 

<p>While /GZ focuses on trapping runtime errors earlier, the compiler also has several new warnings. Finally, developer productivity is also aided by improvements in compiler throughput - you&#146;ll find that your builds may take as much as thirty percent less time to complete.</p>

<h3>The Linker</h3>
<p>Nobody says much about the linker, but some significant improvements in link time have been made. Specifically, the file format for import libraries has been enhanced so that they&#146;re now much smaller. The import library for the release build of MFC, for example, is now only about half as large as it was in Visual C++ 5.0! Since the linker doesn&#146;t do as much I/O, and doesn&#146;t have to do extra work to manage the file format, build speed has been improved.</p>

<p>The linker now also features the /DELAYLOAD option. This option tells the linker that the module being linked is dependent on a particular DLL, but that the DLL shouldn&#146;t be loaded and initialized until it is actually needed. You can specify the /DELAYLOAD option more than once--you might use the /DELAYLOAD option on all of the DLLs that your module references, for example, but doesn&#146;t use until the user explicitly asks for them. If you load COMMMGR.DLL, for example, but only reference the code in the library when the user makes a connection, specifying /DELAYLOAD for that library will defer the initialization of the library until the time your application actually crosses into the code. Delay Load Imports, when carefully applied to your application, can defer the growth of your application&#146;s working set and significantly improve its start-up time.</p>

<h3>New MFC Features</h3>
<p>MFC 6.0 is shipped in the Visual C++ 6.0 box. The most important feature MFC adds in this release is compatibility with the newest Internet SDK and Platform SDK releases from Microsoft, so your MFC applications are ensured continued compatibility with the technologies emerging in Microsoft&#146;s newest operating systems, platforms, and extensions.</p>

<p>Many of the improvements in MFC 6.0 are evident in the AppWizard. When you run the MFC AppWizard in Visual C++ 6.0, you&#146;ll almost immediately notice that a few new project types have been added. On the first step in creating an MDI or SDI application, you&#146;ll notice that you can create applications that use the MDI or SDI user interface style but don&#146;t provide document/view support! (See Figure 3.) By removing document/view support from your application in AppWizard, you can reduce the runtime size of your program and ease porting to MFC from SDK-based applications. </p>

<p><img src="/visualc/art/newvc3.gif"><br>
<i>Figure 3. Document/view support is now optional</i></p>

<p>Later in the AppWizard, you&#146;ll note that there&#146;s an option to create an Active Document Container application. (See Figure 4.) This support complements code added to the previous version of MFC to allow creation of Active Document Servers. An Active Document Container can hold an instance of other servers, such as the Office applications, Microsoft Internet Explorer, or third party tools like Adobe Acrobat, right within your application. The seamless containment afforded by the Active Document specification gives your applications the ability to contain servers with content that spans more than one page instead of occupying only a rectangle within a larger document space.</p>

<p><img src="/visualc/art/newvc4.gif"><br>
<i>Figure 4. Your applications can contain Active Documents</i></p>

<p>MFC has been modified to support all of the newest common controls available in the system. The new controls include the IP Address control, which allows your users to enter dotted-quad IP Addresses (of the form 207.46.130.14) without performing any subclassing or validation. Support for ComboBoxEx-style controls have been added, allowing your application to provide a control with the user interface of a combo box but the advanced owner-draw painting normally only found in a list view control. The CDateTimeCtrl class provides a control similar to an edit box that displays or accepts date/time information. The control can optionally be linked to a CMonthCalCtrl, which provides a pop-up window showing dates organized like the pages of a calendar. The user can see, at a glance, the state of individual days on the control, or can use the control to select a particular date with a single click. The date-time controls feature new DDX_, DDV_, and RFX_ functions that allow your applications to use the controls in your DoDataExchange() implementation. ClassWizard knows about these new functions and data types, and is capable of adding data exchange code for the new controls automatically for you. Of course, the resource editor has also been enhanced so that you can place these controls on a dialog box whether you&#146;re using MFC or not. (See Figure 5.)</p>

<p><img src="/visualc/art/newvc5.gif"><br>
<i>Figure 5. A number of new controls, with full MFC support, have been added</i></p>

<p>Several of the existing common control classes have been enhanced to support new features found in updated versions of the COMCTL32.DLL library, upgraded by installing Windows 98 or Internet Explorer 4.0 or later. The tree view control, list view control, slider control, and status bar control are all upgraded to support new styles, modes, and display features. The controls all feature hover highlighting, for example, as well as support for background bitmaps that can give the control a special texture or more artistic look-and-feel. All of the new capabilities you&#146;ve read about in the magazines are finally supported by MFC itself!</p>

<p>To support HTML and Dynamic HTML, MFC has added the CHtmlView view type. This view allows your application to very easily host HTML - and work both on- and off-line with HTML-based content.</p>

<p>MFC&#146;s new features also extend to several gentle enhancements to even the most basic classes. Frequently requested find and replace functions have been added to CString, and new conversion calls have been added to the date and time classes, for example.</p> 

<p>Developers who more adeptly use MFC know that the framework is useful for some console applications as well as classic GUI applications. To make initiating such projects easier, the AppWizard now features a Console Application wizard that supports both MFC and non-MFC applications.</p>

<p>Overall, MFC&#146;s undergone some substantial tuning to help reduce the size of the DLL and lower the amount of MFC code linked to your application if you choose to use the static libraries. Despite all of the new features the team has added, the DLL  occupies under one megabyte. Simple console applications which statically link to MFC to use CString can shrink more than 35 percent while a release-mode build of WordPad will be more than five percent smaller than it was in Visual C++ 5.0!</p>

<h3>New Active Template Library (ATL) Features</h3>
<p>ATL version 3.0, provided in the Visual C++ 6.0 box, benefits from an impressive amount of growth that vastly expands the breadth of the library. While the library is still largely aimed at the development of COM objects, the number of object types readily supported by ATL have been impressively bolstered. Further, many issues surrounding the use of ATL within an MFC project have been resolved - making it easy to add efficient COM support to your existing applications. The link errors and obscure warnings when using the collection classes are now a thing of the past!</p>

<p>ATL also now features the ATL Composite Control, which can be used to create an ActiveX control that is based on other controls - even if the contained controls are ActiveX controls! The Composite Control relieves the developer interested in producing an integrated control from worrying about input focus issues, tabbing problems, and handling the esoteric details of keystroke processing while providing a framework for the development of impressive and rich controls. You can add the Composite Control to your existing application by using the ATL Object Wizard. The Wizard provides several customization features - including optional support for standard ambient properties for the contained controls. The resulting dialog resource is used to draw the contents of the composite control. Creating the composite control object instantiates the dialog and all of its contents as an ActiveX control. </p>

<p>The ATL Object Wizard now features support for generating the registration code appropriate for the object's participation in Microsoft Transaction Server packages. Once registered as part of an MTS package, the object will work on the server within the same process boundary, and can participate in trusted relationships with different objects in the same package.</p>

<p>Microsoft&#146;s OLE DB initiative brings a common database API to all languages. While OLE DB is highly performant and very flexible, it&#146;s not so easy to utilize. ATL now supports the generation of OLE DB consumers, which attach to OLE-DB data sources to query and enumerate data. Further, ATL also supports the creation of OLE DB providers, which allow for the creation of such data sources. Such a project can allow you to collect data to from disparate sources to be exposed as one single source, or publish data in a standard format to any tool that can consume OLE DB data. ATL&#146;s support for OLE DB exposes the technology in a very convenient and approachable way while inducing nearly no performance degradation.</p>

<p>The Microsoft Management Console support allows you to produce a snap-in that can be contained by the Microsoft Management Console. When hosted in the Management Console, your component can be used by anyone to manage a running service, a custom application, or a system component.

<p>In the very near future, both the Microsoft Management Console and OLE DB will play pivotal roles in the development of system-level components. You&#146;ve probably already noticed the user interface face lift in the newest versions of administrators&#146; tools for Microsoft Internet Information Server and SQL Server: these tools use the Microsoft Management Console technology. Similarly, OLE DB is at the heart of Microsoft&#146;s Active Directory Services technology, available in the Windows NT Option Pack. These initiatives are only the tip of the iceberg! </p>

<p>Along the lines of server-side programming, the new Cluster Resource Type Wizard allows you to implement a Microsoft Cluster Server (MSCS) resource type, which allows your applications to be closely managed and monitored by MSCS. The project produced by the Wizard gives you a COM object that acts as an in-process server that provides a UI to manage the new resources - that object actually talks to the managing component, which is normally a Microsoft Management Console application. The project also includes a DLL to be loaded by the MSCS resource monitor on the cluster node where the application is run. It&#146;s that DLL that actually performs the monitoring functions.</p>

<p>Like MFC 6.0, ATL 3.0 has the capability to contain HTML-based user interface elements by using the Object Wizard to add the HTML control to your existing project. The ATL wizards have also been enhanced to make setting up connection points much easier, and by providing options to make adding message and event handlers a trivial effort.</p>

<p>The ATL Object Wizard has been further expanded to support &quot;Lite&quot; versions of normal OLE Controls, the Composite Control, and the HTML control. The lite versions of the controls supply only the interfaces necessary to get the control hosted in Internet Explorer - while that hurts the flexibility of the control, for web-based development it can make the already tiny ATL control implementations even smaller!</p>

<h3>Other Tools</h3>
<p>Perhaps one of the less-pronounced but absolutely shining improvements in the product involves one of the most under-designed and over-utilized tools that Microsoft has ever produced: The ActiveX Control Test Container. The container has been completely rewritten, but before I describe it&#146;s new features let me say this: complete source code is now included!</p>

<p>The new Test Container really is a complete rewrite, and that rewrite cleaned up lots of problems and offered support for lots of nifty features. First, the user interface  (See Figure 6) is coherent, sane, and convenient. There are no sharp edges to snag and tear your testing efforts. Then, there&#146;s the brilliant support for serialization - you can watch your control serialize to or from any target, step by step. Painting tests within the control have also been made more robust - you can explicitly select the way your control will be required to paint, and you can have the container force the control to render itself very slowly in order to watch the blow-by-blow action.</p>

<p><img src="/visualc/art/newvc6_sm.gif"><br>
<i>Figure 6. The Test Container has an all-new interface.</i></p>

<p>Last, but not least, Test Container now is an Active Script container! Something of a development environment within a development environment, you can really use the tool to put together automated tests by writing script code to drive the automation interfaces exposed by your control. When you get the new product, don&#146;t let your boss catch you playing the &quot;follow-me&quot; game included as a sample script.</p>

<p>If you&#146;re a database developer, you&#146;ll notice a new Extended Stored Procedure Wizard that helps you write XSP dynamic-link libraries for SQL Server. If you&#146;re not using SQL Server, you&#146;ll find that the improved support for Oracle database tools throughout the product relieves some of your frustration.</p>

<h3>Introducing Visual C++ 6.0</h3>
<p>Visual C++ 6.0 represents hundreds of person-years of work, and I think the improvements are very obvious. Upgrading to Visual C++ will reward you with a more complete and comprehensive development environment with the most innovative developer productivity features Microsoft offers. Best of all, it will position you and your staff to support the newest operating system features that Microsoft has made available.</p>

<p><i>Mike Blaszczak is a development lead for the MFC team and sets the technical direction of the libraries while still participating in their implementation. Mike, a Microsoft employee for more than six years, enjoys long-distance motorcycling, ice hockey, and writing. He has written for several magazines, and the third edition of his book about Windows programming with MFC was published in 1997 by WROX Press. mikeblas@nwlink.com</i></p>


<!-- Main Content Area END -->


													</td>
                                                            </tr>
                                                            <tr>
                                                                 <td>				
				<br>
				<table cellpadding="0" cellspacing="0" border="0" width="100%" id="donotprint">
					<tr valign="bottom">
						<td align="left"><a href="#top"><img src="/products/shared/images/top_v1.gif" width="40" height="20" alt="To top of page" border="0" /></a></td>
						<td align="right">	
										
						</td>
					</tr>
				</table>
                                                                 </td>
                                                            </tr>  
                                                       </table>					
<!-- -->

										</td>
                                             </tr>
                                        </table>
     
                                   </td> 
                              </tr>
                         </table>
                    </td>
               </tr>
               <tr valign="top">
                    <td>
                         <table border="0" cellpadding="0" cellspacing="0" width="100%">
                              <tr>
                                   <td width="100%">
                                        <span id="donotprint">
	<span id="pgFooter">

		<table cellpadding="0" cellspacing="0" width="100%" height="20" border="0" class="FooterBranding">
			<tr>
				<td align="left">
					<table cellpadding="0" cellspacing="0" border="0" height="100%">
						<tr class="MNPFooterRow1">
							<td width="10">&nbsp;&nbsp;</td>

							<td nowrap><a href="/isapi/goregwiz.asp?target=/contactus30/contactus.asp?domain=devtools/vc" target="_top">Contact Us</a></td>
							<td width="10">&nbsp;&nbsp;</td>

						<script language="javascript"  type="text/javascript">
							var sItemURL = "mailto:?subject=A link from Microsoft&body=This link is from the Visual C++ Web site" + " "  + top.parent.location.href
							document.write('<td nowrap><a href="' + sItemURL + '"  target=>E-Mail This Page</a></td>')
							document.write ('<td>&nbsp;&nbsp;</td>')
						</script>
	
						</tr>
					</table>
				</td>
			</tr>
		</table>

		<table cellpadding="0" cellspacing="0" width="100%" height="30" border="0" class="FooterBranding">
			<tr>
				<td align="left">
					<table cellpadding="0" cellspacing="0" border="0" height="100%">
						<tr class="MNPFooterRow2">
							<td width="10">&nbsp;&nbsp;</td>

							<td nowrap><a href="http://www.microsoft.com/info/cpyright.htm" target="_top">© 2002 Microsoft Corporation. All rights reserved.  Terms of Use.</a></td>
							<td width="10">&nbsp;&nbsp;</td>

							<td nowrap><a href="http://www.microsoft.com/info/privacy.htm" target="_top">Privacy Statement</a></td>
							<td width="10">&nbsp;&nbsp;</td>

							<td nowrap><a href="http://www.microsoft.com/enable/" target="_top">Accessibility</a></td>
							<td width="10">&nbsp;&nbsp;</td>

						</tr>
					</table>
				</td>
			</tr>
		</table>

	</span>
</span>
                                   </td>
                              </tr>
                         </table>
                    </td>
               </tr>
          </table>     
     

</body>
</html>

