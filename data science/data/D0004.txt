ID=D0004
URL=http://www.devicetop.com/site/tutorial/detail?ID=78
SIZE=76646
DATE=16/07/02
TIME=14:34:37
DATASET=Java
HTML= 





 <!-- Begin master_head -->

<html>
  <head>
    <title>Devicetop.com - Tutorials</title>
    <link rel="STYLESHEET" type="text/css" href="/DT/css/devicetop_styles.css">
   <script language=JavaScript>

    function openWin(URL,winName,width,height){
     var popWin = window.open(URL,winName,"location=no,status=no,scrollbars=yes,resizable=yes,height="+height+",width="+width);
     popWin.focus();
    }

   </script>
  </head>
  <body bgcolor="#FFFFFF" leftmargin="0" topmargin="0" marginwidth="0" marginheight="0">

<!-- End master_head -->
 <!-- Begin master_topbar -->
<table width="100%" border="0" cellspacing="0" cellpadding="0">
  <tr>
    <td bgcolor="#E8E8E8">
      <table width="400" border="0" cellspacing="0" cellpadding="0" align="center">
        <tr>
         <form name=login action='/site/gw' method=post>
          <input type="hidden" name="redirect" value="main">
          <td><img src="/dt/images/spacer.gif" width="10" height="1">login
            <input type="text" name="login" size="8" style=width:50px>
             password
            <input type="password" name="password" size="8" style=width:50px>
            <input type="image" name="LOGIN" src="/DT/images/icons/action.gif" width="16" height="16" border="0">
            <img src="/dt/images/spacer.gif" width="10" height="1">
            logout&nbsp;<a href=/site/gw?logout><img type="image" name="log_out" src="/DT/images/icons/log_out.gif" width="16" height="16" border="0" align="absmiddle"></a>&nbsp;
         </td>
          </form>
        </tr>
      </table>
    </td>
  </tr>
  <tr>
    <td bgcolor="#E8E8E8" background="/dt/images/template/topbar_bevel.gif"><img src="/dt/images/spacer.gif" width="1" height="3"></td>
  </tr>
</table>





<!-- End master_topbar --> <!-- Begin master_banner -->
<table width="772" border="0" cellspacing="0" cellpadding="0" align="center" name="template_logo">
  <tr> 
    <td><img src="/DT/images/spacer.gif" width="1" height="8"></td>
    <td><img src="/DT/images/spacer.gif" width="1" height="8"></td>
  </tr>
  <tr> 
    <td><img src="/DT/images/template/logo.gif" width="304" height="60"></td>
    <td width="468">
<a href='http://www.devicetop.com/ads/adclick.php'><img src='http://www.devicetop.com/ads/adview.php?what=zone:1' border='0'></a>
<!--<a href=http://www.javadevices.org/dtcourse/><img border=0 src='/DT/images/banners/1'></a>-->
</td>
  </tr>
</table>


<!-- End master_banner --> <!-- Begin master_main_navigation -->


<table width="772" border="0" cellspacing="0" cellpadding="0" align="center">
  <tr> 
    <td><img src="/DT/images/spacer.gif" width="8" height="1"></td>
    <td><img src="/DT/images/spacer.gif" width="176" height="1"></td>
    <td></td>
    <td><img src="/DT/images/spacer.gif" width="123" height="1"></td>
    <td><img src="/DT/images/spacer.gif" width="8" height="1"></td>
    <td><img src="/DT/images/spacer.gif" width="8" height="1"></td>
    <td><img src="/DT/images/spacer.gif" width="45" height="8"></td>
  </tr>
  <tr> 
    <td colspan="2" background="/DT/images/template/topnav_topright_back.gif"><img src='/DT/images/template/title_resources.gif' border=0></td>
    <td nowrap background="/DT/images/template/topnav_topright_back.gif" width="404" align="center"><a href="/site/main"><img src="/DT/images/template/topnav_home.gif" width="27" height="23" border="0"></a><a href="/site/um?LEFT=user_wrap_left&RIGHT=user_wrap_right"><img src="/DT/images/template/topnav_user.gif" width="30" height="23" border="0"></a><a href="/site/forum"><img src="/DT/images/template/topnav_forums.gif" width="43" height="23" border="0"></a><a href="/site/newswire/overview"><img src="/DT/images/template/topnav_newswire.gif" width="54" height="23" border="0"></a><a href="/site/news/overview"><img src="/DT/images/template/topnav_editorial.gif" width="53" height="23" border="0"></a><a href="/site/page/static?sect=contest&CNTR=contests_wrap_center&LEFT=contests_wrap_left&RIGHT=contests_wrap_right"><img src="/DT/images/template/topnav_contests.gif" width="54" height="23" border="0"></a><!--<a href="/site/"><img src="/DT/images/template/topnav_resources.gif" width="60" height="23" border="0"></a>--><a href="/site/page/static?sect=tools&CNTR=dev_wrap_center&LEFT=dev_wrap_left&RIGHT=dev_wrap_right"><img src="/DT/images/template/topnav_tools.gif" width="55" height="23" border="0"></a><a href="/site/contrib/lookup"><img src="/DT/images/template/topnav_apps.gif" width="28" height="23" border="0"></a></td>
    <td background="/DT/images/template/topnav_topright_back.gif" align="right" class="title_small" height="23"> <a class=body href=/site/um/join ><font color="#FFFFFF"><b>join devicetop!</b></font></a></td>
    <td><img src="/DT/images/template/topnav_top_right.gif" width="8" height="23"></td>
    <td><img src="/DT/images/spacer.gif" width="8" height="1"></td>
    <td rowspan="2" height="46" width="45"><img src='/dt/mycons/anon.gif' height=45 width=45 border=0></td>
  </tr>
  <tr> 
    <td><img src="/DT/images/template/topnav_bottom_left.gif" width="8" height="23"></td>
    <td colspan="2" background="/DT/images/template/topnav_bottom_middle.gif" class="body"> <a href='/site/main'>home</a> >  <a href='/site/tutorial/overview'>tutorials</a> >  <a href='/site/tutorial/overview?TYPE=72'>java device programming</a> >  <a href='/site/tutorial/detail?id=78'>device programming w...</a>  </td>
    <td background="/DT/images/template/topnav_bottomright_back.gif" align="right" class="body">0 pts</td>
    <td><img src="/DT/images/template/topnav_bottom_right.gif" width="8" height="23"></td>
    <td></td>
  </tr>
  <tr> 
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td><img src="/DT/images/spacer.gif" width="45" height="8"></td>
  </tr>
</table>

<!-- End master_main_navigation -->

<!-- Begin tutorial_master_v -->
<center>

<table width="772" border="0" cellspacing="0" cellpadding="0" align="center" name="template_body">
  <tr> 
    <td valign="top" width="176"> 

      <!-- Begin win_utility_small_1_v -->
<table width="176" border="0" cellspacing="0" cellpadding="0">
  <tr> 
    <td width="8"><img src="/DT/images/windows/util_left.gif" width="8" height="22"></td>
    <td background="/DT/images/windows/util_back.gif" width="168" class="title">Tutorial Categories</td>
  </tr>
  <tr> 
    <td colspan="2"><img src="/DT/images/spacer.gif" width="176" height="2"></td>
  </tr>
  <tr> 
    <td colspan="2" bgcolor="fbfbfb"> 
      <table width="176" border="0" cellspacing="0" cellpadding="0">
        <tr> 
          <td width="6"><img src="/DT/images/spacer.gif" width="8" height="6"></td>
          <td><img src="/DT/images/spacer.gif" width="110" height="1"></td>
          <td><img src="/DT/images/spacer.gif" width="50" height="1"></td>
          <td width="6"><img src="/DT/images/spacer.gif" width="8" height="1"></td>
        </tr>

	         <tr> 
          <td></td>
     	  	   <td class="body" colspan="2">
             <a href="/site/tutorial/overview?TYPE=77" class="linkbody">All</a>
           </td>
          <td> </td>
         </tr>
	         <tr> 
          <td></td>
     	  	   <td class="body" colspan="2">
             <a href="/site/tutorial/overview?TYPE=69" class="linkbody">Espial Development Tools</a>
           </td>
          <td> </td>
         </tr>
	         <tr> 
          <td></td>
     	  	   <td class="body" colspan="2">
             <a href="/site/tutorial/overview?TYPE=70" class="linkbody">Espial DeviceTop</a>
           </td>
          <td> </td>
         </tr>
	         <tr> 
          <td></td>
     	  	   <td class="body" colspan="2">
             <a href="/site/tutorial/overview?TYPE=71" class="linkbody">Espial Escape</a>
           </td>
          <td> </td>
         </tr>
	         <tr> 
          <td></td>
     	  	   <td class="body" colspan="2">
             <a href="/site/tutorial/overview?TYPE=74" class="linkbody">Game Programming</a>
           </td>
          <td> </td>
         </tr>
	         <tr> 
          <td></td>
     	  	   <td class="body" colspan="2">
             <a href="/site/tutorial/overview?TYPE=73" class="linkbody">General Java</a>
           </td>
          <td> </td>
         </tr>
	         <tr> 
          <td></td>
     	  	   <td class="body" colspan="2">
             <a href="/site/tutorial/overview?TYPE=75" class="linkbody">Handheld Programming</a>
           </td>
          <td> </td>
         </tr>
	         <tr> 
          <td></td>
     	  	   <td class="body" colspan="2">
             <a href="/site/tutorial/overview?TYPE=76" class="linkbody">Interactive Digital TV Programming</a>
           </td>
          <td> </td>
         </tr>
	         <tr> 
          <td></td>
     	  	   <td class="body" colspan="2">
             <a href="/site/tutorial/overview?TYPE=72" class="linkbody">Java Device Programming</a>
           </td>
          <td> </td>
         </tr>
	
      </table>
     </td>
  </tr>
</table>

<br>
<!-- End win_utility_small_1_v -->

    </td>
    <td width="8"><img src="/DT/images/spacer.gif" width="8" height="1"></td>
    <td width="596" valign="top"> 

      <!-- Begin tutorial_detail_v -->

<table width="596" border="0" cellspacing="0" cellpadding="0">

  <tr> 
    <td width="8"><img src="/DT/images/windows/util_left.gif" width="8" height="22"></td>
    <td background="/DT/images/windows/util_big_back.gif" width="288" class="title">&nbsp</td>
    <td background="/DT/images/windows/util_big_back.gif" width="100" class="title" align="right"><a href="/site/tutorial/overview?PAGE=1"><img src="/DT/images/icons/nc_up.gif" border="0"></a></td>
    <td width="8"><img src="/DT/images/windows/util_right_small.gif" width="8" height="22"> </td>
  </tr>
  <tr> 
    <td width="8"><img src="/DT/images/spacer.gif" width="8" height="8"></td>
    <td width="288"><img src="/DT/images/spacer.gif" width="288" height="8"></td>
    <td width="100"><img src="/DT/images/spacer.gif" width="100" height="8"></td>
    <td width="8"><img src="/DT/images/spacer.gif" width="8" height="8"></td>
  </tr>


  <tr> 
    <td width="8"> </td>
    <td class="title" width="388" colspan="2"><font color="#666666">Device programming with MIDP, Part 2</font></td>
    <td width="8"><img src="/DT/images/spacer.gif" width="8" height="4"></td>
  </tr>
  <tr> 
    <td width="8"><img src="/DT/images/spacer.gif" width="8" height="8"></td>
    <td width="288"><img src="/DT/images/spacer.gif" width="288" height="8"></td>
    <td width="100"><img src="/DT/images/spacer.gif" width="100" height="8"></td>
    <td width="8"><img src="/DT/images/spacer.gif" width="8" height="8"></td>
  </tr>
  <tr> 
    <td width="8">&nbsp;</td>
    <td class="body" width="388" colspan="2"><font color="#666666"><font color="#FF9C00">28-03-01</font></font></td>
    <td width="8"><img src="/DT/images/spacer.gif" width="8" height="4"></td>
  </tr>

  <tr> 
    <td width="8"><img src="/DT/images/spacer.gif" width="8" height="2"></td>
    <td width="313"><img src="/DT/images/spacer.gif" width="288" height="2"></td>
    <td width="8"><img src="/DT/images/spacer.gif" width="100" height="2"></td>
    <td width="8"><img src="/DT/images/spacer.gif" width="8" height="2"></td>
  </tr>
  <tr> 
    <td width="8">&nbsp;</td>
    <td class="body" width="580" colspan="2">

       <table width="100%">
          <tr>
             <td width="8"> </td>
             <td align="left" valign="top" class="body">This second part of Michael Cymerman's MIDP series will focus on the development 
  of an application using non-graphical user interface components. In addition, 
  he'll explore the conversion and storage of application data to the MIDlet RecordStore. 
  These two concepts are discussed in detail through a simple Stock Portfolio 
  management application constructed specifically for this demonstration. </td>
          </tr>
  <tr> 
    <td width="8"><img src="/DT/images/spacer.gif" width="8" height="8"></td>
    <td class="body" width="580"><img src="/DT/images/spacer.gif" width="8" height="8"></td>
  </tr>
          <tr>
             <td width="8"></td>
             <td align="left" valign="top" class="body"><a class=linkColor href="http://www.devicetop.com/dt/editorial?openArticle=1:56">Part 
  1</a> of this series was focused on the deployment of the J2MEWTK environment 
  and a rudimentary exploration of the MIDP APIs. This part of the series will 
  focus on the development of an application using the pre-canned user interface 
  components provided in the MIDP API. In addition, I'll explore the conversion 
  and storage of application data to the MIDlet <code>RecordStore</code>. These 
  two concepts will be discussed in detail through a simple Stock Portfolio management 
  application constructed specifically for this article. 
<p> <!-- Right-aligned text box --> 
<table bgcolor="#990033" hspace="5" width="50%" align="RIGHT" cellpadding="2" cellspacing="0" border="0">
  <tr> 
    <th> <font color="#FFFFFF" face="Arial,Helvetica,Sans-serif"> &nbsp;Device 
      programming with MIDP: Read the whole series! &nbsp; </font> </th>
  </tr>
  <tr> 
    <td> 
      <table width="100%" bgcolor="#cccccc" cellpadding="5" cellspacing="0" border="0">
        <tr> 
          <td> <font size="-1" face="Arial,Helvetica,Sans-serif"> 
            <li><a class=linkColor href="http://javaworld.com/javaworld/jw-01-2001/jw-0105-midp.html">Part 
              1. Build devices with MIDP APIs and J2ME across multiple wireless 
              platforms. </a></li>
            <li><a class=linkColor href="http://javaworld.com/javaworld/jw-03-2001/jw-0309-midp2.html">Part 
              2. Use these user-interface and data-store components to create 
              MIDP-based applications.</a></li>
            </font> </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<!-- End text box --> 
<p> <font size="+1"><strong>The hierarchy of Displayable objects</strong></font><br>
  In the examples found in Part 1, I discussed the two major categories of <code>Displayable</code>s: 
  <code>Canvas</code> and <code>Screen</code>. 
<p> <code>Canvas</code> is a type of <code>Displayable</code> in which the developer 
  accepts responsibility for creating the entire user interface. This is an extremely 
  useful interface for creating complex graphical interfaces, such as those used 
  in video games. If you choose this path, the UI is drawn on a <code>Canvas</code> 
  object similar to the AWT Canvas used in applets. 
<p> <code>Screen</code> is a type of <code>Displayable</code> in which you use 
  predefined components to assemble a user interface. The components are similar 
  to those AWT components used in constructing applets, such as <code>Label</code> 
  and <code>TextField</code>. If you choose this path, you will need to add components 
  to a subclass of the abstract <code>Screen</code> object when necessary to construct 
  your user interface. 
<p> I will focus on the <code>Screen</code> type of <code>Displayable</code> object 
  in this part of the series, since the <code>Canvas</code> object was sufficiently 
  discussed Part 1. As I mentioned above, the <code>Screen</code> object is an 
  abstract class of <code>Displayable</code>. The subclasses of the <code>Screen</code> 
  class are <code>Alert</code>, <code>Form</code>, <code>List</code>, and <code>TextBox</code>. 
<p> In this article, I will examine the mechanics of these <code>Displayable</code> 
  objects, including the construction, interaction, and event-handling schemes 
  that enable them to come together to form an application. 
<p> <font size="+1"><strong>Detailed example</strong></font><br>
  The best way to learn how to use some of these screens is through an example. 
  The example used here contains some workflow that demonstrates the following 
  concepts: 
<p> 
<ul>
  <li>Construction with different screen types</li>
  <li>Construction with different screen components</li>
  <li>Usage of commands from within the <code>javax.microedition.lcdui</code> 
    classes</li>
  <li>An implementation of MVC for efficient screen manipulation</li>
  <li>Interaction with the <code>javax.microedition.rms</code> data store on the 
    device</li>
</ul>
<p> To provide this information, I will use a simple rendition of a brokerage 
  application. In this application, the user can buy a stock or sell a stock that 
  he or she currently owns. Please understand that this process has been highly 
  simplified in order to demonstrate key concepts. 
<p> In Part 3 of this series, I will expand this application to connect with a 
  ticker service to retrieve accurate pricing for the purchase-using HTTP. 
<p> <strong>ExampleMidlet</strong><br>
  The <code>ExampleMidlet</code> provides the context for this application. It 
  controls the flow and provides access to the device resources as defined in 
  the MIDP specification. 
<p> <code> public class ExampleMidlet extends MIDlet implements Controller<br>
  </code> 
<p> As shown, the <code>ExampleMidlet</code> implements the <code>Controller</code> 
  interface to manage the screen interactions. The intent of the <code>Controller</code> 
  interface is to provide the services needed by both the view and model classes. 
<p> <strong>Controller interface</strong><br>
  The <code>Controller</code> interface contains methods to access the <em><code>StockDatabase</code></em>, 
  which is a simple RMS data store, and to manipulate the <code>Display</code> 
  object associated with the MIDlet. The <code>Controller</code> interface in 
  this example is a simple interface that you can expand to include methods to 
  retrieve properties, make HTTP connections, or whatever your application requirements 
  deem necessary. 
<p> 
<pre>
<code> public interface Controller
  {
  public StockDatabase getStockDatabase();
  public Displayable currentScreen();
  public void nextScreen(Displayable display);
  public void lastScreen();
  }</code></pre>
<p> By implementing the <code>Controller</code> interface, the <code>ExampleMidlet</code> 
  can expose certain methods to the individual screens. You could instead pass 
  the MIDlet as a parameter to the screens, but you probably don't want to interfere 
  with the normal MIDlet lifecycle. 
<p> Within the <code>ExampleMidlet</code>, the <code>nextScreen()</code> and <code>lastScreen()</code> 
  methods have been used to maintain the information about the currently visible 
  screen. These methods use the <code>java.util.Stack</code> object to maintain 
  the display state. 
<p> The application will push the currently displayed <code>Displayable</code> 
  object to the <code>Stack</code> prior to displaying the next screen when <code>nextScreen</code> 
  is called. 
<p> 
<pre> 
public void nextScreen(Displayable display){
  Displayable currentScreen = this.getDisplay().getCurrent();
  
  if ( currentScreen != null)
    _screenStack.push( currentScreen );
  
  getDisplay().setCurrent( display);
}
  </pre>
<p> The application will pop the previously displayed <code>Displayable</code> 
  object from the <code>Stack</code> and set the display to show that screen. 
<p> 
<pre>
public void lastScreen()
{
  Displayable display = null;
  
  if ( !_screenStack.empty() )
    display = (Displayable) _screenStack.pop();
  else
    display = new WelcomeScreen( (Controller) this );
  
  getDisplay().setCurrent( display);
}
  </pre>
<p> There are other ways in which you could handle the management of the screens. 
  For example, you could read in a screen from the properties file and use that 
  list to manage the interactions between the display screens. This approach provides 
  the necessary management for this example without suffering through a more complex 
  approach. 
<p> <font size="+1"><strong>WelcomeScreen</strong></font><br>
  The first screen that is visible to the user is the <em><code>WelcomeScreen</code></em>. 
  Let's walk through the code for this screen. The <code>WelcomeScreen</code> 
  extends from the <code>javax.microedition.lcdui.List</code> object and implements 
  the <code>CommandListener</code> interface. 
<p> <code> public class WelcomeScreen extends List implements CommandListener<br>
  </code> 
<p> The constructor is passed a parameter that contains a reference to the <code>Controller</code> 
  as an argument, which will be stored as a private variable for future use. 
<p> <code> public WelcomeScreen(Controller controller)<br>
  </code> 
<p> Because the <code>WelcomeScreen</code> extends the <code>List</code> object, 
  the superclass must be called for instantiation. The parameters passed are the 
  title of the screen and the type of list. 
<p> <code> super("Welcome", List.IMPLICIT);<br>
  </code> 
<p> <strong>List</strong><br>
  In this case, the list is of type <code>IMPLICIT</code>. The list types that 
  you can use are shown in Table 1. 
<p> <!--[PROD: PLEASE ADD TABLE HEAD: Table 1. List types defined]--> 
<table width="85%" align="center" border="0" cellpadding="2" cellspacing="2" bgcolor="#ccffff" color="#ffffff">
  <caption align="bottom"><strong><font size="-1">Table 1. List types defined</font></strong></caption>
  <tr align="left" valign="top"> 
    <th> List Type</th>
    <th>Definition</th>
  </tr>
  <tr align="left" valign="top" bgcolor="#ccffcc"> 
    <td><strong><code>IMPLICIT</code></strong></td>
    <td>Neither checkboxes nor radio buttons are visible next to each item in 
      a list. Users can select only one item from the list. Similar to an HTML 
      Option list.</td>
  </tr>
  <tr align="left" valign="top"> 
    <td><strong><code>EXPLICIT</code></strong></td>
    <td>Radio buttons allow users to select only one item from the list.</td>
  </tr>
  <tr align="left" valign="top" bgcolor="#ccffcc"> 
    <td> <strong><code>MULTIPLE</code></strong></td>
    <td>Checkboxes allow users to select multiple items from the list.</td>
  </tr>
</table>
<p> <strong>Ticker</strong><br>
  The <code>WelcomeScreen</code> also contains a <code>ticker</code> that generates 
  a simple welcome message to the user. To create a <code>ticker</code>, call 
  its constructor with a <code>String</code> object of the message to be scrolled 
  and then call the <code>setTicker()</code> method of the <code>Screen</code> 
  object to add the ticker to the heading. 
<p> <code> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ticker ticker = <br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new 
  Ticker("Thank you for viewing the Stock Application Example");<br>
  <br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.setTicker( ticker);<br>
  <br>
  </code> 
<p> Using the <code>append()</code> method, you can add each item to the list 
  for display. 
<p> <code> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;append("Buy Stock", 
  null);<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;append("Sell Stock", null);</code> 
<p><code><br>
  </code> 
<p> The <code>WelcomeScreen</code> will listen and handle any commands that are 
  initiated when it is displayed. Therefore, it calls the <code>setCommandListener()</code> 
  method with itself as a parameter. 
<p> <code> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.setCommandListener(this);<br>
  </code> 
<p> <strong>CommandListener</strong><br>
  The event-handling infrastructure in the MIDlet architecture, briefly discussed 
  in the <code>WelcomeScreen</code> example, lets you handle events generated 
  from the MIDlet <code>Screen</code> objects. 
<p> Events are generated on user actions, such as clicking the soft-key menu buttons 
  on a <code>Sreen</code> or selecting items from a <code>List</code>. When these 
  events are generated, the <code>commandAction()</code> method of the objects 
  that have registered interest in the current screen will be executed. 
<p> For the <code>WelcomeScreen</code> example, the user is presented with a list 
  containing two items: "Buy Stock" and "Select Stock." When the user selects 
  one of the items by using the up/down arrows and then clicking the action button, 
  the <code>commandAction()</code> method will be called. 
<p> 
<code> &nbsp;&nbsp;&nbsp;&nbsp; 
<pre>
public void commandAction (Command c, Displayable d)
{
  if ( c == List.SELECT_COMMAND)
  {
    List shown = (List) _controller.currentScreen();
    
    switch 
      (shown.getSelectedIndex())
    {
    case 0:
      _controller.nextScreen( 
        new BuyStockScreen( _controller) );
      break;
    case 1:
    default:
      _controller.nextScreen( 
        new SelectStockScreen(_controller) );
    }
  }
}
</pre>
<br>
</code> 
<p> This <code>commandAction()</code> method demonstrates how to capture the events 
  generated by an <code>IMPLICIT</code> list. The first step involves retrieving 
  the list from the display, which in this example is done through the <code>Controller</code> 
  interface. The selected item can be retrieved from the list to allow the application 
  to perform logical operations to determine the proper course of action. In this 
  case, the next display object will be instantiated and passed to the controller's 
  <code>nextScreen()</code> method. 
<p> <!-- break --> 
<p> <font size="+1"><strong>BuyStockScreen</strong></font><br>
  Continuing the example, suppose the user has selected the "Buy Stock" option 
  from the Welcome screen. In this section, I will examine the <code>BuyStockScreen</code> 
  object that would be instantiated in that case. 
<p> <code> public class BuyStockScreen extends StockScreen implements CommandListener<br>
  </code> 
<p> The <code>BuyStockScreen</code> class extends the <code>StockScreen</code> 
  class, which itself extends the <code>javax.microedition.lcdui.Form</code> class. 
<p> <strong>StockScreen</strong><br>
  The constructor is passed the title of the screen and a reference to the controller 
  object, which is to be stored in a protected variable for use by the child class. 
  The title is passed because the <code>StockScreen</code> object is inherited 
  by the <code>BuyStockScreen</code>, <code>SelectStockScreen</code>, and <code>SellStockScreen</code> 
  classes. 
<p> 
<pre> 
public StockScreen(String title, Controller controller)
{
	super(title);
   _controller = controller;
   _stockDB = controller.getStockDatabase();
}
</pre>
<p> One item of interest in the constructor is the fact that the <code>StockScreen</code> 
  class is retrieving a reference to the <code>StockDatabase</code> interface 
  for use within the child classes. 
<p> 
<pre>     
public void displayScreen(String symbol, int  numShares)
{
  _symbolField = new StringItem("Stock Symbol: ", symbol);
  _numSharesField = new StringItem("Num Shares: ", ""+ numShares);
  
  append(_symbolField);
  append(_numSharesField);
  generateButtons();
}

public void displayScreen()
{
  _symbolEntry = new TextField("EnterStock Symbol", 
    "", 6, TextField.ANY);
  _numEntry = new TextField("Enter Num Shares",
    "", 10, TextField.NUMERIC);
  
  append(_symbolEntry);
  append(_numEntry);
  
  generateButtons();
}

There are two different <code>displayScreen()</code> methods to illustrate 
  two different user interface components: <code>StringItem</code> and <code>TextField</code>. 
</pre>
<p> <strong>StringItem</strong><br>
  A <code>StringItem</code> is a display-only item that contains a label and a 
  corresponding value. In this case, the <code>StringItem</code> is used to display 
  the chosen stock and the number of shares for the sell order. 
<p> <strong>TextField</strong><br>
  A <code>TextField</code> is a UI component that lets the user enter information 
  from the phone keypad to the application. The <code>TextField</code> takes the 
  following parameters: 
<p> 
<ul>
  <li>Label</li>
  <li>Initial text</li>
  <li>Maximum length</li>
  <li>Field constraint</li>
</ul>
<p> Table 2 illustrates the different field constraints that may be used by default. 
<p> <!--[PROD: PLEASE ADD TABLE HEAD: Table 2. Description of different field constraints]--> 
<table width="85%" align="center" border="0" cellpadding="2" cellspacing="2" bgcolor="#ccffff" color="#ffffff">
  <caption align="bottom"><strong><font size="-1">Table 2. Description of different 
  field constraints</font></strong></caption>
  <tr align="left" valign="top"> 
    <th> Field Constraint</th>
    <th>Description</th>
  </tr>
  <tr align="left" valign="top" bgcolor="#ccffcc"> 
    <td> <strong>ANY</strong></td>
    <td>The user is allowed to enter any text</td>
  </tr>
  <tr align="left" valign="top"> 
    <td><strong>EMAILADDR</strong></td>
    <td>The user is allowed to enter an email address</td>
  </tr>
  <tr align="left" valign="top" bgcolor="#ccffcc"> 
    <td><strong>NUMERIC</strong></td>
    <td>The user is allowed to enter only an integer value</td>
  </tr>
  <tr align="left" valign="top"> 
    <td><strong>PASSWORD</strong></td>
    <td>The text entered must be masked so that typed characters are not visible</td>
  </tr>
  <tr align="left" valign="top" bgcolor="#ccffcc"> 
    <td><strong>PHONENUMBER</strong></td>
    <td>The user is allowed to enter a phone number</td>
  </tr>
  <tr align="left" valign="top"> 
    <td> <strong>URL</strong></td>
    <td>The user is allowed to enter a URL</td>
  </tr>
</table>
<p> You should note that different implementations of the MIDP specification may 
  have differing behavior. For example, the phone number field may contain additional 
  characters, such as the + sign commonly used in European phone numbers. The 
  application must remain sensitive to these varying implementation details until 
  the specification becomes more standardized. 
<p> Both of the <code>displayScreen()</code> methods will call the <code>generateButtons()</code> 
  method to create the "Next" and "Back" buttons used on all three of the subclass 
  screens. In this method, each <code>Command</code> object is instantiated and 
  in turn added to the screen using the <code>addCommand()</code> method. 
<p> <code> &nbsp;&nbsp;&nbsp;&nbsp;public void generateButtons()<br>
  &nbsp;&nbsp;&nbsp;&nbsp;{<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.nextCommand = new Command("Next", 
  Command.SCREEN, 1);<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.backCommand = new Command("Back", 
  Command.BACK, 1);<br>
  <br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.addCommand(backCommand);<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.addCommand(nextCommand);<br>
  &nbsp;&nbsp;&nbsp;&nbsp;}<br>
  }<br>
  </code> 
<p> <font size="+1"><strong>BuyStockScreen revisited</strong></font><br>
  I will now return to the <code>BuyStockScreen</code>. Because the superclass 
  has handled all of the initialization, this screen needs only to set up its 
  <code>CommandListener</code> actions. 
<p> <code> &nbsp;&nbsp;&nbsp;&nbsp;public BuyStockScreen(Controller controller)<br>
  &nbsp;&nbsp;&nbsp;&nbsp;{<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super("Buy Stock", controller);<br>
  <br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super.displayScreen();<br>
  <br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.setCommandListener(this);<br>
  &nbsp;&nbsp;&nbsp;&nbsp;}<br>
  </code> 
<p> In the <code>commandAction()</code> method, the first check is to determine 
  if the user has clicked on the "Back" button. If so, the controller is called 
  to display the previous screen retrieved from the <code>Stack</code>. 
<p> <code> &nbsp;&nbsp;&nbsp;&nbsp;public void commandAction(Command c, Displayable 
  d)<br>
  &nbsp;&nbsp;&nbsp;&nbsp;{<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( c == backCommand)<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_controller.lastScreen();<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
  </code> 
<p> If the user has instead clicked on the "Next" button, the process of buying 
  a stock will begin. In this process, the parameters from the <code>TextField</code> 
  must be retrieved. The <code>buyStock()</code> method of the <code>StockDatabase</code> 
  interface will then be called to add the newly purchased stock to the stock 
  database. If this proceeds without any exceptions, the <code>WelcomeScreen</code> 
  will once again be displayed to the user. 
<p> <code> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// buy 
  the shares<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String 
  symbol = _symbolEntry.getString();<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String 
  shares = _numEntry.getString();<br>
  <br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_stockDB.buyStock( 
  symbol, shares, 4);<br>
  <br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_controller.nextScreen( 
  new WelcomeScreen( _controller) );<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;catch 
  (StockException se)<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.setTitle("Bad 
  Data");<br>
  <br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;se.printStackTrace();<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
  </code> 
<p> <font size="+1"><strong>StockDatabase</strong></font><br>
  The <code>StockDatabase</code> interface is used to abstract the functionality 
  of the MIDP storage implementation from the application. Because the UI developer 
  does not need to understand the technical details of the data storage, an abstraction 
  of this level can be helpful. 
<p> <code> public interface StockDatabase<br>
  {<br>
  &nbsp;&nbsp;&nbsp;&nbsp;public void buyStock(String symbol, String shares, int 
  price) throws StockException;<br>
  &nbsp;&nbsp;&nbsp;&nbsp;public void sellStock(Stock stock, int numShares) throws 
  StockException;<br>
  &nbsp;&nbsp;&nbsp;&nbsp;public Vector getStocks() throws StockException;<br>
  &nbsp;&nbsp;&nbsp;&nbsp;public Stock getStock(String stock) throws StockException;<br>
  }<br>
  </code> 
<p> The <code>StockDatabase</code> interface contains methods to add, retrieve, 
  and remove data from the MIDlet <code>RecordStore</code>. The <code>StockDatabase</code> 
  and corresponding data store will be discussed in further detail following my 
  discussion of the UI components. 
<p> <!-- break --> 
<p> <font size="+1"><strong>SelectStockScreen</strong></font><br>
  The <code>SelectStockScreen</code> presents the user with a list of stocks in 
  a personal portfolio as retrieved from the database. The constructor of this 
  object is responsible for initializing the display. Recall from the <code>StockScreen</code> 
  discussion that the <code>StockDatabase</code> reference <em><code>_stockDB</code></em> 
  has been retrieved in the superclass constructor. The <code>getStocks()</code> 
  method is called to retrieve a list of the stocks in the user's portfolio. If 
  any are found, a <code>Vector</code> containing those stocks will be returned 
  and passed to the <code>showStockList()</code> method for conversion into a 
  friendly user interface. 
<p> <code> &nbsp;&nbsp;&nbsp;&nbsp;public SelectStockScreen(Controller controller)<br>
  &nbsp;&nbsp;&nbsp;&nbsp;{<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super("Select Stock", controller);<br>
  <br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Vector 
  stocks = _stockDB.getStocks();<br>
  <br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Item 
  displayItem = showStockList(stocks);<br>
  <br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;append(displayItem);<br>
  <br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super.generateButtons();<br>
  <br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.setCommandListener( 
  this);<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;catch (StockException se)<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;append(se.getMessage() 
  );<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
  &nbsp;&nbsp;&nbsp;&nbsp;}<br>
  </code> 
<p> <strong>ChoiceGroup</strong><br>
  The <code>showStockList()</code> method is used to retrieve the <code>Stock</code> 
  objects from the <code>Vector</code> of stocks. It then creates a <code>ChoiceGroup</code> 
  object packed with the list of stocks the user can sell. A <code>ChoiceGroup</code> 
  is an <code>Item</code> that you can add to a <code>Form</code> screen. It resembles 
  a list in capabilities and options, but is not a screen type. On this screen, 
  the <code>EXCLUSIVE</code> option for the list has been used to generate a list 
  of stocks to sell so that the user can choose only one stock at a time. 
<p> <code> &nbsp;&nbsp;&nbsp;&nbsp;private Item showStockList(Vector stocks)<br>
  &nbsp;&nbsp;&nbsp;&nbsp;{<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Stock currentStock = null;<br>
  <br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_stockList = new ChoiceGroup("Choose 
  stock", ChoiceGroup.EXCLUSIVE);<br>
  <br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for ( int i = 0; i &lt; stocks.size(); 
  i++)<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;currentStock 
  = (Stock) stocks.elementAt(i);<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_stockList.append( 
  currentStock.getSymbol(), null );<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
  <br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return _stockList;<br>
  &nbsp;&nbsp;&nbsp;&nbsp;}<br>
  </code> 
<p> The <code>SelectStockScreen</code>'s <code>commandAction()</code> method is 
  used to pass the control from the screen where the user selects the stock to 
  sell to the screen that will actually perform the stock sale. This method will 
  retrieve the currently selected stock from the list of stocks and pass that 
  <code>String</code> to the <code>SellStockScreen</code>. 
<p> <code> &nbsp;&nbsp;&nbsp;&nbsp;public void commandAction( Command c, Displayable 
  d)<br>
  &nbsp;&nbsp;&nbsp;&nbsp;{<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( c == backCommand)<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_controller.lastScreen();<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// get 
  the selected item<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int 
  selectedIndex = _stockList.getSelectedIndex();<br>
  <br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String 
  selectedStock = _stockList.getString( selectedIndex);<br>
  <br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// move 
  on to the SellStockScreen<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SellStockScreen 
  sellStockScreen = <br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new 
  SellStockScreen(_controller, selectedStock);<br>
  <br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_controller.nextScreen( 
  sellStockScreen);<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
  &nbsp;&nbsp;&nbsp;&nbsp;}<br>
  </code> 
<p> <font size="+1"><strong>SellStockScreen</strong></font><br>
  The <code>SellStockScreen</code> is used to display a message to the user confirming 
  the sale of the stock that was previously selected. If the user selects the 
  "Next" button, the stock will be removed from the database. 
<p> The constructor of this object will receive a reference to the <code>Controller</code> 
  class, as well as a <code>String</code> representing the stock to be sold. This 
  screen will access the <code>StockDatabase</code> object to retrieve information 
  that relates to the number of shares of that stock currently listed in the database. 
  It will then display that information to the screen using the <code>displayScreen()</code> 
  method described earlier in the <code>StockScreen</code> discussion. 
<p> <code> &nbsp;&nbsp;&nbsp;&nbsp;public SellStockScreen(Controller controller, 
  String selectedStock)<br>
  &nbsp;&nbsp;&nbsp;&nbsp;{<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super("Sell "+ selectedStock, 
  controller);<br>
  <br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;append("Selling " + selectedStock);<br>
  <br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// determine 
  how many shares the user has<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_sellStock 
  = _stockDB.getStock( selectedStock);<br>
  <br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_symbol 
  = _sellStock.getSymbol();<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_numShares 
  = _sellStock.getNumShares();<br>
  <br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// display 
  screen<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super.displayScreen(_symbol, 
  _numShares);<br>
  <br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.setCommandListener( 
  this);<br>
  <br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;catch (StockException se)<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.out.println("EXCEPTION 
  "+ se.getMessage() );<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
  &nbsp;&nbsp;&nbsp;&nbsp;}<br>
  <br>
  </code> 
<p> The <code>commandAction()</code> method will handle the user interaction. 
  Should the user click the "Next" button, the <code>StockDatabase</code> will 
  be accessed to sell all shares of the chosen stock that are present in the database. 
  The <code>SellStockScreen</code> in this example does not allow the user to 
  alter the number of shares that are to be sold. The display will once again 
  return to the <code>WelcomeScreen</code> to show the user the main menu of commands. 
<p> <code> &nbsp;&nbsp;&nbsp;&nbsp;public void commandAction( Command c, Displayable 
  d)<br>
  &nbsp;&nbsp;&nbsp;&nbsp;{<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( c == backCommand)<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_controller.lastScreen();<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// sell 
  the shares<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_stockDB.sellStock( 
  _sellStock, _numShares);<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;catch 
  (StockException se)<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;se.printStackTrace();<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
  <br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_controller.nextScreen( 
  new WelcomeScreen( _controller) );<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
  &nbsp;&nbsp;&nbsp;&nbsp;}<br>
  </code> 
<p> <strong>Stock object</strong><br>
  The <code>Stock</code> object that has been used throughout the example is a 
  simple object containing a constructor and a set of <code>getXYZ()</code> methods. 
  As a prelude to my discussion of the <code>RecordStore</code> infrastructure, 
  the key methods are presented here: 
<p> <code> &nbsp;&nbsp;&nbsp;&nbsp;public Stock(String symbol, int numShares, 
  int price)<br>
  &nbsp;&nbsp;&nbsp;&nbsp;{<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_symbol = symbol;<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_numShares = numShares;<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_price = price;<br>
  &nbsp;&nbsp;&nbsp;&nbsp;}<br>
  <br>
  &nbsp;&nbsp;&nbsp;&nbsp;public String getSymbol(){ return _symbol; }<br>
  &nbsp;&nbsp;&nbsp;&nbsp;public int getNumShares(){ return _numShares; }<br>
  &nbsp;&nbsp;&nbsp;&nbsp;public int getPrice(){ return _price; }<br>
  </code> 
<p> <font size="+1"><strong>RMSStockStore </strong></font><br>
  Having completed the discussion of the example's application layer, I'll turn 
  your attention toward the data storage layer. In my prior discussion, the data 
  store had been accessed solely through the <code>StockDatabase</code> interface. 
  I will now examine the object that implements that interface. 
<p> The <code>RMSStockStore</code> is the object in this example that is used 
  to coordinate all activities related to the <code>RecordStore</code>. This object 
  contains a reference to the <code>javax.microedition.rms.RecordStore</code> 
  object that is part of the MIDP APIs. 
<p> <code> public class RMSStockStore implements RecordFilter, RecordComparator, 
  StockDatabase<br>
  </code> 
<p> The constructor of the <code>RMSStockStore</code> object will instantiate 
  a <code>RecordStore</code> object pointing toward the "shares" data store. It 
  will create that data store if one does not previously exist. 
<p> 
<pre>
public RMSStockStore(){
  try
  {
    String fileName = "shares";
    recordStore = RecordStore.openRecordStore(fileName, true);
  }
  catch (RecordStoreException rse) 
  {
    System.out.println(rse);
    rse.printStackTrace();
  }
}
  </pre>
<p> The <code>addStock()</code> method is an internal method that is used by the 
  object to perform the actual writes to the data store. Notice that the data 
  to be stored must be converted from an object or a series of objects to a byte 
  array in order to be added to the record store. This conversion is done with 
  the help of the <code>StockStorage</code> class, which I'll discuss later. Once 
  the byte array is ready for storage, the <code>addRecord()</code> method is 
  called, passing on that byte array to the <code>RecordStore</code> object. 
<p> 
<pre>    
private void addStock(int shares, String symbolName, 
  int price)
{
  ByteArrayOutputStream baos = 
    new ByteArrayOutputStream();
  
  DataOutputStream outputStream 
    = new DataOutputStream(baos);
  
  try {
    Stock 
      outputStock = new Stock( symbolName, shares, price);
    
    StockStorage.writeStock( 
      outputStock, outputStream);
  }
  catch (IOException ioe) {
    System.out.println(ioe);
    ioe.printStackTrace();
  }
  
  // Extract the byte array
  byte[] b = baos.toByteArray();
  
  // Add it to the record store
  try {
    recordStore.addRecord(b, 
      0, b.length);
  }
  catch (RecordStoreException rse) {
    System.out.println(rse);
    rse.printStackTrace();
  }
}
  </pre>
<br>
<br>
The <code>getStockHelper()</code> method is used as a helper to both the <code>getStock()</code> 
and <code>getStocks()</code> methods. The <code>getStockHelper()</code> method 
can enumerate over a set of records that has been returned from the <code>RecordStore</code>. 
In doing so, it will read in those records and add them to a <code>Vector</code> 
that will be passed back to the user interface objects. Notice that the <code>StockStorage</code> 
object is also used to convert the <code>InputStream </code> (byte array) into 
a <code>Stock</code> object.<br>
<br>
<pre>private Vector getStockHelper(RecordEnumeration re)
{
  Vector stockVector = new Vector();
  
  try {
    while(re.hasNextElement())
    {
      int id = re.nextRecordId();
      
      ByteArrayInputStream bais =  new 
        ByteArrayInputStream(recordStore.getRecord(id));
      
      DataInputStream inputStream = new
        DataInputStream(bais);
      
      try 
      {
        Stock stock = StockStorage.readStock(inputStream);
        stockVector.addElement(sock);
      }
      catch 
        (EOFException eofe) {
        System.out.println(eofe);
        eofe.printStackTrace();
      }
    }
  }
  ...
  return stockVector;
}
  </pre>
<p> <strong>RecordStore </strong><br>
  In the code already discussed, there are references to the <code>javax.microedition.rms.RecordStore</code> 
  object. The following is a subset of the methods contained within that object 
  that I have used in this example: 
<p> 
<ul>
  <li><code>openRecordStore()</code>: Used to open/create a record store</li>
  <li><code>addRecord()</code>: Used to add a record to that store</li>
  <li><code>enumerateRecords()</code>: Used to loop over the records in a record 
    store</li>
  <li><code>getRecord()</code>: Used to retrieve a specific record from the record 
    store</li>
  <li><code>deleteRecord()</code>: Used to remove a record from the record store</li>
</ul>
<p> The <code>RecordStore</code> object provides a convenient and flexible storage 
  system for the MIDP platform. Using a <code>RecordStore</code>, an application 
  can store information ranging from primitive types to complex serialized objects. 
<p> <strong>RecordComparator</strong><br>
  The <code>RMSStockStore</code> object implements the <code>javax.microedition.rms.RecordComparator</code> 
  interface. This interface is then passed to the <code>RecordStore</code> when 
  it becomes necessary to sort the data being retrieved from the store. An object 
  that implements the <code>RecordComparator</code> interface must implement the 
  <code>compare()</code> method. The intent of this method is to determine the 
  sorting order of two records in the database. 
<p> In the implementation of <code>compare</code> that is contained within the 
  <code>RMSStockStore</code> object, a comparison is being made between the stock 
  symbols of two records in the database. Both records are converted from byte 
  arrays to stock objects through the various <code>InputStreams</code>. The symbols 
  of each stock are retrieved using the <code>getSymbol()</code> method and then 
  compared using the <code>String compareTo()</code> method. That method returns 
  three possible <code>int</code>s, corresponding to conditions of less than, 
  equal to, or greater than. 
<p> <code> &nbsp;&nbsp;&nbsp;&nbsp;public int compare(byte[] rec1, byte[] rec2)<br>
  &nbsp;&nbsp;&nbsp;&nbsp;{<br>
  &nbsp;&nbsp;&nbsp;&nbsp;...<br>
  &nbsp;&nbsp;&nbsp;&nbsp;try {<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Extract the stocks.<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Stock stock1 = StockStorage.readStock(inputStream1);<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Stock stock2 = StockStorage.readStock(inputStream2);<br>
  <br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String symbol1 = stock1.getSymbol();<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String symbol2 = stock2.getSymbol();<br>
  <br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;compareValue = symbol1.compareTo(symbol2);<br>
  &nbsp;&nbsp;&nbsp;&nbsp;}<br>
  &nbsp;&nbsp;&nbsp;&nbsp;...<br>
  </code> 
<p> Based upon the value returned, different values are returned to the <code>RecordStore</code> 
  so that it can determine how to organize the rows in the <code>RecordEnumerator</code>. 
  You can use multiple <code>RecordComparator</code> objects if it is necessary 
  to sort on different criteria for different queries. 
<p> <code> &nbsp;&nbsp;&nbsp;&nbsp;...<br>
  &nbsp;&nbsp;&nbsp;&nbsp;// Sort by symbol name<br>
  &nbsp;&nbsp;&nbsp;&nbsp;if (compareValue &lt; 0) {<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return RecordComparator.PRECEDES;<br>
  &nbsp;&nbsp;&nbsp;&nbsp;}<br>
  &nbsp;&nbsp;&nbsp;&nbsp;else if (compareValue &gt; 0) {<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return RecordComparator.FOLLOWS;<br>
  &nbsp;&nbsp;&nbsp;&nbsp;}<br>
  &nbsp;&nbsp;&nbsp;&nbsp;else {<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return RecordComparator.EQUIVALENT;<br>
  &nbsp;&nbsp;&nbsp;&nbsp;}<br>
  &nbsp;&nbsp;&nbsp;&nbsp;}<br>
  </code> 
<p> <strong>RecordFilter</strong><br>
  The <code>RMSStockStore</code> object implements the <code>javax.microedition.rms.RecordFilter</code> 
  interface. This interface requires the implementation of a method called <code>matches()</code>. 
  This method will act as a filter to enable the <code>RecordStore</code> to determine 
  whether a given byte array matches the entity that is being queried in the tables. 
  In this example, the <code>RecordFilter</code> is used to obtain the values 
  of a single stock from the database. So, the <code>matches()</code> method must 
  be used to ensure that only the records that match the stock are shown to be 
  true by this method. 
<p> A review of the following method demonstrates that the stock is again read 
  from the <code>InputStream</code> using the <code>StockStorage()</code> method. 
  The name of the stock is retrieved from the object using the <code>getSymbol()</code> 
  method. Notice that the return statement itself performs the comparison between 
  the name of the stock and the filter value that is stored as a class variable. 
<p> 
<pre>
public boolean matches(byte[] candidate)
  throws IllegalArgumentException
{
  // If no filter set, nothing 
  can match it.
    if (this.symbolFilter == null) 
    {
      return 
        false;
    }
  
  ByteArrayInputStream bais = 
    new ByteArrayInputStream(candidate);
  
  DataInputStream inputStream 
    = new DataInputStream(bais);
  
  String name = null;
  
  try {
    
    Stock 
      stock = StockStorage.readStock(inputStream);
    int 
      shares = stock.getNumShares();
    name 
      = stock.getSymbol();
  }
  ...
  return (this.symbolFilter.equals(name));
}
  </pre>
<p> Only records for which this method returns true will appear in the set of 
  results to this lookup. 
<p> <strong>StockDatabase</strong><br>
  The <code>RMSStockStore</code> object implements the <code>StockDatabase</code> 
  interface defined for this example. These methods use the helper methods and 
  the <code>StockStorage</code> object to perform the actions corresponding to 
  their names. 
<p> The <code>buyStock()</code> method is used to add a stock to the <code>RecordStore</code>. 
  It is called from the <code>BuyStockScreen</code> when a user adds a stock to 
  a portfolio. 
<p> <code> &nbsp;&nbsp;&nbsp;&nbsp;public void buyStock(String symbol, String 
  shares, int price) throws StockException<br>
  &nbsp;&nbsp;&nbsp;&nbsp;{<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int numShares = 0;<br>
  <br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;numShares 
  = Integer.parseInt( shares);<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;catch( NumberFormatException 
  nfe)<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw 
  new StockException("Number of shares value is invalid", nfe);<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
  </code> 
<p> The <code>buyStock()</code> method performs some basic field validation to 
  ensure that the values are present and of the correct format. 
<p> <code> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( numShares &lt;= 
  0 || price &lt;= 0 || symbol.length() == 0)<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw 
  new StockException("Invalid Data passed to RMS", null);<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
  </code> 
<p> This example limits the user to a single entry in a portfolio for a given 
  stock. To do so, the <code>buyStock()</code> method must look up to determine 
  whether a given stock already exists in the portfolio. 
<p> <code> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// check if there are 
  existing shares<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Stock stock = getStock( symbol);<br>
  </code> 
<p> If not, it will just add the stock to the portfolio. 
<p> <code> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( stock == null)<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// add 
  the new shares<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;addStock( 
  numShares, symbol, price);<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
  </code> 
<p> If the stock does exist, the first entry will be removed from the database 
  and a new record inserted in its place. Note that you can use the <code>RecordStore.setRecord()</code> 
  method instead of performing these two steps. I made this design choice to simplify 
  this example. 
<p> <code> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sellStock( 
  stock, stock.getNumShares() );<br>
  <br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;addStock( 
  numShares + stock.getNumShares(), symbol, price);<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
  </code> 
<p> The <code>sellStock()</code> method is called from both the <code>buyStock()</code> 
  method and the <code>SellStockScreen</code>. This method is used to remove a 
  stock from the data store. 
<p> <code> &nbsp;&nbsp;&nbsp;&nbsp;public void sellStock(Stock stock, int numShares) 
  throws StockException<br>
  </code> 
<p> The <code>symbolFilter</code> value is set to be the symbol of the stock to 
  be sold. Recall that the <code>RecordComparator</code> uses this value in its 
  <code>matches()</code> method to determine which records meet that criterion. 
<p> <code> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// delete entry from 
  the database<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.symbolFilter = stock.getSymbol();<br>
  <br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Stock retrievedStock = null;<br>
  </code> 
<p> The <code>RecordStore</code> provides a query mechanism through the user of 
  the <code>RecordFilter</code> interface. To obtain an enumeration of records, 
  pass the <code>RecordFilter</code> instance to the <code>enumerateRecords()</code> 
  method. The filter will ensure that only records that contain this symbol will 
  be returned. By passing the <code>RecordComparator</code>, the <code>RecordStore</code> 
  will return the records according to the desired sort order. In this example, 
  the <code>RMSRecordStore</code> implements the <code>RecordComparator</code> 
  and <code>RecordFilter</code> interfaces, so they are passed in as <code>this</code>. 
<p> <code> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try {<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RecordEnumeration 
  re = recordStore.enumerateRecords(this, this, true);<br>
  <br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while(re.hasNextElement())<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int 
  id = re.nextRecordId();<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ByteArrayInputStream 
  bais = <br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new 
  ByteArrayInputStream(recordStore.getRecord(id));<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DataInputStream 
  inputStream = new DataInputStream(bais);<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try 
  {<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;retrievedStock 
  = StockStorage.readStock(inputStream);<br>
  </code> 
<p> The record is removed from the record store based upon its id value. 
<p> <code> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;recordStore.deleteRecord( 
  id);<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br>
  </code> 
<p> The <code>getStocks()</code> method is used to obtain a list of stocks that 
  are listed in the user's portfolio. This method will return a <code>Vector</code> 
  of <code>Stock</code> objects that is used by the <code>SelectUserScreen</code> 
  to retrieve the stock list. Notice that the value of the <code>RecordFilter</code> 
  is passed in as null. This ensures that all records in the database will be 
  returned and that no filtering will be used. 
<p> 
<pre>
public Vector getStocks() throws StockException
{
  Vector stockVector = new Vector();
  
  try {
    // Enumerate the records using the comparator implemented
    // above to sort by game symbol.

    RecordEnumeration re = 
      recordStore.enumerateRecords(null, this, true);
    
    stockVector = getStockHelper(re);
  }
  catch (RecordStoreException rse) {
    System.out.println(rse);
    rse.printStackTrace();
  }
}
  </pre>
<p> If the <code>Vector</code> is empty, throw an exception because this method 
  should not be accessed unless the user has bought a stock previously. 
<p> <code> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( stockVector.size() 
  == 0)<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw 
  new StockException("No Stocks found in portfolio.");<br>
  <br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return stockVector;<br>
  &nbsp;&nbsp;&nbsp;&nbsp;}<br>
  </code> 
<p> <strong>StockStorage</strong><br>
  The <code>StockStorage</code> object is intended to encapsulate the storage 
  of the <code>Stock</code> object to a single class. All other classes may retrieve 
  and store the <code>Stock</code> object in the <code>RecordStore</code> without 
  knowing the format of the data stored. The <code>RecordStore</code> itself has 
  no working knowledge of the format of the <code>Stock</code> object in the database. 
  If you decided that the date of purchase should be stored, you make that design 
  (without any modification to the remainder of the application) by simply changing 
  the fields in the <code>StockStorage</code> object. 
<p> The <code>Stock</code> object is stored as follows: 
<p> <!--[PROD: PLEASE ADD TABLE HEAD: Table 3. Storing of the Stock object]--> 
<table width="65%" align="center" border="0" cellpadding="2" cellspacing="2" bgcolor="#ccffff" color="#ffffff">
  <caption align="bottom"><strong><font size="-1">Table 3. Storing of the Stock 
  object</font></strong></caption>
  <tr align="left" valign="top"> 
    <th>Field</th>
    <th>Description</th>
  </tr>
  <tr align="left" valign="top" bgcolor="#ccffcc"> 
    <td>Number of shares</td>
    <td>Integer field</td>
  </tr>
  <tr align="left" valign="top"> 
    <td>Symbol</td>
    <td>UTF</td>
  </tr>
  <tr align="left" valign="top" bgcolor="#ccffcc"> 
    <td>Cost</td>
    <td>Integer field</td>
  </tr>
</table>
<p> By isolating the storage information to this object, the rest of the application 
  is spared all knowledge of the lowest level of details. 
<p> The <code>writeStock()</code> method will retrieve the values from the <code>Stock</code> 
  object and pass them to the <code>OutputStream</code>. 
<p> 
<pre>   
public static void writeStock(Stock stock, 
  DataOutputStream outputStream) 
  throws IOException
{
  // Push the number of shares into a byte array.
    outputStream.writeInt( stock.getNumShares() ;
  
  // Then push the stock name.
  outputStream.writeUTF( stock.getSymbol() );
  
  // push the stock price
  outputStream.writeInt( stock.getPrice() );
}
  </pre>
<p> The <code>readStock()</code> method will retrieve values from the <code>InputStream</code> 
  and create a new <code>Stock</code> object for the application to manipulate 
  as needed. 
<p> 
<pre>
public static Stock readStock(DataInputStream 
  inputStream) throws IOException
{
  // read the number of shares
  int numShares = inputStream.readInt();
  
  // read the stock symbol
  String symbol = inputStream.readUTF();
  
  // read the stock price
  int price = inputStream.readInt();
  
  // return a new Stock object
  return new Stock( symbol, numShares,  price);
}
</pre>
<p> <font size="+1"><strong>Conclusion</strong></font><br>
  The intent of this article was to discuss the various components that you can 
  use to create an application to run on the MIDP platform. I focused on two components 
  specifically: the user interface and the data store. 
<p> The example I used combined these two components and provided a backdrop for 
  a discussion on the interactions between these components and others in the 
  MIDP platform. 
<p> On the user interface side, I discussed most of the UI components that can 
  go into creating an application on the MIDP device. Additionally, I identified 
  several concepts that can ease MIDlet development, such as the MVC approach, 
  the use of interfaces for encapsulation, and the use of inheritance for code 
  reuse. 
<p> On the data store side, I covered the key components in any data storage application 
  for the MIDP platform. Any data store-based application will use one or more 
  <code>RecordStore</code> objects, and implement one or more <code>RecordFilters</code> 
  and <code>RecordComparators</code>. Those are the basic components to a data 
  storage application. In addition, I examined the encapsulation of key functionality 
  -- whether to reduce the burdens of data storage format or to provide a clean 
  API for UI developers. 
<p> While there are admittedly many improvements that you can make to this sample 
  application, I designed it as a simple illustration of these key concepts. In 
  the next article in the series, I will expand the application to include HTTP 
  requests for stock information and a portfolio-tracking component. <img height="8" width="8" src="http://a301.g.akamai.net/7/301/1403/v001/www.javaworld.com/javaworld/icons/dingbat.gif"> 
  <!-- end body text --> 
<p> <a name="bio"></a> 
<table cellpadding="0" cellspacing="3" border="0" width="100%">
  <tr> 
    <td valign="CENTER"> </td>
    <td bgcolor="#000000"><img src="http://a301.g.akamai.net/7/301/1403/v001/www.javaworld.com/javaworld/icons/dot_clear.gif" width="2" height="1" align="BOTTOM" border="0"></td>
    <td valign="TOP"> <strong> <font size="-1" face="Arial,Helvetica,Sans-serif"> 
      About the author </font> </strong><br>
      <a class=linkColor href="mailto:michael.cymerman@javaworld.com">Michael 
      Cymerman</a> is the research and development director at <a href="http://www.groupserve.com">GroupServe</a>, 
      a Washington, D.C.-based telecommunications firm that creates Internet applications 
      to facilitate group communication. </td>
  </tr>
</table>
<p> <a name="resources"><strong>Resources</strong></a> 
<ul>
  <li>Download the source code for this article from: <br>
    <a class=linkColor href="http://www.javaworld.com/jw-03-2001/midp/examplemidlet.zip">http://www.javaworld.com/jw-03-2001/midp/examplemidlet.zip</a> 
  <li>Read Part 1 of Michael Cymerman's "Device Programming with MIDP" (<em>JavaWorld,</em> 
    January 5, 2001): <br>
    <a class=linkColor href="http://javaworld.com/javaworld/jw-01-2001/jw-0105-midp.html">http://javaworld.com/javaworld/jw-01-2001/jw-0105-midp.html</a> 
  <li>For an overview and a list of relevant links, visit the MIDP homepage: <br>
    <a class=linkColor href="http://java.sun.com/products/midp/index.html">http://java.sun.com/products/midp/index.html</a> 
  <li>Java Developer Connection J2ME pages have a bunch of articles on MIDP development. 
    Some may be out of date, so make sure to review the more current postings: 
    <br>
    <a class=linkColor href="http://developer.java.sun.com/developer/products/j2me">http://developer.java.sun.com/developer/products/j2me</a> 
  <li>Bill Day's J2ME Archive: <br>
    <a class=linkColor href="http://www.billday.com/j2me">http://www.billday.com/j2me</a> 
  <li>Chat about all wireless in ITworld.com's <strong>Java Device Programming</strong> 
    discussion, moderated by <em>JavaWorld</em> writer Qusay Mahmoud: <br>
    <a class=linkColor href="http://www.itworld.com/jump/jw-0309-midp2/forums.itworld.com/webx?14@@.ee6b808/146!skip=101">http://www.itworld.com/jump/jw-0309-midp2/forums.itworld.com/webx?14@@.ee6b808/146!skip=101</a> 
  <li>Complete listing of <strong>Embedded Java</strong> articles in <em>JavaWorld'</em>s 
    Topical Index: <br>
    <a class=linkColor href="http://www.javaworld.com/javaworld/topicalindex/jw-ti-embedded.html">http://www.javaworld.com/javaworld/topicalindex/jw-ti-embedded.html</a> 
  <li>Sign up for the <em>JavaWorld This Week</em> free weekly email newsletter 
    and keep up with what's new at <em>JavaWorld</em>: <br>
    <a class=linkColor href="http://reg.itworld.com/cgi-bin/subcontent12.cgi ">http://reg.itworld.com/cgi-bin/subcontent12.cgi 
    </a> 
</ul>
<ul>
  <li>Other <em>JavaWorld</em> articles by Michael Cymerman: <br>
    <a class=linkColor href=""></a> 
    <ul>
      <li>"Automate Your Build Process Using Java and Ant" (October 10, 2000): 
        <br>
        <a class=linkColor href="http://www.javaworld.com/javaworld/jw-10-2000/jw-1020-ant.html">http://www.javaworld.com/javaworld/jw-10-2000/jw-1020-ant.html</a> 
      <li>"Secure a Web Application, Java-style" (April 28, 2000): <br>
        <a class=linkColor href="http://www.javaworld.com/javaworld/jw-04-2000/jw-0428-websecurity.html">http://www.javaworld.com/javaworld/jw-04-2000/jw-0428-websecurity.html</a> 
      <li>"Building a Java Servlet Framework Using Reflection, Part 1" (November 
        1999): <br>
        <a class=linkColor href="http://www.javaworld.com/javaworld/jw-11-1999/jw-11-servlet.html">http://www.javaworld.com/javaworld/jw-11-1999/jw-11-servlet.html</a> 
      <li>"Building a Java Servlet Framework Using Reflection, Part 2" (February 
        2000): <br>
        <a class=linkColor href="http://www.javaworld.com/javaworld/jw-02-2000/jw-02-servlets2.html">http://www.javaworld.com/javaworld/jw-02-2000/jw-02-servlets2.html</a> 
    </ul>
    <br></td>
          </tr>
       </table>

    </td>
    <td width="8"></td>
  </tr>

  
</table>

<!-- End tutorial_detail_v --> 

    </td>
<!--
    <td width="8"><img src="/DT/images/spacer.gif" width="8" height="1"></td>
    <td valign="top" class="titles">

        

    </td>
-->
  </tr>
  <tr> 
    <td colspan="5" height="8"><img src="/DT/images/spacer.gif" width="3" height="8"></td>
  </tr>
</table>
</center>

<br> <br>
  <!-- Begin master_footer-->

<table width="772" border="0" cellspacing="0" cellpadding="0" align="center" name="template_footer">
  <tr>

    <td align="center"><span class="body">CREATE &#8226; CODE &#8226; UPLOAD</span><span class="caterized"><br>
      <p><a href="/site/main" class="title_small">HOME</a> l <a href="/site/um?LEFT=user_wrap_left&RIGHT=user_wrap_right" class="title_small">USER</a> 
        l <a href="/site/forum" class="title_small">FORUMS</a> l <a href="/site/newswire/overview" class="title_small">NEWSWIRE</a> 
        l <a href="/site/page/static?sect=contest&CNTR=contests_wrap_center" class="title_small">CONTEST</a> l <a href="/site/main?CENTER=dev_wrap_center&LEFT=dev_wrap_left&RIGHT=dev_wrap_right" class="title_small">TOOLS</a> 
        l <a href="/site/contrib/lookup" class="title_small">APPLICATIONS</a></p>
      <p><a href="/site/page/static/?CENTER=about_us_section_wrap_center" class="title_small">ABOUT DEVICETOP.COM</a>  <a href="/site/page/static?CENTER=privacy_statement" class="title_small">PRIVACY 
        STATEMENT</a>  <a href="mailto:jmeloche@espial.com" class="title_small">CONTACT US</a>  <a href="/site/page/static?CENTER=contest_rules" class="title_small">CONTEST RULES</a>  <a href="/site/page/static?CENTER=partners_content" class="title_small">PARTNERS</a>
<br>NEED A <a href="http://www.java-browser.com">JAVA BROWSER</a>?

</p>


      <p class="operational"> 2000 Espial Group Inc. Espial and devicetop.com 
        are trademarks of Espial Group <br>Inc. All other trademarks belong to their 
        respective owners.</p>
      <p class="operational"><a href="#" onMouseOut="MM_swapImgRestore()" onMouseOver="MM_swapImage('mac1','','/DT/images/template/mac.gif',1)"><img src="/DT/images/spacer.gif" width="12" height="15" name="mac1" border="0"></a></p>
      </span></td>

  </tr>
  <tr>

    <td align="center"><span class="categorize"> 
      <p class="operational"><img src="/DT/images/spacer.gif" width="404" height="1"></p>
      </span></td>

  </tr>
</table>
<!-- End master_footer-->
<br>

<!-- Begin master_tail -->

  </body>
</html>

<!-- End master_tail -->




