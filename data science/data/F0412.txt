ID=F0412
URL=http://www.geocities.com/vkliew/vb/lesson14.html
SIZE=4423
DATE=09/07/2002
TIME=13:20:14
DATASET=Visual Basic
HTML=<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
   <meta name="Author" content="Liew Voon Kiong">
   <meta name="GENERATOR" content="Mozilla/4.51 [en] (Win98; I) [Netscape]">
   <title>lesson14</title>
</head>
<body>

<h2>
Lesson 14: Working with Files</h2>

<h4>
14.1 Introduction</h4>
Up until lesson 13 we are only creating programs that could accept data
at runtime, when a program is terminated, the data also disappear. Is it
possible to save data accepted by a VB
<br>program into a storage device, such as a hardisk or diskette, or even
CDRW? The answer is possible. Is this chapter, we will learn how to create
files by writing them into a storage device and then retrieve the data
by reading&nbsp; the contents of the files using customized VB programs.
<h4>
14.2 Creating files</h4>
To create a file , use&nbsp; the following command
<p><b><font color="#3333FF">Open "fileName" For Output&nbsp; As #fileNumber</font></b>
<p>Each file created must have a file name and a file number for identification.
As for file name, you must also specify the path where the file will reside.
<p>For example
<p><b><font color="#3333FF">Open "c:\My Documents\sample.txt" For Output
As #1</font></b>
<p>will create a text file by the name of sample.txt in the My Document
folder. The accompany file number is 1. If you wish to create and save
the file in A drive, simply change the path, as follows"
<p><b><font color="#3333FF">Open "A:\sample.txt" For Output As #1</font></b>
<p><font color="#000000">If you wish to&nbsp; create a HTML file , simple
change the extension to .html</font>
<p><b><font color="#3333FF">Open "c:\My Documents\sample.html" For Output
As # 2</font></b>
<p><b>14.2.1 Sample Program : Creating a text file</b>
<p><font color="#3366FF">Private Sub</font> create_Click()
<br><font color="#3366FF">Dim</font> intMsg <font color="#3333FF">As String</font>
<br><font color="#3333FF">Dim</font> StudentName <font color="#3333FF">As
String</font>
<p><font color="#3333FF">Open</font> "c:\My Documents\sample.txt" <font color="#3333FF">For
Output As</font> #1
<br>intMsg = MsgBox("File sample.txt opened")
<br>StudentName = InputBox("Enter the student Name")
<br><font color="#3333FF">Print</font> #1, StudentName
<br>intMsg = MsgBox("Writing a" &amp; StudentName &amp; " to sample.txt
")
<p><font color="#3333FF">Close</font> #1
<p>intMsg = MsgBox("File sample.txt closed")
<br><font color="#3333FF">End Sub</font>
<p>* The above program will create a file sample.txt in the My Documents'
folder and ready to receive input from users. Any data input by users will
be saved in this text file.
<br>&nbsp;
<h4>
14.3 Reading files</h4>
To read a file created in section 14.2,&nbsp; you can use the input # statemment.
However, we can only read the file according to the format when it was
written. You have to open the file according to its file number and the
variable that hold the data. We also need to declare the variable using
the DIM command.
<p><b>14.3.1 Sample Program: Reading file</b>
<p><font color="#3333FF">Private Sub</font> Reading_Click()
<br><font color="#3333FF">Dim</font> variable1 <font color="#3333FF">As
String</font>
<br><font color="#3333FF">Open</font> "c:\My Documents\sample.txt" <font color="#3333FF">For
Input As </font>#1
<br><font color="#3333FF">Input</font> #1, variable1
<br>Text1.Text = variable1
<br><font color="#3333FF">Close</font> #1
<p><font color="#3333FF">End Sub</font>
<p><font color="#000000">* This program will open the sample.txt file and
display its contents in the Text1 textbox.</font>
<br>&nbsp;
<p><br>
<center>
<p><font size=+0><a href="vbtutor.html">Back to contents&nbsp; page]</a></font></center>

</body>
</html>
<!-- text below generated by server. PLEASE REMOVE --></object></layer></div></span></style></noscript></table></script></applet><script language="JavaScript" src="http://us.i1.yimg.com/us.yimg.com/i/mc/mc.js"></script><script language="JavaScript" src="http://us.geocities.com/js_source/geov2.js"></script><script language="javascript">geovisit();</script><noscript><img src="http://visit.geocities.com/visit.gif?1026141580" border=0 width=1 height=1></noscript>
<IMG SRC="http://geo.yahoo.com/serv?s=76001088&t=1026141580" ALT=1 WIDTH=1 HEIGHT=1>

