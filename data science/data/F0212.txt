ID=F0212
URL=http://www.visualbasicbooks.com/27260303.htm
SIZE=26064
DATE=09/07/2002
TIME=13:16:44
DATASET=Visual Basic
HTML=<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">


<head <meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="./27260303_files/filelist.xml">
<link rel=Edit-Time-Data href="./27260303_files/editdata.mso">
<link rel=OLE-Object-Data href="./27260303_files/oledata.mso">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->
<title>Building Tables with Data</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Sonia Mullineux</o:Author>
  <o:LastAuthor>Sonia Mullineux</o:LastAuthor>
  <o:Revision>1</o:Revision>
  <o:TotalTime>1</o:TotalTime>
  <o:Created>2000-02-04T13:42:00Z</o:Created>
  <o:LastSaved>2000-02-04T13:43:00Z</o:LastSaved>
  <o:Pages>4</o:Pages>
  <o:Words>836</o:Words>
  <o:Characters>4767</o:Characters>
  <o:Company>Wrox Press</o:Company>
  <o:Lines>39</o:Lines>
  <o:Paragraphs>9</o:Paragraphs>
  <o:CharactersWithSpaces>5854</o:CharactersWithSpaces>
  <o:Version>9.2720</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:DisplayHorizontalDrawingGridEvery>0</w:DisplayHorizontalDrawingGridEvery>
  <w:DisplayVerticalDrawingGridEvery>0</w:DisplayVerticalDrawingGridEvery>
  <w:UseMarginsForDrawingGridOrigin/>
  <w:Compatibility>
   <w:FootnoteLayoutLikeWW8/>
   <w:ShapeLayoutLikeWW8/>
   <w:AlignTablesRowByRow/>
   <w:ForgetLastTabAlignment/>
   <w:LayoutRawTableWidth/>
   <w:LayoutTableRowsApart/>
  </w:Compatibility>
 </w:WordDocument>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
@font-face
	{font-family:Verdana;
	panose-1:2 11 6 4 3 5 4 4 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:647 0 0 0 159 0;}
@font-face
	{font-family:Palatino;
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:FranklinGothic;
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-alt:"ITC Franklin Gothic Book";
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:Verdana;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
h1
	{mso-style-parent:"";
	mso-style-next:Normal;
	margin-top:22.0pt;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:1;
	font-size:19.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:FranklinGothic;
	color:black;
	mso-font-kerning:14.0pt;
	mso-ansi-language:EN-GB;
	mso-bidi-font-weight:normal;}
h2
	{mso-style-parent:"";
	mso-style-next:Normal;
	margin-top:14.0pt;
	margin-right:0in;
	margin-bottom:8.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:2;
	font-size:16.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:FranklinGothic;
	color:black;
	mso-ansi-language:EN-GB;
	mso-bidi-font-weight:normal;}
h4
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:4;
	font-size:14.0pt;
	font-family:"Times New Roman";}
h5
	{mso-style-parent:"";
	mso-style-next:Normal;
	margin-top:11.0pt;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	mso-outline-level:5;
	background:black;
	mso-shading:windowtext;
	mso-pattern:solid auto;
	border:none;
	mso-border-alt:solid black 2.25pt;
	padding:0in;
	mso-padding-alt:1.0pt 1.0pt 1.0pt 1.0pt;
	font-size:10.0pt;
	font-family:FranklinGothic;
	mso-ansi-language:EN-GB;
	mso-bidi-font-weight:normal;}
span.MsoCommentReference
	{mso-ansi-font-size:8.0pt;}
p.Bullets, li.Bullets, div.Bullets
	{mso-style-name:Bullets;
	mso-style-parent:"";
	mso-style-next:Normal;
	margin-top:2.1pt;
	margin-right:62.65pt;
	margin-bottom:3.0pt;
	margin-left:62.65pt;
	mso-pagination:widow-orphan;
	mso-hyphenate:none;
	font-size:9.5pt;
	mso-bidi-font-size:10.0pt;
	font-family:Palatino;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	color:black;}
p.CodeForeground, li.CodeForeground, div.CodeForeground
	{mso-style-name:"Code Foreground";
	mso-style-update:auto;
	mso-style-parent:"";
	margin-top:0in;
	margin-right:-28.9pt;
	margin-bottom:0in;
	margin-left:17.3pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	mso-hyphenate:none;
	tab-stops:56.9pt 84.95pt 141.85pt 169.9pt;
	background:#F2F2F2;
	mso-shading:windowtext;
	mso-pattern:gray-5 auto;
	font-size:8.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	color:black;
	mso-font-kerning:72.0pt;
	mso-ansi-language:EN-GB;}
span.CodeinText
	{mso-style-name:"Code in Text";
	mso-style-parent:"";
	mso-ansi-font-size:9.0pt;
	mso-ascii-font-family:"Courier New";
	mso-hansi-font-family:"Courier New";
	color:black;}
p.Foreground, li.Foreground, div.Foreground
	{mso-style-name:Foreground;
	margin-top:6.0pt;
	margin-right:.5in;
	margin-bottom:6.0pt;
	margin-left:33.85pt;
	mso-pagination:widow-orphan;
	mso-hyphenate:none;
	background:#F2F2F2;
	mso-shading:windowtext;
	mso-pattern:gray-5 auto;
	border:none;
	mso-border-alt:solid black .75pt;
	padding:0in;
	mso-padding-alt:6.0pt 6.0pt 6.0pt 6.0pt;
	font-size:9.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:Palatino;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	color:black;
	mso-font-kerning:72.0pt;
	font-weight:bold;
	mso-bidi-font-weight:normal;}
p.HowItWorks, li.HowItWorks, div.HowItWorks
	{mso-style-name:"How It Works";
	mso-style-update:auto;
	mso-style-parent:"Heading 4";
	margin-top:11.0pt;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:4;
	font-size:10.0pt;
	font-family:FranklinGothic;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	color:black;
	mso-ansi-language:EN-GB;
	font-weight:bold;
	mso-bidi-font-weight:normal;
	font-style:italic;
	mso-bidi-font-style:normal;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
-->
</style>





<meta name="description"
content="Visual Basic books for all levels of visual basic programmers are featured and reviewed regularly. Only those Visual Basic books of highest quality appear on this site.">
<meta name="keywords" content="visual basic books,visual basic,vb books,visual basic sites,programming,win32 api,database,beginner,amazon,bookstore">

<title>Beginning ASP Databases - Chapter 3</title>
</head>

<body lang=EN-US style='tab-interval:.5in' bgcolor="#6373B5" text="#000000" link="#0000ff" vlink="#666666" alink="#CC9900">
<center>
<!-- BEGIN RICH-MEDIA BURST! CODE --> 
       <script language="JavaScript"> 
       <!-- /* © 1997-1999 BURST! Media, LLC. All Rights Reserved.*/ 
       var TheAdcode = 'ad5645a'; 
       var bN = navigator.appName; 
       var bV = parseInt(navigator.appVersion); 
       var base='http://www.burstnet.com/'; 
       var Tv=''; 
       var agt=navigator.userAgent.toLowerCase(); 
       if (bV>=4) 
         {ts=window.location.pathname+window.location.search; 
          i=0; Tv=0; while (i< ts.length) 
             { Tv=Tv+ts.charCodeAt(i); i=i+1; } Tv="/"+Tv;} 
         else   {Tv=escape(window.location.pathname); 
          if( Tv.charAt(0)!='/' ) Tv="/"+Tv; 
                 else if (Tv.charAt(1)=="/")
       Tv=""; 
         if( Tv.charAt(Tv.length-1) == "/") 
           Tv = Tv + "_";} 
       if (bN=='Netscape'){ 
            if ((bV>=4)&&(agt.indexOf("mac")==-1))
       {  document.write('<s'+'cript src="'+ 
             base+'cgi-bin/ads/'+TheAdcode+'.cgi/RETURN-CODE/JS' 
             +Tv+'">'); 
            document.write('</'+'script>');    
       } 
            else if (bV>=3) {document.write('<'+'a href="'+base+'ads/'+ 
               TheAdcode+'-map.cgi'+Tv+'"target=_top>'); 
               document.write('<img src="' + base + 'cgi-bin/ads/' + 
               TheAdcode + '.cgi' + Tv + '" ismap width=468 height=60' + 
               ' border=0 alt="Click Here"></a>');} 
        } 
       if (bN=='Microsoft Internet Explorer') 
        document.write('<ifr'+'ame id=BURST src="'+base+'cgi-bin/ads/'
       + 
         TheAdcode + '.cgi' + Tv + '/RETURN-CODE" width=468 height=60' + 
         'marginwidth=0 marginheight=0 hspace=0 vspace=0 ' + 
         'frameborder=0 scrolling=no></ifr'+'ame>'); 
       // --> 
       </script> 
       <noscript><a href="http://www.burstnet.com/ads/ad5645a-map.cgi" target=_top> 
       <img src="http://www.burstnet.com/cgi-bin/ads/ad5645a.cgi" 
        width=468 height=60 border=0 alt="Click Here"></a> 
       </noscript> 
       <!-- END BURST CODE --> 
</center>


<table border="0" bgcolor="" cellpadding="0" cellspacing="0">
<tr><td><p align="center"><img src="../images/vblogo.jpg" border="0" alt="vb logo"></td></tr>
<tr> 
<td rowspan="3" valign="top" height="1"> <p>&nbsp;</p>

<p align="left"><font face= "verdana" color="#000000"><b>Visual Basic Books</b></font><br>
<a href="index.html"><font color="#ffffff">Home</font></a><br>
<a href="beginner.html"><font color="#ffffff">Visual Basic Beginner Books</font></a><br>
<a href="database.html"><font color="#ffffff">Visual Basic Database Books</font></a><br>
<a href="activex.html"><font color="#ffffff">Visual Basic ActiveX Books</font></a><br>
<a href="advanced.html"><font color="#ffffff">Visual Basic Advanced Books</font></a><br>
<a href="vbinternet.html"><font color="#ffffff">VB Internet Programming Books</font></a><br>


</p>
<p><font color="#000000" face="verdana"><b>Resources</b></font><br>
<a href="links.html"><font color="#FFFFFF">Visual Basic Links</font></a><br>
<a href="addlink.html"><font color="#FFFFFF">Add a Link</font></a><br>
<a href="esubscribe.html"><font color="#FFFFFF">Subscribe to Mailing List</font></a>

</p>

<p>


</font>


<td bgcolor="#ffffff" valign="middle"><h1 align="center"><img src="../images/anibook.gif" alt="" width="32" height="32"><font face="trebuchet ms, arial, helvetica" color="#000000"> Visual Basic Books </font><img src="../images/anibook.gif" alt="" width="32" height="32"></h1>

</td>






</tr><tr>
<td bgcolor="#ffffff" colspan="1" valign="top">



<table border="0" cellpadding="5"><tr><td>


<font  color="#000000" FACE="Verdana, Arial, Helvetica" SIZE="-1">

<CENTER>
<A HREF="27260302.htm"><IMG SRC="back.gif" WIDTH=65 HEIGHT=34 BORDER=0 ALT="Back"></A>
<A HREF="contents.htm"><IMG SRC="contents.gif" WIDTH=69 HEIGHT=34 BORDER=0 ALT="Contents"></A>
<A HREF="27260304.htm"><IMG SRC="next.gif" WIDTH=62 HEIGHT=34 BORDER=0 ALT="Next"></A>
</CENTER>
<HR>

<div class=Section1>

<h1><a name="_Toc445024337"><span style='mso-ansi-language:EN-US'>Building
Tables with Data</span></a><span style='mso-ansi-language:EN-US'><o:p></o:p></span></h1>

<p class=MsoNormal>Very frequently<!--[if supportFields]><span
style='mso-element:field-begin'></span> XE &quot;tables:tags&quot; <![endif]--><!--[if supportFields]><span
style='mso-element:field-end'></span><![endif]--><span style="mso-spacerun:
yes"> </span>your client will want to place data into an HTML table, for
display of the browser. To review some HTML, let me state the three basic rules
of table tags:</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Bullets>Begin and end the entire table with <span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
mso-bidi-font-family:"Times New Roman"'>&lt;TABLE</span></span> <span
class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>BORDER=&quot;1&quot;&gt;</span></span>
and <span class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>&lt;/TABLE&gt;</span></span></p>

<p class=Bullets>Begin and end each row with <span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
mso-bidi-font-family:"Times New Roman"'>&lt;TR&gt;</span></span> and <span
class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>&lt;/TR&gt;</span></span></p>

<p class=Bullets>Begin and end each cell with <span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
mso-bidi-font-family:"Times New Roman"'>&lt;TD&gt;</span></span> and <span
class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>&lt;/TD&gt;</span></span></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>Using the double quotes for the border value ensures universal
readability. However, many common browsers do not require them.<!--[if supportFields]><span
style='mso-element:field-begin'></span> XE &quot;recordsets:data in
tables&quot; <![endif]--><!--[if supportFields]><span style='mso-element:field-end'></span><![endif]--><!--[if supportFields]><span
style='mso-element:field-begin'></span><span style="mso-spacerun:
yes"> </span>XE &quot;tables:data from recordsets&quot; <![endif]--><!--[if supportFields]><span
style='mso-element:field-end'></span><![endif]--></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>To build tables that display our data, we need to mix HTML
table tags into the data that ADO returns. The most basic table contains only
one row (one record or one name) and two columns, as follows. This is
artificially easy, but a good way to start:</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=CodeForeground><span lang=EN-GB>&lt;%</span></p>

<p class=CodeForeground><span lang=EN-GB>dim oRSst </span></p>

<p class=CodeForeground><span lang=EN-GB>Set
oRSst=server.createobject(&quot;ADODB.recordset&quot;) </span></p>

<p class=CodeForeground><span lang=EN-GB>oRSst.open &quot;People&quot;,
&quot;DSN=Sailors&quot;</span></p>

<p class=CodeForeground><span lang=EN-GB>response.write &quot;&lt;table
BORDER='1'&gt;&quot;</span></p>

<p class=CodeForeground><span lang=EN-GB>response.write &quot;&lt;tr&gt;&quot;</span></p>

<p class=CodeForeground><span lang=EN-GB>response.write &quot;&lt;td&gt;&quot;</span></p>

<p class=CodeForeground><span lang=EN-GB>response.write
oRSst(&quot;PeopleNameFirst&quot;)</span></p>

<p class=CodeForeground><span lang=EN-GB>response.write &quot;&lt;/td&gt;&quot;</span></p>

<p class=CodeForeground><span lang=EN-GB>response.write &quot;&lt;td&gt;&quot;</span></p>

<p class=CodeForeground><span lang=EN-GB>response.write
oRSst(&quot;PeopleNameLast&quot;)</span></p>

<p class=CodeForeground><span lang=EN-GB>response.write &quot;&lt;/td&gt;&quot;</span></p>

<p class=CodeForeground><span lang=EN-GB>response.write &quot;&lt;/tr&gt;&quot;</span></p>

<p class=CodeForeground><span lang=EN-GB>response.write
&quot;&lt;/table&gt;&quot;</span></p>

<p class=CodeForeground><span lang=EN-GB>%&gt;</span></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>The code sample above lays out the logic very explicitly. In
the following listing we condense this to fewer lines of code. Keep in mind
that this is still the same very simple 1-row, 2-column table:</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=CodeForeground><span lang=EN-GB>&lt;%</span></p>

<p class=CodeForeground><span lang=EN-GB>dim oRSst2 </span></p>

<p class=CodeForeground><span lang=EN-GB>Set
oRSst2=server.CreateObject(&quot;ADODB.recordset&quot;) </span></p>

<p class=CodeForeground><span lang=EN-GB>oRSst2.open &quot;People&quot;,
&quot;DSN=Sailors&quot;</span></p>

<p class=CodeForeground><span lang=EN-GB><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=CodeForeground><span lang=EN-GB>Response.Write &quot;&lt;TABLE
BORDER='1'&gt;&lt;TR&gt;&lt;TD&gt;&quot;</span></p>

<p class=CodeForeground><span lang=EN-GB>Response.Write
oRSst2(&quot;PeopleNameFirst&quot;)</span></p>

<p class=CodeForeground><span lang=EN-GB>Response.Write
&quot;&lt;/TD&gt;&lt;TD&gt;&quot;</span></p>

<p class=CodeForeground><span lang=EN-GB>Response.Write
oRSst2(&quot;PeopleNameLast&quot;)</span></p>

<p class=CodeForeground><span lang=EN-GB>Response.Write
&quot;&lt;/TD&gt;&lt;/TR&gt;&lt;/TABLE&gt;&quot;</span></p>

<p class=CodeForeground><span lang=EN-GB>%&gt;</span></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>We can also use the Response.Write shortcut to further
condense the code that generates this table, as follows. However, it is general
good practice not to code your ASPs this way as separating your server side
scripting rather than keeping it all together in the same place degrades
performance.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=CodeForeground><span lang=EN-GB>&lt;%</span></p>

<p class=CodeForeground><span lang=EN-GB>dim oRSst3 </span></p>

<p class=CodeForeground><span lang=EN-GB>Set
oRSst3=server.CreateObject(&quot;ADODB.recordset&quot;) </span></p>

<p class=CodeForeground><span lang=EN-GB>oRSst3.open &quot;People&quot;,
&quot;DSN=Sailors&quot;</span></p>

<p class=CodeForeground><span lang=EN-GB>%&gt;</span></p>

<p class=CodeForeground><span lang=EN-GB><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=CodeForeground><span lang=EN-GB>&lt;TABLE BORDER=&quot;1&quot;&gt;</span></p>

<p class=CodeForeground><span lang=EN-GB>&lt;TR&gt;&lt;TD&gt;&lt;%=oRSst3(&quot;PeopleNameFirst&quot;)%&gt;&lt;/TD&gt;</span></p>

<p class=CodeForeground><span lang=EN-GB>&lt;TD&gt;&lt;%=oRSst3(&quot;PeopleNameLast&quot;)%&gt;&lt;/TD&gt;&lt;/TR&gt;</span></p>

<p class=CodeForeground><span lang=EN-GB>&lt;/TABLE&gt;</span></p>

<h2><a name="_Toc445024338"><span style='mso-ansi-language:EN-US'>Building
Tables with ForNext Loops</span></a><span style='mso-ansi-language:EN-US'><o:p></o:p></span></h2>

<p class=MsoNormal>It is rare that you have a client that will be satisfied
with a one-row table! Tables usually present data on many records. We will
explore that technique first with a table that produces three rows as a result
of putting the code for a row within a ForNext loop in the code below. <!--[if supportFields]><span
style='mso-element:field-begin'></span><span style="mso-spacerun:
yes"> </span>XE &quot;tables:For...Next loops&quot; <![endif]--><!--[if supportFields]><span
style='mso-element:field-end'></span><![endif]--><!--[if supportFields]><span
style='mso-element:field-begin'></span><span style="mso-spacerun:
yes"> </span>XE &quot;For...Next loops:tables&quot; <![endif]--><!--[if supportFields]><span
style='mso-element:field-end'></span><![endif]-->Of course, we can only loop
within ASP, so we will have to forget about the <span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
mso-bidi-font-family:"Times New Roman";color:black'>Response.Write</span></span>
shortcut used above; instead we'll revert to writing the HTML tags from within
ASP, and using <span class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:"Courier New";mso-bidi-font-family:"Times New Roman";
color:black'>Response.Write</span></span> explicitly:</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=CodeForeground><span lang=EN-GB>&lt;%</span></p>

<p class=CodeForeground><span lang=EN-GB>dim iRowCounter</span></p>

<p class=CodeForeground><span lang=EN-GB>dim oRSfn</span></p>

<p class=CodeForeground><span lang=EN-GB>set
oRSfn=server.CreateObject(&quot;adodb.recordset&quot;)</span></p>

<p class=CodeForeground><span lang=EN-GB>oRSfn.open &quot;People&quot;,
&quot;DSN=Sailors&quot;</span></p>

<p class=CodeForeground><span lang=EN-GB>oRSfn.MoveFirst</span></p>

<p class=CodeForeground><span lang=EN-GB>Response.Write &quot;&lt;TABLE
BORDER='1'&gt;&quot;</span></p>

<p class=CodeForeground><span lang=EN-GB>For iRowCounter=1 to 3</span></p>

<p class=CodeForeground><span lang=EN-GB><span style="mso-spacerun: yes"> 
</span>Response.Write &quot;&lt;TR&gt;&lt;TD&gt;&quot; &amp;
oRSfn(&quot;PeopleNameFirst&quot;) &amp; &quot;&lt;/TD&gt;&quot;</span></p>

<p class=CodeForeground><span lang=EN-GB><span style="mso-spacerun: yes"> 
</span>Response.Write &quot;&lt;TD&gt;&quot; &amp;
oRSfn(&quot;PeopleNameLast&quot;) &amp; &quot;&lt;/TD&gt;&lt;/TR&gt;&quot;</span></p>

<p class=CodeForeground><span lang=EN-GB><span style="mso-spacerun: yes"> 
</span>oRSfn.MoveNext</span></p>

<p class=CodeForeground><span lang=EN-GB>Next</span></p>

<p class=CodeForeground><span lang=EN-GB>Response.Write
&quot;&lt;/TABLE&gt;&quot;</span></p>

<p class=CodeForeground><span lang=EN-GB>%&gt;</span></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>Note in the above listing that we have to be sure that the
table tags are outside of the loop but the rows and cell tags are inside the
loop.<span style="mso-spacerun: yes">  </span>For the purposes of this demo we
are assuming that there are at least three records; in the real world that
would be a dangerous assumption.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<div style='border:solid black .75pt;padding:6.0pt 6.0pt 6.0pt 6.0pt;
background:#F2F2F2;mso-shading:windowtext;mso-pattern:gray-5 auto'>

<p class=Foreground>The common errors on the above code include:<!--[if supportFields]><span
style='mso-element:field-begin'></span> XE &quot;For...Next loops:tables:common
mistakes&quot; <![endif]--><!--[if supportFields]><span style='mso-element:
field-end'></span><![endif]--><!--[if supportFields]><span style='mso-element:
field-begin'></span><span style="mso-spacerun: yes"> </span>XE
&quot;tables:For...Next loops:common mistakes&quot; <![endif]--><!--[if supportFields]><span
style='mso-element:field-end'></span><![endif]--></p>

<p class=Foreground>(the usual problems in creating recordsets)</p>

<p class=Foreground>Putting the &lt;TABLE&gt; or &lt;/TABLE&gt; inside the loop</p>

<p class=Foreground>Leaving out &lt;/TABLE&gt;</p>

<p class=Foreground>Putting more than one &lt;TR&gt; or &lt;/TR&gt; in a row</p>

<p class=Foreground>Forgetting to include the <span class=CodeinText><span
style='font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>.MoveNext</span></span>
line within the loop</p>

<p class=Foreground>Trying to retrieve more records than are available in the
database<span class=MsoCommentReference><span style='font-size:8.0pt;
mso-bidi-font-size:10.0pt;color:blue;display:none;mso-hide:all;mso-font-kerning:
0pt;font-weight:normal'> </span></span></p>

</div>

<p class=MsoNormal>In later sections of the book we discuss even faster and
more eloquent ways to build a table.</p>

<div style='border:solid black 2.25pt;padding:1.0pt 1.0pt 1.0pt 1.0pt;
background:black;mso-shading:windowtext;mso-pattern:solid auto'>

<h5><a name="_Toc445024339"><span style='mso-ansi-language:EN-US'>Try It Out -
Building a Table of the First Five Clothing Items</span></a><span
style='mso-ansi-language:EN-US'><o:p></o:p></span></h5>

</div>

<p class=MsoNormal>Let's use the Clothier database again, to create a table
that shows the Name and department of the first five items.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=CodeForeground><span lang=EN-GB>&lt;TITLE&gt;2726-03-SimpleRS TIO
Building a Table of the First Five Clothing Items&lt;/TITLE&gt;</span></p>

<p class=CodeForeground><span lang=EN-GB>&lt;/HEAD&gt;</span></p>

<p class=CodeForeground><span lang=EN-GB>&lt;BODY&gt;</span></p>

<p class=CodeForeground><span lang=EN-GB>&lt;H1&gt;Chapter 3 Simple
Recordsets&lt;BR&gt;</span></p>

<p class=CodeForeground><span lang=EN-GB>Try It Out - &lt;BR&gt;</span></p>

<p class=CodeForeground><span lang=EN-GB>Building a Table of &lt;BR&gt;</span></p>

<p class=CodeForeground><span lang=EN-GB>the First Five Clothing
Items&lt;/h1&gt;</span></p>

<p class=CodeForeground><span lang=EN-GB>&lt;%</span></p>

<p class=CodeForeground><span lang=EN-GB>dim oRSc</span></p>

<p class=CodeForeground><span lang=EN-GB>dim iRowCounter</span></p>

<p class=CodeForeground><span lang=EN-GB>set
oRSc=server.CreateObject(&quot;adodb.recordset&quot;)</span></p>

<p class=CodeForeground><span lang=EN-GB>oRSc.open &quot;items&quot;,
&quot;DSN=clothier&quot;</span></p>

<p class=CodeForeground><span lang=EN-GB>oRSc.MoveFirst</span></p>

<p class=CodeForeground><span lang=EN-GB><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=CodeForeground><span lang=EN-GB>Response.Write &quot;&lt;TABLE
BORDER='1'&gt;&quot;</span></p>

<p class=CodeForeground><span lang=EN-GB>For iRowCounter = 1 to 5</span></p>

<p class=CodeForeground><span lang=EN-GB><span style="mso-spacerun: yes"> 
</span>Response.Write &quot;&lt;TR&gt;&lt;TD&gt;&quot; &amp;
oRSc(&quot;ItemName&quot;) &amp; &quot;&lt;/TD&gt;&quot;</span></p>

<p class=CodeForeground><span lang=EN-GB><span style="mso-spacerun: yes"> 
</span>Response.Write &quot;&lt;TD&gt;&quot; &amp;
oRSc(&quot;ItemDepartment&quot;) &amp; &quot;&lt;/TD&gt;&lt;/TR&gt;&quot;</span></p>

<p class=CodeForeground><span lang=EN-GB><span style="mso-spacerun: yes"> 
</span>oRSc.MoveNext</span></p>

<p class=CodeForeground><span lang=EN-GB>next</span></p>

<p class=CodeForeground><span lang=EN-GB>%&gt;</span></p>

<p class=CodeForeground><span lang=EN-GB>&lt;/TABLE&gt;&lt;/BODY&lt;/html&gt;</span></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>The above code produces the following screen.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><!--[if gte vml 1]><v:shapetype id="_x0000_t75" coordsize="21600,21600"
 o:spt="75" o:preferrelative="t" path="m@4@5l@4@11@9@11@9@5xe" filled="f"
 stroked="f">
 <v:stroke joinstyle="miter"/>
 <v:formulas>
  <v:f eqn="if lineDrawn pixelLineWidth 0"/>
  <v:f eqn="sum @0 1 0"/>
  <v:f eqn="sum 0 0 @1"/>
  <v:f eqn="prod @2 1 2"/>
  <v:f eqn="prod @3 21600 pixelWidth"/>
  <v:f eqn="prod @3 21600 pixelHeight"/>
  <v:f eqn="sum @0 0 1"/>
  <v:f eqn="prod @6 1 2"/>
  <v:f eqn="prod @7 21600 pixelWidth"/>
  <v:f eqn="sum @8 21600 0"/>
  <v:f eqn="prod @7 21600 pixelHeight"/>
  <v:f eqn="sum @10 21600 0"/>
 </v:formulas>
 <v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/>
 <o:lock v:ext="edit" aspectratio="t"/>
</v:shapetype><v:shape id="_x0000_i1025" type="#_x0000_t75" style='width:338.25pt;
 height:320.25pt' o:ole="" fillcolor="window">
 <v:imagedata src="./27260303_files/image001.gif" o:title=""/>
</v:shape><![endif]--><![if !vml]><img width=451 height=427
src="./27260303_files/image001.gif" v:shapes="_x0000_i1025"><![endif]><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PBrush" ShapeID="_x0000_i1025"
  DrawAspect="Content" ObjectID="_1011176965">
 </o:OLEObject>
</xml><![endif]--></p>

<p class=HowItWorks><a name="_Toc445024340"><span lang=EN-GB>How It Works</span></a><span
lang=EN-GB> - Building a Table of the First Five Clothing Items</span></p>

<p class=MsoNormal>The following lines create the recordset and ensure that we
are positioned at the first record:</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=CodeForeground><span lang=EN-GB>dim oRSc</span></p>

<p class=CodeForeground><span lang=EN-GB>dim iRowCounter</span></p>

<p class=CodeForeground><span lang=EN-GB>set
oRSc=server.CreateObject(&quot;adodb.recordset&quot;)</span></p>

<p class=CodeForeground><span lang=EN-GB>oRSc.open &quot;items&quot;,
&quot;DSN=clothier&quot;</span></p>

<p class=CodeForeground><span lang=EN-GB>oRSc.MoveFirst</span></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>Then we begin to write the table to the web page. First, we
write the <span class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:"Courier New";mso-bidi-font-family:"Times New Roman";
color:black'>&lt;TABLE&gt;</span></span> tag, which belongs <i
style='mso-bidi-font-style:normal'>outside</i> the loop:</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=CodeForeground><span lang=EN-GB>Response.Write &quot;&lt;TABLE
BORDER='1'&gt;&quot;</span></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>Now we can loop through the first five records. Note that,
like all <span class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:"Courier New";mso-bidi-font-family:"Times New Roman";
color:black'>For</span></span>...<span class=CodeinText><span style='font-size:
9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";mso-bidi-font-family:
"Times New Roman";color:black'>Next</span></span> Loops we need a counter to
keep track of the number of loops that have been performed. In each loop we
write the open row tag &lt;TR&gt; then the tags and data for the two cells in
the two columns:</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=CodeForeground><span lang=EN-GB>For iRowCounter = 1 to 5</span></p>

<p class=CodeForeground><span lang=EN-GB><span style="mso-spacerun: yes"> 
</span>Response.Write &quot;&lt;TR&gt;&lt;TD&gt;&quot; &amp;
oRSc(&quot;ItemName&quot;) &amp; &quot;&lt;/TD&gt;&quot;</span></p>

<p class=CodeForeground><span lang=EN-GB><span style="mso-spacerun: yes"> 
</span>Response.Write &quot;&lt;TD&gt;&quot; &amp;
oRSc(&quot;ItemDepartment&quot;) &amp; &quot;&lt;/TD&gt;&lt;/TR&gt;&quot;</span></p>

<p class=CodeForeground><span lang=EN-GB><span style="mso-spacerun: yes"> 
</span>oRSc.MoveNext</span></p>

<p class=CodeForeground><span lang=EN-GB>next</span></p>

<p class=CodeForeground><span lang=EN-GB>%&gt;</span></p>

<p class=MsoNormal><span style='layout-grid-mode:line'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='layout-grid-mode:line'>And then we place the
table close tag outside of the loop as follows.<o:p></o:p></span></p>

<p class=MsoNormal><span style='layout-grid-mode:line'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=CodeForeground><span lang=EN-GB>&lt;/TABLE&gt;</span></p>

<p class=CodeForeground><span lang=EN-GB>&lt;/BODY&lt;/html&gt;</span></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

</div>

<HR>
<CENTER>
<A HREF="27260302.htm"><IMG SRC="back.gif" WIDTH=65 HEIGHT=34 BORDER=0 ALT="Back"></A>
<A HREF="contents.htm"><IMG SRC="contents.gif" WIDTH=69 HEIGHT=34 BORDER=0 ALT="Contents"></A>
<A HREF="27260304.htm"><IMG SRC="next.gif" WIDTH=62 HEIGHT=34 BORDER=0 ALT="Next"></A>
</CENTER>
<FONT SIZE=1>&copy;1999 <A HREF="http://www.wrox.com"> Wrox Press Limited</A>, US and UK.</FONT>



</td></tr></table></table><tr><td bgcolor="#991100"><center>
<font FACE="Verdana, Arial, Helvetica" SIZE="-1"><font color="#FFFFFF">Email us your comments:<a href="mailto:contact@vbbooks.freeservers.com"><img src="../images/emailed.gif"alt="mail" border=0></a><br>Fax: 1(916)404-7719<br>&copy;1999-2000 Visual Basic Books. All rights reserved.</font>

<P>

</center>


</body>
</html>

