ID=F0316
URL=http://www.vb-helper.com/vbcl_sample_text.html
SIZE=33304
DATE=09/07/2002
TIME=13:18:42
DATASET=Visual Basic
HTML=<HTML>
<META http-equiv="PICS-Label" content='(PICS-1.1 "http://www.rsac.org/ratingsv01.html" l gen true comment "RSACi North America Server" by "RodStephens@vb-helper.com" for "http://www.vb-helper.com" on "1998.03.17T18:18-0800" r (n 0 s 0 v 0 l 0))'>
<HEAD>
<TITLE>VB Helper: Ready-to-Run Visual Basic Code Library: Sample Text</TITLE>
<META NAME="Author" CONTENT="Rod Stephens">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<META HTTP-EQUIV="Keywords" CONTENT="Visual Basic, tips, tricks, examples">
<META NAME="Keywords" CONTENT="Visual Basic, tips, tricks, examples">
<META NAME="Description" CONTENT="VB Helper: Ready-to-Run Visual Basic Code Library: Sample Text">
<META NAME="Copyright" CONTENT="Copyright 1997-2001, Rocky Mountain Computer Consulting, Inc.">
<META NAME="Rating" CONTENT="General">
<META NAME="Robots" CONTENT="All">
</HEAD>

<BODY BGCOLOR="#E1F3FF" BACKGROUND="bg_blue.jpg">

  <!-- This table contains the banner, menu column, and content. -->
  <TABLE WIDTH="100%" BORDER="0" CELLSPACING="0" CELLPADDING="0">
    <!-- ****** -->
    <!-- Banner -->
    <!-- ****** -->
    <TR><TD>
      <TABLE WIDTH="100%" BORDER="0" CELLSPACING="0" CELLPADDING="0" ALIGN="Left">
        <TR>
          <TD BACKGROUND="banner_mid.jpg"><IMG SRC="banner_l.jpg" WIDTH="410" HEIGHT="64"></TD>
          <TD BGCOLOR="#E1F3FF"><IMG SRC="banner_r.jpg" WIDTH="32" HEIGHT="64"></TD>
        </TR>
      </TABLE>
    </TD></TR>
    <TR><TD>&nbsp;</TD></TR>

    <!-- Menu column and content -->
    <TR><TD>
      <TABLE WIDTH="100%" BORDER="0" CELLSPACING="2" CELLPADDING="0">
        <!-- *********** -->
        <!-- Menu column -->
        <!-- *********** -->
        <TR>
          <TD ALIGN="Left" VALIGN="Top">
            <TABLE BORDER="0" CELLSPACING="0" CELLPADDING="0">
              <!-- Menu top -->
              <TR>
                <TD><IMG SRC="blue_ul.jpg" WIDTH="16" HEIGHT="16"></TD>
                <TD><IMG SRC="blue_um.jpg" WIDTH="93" HEIGHT="16"></TD>
                <TD><IMG SRC="blue_ur.jpg" WIDTH="16" HEIGHT="16"></TD>
              </TR>

              <!-- Menu entries -->
              <TR BGCOLOR="#7FCFFF">
                <TD BACKGROUND="blue_l.jpg" WIDTH="16">&nbsp;</TD>
                <TD><CENTER>
                  <A HREF="index.html"><B><FONT SIZE="+1">Home</FONT></B></A><BR>
                  &nbsp;<BR>
                  <A HREF="whats_new.html"><B>What's New</B></A><BR>
                  <A HREF="index_categories.html"><B>Index</B></A><BR>
                  <A HREF="books.html"><B>Books</B></A><BR>
                  <A HREF="links.html"><B>Links</B></A><BR>
                  <A HREF="http://www.topica.com/lists/VBHelperQA/read"><B>Q &amp; A</B></A><BR>
                  <A HREF="newsletter.html"><B>Newsletter</B></A><BR>
                  <A HREF="banners.html"><B>Banners</B></A><BR>
                  &nbsp;<BR>
                  <A HREF="mailto:feedback@vb-helper.com"><B>Feedback</B></A><BR>
                  <A HREF="tip_jar.html"><B>Tip Jar</B></A><BR>
                </CENTER></TD>
                <TD BACKGROUND="blue_r.jpg" WIDTH="16">&nbsp;</TD>
              </TR>

              <!-- Menu bottom -->
              <TR>
                <TD><IMG SRC="blue_ll.jpg" WIDTH="16" HEIGHT="16"></TD>
                <TD><IMG SRC="blue_lm.jpg" WIDTH="93" HEIGHT="16"></TD>
                <TD><IMG SRC="blue_lr.jpg" WIDTH="16" HEIGHT="16"></TD>
              </TR>

              <TR><TD HEIGHT="20" COLSPAN="3">&nbsp;</TR></TD>
              <!-- Old Menu top -->
              <TR>
                <TD><IMG SRC="magenta_ul.jpg" WIDTH="16" HEIGHT="16"></TD>
                <TD><IMG SRC="magenta_t.jpg" WIDTH="93" HEIGHT="16"></TD>
                <TD><IMG SRC="magenta_ur.jpg" WIDTH="16" HEIGHT="16"></TD>
              </TR>

              <!-- Menu entries -->
              <TR BGCOLOR="#E36BFF">
                <TD BACKGROUND="magenta_lside.jpg" WIDTH="16">&nbsp;</TD>
                <TD><CENTER>
                  <B><FONT SIZE="+1">Old Pages</FONT></B><BR>
                  &nbsp;<BR>
                  <A HREF="old_index.htm"><B>Old Index</B></A></BR>
                  <A HREF="sitemap.htm"><B>Site Map</B></A></BR>
                  <A HREF="whatsnew.htm"><B>What's New</B></A></BR>
                  &nbsp;<BR>
                  <A HREF="books.htm"><B>Books</B></A></BR>
                  <A HREF="howto.htm"><B>How To</B></A></BR>
                  <A HREF="tips.htm"><B>Tips &amp; Tricks</B></A></BR>
                  <A HREF="tutorial.htm"><B>Tutorials</B></A></BR>
                  <A HREF="stories.htm"><B>Stories</B></A></BR>
                  <A HREF="perform.htm"><B>Performance</B></A></BR>
                  <A HREF="essays.htm"><B>Essays</B></A></BR>
                  <A HREF="links.htm"><B>Links</B></A></BR>
                  <A HREF="q_and_a.htm"><B>Q &amp; A</B></A></BR>
                  <A HREF="newvb6.htm"><B>New in VB6</B></A></BR>
                  <A HREF="free.htm"><B>Free Stuff</B></A></BR>
                  <A HREF="pictures.htm"><B>Pictures</B></A></BR>
                </CENTER></TD>
                <TD BACKGROUND="magenta_rside.jpg" WIDTH="16">&nbsp;</TD>
              </TR>

              <!-- Old Menu bottom -->
              <TR>
                <TD><IMG SRC="magenta_ll.jpg" WIDTH="16" HEIGHT="16"></TD>
                <TD><IMG SRC="magenta_b.jpg" WIDTH="93" HEIGHT="16"></TD>
                <TD><IMG SRC="magenta_lr.jpg" WIDTH="16" HEIGHT="16"></TD>
              </TR>

              <!-- Other stuff in the menu column -->
              <TR><TD HEIGHT="100" COLSPAN="3">&nbsp;</TR></TD>

              <!-- ***************** -->
              <!-- Amazon Recommends -->
              <!-- ***************** -->
              <TR><TD COLSPAN="3" ALIGN="Center">
<!-- -->
                <SCRIPT SRC="http://rcm.amazon.com/e/cm?t=vbhelper&l=rc1&p=2&o=1" TYPE="text/JavaScript"></SCRIPT>
<!-- -->
                <NOSCRIPT>
                  <TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" WIDTH="125">
                    <TR><TD>
                      <MAP NAME="boxmap">
                        <AREA SHAPE="RECT" COORDS="18, 263, 105, 274" HREF="http://rcm.amazon.com/e/cm/privacy-policy.html?o=1">
                        <AREA COORDS="0,0,10000,10000" HREF="http://www.amazon.com/exec/obidos/redirect-home/vbhelper">
                      </MAP>
                      <img src="http://rcm-images.amazon.com/images/G/01/associates/amzn_recommends/gnbox125x275.gif" width="125" height="275" border="0" usemap="#boxmap">
                    </TD></TR>
                  </TABLE>
                </NOSCRIPT>
              </TD></TR>
              <TR><TD HEIGHT="100" COLSPAN="3">&nbsp;</TR></TD>

              <!-- ******** -->
              <!-- Partners -->
              <!-- ******** -->
              <TR><TD COLSPAN="3" ALIGN="Center" BACKGROUND="sandpaper.gif"><A HREF="http://www.wiley.com/compbooks"><IMG SRC="wiley_logo.gif" BORDER="0" ALIGN="Center" WIDTH="77" HEIGHT="105"></TD></TR>
              <TR><TD COLSPAN="3"><FONT SIZE="1">&nbsp;</FONT></TD></TR>
              <TR><TD COLSPAN="3" ALIGN="Center"><A HREF="http://www.quepublishing.com"><IMG SRC="que.gif" BORDER="0" ALIGN="Center" WIDTH="121" HEIGHT="36"></A></TD></TR>
              <TR><TD COLSPAN="3"><FONT SIZE="1">&nbsp;</FONT></TD></TR>
              <TR><TD COLSPAN="3" ALIGN="Center"><A HREF="amazon.html"><IMG SRC="amazon_logo.gif" BORDER="0" ALIGN="Center" WIDTH="68" HEIGHT="65"></A></TD></TR>
              <TR><TD COLSPAN="3">&nbsp;</TR></TD>

              <!-- ********** -->
              <!-- More stuff -->
              <!-- ********** -->
            </TABLE>
          </TD>

          <!-- A little space between the menus and content -->
          <TD WIDTH="5">&nbsp;</TD>

          <!-- ******* -->
          <!-- Content -->
          <!-- ******* -->
          <TD WIDTH="100%" ALIGN="Left" VALIGN="Top">
            <TABLE WIDTH="100%" BORDER="0" CELLSPACING="0" CELLPADDING="0">

<TR><TD>
  <!-- Navigation menu -->
  <TABLE WIDTH="100%" BORDER="0" BGCOLOR="#7FE398" CELLSPACING="0" CELLPADDING="0">
    <!-- Top row -->
    <TR>
      <TD BGCOLOR="#7FE398" WIDTH="20"><IMG SRC="green_ul.jpg" WIDTH="20" HEIGHT="20"></TD>
      <TD WIDTH="100%" BACKGROUND="green_t.jpg">&nbsp;</TD>
      <TD BGCOLOR="#7FE398" WIDTH="20"><IMG SRC="green_ur.jpg" WIDTH="20" HEIGHT="20"></TD>
    </TR>

    <!-- Title row -->
    <TR>
      <TD BGCOLOR="#7FE398" WIDTH="20" BACKGROUND="green_l.jpg">&nbsp;</TD>
      <TD BGCOLOR="#7FE398" WIDTH="100%" ALIGN="Center"><B><FONT SIZE="+1" COLOR="#0000C0">Ready-to-Run Visual Basic Code Library: Sample Text</FONT></B></TD>
      <TD BGCOLOR="#7FE398" WIDTH="20" BACKGROUND="green_r.jpg">&nbsp;</TD>
    </TR>

    <!-- Menu entries -->
    <TR>
      <TD BGCOLOR="#E1F3FF" BACKGROUND="green_l.jpg" WIDTH="20">&nbsp;</TD>
      <TD BGCOLOR="#7FE398" WIDTH="100%" ALIGN="Center">
        <TABLE WIDTH="100%" BGCOLOR="#7FE398" BORDER="0" CELLPADDING="0" CELLSPACING="0">
          <TR>
            <TD WIDTH="33%" BGCOLOR="#7FE398" ALIGN="Center"><A HREF="vbcl.htm">Overview</A></TD>
            <TD WIDTH="33%" BGCOLOR="#7FE398" ALIGN="Center"><A HREF="vbcl_toc.html">Table of Contents</A></TD>
            <TD WIDTH="33%" BGCOLOR="#7FE398" ALIGN="Center"><B>Sample Text</B></TD>
          </TR>
          <TR>
            <TD WIDTH="33%" BGCOLOR="#7FE398" ALIGN="Center"><A HREF="vbcl_updates.html">Updates</A></TD>
            <TD WIDTH="33%" BGCOLOR="#7FE398" ALIGN="Center"><A HREF="http://www.amazon.com/exec/obidos/ASIN/047133345X/vbhelper/">Amazon.com</A></TD>
            <TD WIDTH="33%" BGCOLOR="#7FE398" ALIGN="Center"><A HREF="http://www.amazon.co.uk/exec/obidos/ASIN/047133345X/vbhelper0e/">Amazon.co.uk</A></TD>
          </TR>

        </TABLE>
      </TD>
      <TD BGCOLOR="#E1F3FF" BACKGROUND="green_r.jpg" WIDTH="20">&nbsp;</TD>
    </TR>


    <!-- Bottom row -->
    <TR>
      <TD BGCOLOR="#7FE398" WIDTH="20"><IMG SRC="green_ll.jpg" WIDTH="20" HEIGHT="20"></TD>
      <TD WIDTH="100%" BACKGROUND="green_b.jpg" ALIGN="Center">&nbsp;</TD>
      <TD BGCOLOR="#7FE398" WIDTH="20"><IMG SRC="green_lr.jpg" WIDTH="20" HEIGHT="20"></TD>
    </TR>
  </TABLE>
</TD></TR>

<TR><TD>
&nbsp;
<P>

  <H1>Chapter 8. Taming TextBoxes</H1>
Visual Basic's TextBox control provides many useful features including copy, cut, and paste, scroll bars, 
and multiline text entry. The RichTextBox control provides even more features including the ability to 
display multiple fonts and character styles in a single piece of text. This chapter explains ways you 
can get even more out of the TextBox and RichTextBox controls.
<P>
&lt;Text omitted&gt;
<P>
<H2>66. Make a RichTextBox Editor ***</H2>
The RichTextBox control is an enhanced TextBox that provides many additional formatting features. 
Example program RichEdit uses a RichTextBox control to implement a simple text editor. It implements 
several standard menu items in addition to several text formatting commands.
<P>
<CENTER>
<IMG SRC="richedit.jpg"><BR>
<I>Program RichEdit.</I>
</CENTER>
<H3>How It Works</H3>
The three most interesting tasks performed by program RichEdit are protecting data, displaying a Most 
Recently Used (MRU) file list, and allowing the user to select fonts. These topics are described in 
the following sections.

<H4>Protecting Data</H4>

Any program that manages data must ensure that its data is safe. It cannot let the user accidentally 
lose changes that have been made to the data. When the user wants to exit, begin a new file, or load 
a different file, the program must ask if it should save the modified data first.
<P>
Program RichEdit uses the DataModified Boolean variable to keep track of whether the current data has 
been modified since it was loaded or last saved. 
<P>
Whenever the program's RichTextBox detects a change, its Change event handler invokes subroutine 
SetDataModified. This routine updates DataModified and sets the program's caption so it displays an 
asterisk if the data is modified. For instance, if the file's title is MyData.txt, the routine would
make the program's caption read "RichEdit*[MyData.txt]."
<P>

<TABLE BACKGROUND="computer_paper.jpg" WIDTH="100%">
  <TR><TD>
<PRE><FONT NAME="Courier New" POINT-SIZE="10" SIZE="2">Option Explicit

Private FileName As String  <FONT COLOR="#008000">' The full file name.</FONT>
Private FileTitle As String <FONT COLOR="#008000">' The file name without path.</FONT>

Private DataModified As Boolean

Private Sub rchEditor_Change()
    SetDataChanged True
End Sub

<FONT COLOR="#008000">' Set DataModified. Display an asterisk in the
' form's Caption next to the file name if
' appropriate.</FONT>
Private Sub SetDataModified(changed As Boolean)
    <FONT COLOR="#008000">' Don't bother if it's already been done.</FONT>
    If DataModified = changed Then Exit Sub

    DataModified = changed
    If changed Then
        Caption = "RichEdit*[" & FileTitle & "]"
    Else
        Caption = "RichEdit [" & FileTitle & "]"
    End If
End Sub</FONT></PRE></TT></TD></TR>
</TABLE>

<P>
When the user wants to exit, load a different file, or start a new file, the program calls the DataSafe 
function. This function returns True if it is safe to remove the old data.
<P>
DataSafe begins by checking the value of DataModified. If DataModified is False, the current data has 
not been modified so it can safely be discarded. DataSafe returns True to indicate that it is safe to 
proceed with the operation that will remove the current data.
<P>
If the data has been modified, DataSafe warns the user and asks if it should save the changes. If the 
user clicks the No button, the user does not want to save the data so it is safe to discard. DataSafe returns True.
<P>
If the user clicks the Cancel button, the user has decided not to continue with the operation that would 
remove the current data. DataSafe returns False to tell the calling routine that it is not safe to remove 
the current data.
<P>
Finally, if the user clicks the Yes button, the user wants to save the data. DataSafe invokes the 
mnuFileSave_Click event handler just as if the user had selected the Save menu item from the File menu. 
This routine saves the modified data, prompting the user for a file name if necessary. If the save succeeds, 
the program sets DataModified to False. DataSafe sets its return value to Not DataModified. This tells the 
calling routine that the data is safe if the data was properly saved.
<P>

<TABLE BACKGROUND="computer_paper.jpg" WIDTH="100%">
  <TR><TD>
<PRE><FONT NAME="Courier New" POINT-SIZE="10" SIZE="2"><FONT COLOR="#008000">' Return True if the data is safe.</FONT>
Private Function DataSafe() As Boolean
    <FONT COLOR="#008000">' No problem if the data is unmodified.</FONT>
    If Not DataModified Then
        DataSafe = True
        Exit Function
    End If

    <FONT COLOR="#008000">' See if the user wants to save changes.</FONT>
    Select Case MsgBox("The data has been modified. " & _
            Do you want to save the changes?", vbYesNoCancel)
        Case vbYes
            <FONT COLOR="#008000">' Save the data. Procedure SaveData
            ' will reset DataModified.</FONT>
            mnuFileSave_Click
            DataSafe = Not DataModified

        Case vbNo
            <FONT COLOR="#008000">' Discard the changes to the data.</FONT>
            DataSafe = True

        Case vbCancel
            <FONT COLOR="#008000">' Cancel.</FONT>
            DataSafe = False
    End Select
End Function</FONT></PRE></TT></TD></TR>
</TABLE>

<P>
The RichTextBox's Change event handler calls SetDataModified to mark the data as modified. 
The program also calls SetDataModified when the data is freshly loaded or created and it has 
not yet been modified. For instance, the following code executes when the user selects the File
menu's New command. It first verifies that the current data is safe. It then blanks the text 
document and the file name and calls SetDataModified to indicate that the data has not been modified yet.
<P>

<TABLE BACKGROUND="computer_paper.jpg" WIDTH="100%">
  <TR><TD>
<PRE><FONT NAME="Courier New" POINT-SIZE="10" SIZE="2"><FONT COLOR="#008000">' Start a new file.</FONT>
Private Sub mnuFileNew_Click()
    <FONT COLOR="#008000">' Make sure the existing data is safe.</FONT>
    If Not DataSafe Then Exit Sub

    <FONT COLOR="#008000">' Start a new document.</FONT>
    rchEditor.Text = ""

    <FONT COLOR="#008000">' Save the file name and title.</FONT>
    FileTitle = ""
    FileName = ""

    <FONT COLOR="#008000">' Make sure the caption gets updated.</FONT>
    DataModified = True
    SetDataModified False
End Sub</FONT></PRE></TT></TD></TR>
</TABLE>

<P>
This technique is quite flexible and is useful in any program that allows the user to modify data.
<H4>MRU List</H4>
Most recently used (MRU) file lists have become standard on commercial applications. 
As Figure 8.1 shows, Program RichEdit displays the last four files it accessed in its MRU list.
<CENTER>
<IMG SRC="riched2.jpg">
<BR>
<I>Figure 8.1 Example program RichEdit uses a four-item MRU list.</I>
</CENTER>
<P>
Program RichEdit uses three routines to manage its MRU list. LoadMRUList loads the list from the 
system registry. DisplayMRUList updates the menu items in the program's File menu to display the 
MRU choices. SaveFileName adds a name to the MRU list in the File menu and updates the registry.
<P>
When the program starts, it calls subroutine LoadMRUList to load the MRU file names from the Registry. 
The file names are stored in the Registry in the RichEdit section, MRUList subsection. The files' names 
are stored in keys named Name1, Name2, Name3, and Name4. The files' names without path information are 
stored in the keys Title1, Title2, Title3, and Title4. Subroutine LoadMRUList uses Visual Basic's 
GetSetting statement to read the file names and titles and store them in the MRUName and MRUTitle 
collections. It then calls DisplayMRUList to update the File menu.
<P>

<TABLE BACKGROUND="computer_paper.jpg" WIDTH="100%">
  <TR><TD>
<PRE><FONT NAME="Courier New" POINT-SIZE="10" SIZE="2"><FONT COLOR="#008000">' The MRU list.</FONT>
Private MRUName As Collection
Private MRUTitle As Collection

<FONT COLOR="#008000">' Load the MRU list.</FONT>
Private Sub LoadMRUList()
Dim i As Integer
Dim file_title As String
Dim file_name As String

    <FONT COLOR="#008000">' Load the saved entries.</FONT>
    Set MRUName = New Collection
    Set MRUTitle = New Collection
    For i = 1 To 4
        file_name = GetSetting("RichEdit", _
            "MRUList", "Name" & Format$(i), "")
        If Len(file_name) &gt; 0 Then
            file_title = GetSetting("RichEdit", _
                "MRUList", "Title" & Format$(i), "")
            MRUTitle.Add file_title
            MRUName.Add file_name
        End If
    Next i

    <FONT COLOR="#008000">' Display the MRU items.</FONT>
    DisplayMRUList
End Sub</FONT></PRE></TT></TD></TR>
</TABLE>

<P>
Program RichEdit's File menu contains five menu items that initially have their Visible properties 
set to False. These items come just before the menu's Exit command. The first four are all named 
mnuFileMRUItem and have Index properties 1, 2, 3, and 4. This is where the MRU file names will be displayed.
<P>
The fifth menu item is named mnuFileMRUSep. Its Caption property is set to a dash (-) so it displays 
as a separator in the menu. This is the separator that lies between the MRU file names and the Exit 
command in the menu.
<P>
Subroutine DisplayMRUList examines the strings in the MRUName and MRUTitle collections. For each 
nonblank entry, it sets the caption of one of the mnuFileMRUItem menu items and makes that item visible. 
It sets the Visible property for the other MRU menu items to False so they are not displayed.
<P>

<TABLE BACKGROUND="computer_paper.jpg" WIDTH="100%">
  <TR><TD>
<PRE><FONT NAME="Courier New" POINT-SIZE="10" SIZE="2"><FONT COLOR="#008000">' Display the MRU list.</FONT>
Private Sub DisplayMRUList()
Dim i As Integer

    <FONT COLOR="#008000">' Load the used entries.</FONT>
    For i = 1 To 4
        If i &gt; MRUName.Count Then Exit For
        mnuFileMRUItem(i).Caption = "&" & _
            Format$(i) & " " & MRUTitle(i)
        mnuFileMRUItem(i).Visible = True
    Next i

    <FONT COLOR="#008000">' Hide unneeded entries.</FONT>
    For i = MRUName.Count + 1 To 4
        mnuFileMRUItem(i).Visible = False
    Next i

    <FONT COLOR="#008000">' Show the separator if necessary.</FONT>
    mnuFileMRUSep.Visible = (MRUName.Count &gt; 0)
End Sub</FONT></PRE></TT></TD></TR>
</TABLE>

<P>
When the user saves a file with a new name or opens a file, the program calls subroutine SaveFileName. 
This routine records the file's name and title in the FileName and FileTitle variables. It then searches 
the MRUName and MRUTitle collections to see if the file is already in the MRU file list. If it is, the 
routine removes it from the collections so that it will not appear twice when it is added again.
<P>
SaveFileName then inserts the new file title at the beginning of the MRU collections. This puts the file 
at the top of the MRU list. If the list contains more than four items, the program removes the last one. 
This item will not appear on the MRU list anyway because subroutine DisplayMRUList considers at most four 
files, but removing this item prevents the MRU collections from becoming cluttered.
<P>
Next, SaveFileName uses Visual Basic's SaveSetting command to save the new MRU list in the Registry. 
Finally, the routine invokes DisplayMRUList to update the items in the program's File menu.
<P>

<TABLE BACKGROUND="computer_paper.jpg" WIDTH="100%">
  <TR><TD>
<PRE><FONT NAME="Courier New" POINT-SIZE="10" SIZE="2"><FONT COLOR="#008000">' Save the file name and title. Update the MRU list.</FONT>
Private Sub SaveFileName(ByVal fname As String, _
    ByVal ftitle As String)
Dim i As Integer

    FileTitle = ftitle
    FileName = fname

    <FONT COLOR="#008000">' See if the file is already in the MRU list.</FONT>
    For i = 1 To 4
        If i &gt; MRUName.Count Then Exit For
        If LCase$(MRUName(i)) = LCase$(fname) Then
            <FONT COLOR="#008000">' It is here. Remove it.</FONT>
            MRUName.Remove i
            MRUTitle.Remove i
            Exit For
        End If
    Next i

    <FONT COLOR="#008000">' Add the file at the top of the list.</FONT>
    If MRUName.Count &gt; 0 Then
        MRUName.Add fname, , 1
        MRUTitle.Add ftitle, , 1
    Else
        MRUName.Add fname
        MRUTitle.Add ftitle
    End If

    <FONT COLOR="#008000">' If there are more than 4 files in the
    ' collections, remove the last one.</FONT>
    If MRUName.Count &gt; 4 Then
        MRUName.Remove 5
        MRUTitle.Remove 5
    End If

    <FONT COLOR="#008000">' Save the modified MRU list.</FONT>
    For i = 1 To 4
        If i &gt; MRUName.Count Then
            fname = ""
            ftitle = ""
        Else
            fname = MRUName(i)
            ftitle = MRUTitle(i)
        End If
        SaveSetting "RichEdit", "MRUList", _
            "Name" & Format$(i), fname
        SaveSetting "RichEdit", "MRUList", _
            "Title" & Format$(i), ftitle
    Next i

    <FONT COLOR="#008000">' Redisplay the MRU items.</FONT>
    DisplayMRUList
End Sub</FONT></PRE></TT></TD></TR>
</TABLE>

<P>
A few commercial applications provide a configuration dialog that allows the user to specify the number 
of items that should be displayed in the MRU list. This feature is not widely implemented, but you could 
modify the code presented here to implement it if you like. While this feature does not seem to be turning 
into a standard, it does not hurt because the program can default to the more typical four-item MRU list 
until the user changes it.
<H4>Formatting Fonts</H4>
The RichTextBox control provides several properties that affect the appearance of the text it displays. 
The SelBold, SelItalic, SelStrikethru, and SelUnderline properties are Boolean values that determine 
whether the selected text has a <B>bold</B>, <I>italic</I>, <STRIKE>strike through</STRIKE>, or <U>underlined</U> 
style. The RichEdit program provides simple menu entries to let the user change these values.
<P>
When the user opens the program's Font menu, its mnuFormat_Click event handler executes. 
This routine examines the properties of the currently selected text and places check marks 
beside the appropriate menu items. For instance, if the selected text is bold, the event 
handler checks the Bold menu item. To checking these values easier, the routine uses function FontAttributeValue.
<P>
FontAttributeValue determines whether a property value is Null and returns a default value 
if it is. The RichTextBox control returns Null for a property value if it is ambiguous. 
For instance, if the user selects two words, only one of which is bold, the control's SelBold 
property is Null. In that case the program leaves the Bold menu item unchecked.
<P>

<TABLE BACKGROUND="computer_paper.jpg" WIDTH="100%">
  <TR><TD>
<PRE><FONT NAME="Courier New" POINT-SIZE="10" SIZE="2"><FONT COLOR="#008000">' Get the proper settings.</FONT>
Private Sub mnuFormat_Click()
    mnuFormatBold.Checked = _
        FontAttributeValue(rchEditor.SelBold, False)
    mnuFormatItalic.Checked = _
        FontAttributeValue(rchEditor.SelItalic, False)
    mnuFormatUnderline.Checked = _
        FontAttributeValue(rchEditor.SelUnderline, False)
    mnuFormatStrikethrough.Checked = _
        FontAttributeValue(rchEditor.SelStrikethru, False)
End Sub

<FONT COLOR="#008000">' Return a font attribute value. Return the default
' if the value is Null.</FONT>
Private Function FontAttributeValue( _
    ByVal attr_value As Variant, _
    ByVal default As Variant) As Variant

    If IsNull(attr_value) Then
        FontAttributeValue = default
    Else
        FontAttributeValue = attr_value
    End If
End Function</FONT></PRE></TT></TD></TR>
</TABLE>

<P>
When the user selects one of these menu items, the program sets the selected text's property 
to the opposite of the value displayed by the corresponding menu. For instance, if the Italic 
command is marked in the menu, the selected text is currently italicized. If the user selects 
this menu item, the program switches the text to nonitalic.
<P>

<TABLE BACKGROUND="computer_paper.jpg" WIDTH="100%">
  <TR><TD>
<PRE><FONT NAME="Courier New" POINT-SIZE="10" SIZE="2">Private Sub mnuFormatItalic_Click()
    rchEditor.SelItalic = Not mnuFormatItalic.Checked
End Sub</FONT></PRE></TT></TD></TR>
</TABLE>

<P>
The RichTextBox control also allows the user to specify different fonts and font sizes for 
the selected text. The program's Font command in the Font menu presents the Common Dialog 
control's font selection dialog. It initializes the dialog's font properties using the selected 
text's values. If the user clicks the dialog's OK button, the program applies the new properties to the text.
<P>

<TABLE BACKGROUND="computer_paper.jpg" WIDTH="100%">
  <TR><TD>
<PRE><FONT NAME="Courier New" POINT-SIZE="10" SIZE="2"><FONT COLOR="#008000">' Let the user select new font characteristics.</FONT>
Private Sub mnuFormatFont_Click()
    <FONT COLOR="#008000">' Set the font attributes.</FONT>
    dlgFont.FontBold = _
        FontAttributeValue(rchEditor.SelBold, False)
    dlgFont.FontItalic = _
        FontAttributeValue(rchEditor.SelItalic, False)
    dlgFont.FontUnderline = _
        FontAttributeValue(rchEditor.SelUnderline, False)
    dlgFont.FontStrikethru = _
        FontAttributeValue(rchEditor.SelStrikethru, False)
    dlgFont.FontName = _
        FontAttributeValue(rchEditor.SelFontName, "")
    dlgFont.FontSize = _
        FontAttributeValue(rchEditor.SelFontSize, 0)

    <FONT COLOR="#008000">' Let the user select the font attributes.</FONT>
    On Error Resume Next
    dlgFont.flags = cdlCFScreenFonts
    dlgFont.ShowFont
    If Err.Number = cdlCancel Then
        <FONT COLOR="#008000">' The user canceled.</FONT>
        Exit Sub
    ElseIf Err.Number &lt;&gt; 0 Then
        MsgBox "Error" & Str$(Err.Number) & _
            " selecting font." & _
            vbCrLf & Err.Description
        Exit Sub
    End If
    On Error GoTo 0

    <FONT COLOR="#008000">' Set the font.</FONT>
    rchEditor.SelBold = dlgFont.FontBold
    rchEditor.SelItalic = dlgFont.FontItalic
    rchEditor.SelUnderline = dlgFont.FontUnderline
    rchEditor.SelStrikethru = dlgFont.FontStrikethru
    rchEditor.SelFontName = dlgFont.FontName
    rchEditor.SelFontSize = dlgFont.FontSize
End Sub</FONT></PRE></TT></TD></TR>
</TABLE>

<P>
The RichTextBox control provides other properties that let a program perform such tasks as justifying text, 
creating bulleted lists, and using hanging indentation. You can easily modify program RichEdit to provide
access to these features.
<P>
  <P>

<P>
&nbsp;
<P>
</TD></TR>

<TR><TD>
  <!-- Navigation menu -->
  <TABLE WIDTH="100%" BORDER="0" BGCOLOR="#7FE398" CELLSPACING="0" CELLPADDING="0">
    <!-- Top row -->
    <TR>
      <TD BGCOLOR="#7FE398" WIDTH="20"><IMG SRC="green_ul.jpg" WIDTH="20" HEIGHT="20"></TD>
      <TD WIDTH="100%" BACKGROUND="green_t.jpg">&nbsp;</TD>
      <TD BGCOLOR="#7FE398" WIDTH="20"><IMG SRC="green_ur.jpg" WIDTH="20" HEIGHT="20"></TD>
    </TR>

    <!-- Title row -->
    <TR>
      <TD BGCOLOR="#7FE398" WIDTH="20" BACKGROUND="green_l.jpg">&nbsp;</TD>
      <TD BGCOLOR="#7FE398" WIDTH="100%" ALIGN="Center"><B><FONT SIZE="+1" COLOR="#0000C0">Ready-to-Run Visual Basic Code Library: Sample Text</FONT></B></TD>
      <TD BGCOLOR="#7FE398" WIDTH="20" BACKGROUND="green_r.jpg">&nbsp;</TD>
    </TR>

    <!-- Menu entries -->
    <TR>
      <TD BGCOLOR="#E1F3FF" BACKGROUND="green_l.jpg" WIDTH="20">&nbsp;</TD>
      <TD BGCOLOR="#7FE398" WIDTH="100%" ALIGN="Center">
        <TABLE WIDTH="100%" BGCOLOR="#7FE398" BORDER="0" CELLPADDING="0" CELLSPACING="0">
          <TR>
            <TD WIDTH="33%" BGCOLOR="#7FE398" ALIGN="Center"><A HREF="vbcl.htm">Overview</A></TD>
            <TD WIDTH="33%" BGCOLOR="#7FE398" ALIGN="Center"><A HREF="vbcl_toc.html">Table of Contents</A></TD>
            <TD WIDTH="33%" BGCOLOR="#7FE398" ALIGN="Center"><B>Sample Text</B></TD>
          </TR>
          <TR>
            <TD WIDTH="33%" BGCOLOR="#7FE398" ALIGN="Center"><A HREF="vbcl_updates.html">Updates</A></TD>
            <TD WIDTH="33%" BGCOLOR="#7FE398" ALIGN="Center"><A HREF="http://www.amazon.com/exec/obidos/ASIN/047133345X/vbhelper/">Amazon.com</A></TD>
            <TD WIDTH="33%" BGCOLOR="#7FE398" ALIGN="Center"><A HREF="http://www.amazon.co.uk/exec/obidos/ASIN/047133345X/vbhelper0e/">Amazon.co.uk</A></TD>
          </TR>

        </TABLE>
      </TD>
      <TD BGCOLOR="#E1F3FF" BACKGROUND="green_r.jpg" WIDTH="20">&nbsp;</TD>
    </TR>


    <!-- Bottom row -->
    <TR>
      <TD BGCOLOR="#7FE398" WIDTH="20"><IMG SRC="green_ll.jpg" WIDTH="20" HEIGHT="20"></TD>
      <TD WIDTH="100%" BACKGROUND="green_b.jpg" ALIGN="Center">&nbsp;</TD>
      <TD BGCOLOR="#7FE398" WIDTH="20"><IMG SRC="green_lr.jpg" WIDTH="20" HEIGHT="20"></TD>
    </TR>
  </TABLE>
&nbsp;
<P>
</TD></TR>

            </TABLE> <!-- End content table -->
          </TD>
        </TR> <!-- End row containing menu column and content -->
      </TABLE> <!-- End table containing menu column and content -->
    </TD></TR>

    <!-- ****** -->
    <!-- Footer -->
    <!-- ****** -->
    <TR><TD WIDTH="100%">
      <TABLE WIDTH="100%" BORDER="0" BGCOLOR="#87CEFA" CELLSPACING="0" CELLPADDING="0">
        <!-- Top row -->
        <TR>
          <TD BGCOLOR="#E1F3FF" ALIGN="Right" WIDTH="16"><IMG SRC="blue_ul.jpg" WIDTH="16" HEIGHT="16"></TD>
          <TD BACKGROUND="blue_um.jpg" COLSPAN="2" ALIGN="Center"><FONT SIZE="-2">
            Copyright &copy; 1997-2001 Rocky Mountain Computer Consulting, Inc. &nbsp; All rights reserved.
          </FONT></TD>
          <TD BGCOLOR="#E1F3FF"><IMG SRC="blue_ur.jpg" WIDTH="16" HEIGHT="16"></TD>
        </TR>

        <!-- Bottom row -->
        <TR>
          <TD BGCOLOR="#E1F3FF" ALIGN="Right" WIDTH="16"><IMG SRC="blue_ll.jpg" WIDTH="16" HEIGHT="16"></TD>
          <TD BACKGROUND="blue_lm.jpg"><FONT SIZE="-2">
            &nbsp;<SCRIPT LANGUAGE=JavaScript>document.write(document.URL)</SCRIPT></FONT></TD>
          <TD BACKGROUND="blue_lm.jpg" ALIGN="Right"><FONT SIZE="-2">
            Updated <SCRIPT LANGUAGE=JavaScript>document.write(document.lastModified)</SCRIPT> &nbsp;
          </FONT></TD>
          <TD BGCOLOR="#E1F3FF"><IMG SRC="blue_lr.jpg" WIDTH="16" HEIGHT="16"></TD>
        </TR>
      </TABLE>
    </TD></TR>
  </TABLE> <!-- End table containing banner, menu column + content, and footer -->

</BODY>
</HTML>
