ID=F0005
URL=http://www.vbsquare.com/registry/tip471.html
SIZE=55334
DATE=09/07/2002
TIME=13:11:42
DATASET=Visual Basic
HTML=<html>
<head>
<title>VB Square - Using the Registry - W2K Registry Hack</title>
<meta name="keywords" content=",,visual basic,vb,visual,basic,win32,vb4,vb5,vb6,visual basic,vb,visual,basic,win32,vb4,vb5,vb6">
<meta name="description" content="Those Nasty ole policy editors are back with NT5 (W2K) in force.  Shove this code in a EXE project and run it.  It will restore your use of the RegEdit.exe Program so you can hurt yourself with W2K. ">
<STYLE type=text/css>
.blfont {
  COLOR: #007F00;
}
.redfont {
  COLOR: #cc0033;
}
.yllwfont {
  font-family: Verdana, Arial; 
  font-size: 11px;
  font-weight: bold;
  COLOR: #FFFF33;
}
.bluefont {
  COLOR: #007F00;
  font-family: Verdana, Arial; 
  font-size: 11px;
}
.navbit {
  font-family: Verdana, Geneva, Lucida, Arial; 
  font-size: 11px;
}
.whitefont {
  COLOR: #000000;
}
A:hover {
  COLOR: #ff0000;
}
A:link {
  COLOR: #0000FF;
}
</STYLE>
</head>
<body background="/images/bground.gif" bgcolor="#ffffff" text="#000000">
<!-- Start Header -->
<a name="top"></a>

<!-- Start Branding Table -->
<table border="0" cellPadding="0" cellSpacing="0" width="100%"><TBODY>
<tr><td width="110" valign="top">
<a href="/"><img src="/images/vbsquare.gif" width="90" height="64" border="0"></a>
<img src="/images/clear.gif" height="1" width="110"></td>
<td width="4"><img src="/images/clear.gif" height="1" width="4"></td>
<td width="100%" valign="top">

<!-- Begin Adslot1 -->
<!-- $ adslot1 -->
<!-- End Adslot1 -->

</td></tr>
</tbody></table>
<!-- End Branding Table -->

<!-- Start Content Table -->

<table border="0" cellPadding="0" cellSpacing="0" width="100%">
<TBODY>
<tr><td width="110" valign="top">

<!-- Start left nav bar -->
<FONT SIZE="-1" FACE="verdana, arial, helvetica">

<p align="left"><font color="#FFFF33" class=yllwfont><b>Topic Areas</b></font><br>
<a href="/activex/"><font color="#99CCFF" class=bluefont>ActiveX</font></a><br>
<a href="/api/"><font color="#99CCFF" class=bluefont>API</font></a><br>
<a href="/beginning/"><font color="#99CCFF" class=bluefont>Beginning</font></a><br>
<a href="/controls/"><font color="#99CCFF" class=bluefont>Controls/Forms</font></a><br>
<a href="/databases/"><font color="#99CCFF" class=bluefont>Databases</font></a><br>
<a href="/files/"><font color="#99CCFF" class=bluefont>File/Directory</font></a><br>
<a href="/graphics/"><font color="#99CCFF" class=bluefont>Graphics</font></a><br>
<a href="/internet/"><font color="#99CCFF" class=bluefont>Internet</font></a><br>
<a href="/misc/"><font color="#99CCFF" class=bluefont>Miscellaneous</font></a><br>
<a href="/mouse/"><font color="#99CCFF" class=bluefont>Mouse/Keyboard</font></a><br>
<a href="/registry/"><font color="#99CCFF" class=bluefont>Registry</font></a></p>

<p align="left"><font color="#FFFF33" class=yllwfont><b>Contents</b></font><br>
<a href="/articles/"><font color="#99CCFF" class=bluefont>Articles</font></a><br>
<a href="/tips/"><font color="#99CCFF" class=bluefont>Tips</font></a><br>
<a href="/demos/"><font color="#99CCFF" class=bluefont>Demo Projects</font></a><br>
<a href="/books/"><font color="#99CCFF" class=bluefont>Books</font></a><br>

<p><font color="#FFFF33" class=yllwfont><b>Resources</b></font><br>
<a href="http://www.vbforums.com/?styleid=3"><font color="#99CCFF" class=bluefont>Q and A</font></a><br>
<a href="http://www.vbworld.com/news/"><font color="#99CCFF" class=bluefont>Tech News</font></a><br>
<a href="/newsletters/"><font color="#99CCFF" class=bluefont>Newsletters</font></a><br>
<a href="/php-bin/contactus.php"><font color="#99CCFF" class=bluefont>Contact Us</font></a><br>

</font>
<!-- end left nav bar -->

    <img src="/images/clear.gif" height="1" width="110">
    </td></td>
    <td width="4"><img src="/images/clear.gif" height="1" width="4"></td>
    <td width="100%" valign="top">
    <!-- Start Main page content -->

<!-- End Header -->
<!-- Breadcrumb -->
<table border="0" cellPadding="3" cellSpacing="0" width="100%">
<TBODY><tr>
<td align="left" bgColor="#FFCC00" vAlign="top" width="100%">
<font FACE="Verdana, Arial, Helvetica" SIZE="2">
<b>&nbsp;&nbsp;
<a href="/"><FONT color=#ffffff class=whitefont>Home</font></a> 

<FONT color=#000000>&nbsp;&gt;</font> 
<a href="/registry/"><FONT color=#000000 class=whitefont>Using the Registry</font></a><FONT color=#000000>&nbsp;&gt;</font> 
<a href="/registry/tips.html"><FONT color=#000000 class=whitefont>Tips</font></a>

</b></font></td></tr>
</TBODY></table>

<table width="100%" border=0 cellspacing=0 cellpadding=0 bgcolor="#eeeeee"><tr align=center valign=middle>
<td width="25%" align="center" nowrap>
<FONT face="MS Sans Serif, Geneva" size=-2><a href="/tips/">Visual Basic Code</a></font>
</td><td width="50%" height=40 align=center nowrap>
<!-- Start Search box table -->
<table border=0 cellspacing=0 cellpadding=0 height=40 bgcolor="#EEEEEE">
<form method="GET" action="/php-bin/search.php">
<input type="hidden" name="searchview" value="priority">
<tr align=center valign=middle>
<td height=40 align=right nowrap>&nbsp;</td>
<td align=left nowrap><FONT face="MS Sans Serif, Geneva" size=-2><b>Search VB Square:</b></font></td>
<td height=40 align=right nowrap>&nbsp;</td>
<td align=left><input type="Text" name="query" size="18" maxlength="255"></td>
<td>&nbsp;<input type="submit" value="Go">&nbsp;</td>
</tr></form></table>
<!-- End search box table -->
</td><td width="25%">
<FONT face="MS Sans Serif, Geneva" size=-2><a href="/articles/">Detailed VB Articles</a></font>
</td></tr></table>

<!-- End Breadcrumb -->

<table border="0" cellPadding="0" cellSpacing="0" width="100%">
<TBODY>

<tr><td vAlign="top" width="100%">
<FONT SIZE="-1" FACE="verdana, arial, helvetica">
<br>
<p><font face="Arial, Helvetica" size="+1"><b>W2K Registry Hack</b></font></p>
<p><i>Tip by <a href="/php-bin/authorbio.php?authorid=48&associd=471&assoctype=3">Ronald Garlit</a></i></p>

<table border="0" width="100%" bgcolor="#FFCC00">
  <tr>
<td width="100%"><font face="Arial" size="2"><b>Tip description</b></font></td>  </tr>
</table>
<br>
<table border="1" width="100%" bordercolor="#FFFFFF">
  <tr>
<td width="100%" bordercolor="#000000"><font face="Arial" size="2">Those Nasty ole policy editors are back with NT5 (W2K) in force.  Shove this code in a EXE project and run it.  It will restore your use of the RegEdit.exe Program so you can hurt yourself with W2K. </font></td>  </tr>
</table><br>
<table border="0" width="100%" bgcolor="#FFCC00">
  <tr>
<td width="100%"><font face="Arial" size="2"><b>Tip Code</b></font></td>  </tr>
</table>
<br>
<table border="1" width="100%" bordercolor="#FFFFFF">
  <tr>
<td width="100%" bordercolor="#000000"><font face="arial" size="-1" ><p></font><pre>
‘Basic <font color="#00007F">Module</font> Code
<font color="#00007F">Option</font> <font color="#00007F">Explicit</font>
‘ <font color="#00007F">Module</font>      : modRegistry
‘ Description : This module Implements routines for manipulating the registry.

<font color="#00007F">Private</font> <font color="#00007F">Type</font> FILETIME
dwLowDateTime <font color="#00007F">As</font> <font color="#00007F">Long</font>
dwHighDateTime <font color="#00007F">As</font> <font color="#00007F">Long</font>
<font color="#00007F">End</font> <font color="#00007F">Type</font>

<font color="#00007F">Private</font> <font color="#00007F">Declare</font> <font color="#00007F">Function</font> RegCloseKey _
<font color="#00007F">Lib</font> “advapi32.dll” _
(<font color="#00007F">ByVal</font> lngHKey <font color="#00007F">As</font> <font color="#00007F">Long</font>) _
<font color="#00007F">As</font> <font color="#00007F">Long</font>

<font color="#00007F">Private</font> <font color="#00007F">Declare</font> <font color="#00007F">Function</font> RegCreateKeyEx _
<font color="#00007F">Lib</font> “advapi32.dll” _
<font color="#00007F">Alias</font> “RegCreateKeyExA” _
(<font color="#00007F">ByVal</font> lngHKey <font color="#00007F">As</font> <font color="#00007F">Long</font>, _
<font color="#00007F">ByVal</font> lpSubKey <font color="#00007F">As</font> <font color="#00007F">String</font>, _
<font color="#00007F">ByVal</font> Reserved <font color="#00007F">As</font> <font color="#00007F">Long</font>, _
<font color="#00007F">ByVal</font> lpClass <font color="#00007F">As</font> <font color="#00007F">String</font>, _
<font color="#00007F">ByVal</font> dwOptions <font color="#00007F">As</font> <font color="#00007F">Long</font>, _
<font color="#00007F">ByVal</font> samDesired <font color="#00007F">As</font> <font color="#00007F">Long</font>, _
<font color="#00007F">ByVal</font> lpSecurityAttributes <font color="#00007F">As</font> <font color="#00007F">Long</font>, _
phkResult <font color="#00007F">As</font> <font color="#00007F">Long</font>, _
lpdwDisposition <font color="#00007F">As</font> <font color="#00007F">Long</font>) _
<font color="#00007F">As</font> <font color="#00007F">Long</font>

<font color="#00007F">Private</font> <font color="#00007F">Declare</font> <font color="#00007F">Function</font> RegOpenKeyEx _
<font color="#00007F">Lib</font> “advapi32.dll” _
<font color="#00007F">Alias</font> “RegOpenKeyExA” _
(<font color="#00007F">ByVal</font> lngHKey <font color="#00007F">As</font> <font color="#00007F">Long</font>, _
<font color="#00007F">ByVal</font> lpSubKey <font color="#00007F">As</font> <font color="#00007F">String</font>, _
<font color="#00007F">ByVal</font> ulOptions <font color="#00007F">As</font> <font color="#00007F">Long</font>, _
<font color="#00007F">ByVal</font> samDesired <font color="#00007F">As</font> <font color="#00007F">Long</font>, _
phkResult <font color="#00007F">As</font> <font color="#00007F">Long</font>) _
<font color="#00007F">As</font> <font color="#00007F">Long</font>

<font color="#00007F">Private</font> <font color="#00007F">Declare</font> <font color="#00007F">Function</font> RegQueryValueExString _
<font color="#00007F">Lib</font> “advapi32.dll” _
<font color="#00007F">Alias</font> “RegQueryValueExA” _
(<font color="#00007F">ByVal</font> lngHKey <font color="#00007F">As</font> <font color="#00007F">Long</font>, _
<font color="#00007F">ByVal</font> lpValueName <font color="#00007F">As</font> <font color="#00007F">String</font>, _
<font color="#00007F">ByVal</font> lpReserved <font color="#00007F">As</font> <font color="#00007F">Long</font>, _
lpType <font color="#00007F">As</font> <font color="#00007F">Long</font>, _
<font color="#00007F">ByVal</font> lpData <font color="#00007F">As</font> <font color="#00007F">String</font>, _
lpcbData <font color="#00007F">As</font> <font color="#00007F">Long</font>) _
<font color="#00007F">As</font> <font color="#00007F">Long</font>

<font color="#00007F">Private</font> <font color="#00007F">Declare</font> <font color="#00007F">Function</font> RegQueryValueExLong _
<font color="#00007F">Lib</font> “advapi32.dll” _
<font color="#00007F">Alias</font> “RegQueryValueExA” _
(<font color="#00007F">ByVal</font> lngHKey <font color="#00007F">As</font> <font color="#00007F">Long</font>, _
<font color="#00007F">ByVal</font> lpValueName <font color="#00007F">As</font> <font color="#00007F">String</font>, _
<font color="#00007F">ByVal</font> lpReserved <font color="#00007F">As</font> <font color="#00007F">Long</font>, _
lpType <font color="#00007F">As</font> <font color="#00007F">Long</font>, _
lpData <font color="#00007F">As</font> <font color="#00007F">Long</font>, _
lpcbData <font color="#00007F">As</font> <font color="#00007F">Long</font>) _
<font color="#00007F">As</font> <font color="#00007F">Long</font>

<font color="#00007F">Private</font> <font color="#00007F">Declare</font> <font color="#00007F">Function</font> RegQueryValueExBinary _
<font color="#00007F">Lib</font> “advapi32.dll” _
<font color="#00007F">Alias</font> “RegQueryValueExA” _
(<font color="#00007F">ByVal</font> lngHKey <font color="#00007F">As</font> <font color="#00007F">Long</font>, _
<font color="#00007F">ByVal</font> lpValueName <font color="#00007F">As</font> <font color="#00007F">String</font>, _
<font color="#00007F">ByVal</font> lpReserved <font color="#00007F">As</font> <font color="#00007F">Long</font>, _
lpType <font color="#00007F">As</font> <font color="#00007F">Long</font>, _
<font color="#00007F">ByVal</font> lpData <font color="#00007F">As</font> <font color="#00007F">Long</font>, _
lpcbData <font color="#00007F">As</font> <font color="#00007F">Long</font>) _
<font color="#00007F">As</font> <font color="#00007F">Long</font>
  
<font color="#00007F">Private</font> <font color="#00007F">Declare</font> <font color="#00007F">Function</font> RegQueryValueExNULL _
<font color="#00007F">Lib</font> “advapi32.dll” _
<font color="#00007F">Alias</font> “RegQueryValueExA” _
(<font color="#00007F">ByVal</font> lngHKey <font color="#00007F">As</font> <font color="#00007F">Long</font>, _
<font color="#00007F">ByVal</font> lpValueName <font color="#00007F">As</font> <font color="#00007F">String</font>, _
<font color="#00007F">ByVal</font> lpReserved <font color="#00007F">As</font> <font color="#00007F">Long</font>, _
lpType <font color="#00007F">As</font> <font color="#00007F">Long</font>, _
<font color="#00007F">ByVal</font> lpData <font color="#00007F">As</font> <font color="#00007F">Long</font>, _
lpcbData <font color="#00007F">As</font> <font color="#00007F">Long</font>) _
<font color="#00007F">As</font> <font color="#00007F">Long</font>

<font color="#00007F">Private</font> <font color="#00007F">Declare</font> <font color="#00007F">Function</font> RegSetValueExString _
<font color="#00007F">Lib</font> “advapi32.dll” _
<font color="#00007F">Alias</font> “RegSetValueExA” _
(<font color="#00007F">ByVal</font> lngHKey <font color="#00007F">As</font> <font color="#00007F">Long</font>, _
<font color="#00007F">ByVal</font> lpValueName <font color="#00007F">As</font> <font color="#00007F">String</font>, _
<font color="#00007F">ByVal</font> Reserved <font color="#00007F">As</font> <font color="#00007F">Long</font>, _
<font color="#00007F">ByVal</font> dwType <font color="#00007F">As</font> <font color="#00007F">Long</font>, _
<font color="#00007F">ByVal</font> lpValue <font color="#00007F">As</font> <font color="#00007F">String</font>, _
<font color="#00007F">ByVal</font> cbData <font color="#00007F">As</font> <font color="#00007F">Long</font>) _
<font color="#00007F">As</font> <font color="#00007F">Long</font>

<font color="#00007F">Private</font> <font color="#00007F">Declare</font> <font color="#00007F">Function</font> RegSetValueExLong _
<font color="#00007F">Lib</font> “advapi32.dll” _
<font color="#00007F">Alias</font> “RegSetValueExA” _
(<font color="#00007F">ByVal</font> lngHKey <font color="#00007F">As</font> <font color="#00007F">Long</font>, _
<font color="#00007F">ByVal</font> lpValueName <font color="#00007F">As</font> <font color="#00007F">String</font>, _
<font color="#00007F">ByVal</font> Reserved <font color="#00007F">As</font> <font color="#00007F">Long</font>, _
<font color="#00007F">ByVal</font> dwType <font color="#00007F">As</font> <font color="#00007F">Long</font>, _
lpValue <font color="#00007F">As</font> <font color="#00007F">Long</font>, _
<font color="#00007F">ByVal</font> cbData <font color="#00007F">As</font> <font color="#00007F">Long</font>) _
<font color="#00007F">As</font> <font color="#00007F">Long</font>

<font color="#00007F">Private</font> <font color="#00007F">Declare</font> <font color="#00007F">Function</font> RegSetValueExBinary _
<font color="#00007F">Lib</font> “advapi32.dll” _
<font color="#00007F">Alias</font> “RegSetValueExA” _
(<font color="#00007F">ByVal</font> lngHKey <font color="#00007F">As</font> <font color="#00007F">Long</font>, _
<font color="#00007F">ByVal</font> lpValueName <font color="#00007F">As</font> <font color="#00007F">String</font>, _
<font color="#00007F">ByVal</font> Reserved <font color="#00007F">As</font> <font color="#00007F">Long</font>, _
<font color="#00007F">ByVal</font> dwType <font color="#00007F">As</font> <font color="#00007F">Long</font>, _
<font color="#00007F">ByVal</font> lpValue <font color="#00007F">As</font> <font color="#00007F">Long</font>, _
<font color="#00007F">ByVal</font> cbData <font color="#00007F">As</font> <font color="#00007F">Long</font>) _
<font color="#00007F">As</font> <font color="#00007F">Long</font>
  
<font color="#00007F">Private</font> <font color="#00007F">Declare</font> <font color="#00007F">Function</font> RegEnumKey _
<font color="#00007F">Lib</font> “advapi32.dll” _
<font color="#00007F">Alias</font> “RegEnumKeyA” _
(<font color="#00007F">ByVal</font> lngHKey <font color="#00007F">As</font> <font color="#00007F">Long</font>, _
<font color="#00007F">ByVal</font> dwIndex <font color="#00007F">As</font> <font color="#00007F">Long</font>, _
<font color="#00007F">ByVal</font> lpName <font color="#00007F">As</font> <font color="#00007F">String</font>, _
<font color="#00007F">ByVal</font> cbName <font color="#00007F">As</font> <font color="#00007F">Long</font>) _
<font color="#00007F">As</font> <font color="#00007F">Long</font>

<font color="#00007F">Private</font> <font color="#00007F">Declare</font> <font color="#00007F">Function</font> RegQueryInfoKey _
<font color="#00007F">Lib</font> “advapi32.dll” _
<font color="#00007F">Alias</font> “RegQueryInfoKeyA” _
(<font color="#00007F">ByVal</font> lngHKey <font color="#00007F">As</font> <font color="#00007F">Long</font>, _
<font color="#00007F">ByVal</font> lpClass <font color="#00007F">As</font> <font color="#00007F">String</font>, _
<font color="#00007F">ByVal</font> lpcbClass <font color="#00007F">As</font> <font color="#00007F">Long</font>, _
<font color="#00007F">ByVal</font> lpReserved <font color="#00007F">As</font> <font color="#00007F">Long</font>, _
lpcSubKeys <font color="#00007F">As</font> <font color="#00007F">Long</font>, _
lpcbMaxSubKeyLen <font color="#00007F">As</font> <font color="#00007F">Long</font>, _
<font color="#00007F">ByVal</font> lpcbMaxClassLen <font color="#00007F">As</font> <font color="#00007F">Long</font>, _
lpcValues <font color="#00007F">As</font> <font color="#00007F">Long</font>, _
lpcbMaxValueNameLen <font color="#00007F">As</font> <font color="#00007F">Long</font>, _
<font color="#00007F">ByVal</font> lpcbMaxValueLen <font color="#00007F">As</font> <font color="#00007F">Long</font>, _
<font color="#00007F">ByVal</font> lpcbSecurityDescriptor <font color="#00007F">As</font> <font color="#00007F">Long</font>, _
lpftLastWriteTime <font color="#00007F">As</font> FILETIME) _
<font color="#00007F">As</font> <font color="#00007F">Long</font>

<font color="#00007F">Private</font> <font color="#00007F">Declare</font> <font color="#00007F">Function</font> RegEnumValue _
<font color="#00007F">Lib</font> “advapi32.dll” _
<font color="#00007F">Alias</font> “RegEnumValueA” _
(<font color="#00007F">ByVal</font> lngHKey <font color="#00007F">As</font> <font color="#00007F">Long</font>, _
<font color="#00007F">ByVal</font> dwIndex <font color="#00007F">As</font> <font color="#00007F">Long</font>, _
<font color="#00007F">ByVal</font> lpValueName <font color="#00007F">As</font> <font color="#00007F">String</font>, _
lpcbValueName <font color="#00007F">As</font> <font color="#00007F">Long</font>, _
<font color="#00007F">ByVal</font> lpReserved <font color="#00007F">As</font> <font color="#00007F">Long</font>, _
<font color="#00007F">ByVal</font> lpType <font color="#00007F">As</font> <font color="#00007F">Long</font>, _
<font color="#00007F">ByVal</font> lpData <font color="#00007F">As</font> <font color="#00007F">Byte</font>, _
<font color="#00007F">ByVal</font> lpcbData <font color="#00007F">As</font> <font color="#00007F">Long</font>) _
<font color="#00007F">As</font> <font color="#00007F">Long</font>

<font color="#00007F">Private</font> <font color="#00007F">Declare</font> <font color="#00007F">Function</font> RegDeleteKey _
<font color="#00007F">Lib</font> “advapi32.dll” _
<font color="#00007F">Alias</font> “RegDeleteKeyA” _
(<font color="#00007F">ByVal</font> lngHKey <font color="#00007F">As</font> <font color="#00007F">Long</font>, _
<font color="#00007F">ByVal</font> lpSubKey <font color="#00007F">As</font> <font color="#00007F">String</font>) _
<font color="#00007F">As</font> <font color="#00007F">Long</font>
<font color="#00007F">Private</font> <font color="#00007F">Declare</font> <font color="#00007F">Function</font> RegDeleteValue _
<font color="#00007F">Lib</font> “advapi32.dll” _
<font color="#00007F">Alias</font> “RegDeleteValueA” _
(<font color="#00007F">ByVal</font> lngHKey <font color="#00007F">As</font> <font color="#00007F">Long</font>, _
<font color="#00007F">ByVal</font> lpValueName <font color="#00007F">As</font> <font color="#00007F">String</font>) _
<font color="#00007F">As</font> <font color="#00007F">Long</font>
<font color="#00007F">Public</font> Enum EnumRegistryRootKeys
rrkHKeyClassesRoot = &H80000000
rrkHKeyCurrentUser = &H80000001
rrkHKeyLocalMachine = &H80000002
rrkHKeyUsers = &H80000003
<font color="#00007F">End</font> Enum

<font color="#00007F">Public</font> Enum EnumRegistryValueType
rrkRegSZ = 1
rrkregBinary = 3
rrkRegDWord = 4
<font color="#00007F">End</font> Enum

<font color="#00007F">Private</font> <font color="#00007F">Const</font> mcregOptionNonVolatile = 0
<font color="#00007F">Private</font> <font color="#00007F">Const</font> mcregErrorNone = 0
<font color="#00007F">Private</font> <font color="#00007F">Const</font> mcregErrorBadDB = 1
<font color="#00007F">Private</font> <font color="#00007F">Const</font> mcregErrorBadKey = 2
<font color="#00007F">Private</font> <font color="#00007F">Const</font> mcregErrorCantOpen = 3
<font color="#00007F">Private</font> <font color="#00007F">Const</font> mcregErrorCantRead = 4
<font color="#00007F">Private</font> <font color="#00007F">Const</font> mcregErrorCantWrite = 5
<font color="#00007F">Private</font> <font color="#00007F">Const</font> mcregErrorOutOfMemory = 6
<font color="#00007F">Private</font> <font color="#00007F">Const</font> mcregErrorInvalidParameter = 7
<font color="#00007F">Private</font> <font color="#00007F">Const</font> mcregErrorAccessDenied = 8
<font color="#00007F">Private</font> <font color="#00007F">Const</font> mcregErrorInvalidParameterS = 87
<font color="#00007F">Private</font> <font color="#00007F">Const</font> mcregErrorNoMoreItems = 259

<font color="#00007F">Public</font> <font color="#00007F">Const</font> mcregSynchronize = &H100000

<font color="#00007F">Public</font> <font color="#00007F">Const</font> mcregKeyQueryValue = &H1
<font color="#00007F">Public</font> <font color="#00007F">Const</font> mcregKeySetValue = &H2
<font color="#00007F">Public</font> <font color="#00007F">Const</font> mcregKeyCreateSubKey = &H4
<font color="#00007F">Public</font> <font color="#00007F">Const</font> mcregKeyEnumerateSubKeys = &H8
<font color="#00007F">Public</font> <font color="#00007F">Const</font> mcregKeyCreateLink = &H20
<font color="#00007F">Public</font> <font color="#00007F">Const</font> mcregKeyNotify = &H10
<font color="#00007F">Public</font> <font color="#00007F">Const</font> mcregReadControl = &H20000
<font color="#00007F">Public</font> <font color="#00007F">Const</font> mcregStandardRightsAll = &H1F0000
<font color="#00007F">Public</font> <font color="#00007F">Const</font> mcregStandardRightsRead = (mcregReadControl)
<font color="#00007F">Public</font> <font color="#00007F">Const</font> mcregStandardRightsWrite = (mcregReadControl)

<font color="#00007F">Public</font> <font color="#00007F">Const</font> mcregKeyAllAccess = ((mcregStandardRightsAll <font color="#00007F">Or</font> mcregKeyQueryValue <font color="#00007F">Or</font> mcregKeySetValue <font color="#00007F">Or</font> mcregKeyCreateSubKey <font color="#00007F">Or</font> mcregKeyEnumerateSubKeys <font color="#00007F">Or</font> mcregKeyNotify <font color="#00007F">Or</font> mcregKeyCreateLink) <font color="#00007F">And</font> (<font color="#00007F">Not</font> mcregSynchronize))
<font color="#00007F">Public</font> <font color="#00007F">Const</font> mcregKeyRead = ((mcregStandardRightsRead <font color="#00007F">Or</font> mcregKeyQueryValue <font color="#00007F">Or</font> mcregKeyEnumerateSubKeys <font color="#00007F">Or</font> mcregKeyNotify) <font color="#00007F">And</font> (<font color="#00007F">Not</font> mcregSynchronize))
<font color="#00007F">Public</font> <font color="#00007F">Const</font> mcregKeyWrite = ((mcregStandardRightsWrite <font color="#00007F">Or</font> mcregKeySetValue <font color="#00007F">Or</font> mcregKeyCreateSubKey) <font color="#00007F">And</font> (<font color="#00007F">Not</font> mcregSynchronize))
<font color="#00007F">Public</font> <font color="#00007F">Sub</font> RegistryCreateNewKey( _
eRootKey <font color="#00007F">As</font> EnumRegistryRootKeys, _
strKeyName <font color="#00007F">As</font> <font color="#00007F">String</font>)
‘ Comments  : Creates a new key in the system registry
‘ Parameters: eRootKey - The root key
  ‘             strKeyName - The name of the key to create
  ‘ Returns   : Nothing
<font color="#00007F">Dim</font> lngRetVal <font color="#00007F">As</font> <font color="#00007F">Long</font>
<font color="#00007F">Dim</font> lngHKey <font color="#00007F">As</font> <font color="#00007F">Long</font>
    
<font color="#00007F">On</font> <font color="#00007F">Error</font> <font color="#00007F">GoTo</font> PROC_ERR
‘ Create the key
lngRetVal = RegCreateKeyEx(eRootKey, strKeyName, 0&, vbNullString, _
mcregOptionNonVolatile, mcregKeyWrite, 0&, lngHKey, 0&)
‘ if the key was created, then close it
<font color="#00007F">If</font> lngRetVal = mcregErrorNone <font color="#00007F">Then</font>
RegCloseKey (lngHKey)
<font color="#00007F">End</font> <font color="#00007F">If</font>
PROC_EXIT:
<font color="#00007F">Exit</font> <font color="#00007F">Sub</font>
PROC_ERR:
MsgBox “Error: “ & <font color="#00007F">Err</font>.Number & “. “ & <font color="#00007F">Err</font>.Description, , _
“RegistryCreateNewKey”
<font color="#00007F">Resume</font> PROC_EXIT
<font color="#00007F">End</font> <font color="#00007F">Sub</font>
<font color="#00007F">Public</font> <font color="#00007F">Sub</font> RegistryDeleteKey( _
eRootKey <font color="#00007F">As</font> EnumRegistryRootKeys, _
strKeyName <font color="#00007F">As</font> <font color="#00007F">String</font>)
‘ Comments  : Deletes a key from the system registry
‘ Parameters: eRootKey - The root key
  ‘             strKeyName - The name of the key to delete
  ‘ Returns   : Nothing
<font color="#00007F">Dim</font> lngRetVal <font color="#00007F">As</font> <font color="#00007F">Long</font>
<font color="#00007F">On</font> <font color="#00007F">Error</font> <font color="#00007F">GoTo</font> PROC_ERR
‘ Delete the key
lngRetVal = RegDeleteKey(eRootKey, strKeyName)
    
PROC_EXIT:
<font color="#00007F">Exit</font> <font color="#00007F">Sub</font>
PROC_ERR:
MsgBox “Error: “ & <font color="#00007F">Err</font>.Number & “. “ & <font color="#00007F">Err</font>.Description, , _
“RegistryDeleteKey”
<font color="#00007F">Resume</font> PROC_EXIT
<font color="#00007F">End</font> <font color="#00007F">Sub</font>
<font color="#00007F">Public</font> <font color="#00007F">Sub</font> RegistryDeleteValue( _
eRootKey <font color="#00007F">As</font> EnumRegistryRootKeys, _
strKeyName <font color="#00007F">As</font> <font color="#00007F">String</font>, _
strValueName <font color="#00007F">As</font> <font color="#00007F">String</font>)
‘ Comments  : Deletes a value from the system registry
‘ Parameters: eRootKey - The root key
  ‘             strKeyName - The name of the key to delete
  ‘             strValueName - The name of the value to delete
  ‘ Returns   : Nothing
<font color="#00007F">Dim</font> lngRetVal <font color="#00007F">As</font> <font color="#00007F">Long</font>
<font color="#00007F">Dim</font> lngHKey <font color="#00007F">As</font> <font color="#00007F">Long</font>

<font color="#00007F">On</font> <font color="#00007F">Error</font> <font color="#00007F">GoTo</font> PROC_ERR
‘ <font color="#00007F">Open</font> the key
lngRetVal = RegOpenKeyEx(eRootKey, strKeyName, 0, mcregKeyWrite, _
lngHKey)
‘ <font color="#00007F">If</font> the key was opened successfully, then delete it
<font color="#00007F">If</font> lngRetVal = mcregErrorNone <font color="#00007F">Then</font>
lngRetVal = RegDeleteValue(lngHKey, strValueName)
<font color="#00007F">End</font> <font color="#00007F">If</font>
PROC_EXIT:
<font color="#00007F">Exit</font> <font color="#00007F">Sub</font>
PROC_ERR:
MsgBox “Error: “ & <font color="#00007F">Err</font>.Number & “. “ & <font color="#00007F">Err</font>.Description, , _
“RegistryDeleteValue”
<font color="#00007F">Resume</font> PROC_EXIT
<font color="#00007F">End</font> <font color="#00007F">Sub</font>
<font color="#00007F">Public</font> <font color="#00007F">Sub</font> RegistryEnumerateSubKeys( _
eRootKey <font color="#00007F">As</font> EnumRegistryRootKeys, _
strKeyName <font color="#00007F">As</font> <font color="#00007F">String</font>, _
astrKeys() <font color="#00007F">As</font> <font color="#00007F">String</font>, _
lngKeyCount <font color="#00007F">As</font> <font color="#00007F">Long</font>)
‘ Comments  : Enumerates the sub keys of the specified key
‘ Parameters: eRootKey - The root key
  ‘             strKeyName - The name of the key to enumerate
  ‘             astrKeys - An array of strings to fill with sub key names
  ‘             lngKeyCount - The number of sub keys returned in the parameter
  ‘             astrKeys
  ‘ Returns   : Nothing
<font color="#00007F">Dim</font> lngRetVal <font color="#00007F">As</font> <font color="#00007F">Long</font>
<font color="#00007F">Dim</font> lngHKey <font color="#00007F">As</font> <font color="#00007F">Long</font>
<font color="#00007F">Dim</font> lngKeyIndex <font color="#00007F">As</font> <font color="#00007F">Long</font>
<font color="#00007F">Dim</font> strSubKeyName <font color="#00007F">As</font> <font color="#00007F">String</font>
<font color="#00007F">Dim</font> lngSubkeyCount <font color="#00007F">As</font> <font color="#00007F">Long</font>
<font color="#00007F">Dim</font> lngMaxKeyLen <font color="#00007F">As</font> <font color="#00007F">Long</font>
<font color="#00007F">Dim</font> typFT <font color="#00007F">As</font> FILETIME
  
<font color="#00007F">On</font> <font color="#00007F">Error</font> <font color="#00007F">GoTo</font> PROC_ERR
‘ <font color="#00007F">Open</font> the key
lngRetVal = RegOpenKeyEx(eRootKey, strKeyName, 0, mcregKeyRead, _
lngHKey)
<font color="#00007F">If</font> lngRetVal = mcregErrorNone <font color="#00007F">Then</font>
‘find the number of subkeys, and redim the return string array lngRetVal = RegQueryInfoKey(lngHKey, vbNullString, 0, 0, lngSubkeyCount, _ lngMaxKeyLen, 0, 0, 0, 0, 0, typFT)
<font color="#00007F">If</font> mcregErrorNone = lngRetVal <font color="#00007F">Then</font>
<font color="#00007F">If</font> lngSubkeyCount > 0 <font color="#00007F">Then</font>
<font color="#00007F">ReDim</font> astrKeys(lngSubkeyCount - 1) <font color="#00007F">As</font> <font color="#00007F">String</font>
‘set up the while loop
lngKeyIndex = 0
‘ Pad the string to the maximum length of a sub key, plus 1 for null
‘ termination
lngMaxKeyLen = lngMaxKeyLen + 1
strSubKeyName = <font color="#00007F">Space</font>$(lngMaxKeyLen)
        
<font color="#00007F">Do</font> <font color="#00007F">While</font> RegEnumKey(lngHKey, lngKeyIndex, strSubKeyName, lngMaxKeyLen + 1) = 0
‘ <font color="#00007F">Set</font> the string array to the key name, removing null termination
<font color="#00007F">If</font> <font color="#00007F">InStr</font>(1, strSubKeyName, vbNullChar) > 0 <font color="#00007F">Then</font>
astrKeys(lngKeyIndex) = <font color="#00007F">Left</font>$(strSubKeyName, <font color="#00007F">InStr</font>(1, strSubKeyName, _ vbNullChar) - 1)
<font color="#00007F">End</font> <font color="#00007F">If</font>
‘ Increment the key index for the return string array
lngKeyIndex = lngKeyIndex + 1
        
<font color="#00007F">Loop</font>
<font color="#00007F">End</font> <font color="#00007F">If</font>
‘ return the new dimension of the return string array
lngKeyCount = lngSubkeyCount
<font color="#00007F">End</font> <font color="#00007F">If</font>
    
‘ <font color="#00007F">Close</font> the key
RegCloseKey (lngHKey)
<font color="#00007F">End</font> <font color="#00007F">If</font>
PROC_EXIT:
<font color="#00007F">Exit</font> <font color="#00007F">Sub</font>
PROC_ERR:
MsgBox “Error: “ & <font color="#00007F">Err</font>.Number & “. “ & <font color="#00007F">Err</font>.Description, , _
“RegistryEnumerateSubKeys”
<font color="#00007F">Resume</font> PROC_EXIT
<font color="#00007F">End</font> <font color="#00007F">Sub</font>
<font color="#00007F">Public</font> <font color="#00007F">Sub</font> RegistryEnumerateValues( _
eRootKey <font color="#00007F">As</font> EnumRegistryRootKeys, _
strKeyName <font color="#00007F">As</font> <font color="#00007F">String</font>, _
astrValues() <font color="#00007F">As</font> <font color="#00007F">String</font>, _
lngValueCount <font color="#00007F">As</font> <font color="#00007F">Long</font>)
‘ Comments  : Enumerates the values of the specified key
‘ Parameters: eRootKey - The root key
  ‘             strKeyName - The name of the key to enumerate
  ‘             astrValues - An array of strings to fill with value names
  ‘             lngValueCount - The number of values returned in the parameter
  ‘             astrValues
  ‘ Returns   : Nothing
<font color="#00007F">Dim</font> lngRetVal <font color="#00007F">As</font> <font color="#00007F">Long</font>
<font color="#00007F">Dim</font> lngHKey <font color="#00007F">As</font> <font color="#00007F">Long</font>
<font color="#00007F">Dim</font> lngKeyIndex <font color="#00007F">As</font> <font color="#00007F">Long</font>
<font color="#00007F">Dim</font> strValueName <font color="#00007F">As</font> <font color="#00007F">String</font>
<font color="#00007F">Dim</font> lngTempValueCount <font color="#00007F">As</font> <font color="#00007F">Long</font>
<font color="#00007F">Dim</font> lngMaxValueLen <font color="#00007F">As</font> <font color="#00007F">Long</font>
<font color="#00007F">Dim</font> typFT <font color="#00007F">As</font> FILETIME
  
<font color="#00007F">On</font> <font color="#00007F">Error</font> <font color="#00007F">GoTo</font> PROC_ERR
‘ <font color="#00007F">Open</font> the key
lngRetVal = RegOpenKeyEx(eRootKey, strKeyName, 0, mcregKeyRead, _
lngHKey)
<font color="#00007F">If</font> lngRetVal = mcregErrorNone <font color="#00007F">Then</font>
‘find the number of subkeys, and redim the return string array
lngRetVal = RegQueryInfoKey(lngHKey, vbNullString, 0, 0, 0, _
0, 0, lngTempValueCount, lngMaxValueLen, 0, 0, typFT)
<font color="#00007F">If</font> mcregErrorNone = lngRetVal <font color="#00007F">Then</font>
<font color="#00007F">If</font> lngTempValueCount > 0 <font color="#00007F">Then</font>
<font color="#00007F">ReDim</font> astrValues(lngTempValueCount - 1) <font color="#00007F">As</font> <font color="#00007F">String</font>
‘set up the while loop
lngKeyIndex = 0
‘ Pad the string to the maximum length of a sub key, plus 1 for null
‘ termination
lngMaxValueLen = lngMaxValueLen + 1
strValueName = <font color="#00007F">Space</font>$(lngMaxValueLen)
        
<font color="#00007F">Do</font> <font color="#00007F">While</font> RegEnumValue(lngHKey, lngKeyIndex, strValueName, _
lngMaxValueLen + 1, 0, 0, 0, 0) = 0
        
‘ <font color="#00007F">Set</font> the string array to the key name, removing null termination
<font color="#00007F">If</font> <font color="#00007F">InStr</font>(1, strValueName, vbNullChar) > 0 <font color="#00007F">Then</font>
astrValues(lngKeyIndex) = <font color="#00007F">Left</font>$(strValueName, <font color="#00007F">InStr</font>(1, strValueName, _ vbNullChar) - 1)
<font color="#00007F">End</font> <font color="#00007F">If</font>
‘ Increment the key index for the return string array
lngKeyIndex = lngKeyIndex + 1
        
<font color="#00007F">Loop</font>
<font color="#00007F">End</font> <font color="#00007F">If</font>
‘ return the new dimension of the return string array
lngValueCount = lngTempValueCount
<font color="#00007F">End</font> <font color="#00007F">If</font>
    
‘ <font color="#00007F">Close</font> the key
RegCloseKey (lngHKey)
<font color="#00007F">End</font> <font color="#00007F">If</font>
PROC_EXIT:
<font color="#00007F">Exit</font> <font color="#00007F">Sub</font>
PROC_ERR:
MsgBox “Error: “ & <font color="#00007F">Err</font>.Number & “. “ & <font color="#00007F">Err</font>.Description, , _
“RegistryEnumerateValues”
<font color="#00007F">Resume</font> PROC_EXIT
<font color="#00007F">End</font> <font color="#00007F">Sub</font>
<font color="#00007F">Public</font> <font color="#00007F">Function</font> RegistryGetKeyValue( _
eRootKey <font color="#00007F">As</font> EnumRegistryRootKeys, _
strKeyName <font color="#00007F">As</font> <font color="#00007F">String</font>, _
strValueName <font color="#00007F">As</font> <font color="#00007F">String</font>) _
<font color="#00007F">As</font> <font color="#00007F">Variant</font>
‘ Comments  : Returns a value from the system registry
‘ Parameters: eRootKey - The root key
  ‘             strKeyName - The name of the key
  ‘             strValueName - The name of the value
  ‘ Returns   : The data in the registry value
<font color="#00007F">Dim</font> lngRetVal <font color="#00007F">As</font> <font color="#00007F">Long</font>
<font color="#00007F">Dim</font> lngHKey <font color="#00007F">As</font> <font color="#00007F">Long</font>
<font color="#00007F">Dim</font> varValue <font color="#00007F">As</font> <font color="#00007F">Variant</font>
<font color="#00007F">Dim</font> strValueData <font color="#00007F">As</font> <font color="#00007F">String</font>
<font color="#00007F">Dim</font> abytValueData() <font color="#00007F">As</font> <font color="#00007F">Byte</font>
<font color="#00007F">Dim</font> lngValueData <font color="#00007F">As</font> <font color="#00007F">Long</font>
<font color="#00007F">Dim</font> lngValueType <font color="#00007F">As</font> <font color="#00007F">Long</font>
<font color="#00007F">Dim</font> lngDataSize <font color="#00007F">As</font> <font color="#00007F">Long</font>
  
<font color="#00007F">On</font> <font color="#00007F">Error</font> <font color="#00007F">GoTo</font> PROC_ERR
varValue = Empty
lngRetVal = RegOpenKeyEx(eRootKey, strKeyName, 0&, mcregKeyRead, _
lngHKey)
<font color="#00007F">If</font> mcregErrorNone = lngRetVal <font color="#00007F">Then</font>
lngRetVal = RegQueryValueExNULL(lngHKey, strValueName, 0&, lngValueType, _ 0&, lngDataSize)
<font color="#00007F">If</font> lngRetVal = mcregErrorNone <font color="#00007F">Then</font>
<font color="#00007F">Select</font> <font color="#00007F">Case</font> lngValueType
‘ <font color="#00007F">String</font> type
<font color="#00007F">Case</font> rrkRegSZ:
<font color="#00007F">If</font> lngDataSize > 0 <font color="#00007F">Then</font>
strValueData = <font color="#00007F">String</font>(lngDataSize, 0)
lngRetVal = RegQueryValueExString(lngHKey, strValueName, 0&, _
lngValueType, strValueData, lngDataSize)
<font color="#00007F">If</font> <font color="#00007F">InStr</font>(strValueData, vbNullChar) > 0 <font color="#00007F">Then</font>
strValueData = <font color="#00007F">Mid</font>$(strValueData, 1, <font color="#00007F">InStr</font>(strValueData, _
vbNullChar) - 1)
<font color="#00007F">End</font> <font color="#00007F">If</font>
<font color="#00007F">End</font> <font color="#00007F">If</font>
<font color="#00007F">If</font> mcregErrorNone = lngRetVal <font color="#00007F">Then</font>
varValue = <font color="#00007F">Left</font>$(strValueData, lngDataSize)
<font color="#00007F">Else</font>
varValue = Empty
<font color="#00007F">End</font> <font color="#00007F">If</font>
‘ <font color="#00007F">Long</font> type
<font color="#00007F">Case</font> rrkRegDWord:
lngRetVal = RegQueryValueExLong(lngHKey, strValueName, 0&, _
lngValueType, lngValueData, lngDataSize)
<font color="#00007F">If</font> mcregErrorNone = lngRetVal <font color="#00007F">Then</font>
varValue = lngValueData
<font color="#00007F">End</font> <font color="#00007F">If</font>
‘ Binary type
<font color="#00007F">Case</font> rrkregBinary
<font color="#00007F">If</font> lngDataSize > 0 <font color="#00007F">Then</font>
<font color="#00007F">ReDim</font> abytValueData(lngDataSize - 1) <font color="#00007F">As</font> <font color="#00007F">Byte</font>
lngRetVal = RegQueryValueExBinary(lngHKey, strValueName, 0&, _
lngValueType, VarPtr(abytValueData(0)), lngDataSize)
<font color="#00007F">End</font> <font color="#00007F">If</font>
<font color="#00007F">If</font> mcregErrorNone = lngRetVal <font color="#00007F">Then</font>
varValue = abytValueData
<font color="#00007F">Else</font>
varValue = Empty
<font color="#00007F">End</font> <font color="#00007F">If</font>
<font color="#00007F">Case</font> <font color="#00007F">Else</font>
‘No other data types supported
lngRetVal = -1
        
<font color="#00007F">End</font> <font color="#00007F">Select</font>
<font color="#00007F">End</font> <font color="#00007F">If</font>
RegCloseKey (lngHKey)
<font color="#00007F">End</font> <font color="#00007F">If</font>
‘Return varValue
RegistryGetKeyValue = varValue
  
PROC_EXIT:
<font color="#00007F">Exit</font> <font color="#00007F">Function</font>
PROC_ERR:
MsgBox “Error: “ & <font color="#00007F">Err</font>.Number & “. “ & <font color="#00007F">Err</font>.Description, , _
“RegistryGetKeyValue”
<font color="#00007F">Resume</font> PROC_EXIT
<font color="#00007F">End</font> <font color="#00007F">Function</font>
<font color="#00007F">Public</font> <font color="#00007F">Sub</font> RegistrySetKeyValue( _
eRootKey <font color="#00007F">As</font> EnumRegistryRootKeys, _
strKeyName <font color="#00007F">As</font> <font color="#00007F">String</font>, _
strValueName <font color="#00007F">As</font> <font color="#00007F">String</font>, _
varData <font color="#00007F">As</font> <font color="#00007F">Variant</font>, _
eDataType <font color="#00007F">As</font> EnumRegistryValueType)
‘ Comments  : This procedure sets a key value
‘ Parameters: eRootKey - The root key
  ‘             strKeyName - The name of the key
  ‘             strValueName - The name of the value
  ‘             varData - The data to store in the value
  ‘             eDataType - The type of data to store in the value
  ‘ Returns   : Nothing
<font color="#00007F">Dim</font> lngRetVal <font color="#00007F">As</font> <font color="#00007F">Long</font>
<font color="#00007F">Dim</font> lngHKey <font color="#00007F">As</font> <font color="#00007F">Long</font>
<font color="#00007F">Dim</font> strData <font color="#00007F">As</font> <font color="#00007F">String</font>
<font color="#00007F">Dim</font> lngData <font color="#00007F">As</font> <font color="#00007F">Long</font>
<font color="#00007F">Dim</font> abytData() <font color="#00007F">As</font> <font color="#00007F">Byte</font>
    
<font color="#00007F">On</font> <font color="#00007F">Error</font> <font color="#00007F">GoTo</font> PROC_ERR
‘ <font color="#00007F">Open</font> the specified key, if it does not exist then create it
lngRetVal = RegCreateKeyEx(eRootKey, strKeyName, 0&, vbNullString, _
mcregOptionNonVolatile, mcregKeyRead <font color="#00007F">Or</font> mcregKeyWrite, 0&, lngHKey, 0&)
‘ Determine the data type of the key
<font color="#00007F">Select</font> <font color="#00007F">Case</font> eDataType
  
<font color="#00007F">Case</font> rrkRegSZ
strData = varData & vbNullChar lngRetVal = RegSetValueExString(lngHKey, strValueName, 0&, eDataType, _ strData, <font color="#00007F">Len</font>(strData))
<font color="#00007F">Case</font> rrkRegDWord
lngData = varData lngRetVal = RegSetValueExLong(lngHKey, strValueName, 0&, eDataType, _ lngData, <font color="#00007F">Len</font>(lngData))
‘ Binary type
<font color="#00007F">Case</font> rrkregBinary
abytData = varData lngRetVal = RegSetValueExBinary(lngHKey, strValueName, 0&, eDataType, _ VarPtr(abytData(0)), <font color="#00007F">UBound</font>(abytData) + 1)
<font color="#00007F">End</font> <font color="#00007F">Select</font>
RegCloseKey (lngHKey)
PROC_EXIT:
<font color="#00007F">Exit</font> <font color="#00007F">Sub</font>
PROC_ERR:
MsgBox “Error: “ & <font color="#00007F">Err</font>.Number & “. “ & <font color="#00007F">Err</font>.Description, , _
“RegistrySetKeyValue”
<font color="#00007F">Resume</font> PROC_EXIT
<font color="#00007F">End</font> <font color="#00007F">Sub</font>
</pre><FONT SIZE="-1" FACE="verdana, arial, helvetica">

<p></p>

</font><pre>
‘Form1 code
<font color="#00007F">Option</font> <font color="#00007F">Explicit</font>
<font color="#00007F">Dim</font> iTimeToChange <font color="#00007F">As</font> <font color="#00007F">Integer</font>

<font color="#00007F">Private</font> <font color="#00007F">Sub</font> Form_Load()
<font color="#00007F">Beep</font>
RegistryDeleteValue rrkHKeyCurrentUser, _
“SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System”, _
“DisableRegistryTools”
<font color="#00007F">Me</font>.BackColor = <font color="#00007F">RGB</font>(0, 255, 0)
<font color="#00007F">End</font> <font color="#00007F">Sub</font>
<font color="#00007F">Private</font> <font color="#00007F">Sub</font> Timer1_Timer()
iTimeToChange = iTimeToChange + 1
<font color="#00007F">If</font> iTimeToChange = 1 <font color="#00007F">Then</font>
Unload <font color="#00007F">Me</font>
<font color="#00007F">End</font> <font color="#00007F">If</font>
<font color="#00007F">End</font> <font color="#00007F">Sub</font>
</pre><FONT SIZE="-1" FACE="verdana, arial, helvetica"></p></font></td></tr></table>
<br>
<center><table border=0><tr>
<td><a href="/php-bin/feedback.php?action=viewtopics&associd=471&assoctype=3">
<img src="/images/fbicon1.gif" width="27" height="31" border="0"></a></td>
<td><a href="/php-bin/feedback.php?action=viewtopics&associd=471&assoctype=3"><FONT SIZE="-1" FACE="verdana, arial, helvetica"><a href="/php-bin/feedback.php?action=viewtopics&associd=471&assoctype=3"><b>Question, Query, Criticism?<br>Post your feedback now!</a></b> 0 comments.</font></td>
</tr></table></center>


</font>
</td>
<td width="8"><img src="/images/clear.gif" width="8"></td>
<td vAlign="top" width="125">
<br>

<!-- Start Related -->
<TABLE border=0 cellPadding=0 cellSpacing=0 width=125>
<TBODY><TR><TD bgColor=#FFCC00 vAlign=top width=125>
<CENTER><FONT face=arial,helvetica size=2>
<B>Related</B>
</FONT></CENTER>
</TD></TR></tbody></table>
<TABLE border=0 cellPadding=2 cellSpacing=0 width=125><TBODY>
<TR>
<TD vAlign=top width=5><FONT size=-2><b>-</b><FONT SIZE="-1" FACE="verdana, arial, helvetica"></TD>
<TD vAlign=center><font size="-1" class=navbit><A href="/registry/service/">Service your applications</A></font></TD>
</TR><TR>
<TD vAlign=top width=5><FONT size=-2><b>-</b><FONT SIZE="-1" FACE="verdana, arial, helvetica"></TD>
<TD vAlign=center><font size="-1" class=navbit><A href="/registry/regctl/">Create a registry control</A></font></TD>
</TR><TR>
<TD vAlign=top width=5><FONT size=-2><b>-</b><FONT SIZE="-1" FACE="verdana, arial, helvetica"></TD>
<TD vAlign=center><font size="-1" class=navbit><A href="/registry/tip471.html">W2K Registry Hack</A></font></TD>
</TR><TR>
<TD vAlign=top width=5><FONT size=-2><b>-</b><FONT SIZE="-1" FACE="verdana, arial, helvetica"></TD>
<TD vAlign=center><font size="-1" class=navbit><A href="/registry/tip239.html">Chaning the registered owner</A></font></TD>
</TR><TR>
<TD vAlign=top width=5><FONT size=-2><b>-</b><FONT SIZE="-1" FACE="verdana, arial, helvetica"></TD>
<TD vAlign=center><font size="-1" class=navbit><A href="/registry/tip237.html">Using the GetSetting and SaveSetting commands</A></font></TD>
</TR>
</TBODY></TABLE>
<br>
<!-- End Related -->
<!-- Start Options -->
<TABLE border=0 cellPadding=2 cellSpacing=0 width=125 bgcolor="#FFCC00"><TBODY>
<TR>
<TD vAlign=middle width=16><img src="/images/email_button.gif" width="16" height="16" border="0"></TD>
<TD vAlign=middle><font size="-1" class=navbit><A href="/php-bin/sendtofriend.php?subject=W2K+Registry+Hack">Email this page</A></font></TD>
</TR><TR>
<TD vAlign=middle width=16><img src="/images/print_button.gif" width="16" height="16" border="0"></TD>
<TD vAlign=middle><font size="-1" class=navbit><A href="/php-bin/printfriendly.php?tipid=471">Printer Friendly</A></font></TD>
</TR>
<TR>
<TD vAlign=middle width=16><img src="/images/more_button.gif" width="16" height="16" border="0"></TD>
<TD vAlign=middle><font size="-1" class=navbit><A href="/php-bin/authorbio.php?authorid=48&associd=471&assoctype=3">More From Ronald</A></font></TD>
</TR>
<TR>
<TD vAlign=middle width=16><img src="/images/feedback_button.gif" width="16" height="16" border="0"></TD>
<TD vAlign=middle><font size="-1" class=navbit><A href="/php-bin/feedback.php?action=viewtopics&associd=471&assoctype=3">Post Feedback</A></font></TD>
</TR>
</TBODY></TABLE>

<br>
<!-- End Options -->

<!-- Start Hot Picks -->
<TABLE border=0 cellPadding=0 cellSpacing=0 width=125>
<TBODY><TR><TD bgColor=#FFCC00 vAlign=top width=125>
<CENTER><FONT face=arial,helvetica size=2>
<B>Hot Picks</B>
</FONT></CENTER>
</TD></TR></tbody></table>
<TABLE border=0 cellPadding=2 cellSpacing=0 width=125><TBODY>
<TR>
<TD vAlign=top width=5><FONT size=-2><b>-</b><FONT SIZE="-1" FACE="verdana, arial, helvetica"></TD>
<TD vAlign=center><font size="-1" class=navbit><A href="/internet/inet1/">Using the inet control</A></font></TD>
</TR><TR>
<TD vAlign=top width=5><FONT size=-2><b>-</b><FONT SIZE="-1" FACE="verdana, arial, helvetica"></TD>
<TD vAlign=center><font size="-1" class=navbit><A href="/articles/graph/">Make a  Chart control!</A></font></TD>
</TR><TR>
<TD vAlign=top width=5><FONT size=-2><b>-</b><FONT SIZE="-1" FACE="verdana, arial, helvetica"></TD>
<TD vAlign=center><font size="-1" class=navbit><A href="/articles/diary/">Life of a VB programmer</A></font></TD>
</TR><TR>
<TD vAlign=top width=5><FONT size=-2><b>-</b><FONT SIZE="-1" FACE="verdana, arial, helvetica"></TD>
<TD vAlign=center><font size="-1" class=navbit><A href="/articles/wordobj1/">MS Object Models</A></font></TD>
</TR>
</TBODY></TABLE>
<br>
<!-- End Hot Picks -->
<!-- Start Newsletter -->
<TABLE bgColor=#FFCC00 border=0 cellPadding=2 cellSpacing=0 width=125>
<TBODY><tr><td vAlign=center width=100%>
<CENTER><FONT face=arial,helvetica size=2><B>Free Newsletter</b></font></center>
</td></tr><tr><td valign=center width=100%>
<table cellspacing="0" cellpadding="0" border=0>
<tr><td bgcolor="#FFCC00"><FORM action="http://inbound.postmastergeneral.com/cgi-bin/pmg_subscribe.pl" method=post><input type="TEXT" name="email_address" size="10" value="enter email">&nbsp;
</td><td valign="top" bgcolor="#FFCC00">
<input type="hidden" name="list" value="vbsquare">
<input type="SUBMIT" name="server_action:Subscribe" value="GO"></td>
</tr></form></table>
</td></TR></TBODY></TABLE><BR>
<!-- End Newsletter -->

<!-- Start Discuss -->
<TABLE border=0 cellPadding=0 cellSpacing=0 width=125>
<TBODY><TR><TD bgColor=#FFCC00 vAlign=top width=125>
<CENTER><FONT face=arial,helvetica size=2>
<B>Discuss</B>
</FONT></CENTER>
</TD></TR></tbody></table>
<TABLE border=0 cellPadding=2 cellSpacing=0 width=125><TBODY>
<TR>
<TD vAlign=top width=5><FONT size=-2><b>-</b><FONT SIZE="-1" FACE="verdana, arial, helvetica"></TD>
<TD vAlign=center><font size="-1" class=navbit><A href="http://www.vbforums.com/showthread.php?threadid=178817">Using Cd Drive Id To Open/close...</A></font></TD>
</TR><TR>
<TD vAlign=top width=5><FONT size=-2><b>-</b><FONT SIZE="-1" FACE="verdana, arial, helvetica"></TD>
<TD vAlign=center><font size="-1" class=navbit><A href="http://www.vbforums.com/showthread.php?threadid=178948">Create Table In Ado DB</A></font></TD>
</TR><TR>
<TD vAlign=top width=5><FONT size=-2><b>-</b><FONT SIZE="-1" FACE="verdana, arial, helvetica"></TD>
<TD vAlign=center><font size="-1" class=navbit><A href="http://www.vbforums.com/showthread.php?threadid=178986">Layout</A></font></TD>
</TR><TR>
<TD vAlign=top width=5><FONT size=-2><b>-</b><FONT SIZE="-1" FACE="verdana, arial, helvetica"></TD>
<TD vAlign=center><font size="-1" class=navbit><A href="http://www.vbforums.com/showthread.php?threadid=178776">Due Date</A></font></TD>
</TR><TR>
<TD vAlign=top width=5><FONT size=-2><b>-</b><FONT SIZE="-1" FACE="verdana, arial, helvetica"></TD>
<TD vAlign=center><font size="-1" class=navbit><A href="http://www.vbforums.com/showthread.php?threadid=178063">Automating Excel Spreadsheets...</A></font></TD>
</TR>
</TBODY></TABLE>
<br>
<!-- End Discuss -->

<img src="/images/clear.gif" width="125" height="1">

<!-- End Main Page Content -->
</td></tr></tbody></table>
</td></tr></tbody></table>

<!-- Start End Branding Table -->

<table border="0" cellPadding="0" cellSpacing="0" width="100%">
<TBODY><tr>
<td width="110"><img src="/images/clear.gif" width="110" height="1" border="0"></td>
<td width="4"><img src="/images/clear.gif" width="4" height="1" border="0"></td>
<td width="100%">
<TABLE bgColor=#ffffff border=0 cellPadding=0 cellSpacing=0 width="100%">
<TBODY><TR><TD bgColor="#FFCC00" width="100%">
<b><font FACE="Verdana, Arial, Helvetica" SIZE="-1">&nbsp;VB Square Today</font></b>
</td></tr><tr><td width=100%>
<font FACE="Verdana, Arial, Helvetica" SIZE="-1">
<a href="/activex/begobjects/">Beginning Objects in VB</a> - Learn all you ever wanted to know about objects in our weekly series.<br>
<a href="/internet/xml/index.html">Learn XML</a> - Catch up on this new technology as Sam Huggill reveals all.<br>
<a href="/internet/aspvb/">Using ASP with VB components</a> - Leverage your VB skills and use ASP to provide your data to a wider audience<br>
<a href="/articles/mcsd/">Is MCSD Worth It?</a> - Mack Male finds out just how much MCSD does for you as a programmer.<br>

</font>
</td></tr></tbody></table>
</td></tr></tbody></table>

<!-- End End Branding Table -->

<table border="0" cellPadding="0" cellSpacing="0" width="100%">
<TBODY><tr>
<td width="110" align="center"><img src="/images/clear.gif" width="110" height="1" border="0"><br><a href="#top"><img src="/images/gototop.gif" alt="Top" WIDTH="23" HEIGHT="21" BORDER="0"></a></td>
<td width="4"><img src="/images/clear.gif" width="4" height="1" border="0"></td>
<td width="100%">
<hr>
<p align="center"><font face="Verdana, Arial, Helvetica" size="-2">
Copyright &copy;1997-2001 Lighthouse Internet Solutions. All rights reserved. <a href="/privacy.html">Privacy Policy</a>.
</font></p>
</td></tr>
</tbody></table>

</body></html>
