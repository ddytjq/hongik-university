ID=F0100
URL=http://jadebox.dreamhost.com/vbprog/html/jpg_and_gif_sizes.html
SIZE=14210
DATE=09/07/2002
TIME=13:14:44
DATASET=Visual Basic
HTML=<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">

<HTML>
<HEAD>
<TITLE>Getting the Size of JPG and GIF Images</TITLE>
<meta name="keywords" content="Visual Basic,VB,VB5,VB6,Programming,Application,Development,Debug,Debugging,Basic,Metafiles,WMF,JPEG,JPG,GIF,Image,Images">

<META NAME="Generator" CONTENT="NetObjects Fusion 2.0.2 for Windows">

</HEAD>

<BODY BGCOLOR="#FFFFFF" LINK="#800000" VLINK="#808080" TEXT="#000000">
<TABLE CELLPADDING=0 CELLSPACING=0 BORDER=0 WIDTH=1329>
<TR VALIGN="top" ALIGN="left">
<TD>

  <TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH=98>
   <TR VALIGN="top" ALIGN="left">
	<TD WIDTH=2 HEIGHT =75><IMG SRC="../assets/auto_generated_images/img_3dfbb805.gif" WIDTH =2 HEIGHT =1 BORDER=0></TD>
	<TD WIDTH=96><IMG SRC="../assets/auto_generated_images/img_3dfbb805.gif" WIDTH =96 HEIGHT =1 BORDER=0></TD>
   </TR>
   <TR VALIGN="top" ALIGN="left">
	<TD HEIGHT =230></TD>
	<TD WIDTH=96>
	  <TABLE BORDER=0 CELLSPACING=0 CELLPADDING=3 >
	 <TR VALIGN="top" ALIGN="left">
		<TD WIDTH=90 HEIGHT=40><A HREF="../index.html"><IMG HEIGHT=40 WIDTH=90 SRC="../assets/auto_generated_images/img_49ab4036.gif"  BORDER=0  ALT=" Home " ></A></TD>
	 </TR>
	 <TR VALIGN="top" ALIGN="left">
		<TD WIDTH=90 HEIGHT=40><A HREF="../html/meta_files.html"><IMG HEIGHT=40 WIDTH=90 SRC="../assets/auto_generated_images/img_4a955d9fb.gif"  BORDER=0  ALT=" Meta Files " ></A></TD>
	 </TR>
	 <TR VALIGN="top" ALIGN="left">
		<TD WIDTH=90 HEIGHT=40><A HREF="../html/review__hardcore_visual_basic.html"><IMG HEIGHT=40 WIDTH=90 SRC="../assets/auto_generated_images/img_4c083bc1.gif"  BORDER=0  ALT=" Hardcore VB " ></A></TD>
	 </TR>
	 <TR VALIGN="top" ALIGN="left">
		<TD WIDTH=90 HEIGHT=40><A HREF="../html/what_s_wrong_with_vb_.html"><IMG HEIGHT=40 WIDTH=90 SRC="../assets/auto_generated_images/img_4c0841a2.gif"  BORDER=0  ALT=" What's Wrong? " ></A></TD>
	 </TR>
	 <TR VALIGN="top" ALIGN="left">
		<TD WIDTH=90 HEIGHT=40><A HREF="../html/jpg_and_gif_sizes.html"><IMG HEIGHT=40 WIDTH=90 SRC="../assets/auto_generated_images/img_513872e0.gif"  BORDER=0  ALT=" Image Sizes " ></A></TD>
	 </TR>
	  </TABLE></TD>
   </TR>
   <TR VALIGN="top" ALIGN="left">
	<TD COLSPAN=2 HEIGHT =4107></TD>
   </TR>
  </TABLE>
</TD>
<TD>

  <TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH=1231>
   <TR VALIGN="top" ALIGN="left">
	<TD HEIGHT =71></TD>
	<TD WIDTH=468 COLSPAN=2><A HREF="http://www.jadebox.com/arrow/"><IMG HEIGHT=60 WIDTH=468 SRC="../assets/images/aniarrow.gif"  BORDER=0  ALT="Arrow" ></A></TD>
	<TD></TD>
   </TR>
   <TR VALIGN="top" ALIGN="left">
	<TD WIDTH=12 HEIGHT =40><IMG SRC="../assets/auto_generated_images/img_3dfbb805.gif" WIDTH =12 HEIGHT =1 BORDER=0></TD>
	<TD WIDTH=310><IMG HEIGHT=40 WIDTH=310 SRC="../assets/auto_generated_images/img_513a14e2.gif"  BORDER=0  ALT=" Image Sizes " ></TD>
	<TD WIDTH=158><IMG SRC="../assets/auto_generated_images/img_3dfbb805.gif" WIDTH =158 HEIGHT =1 BORDER=0></TD>
	<TD WIDTH=751><IMG SRC="../assets/auto_generated_images/img_3dfbb805.gif" WIDTH =751 HEIGHT =1 BORDER=0></TD>
   </TR>
  </TABLE>

  <TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH=1231>
   <TR VALIGN="top" ALIGN="left">
	<TD WIDTH=12 HEIGHT =10><IMG SRC="../assets/auto_generated_images/img_3dfbb805.gif" WIDTH =12 HEIGHT =1 BORDER=0></TD>
	<TD WIDTH=482><IMG SRC="../assets/auto_generated_images/img_3dfbb805.gif" WIDTH =482 HEIGHT =1 BORDER=0></TD>
	<TD WIDTH=737><IMG SRC="../assets/auto_generated_images/img_3dfbb805.gif" WIDTH =737 HEIGHT =1 BORDER=0></TD>
   </TR>
   <TR VALIGN="top" ALIGN="left">
	<TD></TD>
	<TD WIDTH=482><P>Here is a routine that gets the height and width of the first image in the specified GIF or JPG image file.</P><P><B><FONT FACE="Courier New,Courier">GetImageSize(filespec As String, _<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Width As Integer, _<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Height As Integer)</B></FONT></P><P>Example:</P><P><FONT FACE="Courier New,Courier">&nbsp; Dim H as Integer<BR>&nbsp; Dim W as Integer<BR><BR>&nbsp; GetImageSize </FONT><FONT SIZE="-1" FACE="Courier New,Courier">&quot;</FONT><FONT FACE="Courier New,Courier">c:\pictures\image1.jpg</FONT><FONT SIZE="-1" FACE="Courier New,Courier">&quot;</FONT><FONT FACE="Courier New,Courier">, W, H<BR>&nbsp; Debug.Print </FONT><FONT SIZE="-1" FACE="Courier New,Courier">&quot;</FONT><FONT FACE="Courier New,Courier">Width: </FONT><FONT SIZE="-1" FACE="Courier New,Courier">&quot;</FONT><FONT FACE="Courier New,Courier"> + Format(W)<BR>&nbsp; Debug.Print </FONT><FONT SIZE="-1" FACE="Courier New,Courier">&quot;</FONT><FONT FACE="Courier New,Courier">Height: </FONT><FONT SIZE="-1" FACE="Courier New,Courier">&quot;</FONT><FONT FACE="Courier New,Courier"> + Format(H)</FONT></P><P>&nbsp;</TD>

	<TD></TD>
   </TR>
  </TABLE>

  <TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH=1231>
   <TR VALIGN="top" ALIGN="left">
	<TD WIDTH=12 HEIGHT =8><IMG SRC="../assets/auto_generated_images/img_3dfbb805.gif" WIDTH =12 HEIGHT =1 BORDER=0></TD>
	<TD WIDTH=482><IMG SRC="../assets/auto_generated_images/img_3dfbb805.gif" WIDTH =482 HEIGHT =1 BORDER=0></TD>
	<TD WIDTH=737><IMG SRC="../assets/auto_generated_images/img_3dfbb805.gif" WIDTH =737 HEIGHT =1 BORDER=0></TD>
   </TR>
   <TR VALIGN="top" ALIGN="left">
	<TD></TD>
	<TD WIDTH=482><P><FONT COLOR="#0000FF" SIZE="-1" FACE="Courier New,Courier">Global Const M_SOF0 = &amp;HC0<BR>Global Const M_SOF1 = &amp;HC1<BR>Global Const M_SOF2 = &amp;HC2<BR>Global Const M_SOF3 = &amp;HC3<BR>Global Const M_SOF5 = &amp;HC5<BR>Global Const M_SOF6 = &amp;HC6<BR>Global Const M_SOF7 = &amp;HC7<BR>Global Const M_SOF9 = &amp;HC9<BR>Global Const M_SOF10 = &amp;HCA<BR>Global Const M_SOF11 = &amp;HCB<BR>Global Const M_SOF13 = &amp;HCD<BR>Global Const M_SOF14 = &amp;HCE<BR>Global Const M_SOF15 = &amp;HCF<BR>Global Const M_SOI = &amp;HD8<BR>Global Const M_EOI = &amp;HD9<BR>Global Const M_SOS = &amp;HDA<BR>Global Const M_COM = &amp;HFE<BR><BR>' Type defs for GIF files<BR>Private Type GIFHeader<BR>&nbsp;&nbsp;&nbsp; GIF As String * 6<BR>&nbsp;&nbsp;&nbsp; Width As Integer<BR>&nbsp;&nbsp;&nbsp; Height As Integer<BR>&nbsp;&nbsp;&nbsp; Flags As String * 1<BR>&nbsp;&nbsp;&nbsp; Background As String * 1<BR>&nbsp;&nbsp;&nbsp; Aspect As String * 1<BR>End Type<BR><BR>Private Type ImageBlock<BR>&nbsp;&nbsp;&nbsp; left As Integer<BR>&nbsp;&nbsp;&nbsp; top As Integer<BR>&nbsp;&nbsp;&nbsp; Width As Integer<BR>&nbsp;&nbsp;&nbsp; Height As Integer<BR>&nbsp;&nbsp;&nbsp; Flags As String * 1<BR>End Type<BR><BR>Public Sub GetImageSize(filespec As String, _<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Width As Integer, Height As Integer)<BR>&nbsp; Dim f As Integer<BR>&nbsp; Dim c6 As String * 6<BR>&nbsp; Dim c4 As String * 4<BR>&nbsp; <BR>&nbsp; f = -1<BR>&nbsp; Height = -1<BR>&nbsp; Width = -1<BR>&nbsp; On Local Error GoTo GetImageSizeError<BR>&nbsp; If FileExists(filespec) Then<BR>&nbsp;&nbsp;&nbsp; f = FreeFile<BR>&nbsp;&nbsp;&nbsp; Open filespec For Binary As #f<BR>&nbsp;&nbsp;&nbsp; Get #f, 1, c6<BR>&nbsp;&nbsp;&nbsp; Select Case c6<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Case &quot;GIF87a&quot;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Close f<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; GetImageSizeGIF filespec, Width, Height<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Case &quot;GIF89a&quot;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Close f<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; GetImageSizeGIF filespec, Width, Height<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Case Else<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Get #f, 7, c4<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Close f<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If c4 = &quot;JFIF&quot; Then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; GetImageSizeJPG filespec, Width, Height<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<BR>&nbsp;&nbsp;&nbsp; End Select<BR>&nbsp; End If<BR>&nbsp; Close f<BR>&nbsp; On Error GoTo 0<BR>&nbsp; Exit Sub<BR>GetImageSizeError:<BR>&nbsp; Height = -1<BR>&nbsp; Width = -1<BR>&nbsp; If f &gt;= 0 Then Close f<BR>&nbsp; Exit Sub<BR>End Sub<BR><BR>Public Sub GetImageSizeGIF(filespec As String, _<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Width As Integer, Height As Integer)<BR>&nbsp; Dim f As Integer<BR>&nbsp; Dim i As Integer<BR>&nbsp; Dim j As Integer<BR>&nbsp; Dim c6 As String * 6<BR>&nbsp; Dim C3 As String * 3<BR>&nbsp; Dim h As GIFHeader<BR>&nbsp; Dim ib As ImageBlock<BR>&nbsp; Dim c As String * 1<BR>&nbsp; <BR>&nbsp; f = -1<BR>&nbsp; Height = -1<BR>&nbsp; Width = -1<BR>&nbsp; On Error GoTo GetImageSizeError87a<BR>&nbsp; f = FreeFile<BR>&nbsp; Open filespec For Binary As #f<BR>&nbsp; <BR>&nbsp; Get #f, 1, h<BR>&nbsp; <BR>&nbsp; Width = h.Width<BR>&nbsp; Height = h.Height<BR>&nbsp; <BR>&nbsp; i = Asc(h.Flags)<BR>&nbsp; If i And &amp;H80 Then<BR>&nbsp;&nbsp;&nbsp; i = 2 ^ ((i And 7) + 1)<BR>&nbsp;&nbsp;&nbsp; For j = 1 To i<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Get #f, , C3<BR>&nbsp;&nbsp;&nbsp; Next<BR>&nbsp; End If<BR><BR>&nbsp; While Not EOF(f)<BR>&nbsp;&nbsp;&nbsp; Get #f, , c<BR>&nbsp;&nbsp;&nbsp; If (c = &quot;,&quot;) Then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Get #f, , ib<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Width = ib.Width<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Height = ib.Height<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Exit Sub<BR>&nbsp;&nbsp;&nbsp; End If<BR>&nbsp; Wend<BR>&nbsp; <BR>&nbsp; Close f<BR>&nbsp; Exit Sub<BR>GetImageSizeError87a:<BR>&nbsp; Height = -1<BR>&nbsp; Width = -1<BR>&nbsp; If f &gt;= 0 Then Close f<BR>&nbsp; Exit Sub<BR>End Sub<BR><BR>Public Sub GetImageSizeJPG(filespec As String, _<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Width As Integer, Height As Integer)<BR>&nbsp; Dim f As Integer<BR>&nbsp; Dim c6 As String * 6<BR>&nbsp; Dim marker As Integer<BR>&nbsp; Dim length As Integer<BR>&nbsp; Dim precision As Integer<BR>&nbsp; <BR>&nbsp; f = -1<BR>&nbsp; Height = -1<BR>&nbsp; Width = -1<BR>&nbsp; On Error GoTo GetImageSizeErrorJPG<BR>&nbsp; f = FreeFile<BR>&nbsp; Open filespec For Binary As #f<BR>&nbsp; If first_marker(f) &lt;&gt; M_SOI Then<BR>&nbsp;&nbsp;&nbsp; Close f<BR>&nbsp;&nbsp;&nbsp; Exit Sub<BR>&nbsp; End If<BR>&nbsp; Do<BR>&nbsp;&nbsp;&nbsp; marker = next_marker(f)<BR>&nbsp;&nbsp;&nbsp; Select Case marker<BR>&nbsp;&nbsp;&nbsp;&nbsp; Case -1<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Close f<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Exit Sub<BR>&nbsp;&nbsp;&nbsp;&nbsp; Case M_SOF0, M_SOF1, M_SOF2, M_SOF3, _<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; M_SOF5, M_SOF6, M_SOF7, M_SOF9, _<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; M_SOF10, M_SOF11, M_SOF13, _<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; M_SOF14, M_SOF15<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; length = GetInt(f)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; precision = GetC(f)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Height = GetInt(f)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Width = GetInt(f)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Close f<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Exit Sub<BR>&nbsp;&nbsp;&nbsp;&nbsp; Case Else<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Skip_Variable f<BR>&nbsp;&nbsp;&nbsp; End Select<BR>&nbsp; Loop<BR>&nbsp; Close f<BR>&nbsp; Exit Sub<BR>GetImageSizeErrorJPG:<BR>&nbsp; Height = -1<BR>&nbsp; Width = -1<BR>&nbsp; If f &gt;= 0 Then Close f<BR>&nbsp; Exit Sub<BR>End Sub<BR>Sub Skip_Variable(f As Integer)<BR>&nbsp; Dim length As Integer<BR>&nbsp;&nbsp;&nbsp; <BR>&nbsp; length = GetInt(f)<BR>&nbsp; length = length - 2<BR>&nbsp; Seek #f, Seek(f) + length<BR>End Sub<BR><BR>Function GetInt(f As Integer) As Long<BR>&nbsp;&nbsp;&nbsp; Dim c As Long, N As Long<BR>&nbsp;&nbsp;&nbsp; c = GetC(f)<BR>&nbsp;&nbsp;&nbsp; N = c * 256&amp;<BR>&nbsp;&nbsp;&nbsp; c = GetC(f)<BR>&nbsp;&nbsp;&nbsp; N = N + c<BR>&nbsp;&nbsp;&nbsp; GetInt = N<BR>End Function<BR><BR>Function GetC(f As Integer) As Integer<BR>&nbsp; Dim bt As String * 1<BR>&nbsp; Get #f, , bt<BR>&nbsp; GetC = Asc(bt)<BR>End Function<BR><BR>Function first_marker(f As Integer) As Integer<BR>&nbsp; Dim C1 As Integer, C2 As Integer<BR>&nbsp; C1 = GetC(f)<BR>&nbsp; C2 = GetC(f)<BR>&nbsp; If C1 &lt;&gt; &amp;HFF Or C2 &lt;&gt; M_SOI Then<BR>&nbsp;&nbsp;&nbsp; first_marker = -1<BR>&nbsp;&nbsp; Else<BR>&nbsp;&nbsp;&nbsp; first_marker = C2<BR>&nbsp; End If<BR>End Function<BR><BR>Function next_marker(f As Integer) As Integer<BR>&nbsp;&nbsp;&nbsp; Dim c As Integer, discarded_bytes As Integer<BR>&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; c = GetC(f)<BR>&nbsp;&nbsp;&nbsp; While c &lt;&gt; &amp;HFF<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; discarded_bytes = discarded_bytes + 1<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; c = GetC(f)<BR>&nbsp;&nbsp;&nbsp; Wend<BR>&nbsp;&nbsp;&nbsp; Do<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; c = GetC(f)<BR>&nbsp;&nbsp;&nbsp; Loop While c = &amp;HFF<BR>&nbsp;&nbsp;&nbsp; If discarded_bytes &lt;&gt; 0 Then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; next_marker = -1<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Exit Function<BR>&nbsp;&nbsp;&nbsp; End If<BR>&nbsp;&nbsp;&nbsp; next_marker = c<BR>End Function</FONT></TD>

	<TD></TD>
   </TR>
  </TABLE>

  <TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0>
   <TR VALIGN="top" ALIGN="left">
	<TD WIDTH=19 HEIGHT =123><IMG SRC="../assets/auto_generated_images/img_3dfbb805.gif" WIDTH =19 HEIGHT =1 BORDER=0></TD>
	<TD WIDTH=431><IMG SRC="../assets/auto_generated_images/img_3dfbb805.gif" WIDTH =431 HEIGHT =1 BORDER=0></TD>
	<TD WIDTH=781><IMG SRC="../assets/auto_generated_images/img_3dfbb805.gif" WIDTH =781 HEIGHT =1 BORDER=0></TD>
   </TR>
   <TR VALIGN="top" ALIGN="left">
	<TD></TD>
	<TD NOWRAP> [<A HREF="../index.html">Home</A>]  [<A HREF="../html/meta_files.html">Meta&nbsp;Files</A>]  [<A HREF="../html/review__hardcore_visual_basic.html">Hardcore&nbsp;VB</A>]  [<A HREF="../html/what_s_wrong_with_vb_.html">What's&nbsp;Wrong?</A>]  [<A HREF="../html/jpg_and_gif_sizes.html">Image&nbsp;Sizes</A>] </TD>
	<TD></TD>
   </TR>
   <TR VALIGN="top" ALIGN="left">
	<TD COLSPAN=3 HEIGHT =975></TD>
   </TR>
  </TABLE>
</TD>
</TR>
</TABLE>
</BODY>
</HTML>

