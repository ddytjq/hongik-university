ID=E0172
URL=http://www.codeguru.com/cpp_mfc/MSAutoFactory.html
SIZE=34303
DATE=12/07/02
TIME=19:18:19
DATASET=C
HTML=<HTML>
<HEAD>   
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">   
    <META NAME="Author" CONTENT="Tom Archer">
    <TITLE>C++ & MFC - Table of Contents</TITLE>   
    <META Name="description" Content="Source codes with MFC">
    <META Name="keywords" Content="SOURCE CODE MFC">

    <SCRIPT LANGUAGE="JavaScript">
<!--
var axel = Math.random() + "";
var ord = axel * 1000000000000000000 + "?";

//This part of script alleviates a Netscape document.write bug
<!-- 
NS4 = document.layers;
if (NS4) {
origWidth = innerWidth;
origHeight = innerHeight;
}
function reDo() {
if (innerWidth != origWidth || innerHeight != origHeight) 
location.reload();
}
if (NS4) onresize = reDo;
//-->
</SCRIPT>

</HEAD>



<body>

<!-- begin logo and top banner ad table -->

<TABLE width=100% cellpadding="0" cellspacing="0">

  <TR align="left">
    <TD COLSPAN="3" VALIGN="TOP" align="left">
      <A HREF="http://www.earthweb.com" TARGET="_top">
        <IMG SRC="/images/eweb_banner.gif" BORDER="0" ALT="EarthWeb">
      </a>
    </TD>
  </TR>

  <TR>
<!--BljAds
    <TD VALIGN="TOP" align=left>
      <A HREF="/">
        <IMG SRC="/images/logo_cobrand.gif" BORDER="0" ALT="Developer.com">
      </a>
    </TD>

    <TD>
      <img src="/images/dotclear.gif" WIDTH="40" HEIGHT="1">
    </TD>
-->
    <TD align="TOP">
    <center>
      <IFRAME SRC="http://ad.doubleclick.net/adi/N339.Internet.com/B974922;sz=468x60;ord=2002.07.12.18.17.48?" WIDTH=470 HEIGHT=62 MARGINWIDTH=0 MARGINHEIGHT=0 HSPACE=0 VSPACE=0 FRAMEBORDER=0 SCROLLING=no BORDERCOLOR='#000000'>
<SCRIPT language='JavaScript1.1' SRC="http://ad.doubleclick.net/adj/N339.Internet.com/B974922;abr=!ie;sz=468x60;ord=2002.07.12.18.17.48?">
</SCRIPT>
<NOSCRIPT>
<A HREF="http://ad.doubleclick.net/jump/N339.Internet.com/B974922;abr=!ie4;abr=!ie5;sz=468x60;ord=2002.07.12.18.17.48?">
<IMG SRC="http://ad.doubleclick.net/ad/N339.Internet.com/B974922;abr=!ie4;abr=!ie5;sz=468x60;ord=2002.07.12.18.17.48?" BORDER=0 WIDTH=468 HEIGHT=60 ALT="Alt Text">Alt Text</A>
</NOSCRIPT>
</IFRAME><IMG SRC="http://www.codeguru.com/RealMedia/ads/adstream_lx.cgi/ew/ewsoftware/www.codeguru.com/cpp_mfc/MSAutoFactory.html/11837/468x60-1/Oracle_RUP_ORA09M_1a/InternetRONBanner468x60.html/38366531313035623364326631643430?_RM_EMPTY_" WIDTH=1 HEIGHT=1>

<!-- Counter Position Eliminated -->

    </center>
    </TD>
  </TR>

</TABLE>
<hr>
<!-- end logo and top banner ad table -->

<!-- begin lower outer table -->

<TABLE cellpadding="0" cellspacing="0" border="0">
<TR>
<TD bgcolor=#efefef VALIGN="TOP" WIDTH="90">




<table border=1 cellspacing=0 cellpadding=0>
<tr><td>

<table border=0 cellpadding=5 cellspacing=0 width=150>
   <tr>
     <td align="center">
      <A HREF="/">
        <IMG SRC="/images/logo_cobrand.gif" BORDER="0" ALT="Developer.com">
      </a>
      </td>
   </tr>
   <tr>
     <td align="center">
     <A HREF="http://www.codeguru.com/RealMedia/ads/click_lx.cgi/ew/ewsoftware/www.codeguru.com/cpp_mfc/MSAutoFactory.html/25196/125x125-1/House_Career_Channel_11g/webopediajobs-125.gif/38366531313035623364326631643430" target="_top"><IMG SRC="http://www.codeguru.com/RealMedia/ads/Creatives/House_Career_Channel_11g/webopediajobs-125.gif"  WIDTH=125 HEIGHT=125 ALT=""  BORDER="0"></A><img src="http://www.codeguru.com/RealMedia/ads/adstream_lx.cgi/ew/ewsoftware/www.codeguru.com/cpp_mfc/MSAutoFactory.html/25196/125x125-1/House_Career_Channel_11g/webopediajobs-125.gif/38366531313035623364326631643430?_RM_EMPTY_" Width="1" Height="1" Border="0">
     </td>
   </tr>
</table>

</td></tr>
<tr><td align="center">
  <table width="100%" border=0 cellpadding=5 cellspacing=0><tr><td align="center"><font size=-1>
  <a href="http://www.bizrate.com/mkt.xpml?mkt_id=503249" target="new">Shop for Software</a></font>
  </td></tr></table>
</td></tr>
<tr><td>
  <table width=130 border=0 cellpadding=5 cellspacing=0>
    <tr>
      <td>
        <!-- SEARCH FORM-->
        <form method="post" action="http://search.internet.com/codeguru.earthweb.com">
          <input type="hidden" name="IC_StartNumber" value="0">
          <input type="hidden" name="IC_BatchSize" value="10">
          <input type="hidden" name="IC_RelevanceThreshold" value="30">
          <input type="hidden" name="IC_QueryDatabase"  value="codeguru.earthweb.com">
          <input type="text"   name="IC_QueryText" value="" size="10">
          <input type="submit" value="Search">
        </form>
        <!-- END OF SEARCH FORM -->
      </td>
    </tr>
  </table>

  <table border=0 cellpadding=5 cellspacing=0 width=150>
    <tr><td><span class="navBarH1">CodeGuru Sites</span></td></tr>
    <tr><td nowrap>
        <small>
          <a href="/index.shtml">Visual C++ / MFC / C++</a><br>
          <a HREF="/csharp/index.shtml">.NET (C# and more)</a><br>
          <a href="/vb/index.shtml">Visual Basic</a><br>
          <a href="http://www.gamelan.com">Gamelan (Java)</a><br>
          <a href="http://www.jars.com">JARs (Java Applets)</a><br>
          <hr>
        </small>
        
        
    <a href="/SubmissionsGuidelines.html">
    <font face="verdana, helvetica" color="#000000" size=1>
       submission guidelines
    </font></a>
<br>

<hr>

    </td></tr>


    <tr><td><span class="navBarH1">Interact</span></td></tr>
    <tr><td nowrap>
        <small>
          <a href="/cgi-bin/bbs/wt/wwwthreads.pl">Discussion Boards</a><br>
          <a href="http://e-newsletters.internet.com">Newsletters (subscribe)</a><br>
          <a href="/Guestbook/guestbook.shtml">Guestbook</a><br>
          <a href="/cgi-bin/recommend.cgi">Recommend Us!</a><br>
          <hr>
        </small>
    </td></tr>


    <tr><td><span class="navBarH1">Of Interest</span></td></tr>
    <tr><td nowrap>
        <small>
       <a href="/announcements/dotnetbooks.html">Books on .NET</a><!--<img src="/images/new.gif">--><br>
       <a HREF="/bookReviews/index.shtml">Book Reviews</a><br>
       <a href="/newsletters/index.shtml">Newsletters (archived)</a><br> 
          <a href="/about.shtml">About Us</a><br>
          <hr>
        </small>
    </td></tr>

    <tr><td><span class="navBarH1">Article Sections</span></td></tr>

    <tr><td>
      <span class="navBarH2">C++</span>
      <br>
      <small>
        <a href="/algorithms/index.shtml">algorithms & formulas</a></br>
        <a href="/cpp_mfc/index.shtml">c++ & mfc</a><br>
        <a href="/date_time/index.shtml">date & time</a><br>
        <a href="/string/index.shtml">string</a><br>
      </small>
    </td></tr>

    <tr><td>
      <span class="navBarH2">COM-based Technologies</span>
      <br>
      <small>
        <a href="/atl/index.shtml">atl & wtl</a><br>
        <a href="/activex/index.shtml">com & activex</a><br>
        <a href="/complus/index.shtml">com+</a><br>
        <a href="/shell/index.shtml">shell programming</a><br>
      </small>
    </td></tr>

    <tr><td>
      <span class="navBarH2">Controls</span>
      <br>
      <small>
        <a href="/buttonctrl/index.shtml">button control  </a><br>
        <a href="/combobox//index.shtml">combobox  </a><br>
        <a href="/editctrl/index.shtml">edit control  </a><br>
        <a href="/imagelist/index.shtml">imagelist control </a><br>
        <a href="/listbox/index.shtml">listbox control  </a><br>
        <a href="/listview/index.shtml">listview control  </a><br>
        <a href="/menu/index.shtml">menu  </a><br>
        <a href="/controls/index.shtml">other controls </a><br>
        <a href="/propertysheet/index.shtml">property sheet  </a><br>
        <a href="/richedit/index.shtml">rich edit control  </a><br>
        <a href="/staticctrl/index.shtml">static control  </a><br>
        <a href="/statusbar/index.shtml">status bar </a><br>
        <a href="/toolbar/index.shtml">toolbar  </a><br>
        <a href="/treeview/index.shtml">treeview control </a><br>
      </small>
    </td></tr>

    <tr><td>
      <span class="navBarH2">Data</span>
      <br>
      <small>
    <!--
        <a href="/ado/index.shtml">ado & oledb</a><br>
        <a href="/odbc/index.shtml">odbc</a><br>
        <a href="/mfc_database/index.shtml">mfc database classes</a><br>
        <a href="/office_db/index.shtml">office products</a><br>
        <a href="/oracle/index.shtml">oracle</a><br>
        <a href="/serialization/index.shtml">serialization</a><br>
        <a href="/sqlserver/index.shtml">sql server</a><br>
    -->
        <a href="/mfc_database/index.shtml">database</a><br>
        <a href="/data-misc/index.shtml">miscellaneous</a><br>
      </small>
    </td></tr>

    <tr><td>
      <span class="navBarH2">Frameworks</span>
      <br>
      <small>
    <!--
        <a href="/component_frameworks/index.shtml">component frameworks</a><br>
        <a href="/printing_frameworks/index.shtml">printing frameworks</a><br>
        <a href="/ui_frameworks/index.shtml">ui frameworks</a><br>
    -->
        <a href="/advancedui/index.shtml">ui & printing frameworks</a><br>
      </small>
    </td></tr>

    <tr><td>
      <span class="navBarH2">Graphics & Multimedia</span>
      <br>
      <small>
        <a href="/bitmap/index.shtml">bitmaps & palettes</a><br>
        <a href="/directx/index.shtml">directx</a><br>
        <a href="/gdi/index.shtml">gdi</a><br>
        <a href="/multimedia/index.shtml">multimedia</a><br>
        <a href="/opengl/index.shtml">opengl</a><br>
      </small>
    </td></tr>

    <tr><td>
      <span class="navBarH2">Internet & Networking</span>
      <br>
      <small>
        <a href="/ieprogram/index.shtml">ie programming</a><br>
        <a href="/internet/index.shtml">internet protocols</a><br>
        <a href="/isapi/index.shtml">isapi</a><br>
        <a href="/network/index.shtml">network protocols</a><br>
      </small>
    </td></tr>
	
    <tr><td>
      <span class="navBarH2">Miscellaneous</span>
      <br>
      <small>
        <a href="/misc/index.shtml">miscellaneous</a><br>
        <a href="/samples/index.shtml">samples</a><br>
      </small>
    </td></tr>

    <!--
    <tr><td><span class="navBarH2">Security</span></td></tr>
    <tr><td><small>
      <a href="/cryptoapi/index.shtml">crypto api</a><br>
      <a href="/encryption/index.shtml">encryption/decryption</a><br>
      <br>
    </small></td></tr>
    -->

    <tr><td>
      <span class="navBarH2">Visual Studio</span>
      <br>
      <small>
    <!--
        <a href="/addins/index.shtml">add-ins</a><br>

        <a href="/tips/index.shtml">editor tips</a><br>
        <a href="/macros/index.shtml">macros</a><br>
    -->
        <a href="/debug/index.shtml">debugging</a><br>
        <a href="/devstudio_macros/index.shtml">add-ins & macros</a><br>
        <a href="/tips/index.shtml">editor tips</a><br>
      </small>
    </td></tr>

    <tr><td>
      <span class="navBarH2">Windows Programming</span>
      <br>
      <small>
        <a href="/ce/index.shtml">ce</a><br>
        <a href="/clipboard/index.shtml">clipboard</a><br>
        <a href="/dll/index.shtml">dll</a><br>
        <a href="/files/index.shtml">file & folder</a><br>
        <a href="/help/index.shtml">help systems</a><br>
        <a href="/printing/index.shtml">printing</a><br>
        <a href="/win32/index.shtml">win32</a><br>
        <a href="/system/index.shtml">system</a><br>
      </small>
    </td></tr>

    <tr><td>
      <span class="navBarH2">Windows &amp; Dialogs</span>
      <br>
      <small>
        <a href="/console/index.shtml">console</a></br>
        <a href="/dialog/index.shtml">dialog</a><br>
        <a href="/docking/index.shtml">docking window</a><br>
        <a href="/doc_view/index.shtml">doc/view</a><br>
        <a href="/splitter/index.shtml">splitter</a><br>
      </small>
      <hr>
    </td></tr>

    </table>

<!-- JOB BUTTON --> 
    <table border=0 cellpadding=5 cellspacing=0 width=150>
    <tr><td align="center">
       <a href="http://jobs.internet.com" target="new">
         <IMG SRC="http://www.codeguru.com/jobs.gif" alt="[Internet Jobs]">
       </a>
    </td></tr>
    </table>

  </td>
</tr>
</table>

<!--/navbar>


<!-- blank column for spacing -->

<td valign="top" width="20">&nbsp;&nbsp;&nbsp;</td>

<!-- end blank column for spacing -->

<!-- begin content column -->

<TD VALIGN="TOP" >

<!--
<table cellpadding="0" cellspacing="0">
<tr>
-->

<!-- begin main content column -->


<!-- closign of column, row, and table are in subfoot file -->





<script type="text/javascript" language="javascript"> 
if (screen.width==640 || screen.width==800)
{
   document.write("<link rel=stylesheet href='/global/global800.css'>"); 
} 
else 
{ 
   document.write("<link rel=stylesheet href='/global/global.css'>"); 
} 
</script>


<CENTER><H3><FONT COLOR="#AOAO99">Automatic Factory from Microsoft</FONT></H3></CENTER><HR>

<!-- Author and contact details -->
<!-- Ed van de Pitte -->

This article was contributed by 
<A HREF="mailto:EvdPitte@zonnet.nl">E. van de Pitte</A>.


<!-- For which environment is this code specific??? -->
<p><u>Environment:</u>   Microsoft VC6
<h3>In short</h3>
<p>
This document describes a mechanism to create instances of classes using their classname. The list of classes that can be created using their classname happens automatically (when new classes are defined, they automatically become part of the list of registered classes). The mechanism is very useful when the class that must be created depends on external input (e.g. registry settings, script file etc).

<h3>History</h3>
<p>
In many applications I make use of the Factory pattern. To avoid having to
write and maintain code to select what class to create I've created a mechanism that automatically registers classes into a static 'registration'-class. Because I did not find an official name for the mechanism, I called it the 'automatic factory' mechanism. The 'automatic' points to the behavior of the classes that are registered into a central list without having to write this code explicitly.

<p>During the development of this mechanism, I took a more closer look under the hood of the DECLARE_DYNAMIC / DECLARE_DYNCREATE and DECLARE_SERIAL macros from Microsoft (actually I noticed the base-concepts of these macro's and my own mechanism were similar).

<p>As a result of this 'closer MFC examination', I created a utility class that makes creation of classes based upon the string representation of the classtype possible (without having to write and maintain registration code).

<p>The standard MFC mechanism to create a class dynamically uses the following syntax:</p>

<PRE><tt>#include &lt;MyBaseClass.h&gt;
#include &lt;MyClass.h&gt;

// Get static CRuntimeClass instance belonging to the class.
CRuntimeClass* pRuntimeClass = RUNTIME_CLASS( CMyClass );
// Create instance (CObject*) and check if this is the 
// classtype (or derived from) we expect (using dynamic_cast).
CMyBaseClass* pClass  = 
   dynamic_cast&lt;CMyBaseClass*&gt; (pRuntimeClass-&gt;CreateObject()); </tt></PRE>

<p>Code 1: Creating instances the using CRuntimeClass.</p>

<p>In this piece of code, the class to create ('CMyClass' in the example) must be known to the routine that creates the instance at compile time, or the CRuntimeClass* of a class to create must be looked up based on some criterion (a mapping of the input to the CRuntimeClass-instance of the class to create must be created).

<p>The automatic factory automatically creates a mapping from the name of the
class to the CRuntimeClass-instance that belongs to that name.<p>Constructing instances using the automatic factory looks like this:

<PRE><tt>#include &lt;MSAutofactory.h&gt;
#include &lt;MyBaseClass.h&gt;

<span class="codeComment">// CREATE_OBJECT returns a pointer to a CObject. To be certain 
// that the instance is derived from the 
// expected type, a dynamic_cast is used.</span>
CMyBaseClass* pClass = dynamic_cast&lt;CMyBaseClass*&gt;( 
      CREATE_OBJECT(_T(&quot;CMyClass&quot;))); <span class="codeComment">// Only base class is needed.</span>
</tt></pre>

<p>Code 2: Creating instances using CREATE_OBJECT.</p>
or, more shortly (the returned instance is safely casted to the base class inside the internal (template)function).

<PRE><tt>#include &lt;MSAutofactory.h&gt;
#include &lt;MyBaseClass.h&gt;

CMyBaseClass *pClass = NULL;
<span class="codeComment">// CMyClass is constructed. The constructed instance is safely 
// casted to the type of the input
// parameter (which is CMyBaseClass*) in this example.</span>
CREATE_CHECKED_OBJECT ( _T(&quot;CMyClass&quot;), pClass );
</tt></PRE>

<p>Code 3: Creating instances using CREATE_CHECKED_OBJECT.</p>

<p>Construction instances this way is extremely helpful when the type that
must be created depends on an 'external source' (e.g. a configuration file).
When new class-types are added to the application, they are immediately looked up (and created) without the need of writing special code.

<h3><a name="PRECONDITIONS"></a>Preconditions</h3>
<p>
The preconditions are also described in the MSDN (article:
&quot;Serialization: Making a Serializable Class&quot;).
<p>
In short the preconditions are:
<ol>
  <li> CObject must be the base class (or part of the inheritance hierarchy).</li>
  <li>The class must have a default constructor.</li>
  <li> DECLARE_SERIAL macro.</li>
  <li>IMPLEMENT_SERIAL macro.</li>
  <li>The class may not be a template class.</li>
</ol>
<p>A class that fulfills these preconditions
is automatically registered to the current module state when the program is
started. Read &quot;<a href="#CREATING_INSTANCES">Creating Instances</a>&quot;
for a description how to create instances based upon the name of the classtype.</p>

<p>Example:
<PRE><tt><u>Header file:</u>
class CSomeBaseClass : public CObject  <span class="codeComment">// 1 &lt;- Derived from CObject</span>
{
  DECLARE_SERIAL(CSomeBaseClass)       <span class="codeComment">// 2 &lt;- DECLARE_SERIAL</span>
public:
  CSomeBaseClass() {}                  <span class="codeComment">// 4 &lt;- Default constructor.</span>
};

class CSomeDerivedClass : public CSomeBaseClass
{
  DECLARE_SERIAL(CSomeDerivedClass)
public:
  CSomeDerivedClass() {}
};</tt></pre>

<u>Source file:</u>
<pre><tt><span class="codeComment">// Precondition 4. Use the IMPLEMENT_SERIAL macro's.</span>
IMPLEMENT_SERIAL ( CSomeBaseClass,    CObject,        1 )
IMPLEMENT_SERIAL ( CSomeDerivedClass, CSomeBaseClass, 1 )
</tt></pre>

<p>Code 4: Defining constructable classes.</p>

<p>In this example code, 2 (empty) classes are defined that met the
preconditions. When the program is started, the static CRuntime-instances of
these 2
classes are registered to the module-state of the current application.</p>

<h3><a name="CREATING_INSTANCES"></a>Creating instances.</h3>
<p align="left">Creating an instance of a class based upon the classtype-name is just a matter of looking up the
CRuntime-class information of the class that you want to instantiate followed by a call to the CreateObject factory-function.</p>
<p>According to the MSDN, the 'CRuntimeClass::FromName' function can be used for this. Unfortunately, this function exists for the Windows CE-library, but not for the 'normal' Windows MFC library (belonging to Visual C++ 6.0).</p>

<p>For that reason, I created a (static) utility class that implements this missing functionality and also adds routines to give insight in the list of classes that can be constructed. To avoid even more 'code-typing effort', macros have been written to create instances of a given class type (look inside the MSAutoFactory.h file for a description of the various functions and their parameters).</p>

<p>Creating instances can be done using 2 functions:
<ol>
  <li><tt>CObject* CreateObject ( LPCTSTR strClassName, bool CurrentModuleOnly = false )</tt>
     <br>
or use the macro
<tt><br>
CREATE_OBJECT( _classname_ )</tt>

     <br>

Create an instance of the type described in 'strClassName' and return the instance (CObject is always the base class).
  </li>
  <li><tt>template &lt;class T&gt; bool CreateObject ( LPCTSTR strClassName, T*&amp;
    pConstructedInstance, bool CurrentModuleOnly = false )</tt><br>
    or use the macro<br>
    <tt>CREATE_CHECKED_OBJECT( _classname_, _outputtype_ )</tt><br>
    Create an instance of the classtype described in 'strClassName'. When this succeeds, a 'dynamic_cast' is used to cast the instance to the type of the parameter (the pConstructedInstance or _outputtype_).<br>
  </li>
</ol>

<p>The usage of these macro's is shown in the small example code below.

<PRE><tt>
<span class="codeComment">// Create a &quot;CSomeDerivedClass&quot; instance, check if it 
// is derived from CSomeBaseClass 
// (internally dynamic_cast is used, using the input type as 
// (template) parameter) and export it.</span>
CSomeBaseClass *pInstance = NULL;
if ( CREATE_CHECKED_OBJECT ( _T(&quot;CSomeDerivedClass&quot;),
                             pInstance );
{
  <span class="codeComment">// Do something with the pointer you've created.
  ..</span>
  delete ( pInstance );
}

<span class="codeComment">// Alternative way (do the dynamic_cast yourself)</span>
CObject *ptrObject = CREATE_OBJECT( _T(&quot;CSomeDerivedClass&quot;));
CSomeBaseClass *pInstance2 = 
       dynamic_cast&lt;CSomeBaseClass*&gt;( ptrObject );
if ( pInstance2 )
{
  <span class="codeComment">// Do something with the instance.
  .. </span>
  delete ( pInstance2 );
}</tt></pre>

<p>Code 5: Example constructing instances using the macros.</P>


<h3>Notes.</h3>
<p>Some notes have to made for this mechanism however:</p>
<ul>
  <li><u>Most important</u>: The mechanism uses an internal structure of
    Microsoft. Although the chance of changes to this structure is small, it may happen in future releases of Visual C++.</li>
  <li>Microsoft offers the following macros:<br>
    <tt>DECLARE_DYNAMIC</tt>      This macro will Add CRuntime-information to a class.<br>
    <tt>DECLARE_DYNCREATE</tt>  This macro adds and fills the 'm_pfnCreateObject'
    factory function.<br>
    <tt>DECLARE_SERIAL</tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;» This macro adds
    a.o. registration of the class.<br>
    The class only registers itself when DECLARE_SERIAL is used, when the other macros are used, the classtype is not registered.</li>
  <li>The <tt>IMPLEMENT_SERIAL</tt> macro needs a 'wSchema' parameter. This parameter is used to detect if the structure of class-data that is serialized from a stream into memory has changed (refer to the serialization mechanism). For the Automatic Factory functionality it has no meaning so any number will be OK.</li>
  <li>The mechanism supports statically linked DLL's. When a DLL is loaded
    dynamically (using LoadLibrary), the classtypes that are registered in the loaded DLL are not added to the classlist (of the application). I don't know if this behavior is the same when delayed DLL loading is used.</li>
</ul>

<h3>Downloads</h3>
<!-- demo and source files -->
<A HREF="MSAutoFactory.zip">Download demo project - 15 Kb</A><BR>

<h3>History</h3>
Date Posted:  May 20, 2002<br>
Date Last Update:  July 11, 2002

<!--comments-->
<h3>Comments:</h3><ul>
<!--startlist-->
<li><b>Updated article and downloads </b>- Brad Jones (Webmaster) (2002/07/11)</li>
<li><a href="/mfc/comments/37546.shtml">Same as MFC?</a> - AB (2002/05/21)

</ul>
<P>
<strong><a href="/cgi-bin/addpage/addpage.cgi?cfg=addcomment&action=Comment">
Add Comment</a></strong>
<P>

</td>

      <!--BLJAds - Added right side tower ad -->
<TD VALIGN="TOP">
<A HREF="http://www.codeguru.com/RealMedia/ads/click_lx.cgi/ew/ewsoftware/www.codeguru.com/cpp_mfc/MSAutoFactory.html/5787/125x800/Oracle_RUP_ORA09M_1a/InternetcomRONSky120x600.html/38366531313035623364326631643430?2002.07.12.18.17.48"> <IMG SRC="http://ad.doubleclick.net/ad/N339.Internet.com/B974922.2;sz=120x600;ord=2002.07.12.18.17.48?" BORDER=0 WIDTH=120 HEIGHT=600 ALT=""></A>
<IMG SRC="http://www.codeguru.com/RealMedia/ads/adstream_lx.cgi/ew/ewsoftware/www.codeguru.com/cpp_mfc/MSAutoFactory.html/5787/125x800/Oracle_RUP_ORA09M_1a/InternetcomRONSky120x600.html/38366531313035623364326631643430?_RM_EMPTY_" WIDTH=1 HEIGHT=1>

<p>

<!-- Commerce bar -->
<table border="0" cellpadding="3" width="140">

<tr bgcolor="black"><td>
<font face="Arial" color="white" size="1" >
<b><center>internet.commerce</center></b></font>
</td></tr>
<tr bgcolor="lightgrey"><td>
<font face="Arial" size="1" >
<a href="http://www.internet.com/partners/">Be a Commerce Partner</A><BR>
<a href="http://www.codeguru.com/RealMedia/ads/click_lx.cgi/ew/ewsoftware/www.codeguru.com/cpp_mfc/MSAutoFactory.html/27467/cp1/LookSurf_2d/FreelanceProjects.html/38366531313035623364326631643430">Freelance Projects</a>
<IMG SRC="http://www.codeguru.com/RealMedia/ads/adstream_lx.cgi/ew/ewsoftware/www.codeguru.com/cpp_mfc/MSAutoFactory.html/27467/cp1/LookSurf_2d/FreelanceProjects.html/38366531313035623364326631643430?_RM_EMPTY_" WIDTH=1 HEIGHT=1>
<BR>
<a href="http://www.codeguru.com/RealMedia/ads/click_lx.cgi/ew/ewsoftware/www.codeguru.com/cpp_mfc/MSAutoFactory.html/16547/cp2/rfpMarket_Inc_8c/FindAWebDeveloper.html/38366531313035623364326631643430">Find A Web Developer</a>
<IMG SRC="http://www.codeguru.com/RealMedia/ads/adstream_lx.cgi/ew/ewsoftware/www.codeguru.com/cpp_mfc/MSAutoFactory.html/16547/cp2/rfpMarket_Inc_8c/FindAWebDeveloper.html/38366531313035623364326631643430?_RM_EMPTY_" WIDTH=1 HEIGHT=1>
<BR>
<a href="http://www.codeguru.com/RealMedia/ads/click_lx.cgi/ew/ewsoftware/www.codeguru.com/cpp_mfc/MSAutoFactory.html/5626/cp3/INB_10a/SendaPressRelease.html/38366531313035623364326631643430">Send a Press Release</a>
<IMG SRC="http://www.codeguru.com/RealMedia/ads/adstream_lx.cgi/ew/ewsoftware/www.codeguru.com/cpp_mfc/MSAutoFactory.html/5626/cp3/INB_10a/SendaPressRelease.html/38366531313035623364326631643430?_RM_EMPTY_" WIDTH=1 HEIGHT=1>
<BR>
<a href="http://www.codeguru.com/RealMedia/ads/click_lx.cgi/ew/ewsoftware/www.codeguru.com/cpp_mfc/MSAutoFactory.html/27474/cp4/Revquest_3d/Revquest_text.html/38366531313035623364326631643430">Web Design</a>
<IMG SRC="http://www.codeguru.com/RealMedia/ads/adstream_lx.cgi/ew/ewsoftware/www.codeguru.com/cpp_mfc/MSAutoFactory.html/27474/cp4/Revquest_3d/Revquest_text.html/38366531313035623364326631643430?_RM_EMPTY_" WIDTH=1 HEIGHT=1>
<BR>
<A href="http://www.codeguru.com/RealMedia/ads/click_lx.cgi/ew/ewsoftware/www.codeguru.com/cpp_mfc/MSAutoFactory.html/16553/cp5/Domain_Bank_14d/RegisterDomains.html/38366531313035623364326631643430">Register Domains</a>
<IMG SRC="http://www.codeguru.com/RealMedia/ads/adstream_lx.cgi/ew/ewsoftware/www.codeguru.com/cpp_mfc/MSAutoFactory.html/16553/cp5/Domain_Bank_14d/RegisterDomains.html/38366531313035623364326631643430?_RM_EMPTY_" WIDTH=1 HEIGHT=1>
<BR>
<a href="http://www.codeguru.com/RealMedia/ads/click_lx.cgi/ew/ewsoftware/www.codeguru.com/cpp_mfc/MSAutoFactory.html/5633/cp6/Mamma.com_9d/SearchtheWeb.html/38366531313035623364326631643430">Search the Web</a>
<IMG SRC="http://www.codeguru.com/RealMedia/ads/adstream_lx.cgi/ew/ewsoftware/www.codeguru.com/cpp_mfc/MSAutoFactory.html/5633/cp6/Mamma.com_9d/SearchtheWeb.html/38366531313035623364326631643430?_RM_EMPTY_" WIDTH=1 HEIGHT=1><BR>
<a href="http://www.codeguru.com/RealMedia/ads/click_lx.cgi/ew/ewsoftware/www.codeguru.com/cpp_mfc/MSAutoFactory.html/27480/cp7/Access_USA_2d/USAMailingAddress.html/38366531313035623364326631643430">USA Mailing Address</a>
<IMG SRC="http://www.codeguru.com/RealMedia/ads/adstream_lx.cgi/ew/ewsoftware/www.codeguru.com/cpp_mfc/MSAutoFactory.html/27480/cp7/Access_USA_2d/USAMailingAddress.html/38366531313035623364326631643430?_RM_EMPTY_" WIDTH=1 HEIGHT=1>
<BR>
<a href="http://www.codeguru.com/RealMedia/ads/click_lx.cgi/ew/ewsoftware/www.codeguru.com/cpp_mfc/MSAutoFactory.html/16560/cp8/Imici_5c/SecureBusinessIM.html/38366531313035623364326631643430">Secure Business IM</a>
<IMG SRC="http://www.codeguru.com/RealMedia/ads/adstream_lx.cgi/ew/ewsoftware/www.codeguru.com/cpp_mfc/MSAutoFactory.html/16560/cp8/Imici_5c/SecureBusinessIM.html/38366531313035623364326631643430?_RM_EMPTY_" WIDTH=1 HEIGHT=1><BR>
<a href="http://www.codeguru.com/RealMedia/ads/click_lx.cgi/ew/ewsoftware/www.codeguru.com/cpp_mfc/MSAutoFactory.html/5639/cp9/Top_Hosts_13c/tophosts.html/38366531313035623364326631643430">Find a Web Host</a>
<IMG SRC="http://www.codeguru.com/RealMedia/ads/adstream_lx.cgi/ew/ewsoftware/www.codeguru.com/cpp_mfc/MSAutoFactory.html/5639/cp9/Top_Hosts_13c/tophosts.html/38366531313035623364326631643430?_RM_EMPTY_" WIDTH=1 HEIGHT=1>
<BR>
<a href="http://www.codeguru.com/RealMedia/ads/click_lx.cgi/ew/ewsoftware/www.codeguru.com/cpp_mfc/MSAutoFactory.html/27487/cp10/EMedia_2d/EMediaMagFreeSub.html/38366531313035623364326631643430">EMedia Mag Free Sub</a>
<IMG SRC="http://www.codeguru.com/RealMedia/ads/adstream_lx.cgi/ew/ewsoftware/www.codeguru.com/cpp_mfc/MSAutoFactory.html/27487/cp10/EMedia_2d/EMediaMagFreeSub.html/38366531313035623364326631643430?_RM_EMPTY_" WIDTH=1 HEIGHT=1><BR>

</font>
</td></tr>
</table>
<br>


</TD>

</tr>
</table>
<!-- begin footer information -->
<br>
<CENTER>
<table width="750" cellpadding="0" cellspacing="0" border="0" background="http://www.codeguru.com/RealMedia/ads/Creatives/House_Interactive_EW_1a/ewebbg.gif"><tr><td width="265" valign="top">
<a href="http://www.codeguru.com/RealMedia/ads/click_lx.ads/ew/ewsoftware/www.codeguru.com/cpp_mfc/MSAutoFactory.html/16566/468x60-2/House_Interactive_EW_1a/eweb_750.html/38366531313035623364326631643430?_RM_REDIR_=www.earthweb.com/"><img src="http://www.codeguru.com/RealMedia/ads/Creatives/House_Interactive_EW_1a/ewebbanner.gif" width="265" height="81" border="0"></a></td><td width="485">
<table width="485" cellpadding="0" cellspacing="0" border="0"><tr><td width="485" colspan="3">
<img src="http://www.codeguru.com/RealMedia/ads/Creatives/House_Interactive_EW_1a/topittop.gif" width="485" height="25" border="0"></td></tr><tr><td width="25" valign="top">
<img src="http://www.codeguru.com/RealMedia/ads/Creatives/House_Interactive_EW_1a/ewebl-top.gif" width="25" height="17" border="0"></td><td width="440" rowspan="3" background="http://www.codeguru.com/RealMedia/ads/Creatives/House_Interactive_EW_1a/w.gif">
<img src="http://www.codeguru.com/RealMedia/ads/Creatives/House_Interactive_EW_1a/sp.gif" width="440" height="1"><br><font face="verdana,arial,helvetica" size="-2">
<!--begin content--><a href="http://www.codeguru.com/RealMedia/ads/click_lx.ads/ew/ewsoftware/www.codeguru.com/cpp_mfc/MSAutoFactory.html/16566/468x60-2/House_Interactive_EW_1a/eweb_750.html/38366531313035623364326631643430?_RM_REDIR_=redir.internet.com/houseads/ew/www.esecurityplanet.com/prodser/article/0,,10753_1383521,00.html">Gilian Unveils Entry Level Version Of G-Server</a><br>
<a href="http://www.codeguru.com/RealMedia/ads/click_lx.ads/ew/ewsoftware/www.codeguru.com/cpp_mfc/MSAutoFactory.html/16566/468x60-2/House_Interactive_EW_1a/eweb_750.html/38366531313035623364326631643430?_RM_REDIR_=redir.internet.com/houseads/ew/www.esecurityplanet.com/prodser/article/0,,10753_1383281,00.html">Guidance Software Pushes Proactive Forensics </a><br>
<a href="http://www.codeguru.com/RealMedia/ads/click_lx.ads/ew/ewsoftware/www.codeguru.com/cpp_mfc/MSAutoFactory.html/16566/468x60-2/House_Interactive_EW_1a/eweb_750.html/38366531313035623364326631643430?_RM_REDIR_=redir.internet.com/houseads/ew/itmanagement.earthweb.com/staff/article/0,,11965_1383051,00.html">Certification Watch: IT Job Market to Improve, Study Says</a><br>
<a href="http://www.codeguru.com/RealMedia/ads/click_lx.ads/ew/ewsoftware/www.codeguru.com/cpp_mfc/MSAutoFactory.html/16566/468x60-2/House_Interactive_EW_1a/eweb_750.html/38366531313035623364326631643430?_RM_REDIR_=redir.internet.com/houseads/ew/www.esecurityplanet.com/trends/article/0,,10751_1382951,00.html">Sun Issues Fix for iPlanet Server Bug</a><br>
<a href="http://www.codeguru.com/RealMedia/ads/click_lx.ads/ew/ewsoftware/www.codeguru.com/cpp_mfc/MSAutoFactory.html/16566/468x60-2/House_Interactive_EW_1a/eweb_750.html/38366531313035623364326631643430?_RM_REDIR_=redir.internet.com/houseads/ew/www.gridcomputingplanet.com/news/article/0,,3281_1382551,00.html">Globus Toolkit 2.0 Wins R&D 100 Award</a><br>
<!--end content-->
</font></td>
<td width="20" valign="top"><img src="http://www.codeguru.com/RealMedia/ads/Creatives/House_Interactive_EW_1a/ewebr-top.gif" width="20" height="17" border="0"></td></tr><tr>
<td width="25" background="http://www.codeguru.com/RealMedia/ads/Creatives/House_Interactive_EW_1a/l-bg.gif"><img src="http://www.codeguru.com/RealMedia/ads/Creatives/House_Interactive_EW_1a/sp.gif" width="25" height="33"></td><td width="20" background="http://www.codeguru.com/RealMedia/ads/Creatives/House_Interactive_EW_1a/r-bg.gif">
<img src="http://www.codeguru.com/RealMedia/ads/Creatives/House_Interactive_EW_1a/sp.gif" width="20" height="33"></td></tr><tr><td width="25"><img src="http://www.codeguru.com/RealMedia/ads/Creatives/House_Interactive_EW_1a/ewebl-btm.gif" width="25" height="15"></td>
<td width="20"><img src="http://www.codeguru.com/RealMedia/ads/Creatives/House_Interactive_EW_1a/ewebr-btm.gif" width="20" height="15"></td></tr><tr><td width="485" valign="bottom" colspan="3">
<img src="http://www.codeguru.com/RealMedia/ads/Creatives/House_Interactive_EW_1a/ewebbtm.gif" width="485" height="10" border="0"></td></tr></table></td></tr></table>
<IMG SRC="http://www.codeguru.com/RealMedia/ads/adstream_lx.cgi/ew/ewsoftware/www.codeguru.com/cpp_mfc/MSAutoFactory.html/16566/468x60-2/House_Interactive_EW_1a/eweb_750.html/38366531313035623364326631643430?_RM_EMPTY_" WIDTH=1 HEIGHT=1>

<br>
<FONT SIZE="-1">EarthWeb is a service of INT Media Group, Incorporated.<br>
Copyright 2002 INT Media Group, Incorporated. All Rights Reserved.<BR>
<A HREF="http://www.internet.com/help/feedback.html">Feedback</A>, &nbsp;
<A HREF="http://www.itmarketer.com">Advertising Info</A>, &nbsp;
<A HREF="http://www.internet.com/corporate/legal.html">Legal Notices</A>,&nbsp;
<A HREF="http://www.internet.com/corporate/reprints.html#Licensing">Licensing</A>, 
<A HREF="http://www.internet.com/corporate/reprints.html#Reprints">Reprints</A>, &amp; 
<A HREF="http://www.internet.com/corporate/reprints.html#Permissions">Permissions</A>, &nbsp;
<A HREF="http://www.internet.com/corporate/privacy/privacypolicy.html">Privacy Policy</A>.
<BR>
<A HREF="http://www.internet.com"><IMG SRC="/images/internetcom.gif"
ALT="http://www.internet.com/" WIDTH="161" HEIGHT="18"
BORDER="0"></A></FONT>
</CENTER>

</BODY>
</HTML>




