ID=F0286
URL=http://www.vbip.com/miscellaneous/directory-info/dir-info-01.asp
SIZE=45067
DATE=09/07/2002
TIME=13:18:16
DATASET=Visual Basic
HTML=
<html>

<head>
<title>Displaying the directory tree using the treeview in VB.Net</title>
<meta name="description" content="This project was created using the .Net beta 2 release. It was originally written in VB6 and then rewritten in VB.Net. It teaches how to browse the directory structure and display it using the treeview control. I make a point of highlighting differences between the VB6 and the VB.Net solutions. Some of them were quite a surprise.">
<meta name="GENERATOR" content="Microsoft FrontPage 5.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<meta name="ROBOTS" content="INDEX,FOLLOW">

	<link rel="stylesheet" type="text/css" href="../../../vbip_nn.css">

</head>

<body bgcolor="#FFFFFF">
<form name="GlobalForm" ID="GlobalForm">
<table border="0" width="100%" cellspacing="0" cellpadding="0">
  <tr>
    <td width="100%">
      <table border="0" width="100%" cellspacing="0" cellpadding="0">
        <tr>
          <td width="120"><img border="0" src="../../_borders/vbip_logo3.gif" width="132" height="50"></td>
          <td valign="middle">
				<p align="center">
              <!-- start BITS ad HTML -- top of page -- 468x60 banner www.bitsonthewire.com         --> 
               <iframe src="http://ads.bitsonthewire.com/admgriframe.asp?siteid=1126&ad_type=0" width=468 height=60 marginwidth=0 marginheight=0 hspace=0 vspace=0 frameborder=0 scrolling=no> 
                 <a href="http://ads.bitsonthewire.com/adrdrmanager.asp?loc=1">
                   <img border="0" src="http://ads.bitsonthewire.com/admanager.asp?loc=1&siteid=1126&ad_type=0">
                 </a></iframe> 
              <!-- stop BITS ad HTML -- top of page -- 468x60 banner                                --> 
				&nbsp;
              <a href="http://www.amazon.com/exec/obidos/redirect-home/vbipvisualbasici">
              <img border="0" src="../../images/gnused120x60.gif" width="120" height="60"></a></p>
          </td>
        </tr>
      </table>
    </td>
  </tr>
  <tr>
    <td width="100%" height="1" valign="top">
      <hr noshade color="#FF9933">
    </td>
  </tr>
  <tr>
    <td width="100%" height="1" valign="top">
    <p class="barsidecaption">
    	<a href="../../default.asp">Home</a> -
      	<a href="../../whatsnew.asp"> What's New</a> - <a href="../../tools.asp"> Tools&amp;Technologies</a> -
      	<a href="../../resources.asp"> Resources</a> - <a href="../../resources/books/default.asp">Books</a>
        - <a href="../../forum/">Forum</a>
    </p>
    </td>
  </tr>
  <tr>
    <td width="100%" height="1" valign="top">
      <hr noshade color="#FF9933">
    </td>
  </tr>
</table>

<table width="100%" cellspacing="1" cellpadding="2" bordercolor="#800000" border="1">
  <tr>
    <td width="100%" bgcolor="#FF9933">
      <font color="#FFFFCC">
      <table border="0" width="100%" cellspacing="0" cellpadding="0">
        <tr>
          <td width="37%">
          <SCRIPT LANGUAGE=javascript>
          <!--
          if(navigator.appName.indexOf('Microsoft')>=0)
          {
          document.write('<a HREF="javascript:void(0);" class="tbcaption" onClick="window.external.AddFavorite(location.href, document.title);">Add to Favorites</a>');
          }
          // -->
          </SCRIPT>
          </td>
          <td width="63%">
            <p align="right" class="tbcaption">
            <a href="../../default.asp" class="tbcaption">Home</a> -
            <a href="../../tools.asp" class="tbcaption">Tools&amp;Technologies</a> 
            - Miscellaneous - DirectoryInfo</td>
        </tr>
      </table>
      </font>
    </td>
  </tr>
</table>
<table border="0" width="100%" cellspacing="0" cellpadding="0">

<!--table-->
    <td width="125" valign="top"  style="border-left: 1px solid #800000; border-right: 1px solid #800000; " bgcolor="#FF9933">

    <table border="0" width="100%">
     <tr>
        <td width="100%" bgcolor="#FFCC00" style="border-left: 1px solid #800000; border-right: 1px solid #FFFFCC; border-top: 1px solid #800000; border-bottom: 1px solid #FFFFCC; " height="20">
          <p align="center" class="barsidecaption">[Advertisement]</td>
      </tr>
      <tr>
        <td width="100%" style="border: 1px solid #800000; " height="120">
<!-- start BITS ad HTML -- first 125x125 banner www.bitsonthewire.com                 --> 
<iframe src="http://ads.bitsonthewire.com/admgriframe.asp?siteid=1126&ad_type=-6" width=125 height=125 marginwidth=0 marginheight=0 hspace=0 vspace=0 frameborder=0 scrolling=no>
<a href="http://ads.bitsonthewire.com/adrdrmanager.asp?loc=3"><img border="0" src="http://ads.bitsonthewire.com/admanager.asp?loc=3&siteid=1126&ad_type=-6"></a></iframe> 
<!-- stop BITS ad HTML -- 125x125 banner                                             --> 	
        </td>
      </tr>
         
      <tr>
        <td width="100%" style="border-left: 1px solid #800000; border-right: 1px solid #FFFFCC; border-top: 1px solid #800000; border-bottom: 1px solid #FFFFCC; " bgcolor="#FFCC00" height="21">
          <p align="center" class="barsidecaption">[Search vbip.com]</td>
      </tr>
      <tr>
      
        <td valign="top" width="100%" height="21">
        
			<input type="text" size="7" name="search_site">&nbsp;
			<input type="button"  value="Go" onclick='location.href="http://www.vbip.com/search2/search.asp?Realm=vbip.com&Match=1&Terms="+document.GlobalForm.search_site.value;'>	
		
        </td>
      </tr>
         
      <tr>
        <td width="100%" style="border-left: 1px solid #800000; border-right: 1px solid #FFFFCC; border-top: 1px solid #800000; border-bottom: 1px solid #FFFFCC; " bgcolor="#FFCC00" height="21">
          <p align="center" class="barsidecaption">[Search other VB sites]</td>
      </tr>
      <tr>
        <td valign="top" width="100%" height="21">
        
			<input type="text" size="7" name="search_web">&nbsp;
			<input type="button"  value="Go" onclick='location.href="http://www.vbip.com/search2/search.asp?Realm=Other+VB+Websites&Match=1&Terms="+document.GlobalForm.search_web.value;'>	
		      
      </tr>
     
      <tr>
        <td width="100%" style="border-left: 1px solid #800000; border-right: 1px solid #FFFFCC; border-top: 1px solid #800000; border-bottom: 1px solid #FFFFCC; " bgcolor="#FFCC00" height="21">
          <p align="center" class="barsidecaption">[Featured Book]</td>
      </tr>
      <tr>
        <td valign="top" width="100%" height="21">
<center><script src="http://rcm.amazon.com/e/cm?t=vbipvisualbasici&l=st1&search=vb%20net&mode=books&p=8&o=1" type="text/JavaScript"></script><noscript>
<MAP NAME="boxmap"><AREA SHAPE="RECT" COORDS="14, 200, 103, 207" HREF="http://rcm.amazon.com/e/cm/privacy-policy.html?o=1"><AREA COORDS="0,0,10000,10000" HREF="http://www.amazon.com/exec/obidos/redirect-home/vbipvisualbasici"></MAP><img src="http://rcm-images.amazon.com/images/G/01/rcm/120x240.gif" width="120" height="240" border="0" usemap="#boxmap" alt="Shop at Amazon.com">

</noscript>

</center>
        </td>
      </tr>
     
      <tr>
        <td width="100%" style="border-left: 1px solid #800000; border-right: 1px solid #FFFFCC; border-top: 1px solid #800000; border-bottom: 1px solid #FFFFCC; " bgcolor="#FFCC00" height="21">
          <p align="center" class="barsidecaption">[Newsletter]</td>
      </tr>
      <tr>
        <td width="100%" height="56">
          <form method="POST" action="../../sub.asp" onSubmit="">
            <table border="0" width="100%" cellspacing="0">
              <tr>
                <td width="84%">
                <input type="text" name="T1" size="8" style="font-family: Tahoma; color: #800000; font-size: 8pt; background-color: #FFCC99; border-left: 1px solid #800000; border-right: 1px solid #FFFFCC; border-top: 1px solid #800000; border-bottom: 1px solid #FFFFCC; " value="your e-mail"></td>
                <td width="16%"><input type="submit" value="Sub" name="B1" style="font-family: Tahoma; font-size: 8pt; color: #800000"></td>
              </tr>
              <tr>
                <td width="100%" colspan="2"><input type="radio" value="V1" checked name="R1"><span class="barsidecaption">HTML</span>
                  <input type="radio" name="R1" value="V2"><span class="barsidecaption">Text</span></td>
              </tr>
            </table>
          </form>
        </td>
      </tr>

      <tr>
        <td width="100%" style="border-left: 1px solid #800000; border-right: 1px solid #FFFFCC; border-top: 1px solid #800000; border-bottom: 1px solid #FFFFCC; " bgcolor="#FFCC00" height="21">
      <p align="center" class="barsidecaption">
      [Partners]
      </tr>
	
  <tr>
        <td width="100%" height="22">
      <p align="center"><a href="http://www.vbcity.com" target="_blank"><img border="0" src="../..//images/vbcity2_100x30.gif" width="100" height="30"></a>
  </tr>
  <tr>
        <td width="100%" height="22">
      <p align="center"><a href="http://www.vbweb.co.uk/" target="_blank"><img border="0" src="../..//images/vbweb_button.gif" width="100" height="30"></a>
  </tr>  
      <tr>
        <td width="100%" height="12" align="center">
      <a href="http://www.vbwire.com" target="_blank"><img border="0" src="../..//images/VBWire-btn.gif" width="100" height="30"></a>
      </tr>

  <tr>
        <td width="100%" height="22">
      <p align="center"><a href="http://www.developersdex.com/vb" target="_blank"><img border="0" src="../..//images/vbdex.gif" width="100" height="30"></a>
  </tr>  
  <tr>
        <td width="100%" height="3">
        <center>
        <!-- BEGIN ACKY CODE -->
		<a href="http://www.acky.net" target="_blank"><img
		src="http://www.acky.net/banners/ackbut3.gif" width="88" height="31"
		border="0" alt="Acky.net is your one stop shop for all of your web
		developing needs"></a>
		<!-- END ACKY CODE -->
		</center>
  </tr>
    </table>

    </td>
    <td valign="top" bgcolor="#FFFFFF">
      <blockquote>
        <p>&nbsp;</p>
          <table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="90%" id="AutoNumber1" height="30">
            <tr>
              <td width="75%" height="14" valign="top">
              <p class="ChapterTitle"><span lang="en-us">DirectoryInfo<br>
              </span><b><font face="Arial" size="2"><span lang="en-us">
              Displaying the directory tree using the TreeView control in VB.NET</span></font></b></td>
              <td width="25%" rowspan="2" height="30">
              <p align="right"><img border="0" src="tree.gif"></td>
            </tr>
            <tr>
              <td width="75%" height="16">
              <p><b><font face="Arial" size="2" color="#800000">
              by Terry Hutt</font></b></td>
              </tr>
        </table>
          <table border="0" width="90%" cellspacing="0" cellpadding="0" height="44">
            <tr>
              <td width="100%" height="15" colspan="3">
        <hr noshade size="1" color="#FF9933">
              </td>
            </tr>
            <tr>
              <td width="16" bgcolor="#FFFFCC" height="21" valign="top" style="border: 1px solid #FF9933" class="tbcaption">
                <p align="center">
                <a href="DirectoryInfo.zip">
                <img border="0" src="../../images/download-icon4.gif" align="right"></a></td>
              <td width="40%" bgcolor="#FF9933" height="21" class="tbcaption">
                <p>&nbsp;<a class="tbcaption" href="DirectoryInfo.zip">Download
                <span lang="en-us">DirectoryInfo</span> sample project</a></td>
              <td width="57%" bgcolor="#FF9933" height="21" class="tbcaption">
              <p align="right" class="tbcaption">
              &nbsp;</td>
            </tr>
            <tr>
              <td width="100%" height="15" colspan="3">
        <hr noshade size="1" color="#FF9933">
              </td>
            </tr>
          </table>
        <p align="justify">
        <img border="0" src="../../images/t.gif" align="left">his project was created using the
        <b>.Net Beta 2 Release</b>. It was 
        originally written in VB6 and then rewritten in VB.Net. It teaches how 
        to browse the directory structure and display it using the TreeView 
        control. I make a point of highlighting differences between the VB6 and 
        the VB.Net solutions. Some of them were quite a surprise.</p>
        <p class="ArticleH2">Requirements</p>
        <blockquote>
          <p align="justify">To write a program that allows the user to browse around their C: 
          drive, listing subfolders and files. The purpose is to learn something 
          about the .Net equivalent of the FileSystem object and the TreeView 
          control. </p>
          <p>You will need Visual Studio.Net Beta 2 or Release Candidate 1 or 
          later installed. </p>
        </blockquote>
        <p class="ArticleH2">Let’s get started</p>
        <blockquote>
          <ul type="square">
            <li>Start a new project in Visual Studio.Net.<br>
&nbsp;</li>
            <li>Under Visual Basic Projects, select Windows Application and name 
            it <font face="Courier New">DirDemo</font>.<br>
&nbsp;</li>
            <li>Rename <font face="Courier New">Form1</font> as
            <font face="Courier New">frmDirDemo</font>, change the text to <i>Directory Demo.
            </i>
            <br>
&nbsp;</li>
            <li>In the toolbox select TreeView in the Windows Forms group.<br>
&nbsp;</li>
            <li>Create a TreeView control covering the entire client area of 
            <font face="Courier New">frmDirDemo</font>. <br>
&nbsp;</li>
            <li>As you know, treeviews use image lists so you need to add and 
            populate an image list. Double click <i>ImageList</i> in the toolbox. You 
            will see <font face="Courier New">ImageList1</font> added under the form. This is different to how 
            invisible controls are displayed at design time in VB6.<br>
&nbsp;</li>
            <li>Select <font face="Courier New">ImageList1</font> and open the 
            <font face="Courier New">Images</font> property in the property 
            frame. <br>
&nbsp;</li>
            <li>Now we can add the images to the image list <br>
&nbsp;</li>
            <li>Click [Add] in the Image Collection Editor dialog box <br>
&nbsp;</li>
            <li>Browse to … <br>
            C:\Program Files\Microsoft Visual 
            Studio.Net\Common7\Graphics\Bitmaps\Outline\ <br>
&nbsp;</li>
            <li>Select Closed.bmp, Open.bmp, and Leaf.bmp in that order. The 
            dialog box should look like this… </li>
          </ul>
          <p align="center">
          <span lang="EN-US" style="font-size: 12.0pt; font-family: Tahoma">
          <img width="365" height="287" src="dir-in1.jpg" v:shapes="_x0000_i1025"></span></p>
          <ul type="square">
            <li>Click OK to close the dialog box. <br>
&nbsp;</li>
            <li>Now we need to tell the TreeView control to use the image list 
            we just created. Select the TreeView control and select 
            <font face="Courier New">ImageList1</font> 
            in the <font face="Courier New">ImageList</font> property. </li>
          </ul>
          <blockquote>
            <p>This is pretty much the same as adding a TreeView and ImageList 
            in VB6. </p>
          </blockquote>
        </blockquote>
        <p class="ArticleH2">Time to add some code</p>
        <blockquote>
          <p align="justify">In VB6 we would have used the Visual Basic Scripting reference to 
          get access to the <font face="Courier New">FileSystem</font> object. In VB.Net we could do the same 
          thing but the <font face="Courier New">System</font> assembly contains several interesting objects 
          such as <font face="Courier New">System.IO.FileSystemInfo</font>, 
          <font face="Courier New">DirectoryInfo</font>, and 
          <font face="Courier New">FileInfo</font> which we 
          will use instead. </p>
          <p>Bring up the code for <font face="Courier New">frmDirDemo</font>.. It should look like this </p>
          <table border='0' width='80%' bgcolor='#F8F8F8' cellspacing='0' cellpadding='2'>
  <tr>
    <td width='100%'>
      <p class='code'><img border="0" src="../../images/minus.gif">&nbsp;Public Class Form1 &nbsp;<br>
Inherits System.Windows.Forms.Form &nbsp;<br>
 &nbsp;<br>
      <img border="0" src="../../images/plus.gif"> Windows Form Designer generated code &nbsp;<br>
 &nbsp;<br>
 End Class &nbsp;<br>
      </p>
    </td>
  </tr>
</table>
          <p>Start by renaming <font face="Courier New">Form1</font> as
          <font face="Courier New">frmDirDemo</font><span lang="en-us">.</span></p>
          <p align="justify">We want to use several references from 
          <font face="Courier New">System.IO</font> so we can add an
          <font face="Courier New">Imports</font> statement at the top to reduce the amount of code we 
          have to write.</p>
          <table border='0' width='80%' bgcolor='#F8F8F8' cellspacing='0' cellpadding='2'>
  <tr>
    <td width='100%'>
      <p class='code'>Imports&nbsp;System.io&nbsp;<br>
      </p>
    </td>
  </tr>
</table>
          <p align="justify">Next we want to write the code that executes when the form loads. 
          Above the code window there are two combo boxes, same as VB6. But if 
          you drop the left combo box you’ll see it looks very different. The 
          entry that says ‘form’ in VB6 has been broken into three entries in 
          VB.Net.</p>
          <p align="center">
          <span lang="EN-US" style="font-size: 12.0pt; font-family: Tahoma">
          <img width="377" height="107" src="dir-in2.jpg" v:shapes="_x0000_i1025"></span></p>
          <p align="justify">Because forms are now classes, the top entry gives you access to 
          all the methods and properties of the current form, the second entry 
          gives you access to all the <i>overridable</i> methods and properties of the 
          base class (<font face="Courier New">Form</font>), and the third entry gives you access to all the 
          events of the base class. After the third entry, all the controls are 
          listed as in VB6. </p>
          <p align="justify">To add code to the form load event, select <i>Base Class Events</i> from 
          the left combo box and the right combo box will be populated with the 
          familiar list of form events (with a few changes). </p>
          <p>Now select the <font face="Courier New">Load</font> event. Visual Studio will add the following 
          code. </p>
          <table border='0' width='80%' bgcolor='#F8F8F8' cellspacing='0' cellpadding='2'>
  <tr>
    <td width='100%'>
      <p class='code'><font color="#000080">Private&nbsp;Sub&nbsp;</font>frmDirDemo_Load(<font color="#000080">ByVal&nbsp;</font>sender&nbsp;<font color="#000080">As&nbsp;Object</font>,&nbsp;<font color="#000080">ByVal&nbsp;</font>e&nbsp;<font color="#000080">As&nbsp;</font>_&nbsp;<br>
      <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      </span>System.EventArgs)&nbsp;<font color="#000080">Handles&nbsp;MyBase</font>.Load&nbsp;<br>
&nbsp;<br>
<font color="#000080">End&nbsp;Sub&nbsp;</font><br>
      </p>
    </td>
  </tr>
</table>
          <p align="justify">Which is a little more than you expected isn’t it? Fact is, there’s 
          a lot more information passed to events in .Net. Note the subroutine 
          does not have to be called <font face="Courier New">frmDirDemo_Load</font>. Visual Studio calls it 
          that to make VB6 programmers feel more at home. You can call it 
          anything you like. The important thing is <font face="Courier New">Handles MyBase.Load</font>. Don’t 
          mess with that bit! </p>
          <p>Our form load code will simply create one node in the tree view 
          called C: It looks like this… </p>
          <table border='0' width='80%' bgcolor='#F8F8F8' cellspacing='0' cellpadding='2'>
  <tr>
    <td width='100%'>
      <p class='code'><font color="#000080">Private&nbsp;Sub&nbsp;</font>frmDirDemo_Load(<font color="#000080">ByVal&nbsp;</font>sender&nbsp;<font color="#000080">As&nbsp;Object</font>,&nbsp;<font color="#000080">ByVal&nbsp;</font>e&nbsp;<font color="#000080">As&nbsp;</font>_&nbsp;<br>
      <span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      </span>System.EventArgs)&nbsp;<font color="#000080">Handles&nbsp;MyBase</font>.Load&nbsp;<br>
<font color="#000080"><span lang="en-us">&nbsp;&nbsp;&nbsp; </span>Dim&nbsp;</font>oNode&nbsp;<font color="#000080">As&nbsp;New&nbsp;</font>System.Windows.Forms.TreeNode&nbsp;<br>
      <span lang="en-us">&nbsp;&nbsp;&nbsp; </span>Try&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span lang="en-us">&nbsp;&nbsp;&nbsp; </span>oNode.ImageIndex&nbsp;=&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">'&nbsp;Closed&nbsp;folder&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span lang="en-us">&nbsp;&nbsp;&nbsp; </span>oNode.SelectedImageIndex&nbsp;=&nbsp;0&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span lang="en-us">&nbsp;&nbsp;&nbsp; </span>oNode.Text&nbsp;=&nbsp;<font color="#808080">"C:"</font>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span lang="en-us">&nbsp;&nbsp;&nbsp; </span>TreeView1.Nodes.Add(oNode)&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span lang="en-us">&nbsp;&nbsp;&nbsp; </span>oNode.Nodes.Add(<font color="#808080">""</font>)&nbsp;<br>
      <span lang="en-us">&nbsp;&nbsp;&nbsp; </span>Catch&nbsp;ex&nbsp;<font color="#000080">As&nbsp;</font>Exception&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span lang="en-us">&nbsp;&nbsp;&nbsp; </span>MsgBox(<font color="#808080">"Cannot&nbsp;create&nbsp;initial&nbsp;node:"</font>&nbsp;&&nbsp;ex.ToString)&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080"><span lang="en-us">&nbsp;&nbsp;&nbsp;
      </span>End&nbsp;</font><br>
<font color="#000080"><span lang="en-us">&nbsp;&nbsp;&nbsp; </span>End&nbsp;Try</font>&nbsp;<br>
<font color="#000080">End&nbsp;Sub&nbsp;</font><br>
&nbsp;<br>
      </p>
    </td>
  </tr>
</table>
          <p>(If you don’t have a C: drive, use another letter instead.)</p>
          <p align="justify">The .Net tree view control is a quite different from the VB6 tree 
          control. The add method has far fewer parameters in .Net. 
          Specifically, the node no longer has a key, only a text property. 
          Also, you build the node object first, then add it to the node 
          collection.</p>
          <p>Whereas in VB6 you might see…</p>
          <table border='0' width='80%' bgcolor='#F8F8F8' cellspacing='0' cellpadding='2'>
  <tr>
    <td width='100%'>
      <p class='code'>TreeView1.Nodes.Add 1, 1, &quot;Key&quot;, &quot;text&quot;, 2, 3</p>
    </td>
  </tr>
</table>
          <p>the equivalent in VB.Net might be…</p>
          <table border='0' width='80%' bgcolor='#F8F8F8' cellspacing='0' cellpadding='2'>
  <tr>
    <td width='100%'>
      <p class='code'><font color="#000080">Dim&nbsp;</font>oNode&nbsp;<font color="#000080">As&nbsp;New&nbsp;</font>System.Windows.Form.TreeNode&nbsp;<br>
oNode.Text&nbsp;=&nbsp;&quot;Text&quot;&nbsp;<br>
oNode.ImageIndex&nbsp;=&nbsp;2&nbsp;<br>
oNode.SelectedImageIndex&nbsp;=&nbsp;3&nbsp;<br>
TreeView1.nodes.add&nbsp;oNode&nbsp;<br>
      </p>
    </td>
  </tr>
</table>
          <p>I’ll leave you to 
          judge which is better.</p>
          <p align="justify">The first thing the user will want to do is expand 
          the C: node. They can only do this is there is a
          <img border="0" src="../../images/plus.gif"> symbol by the node. The 
          TreeView control will only put a
          <img border="0" src="../../images/plus.gif"> symbol by a node if the 
          node’s node collection has members. This creates a chicken and egg 
          situation. We can’t expand a node without a
          <img border="0" src="../../images/plus.gif"> symbol to click on but 
          the symbol won’t be there until we’ve expanded the node.</p>
          <p align="justify">To solve this dilemma, I create an empty child 
          node. If, when we expand the node (folder) it turns our there are no 
          children (subfolders), we will remove the empty node and the
          <img border="0" src="../../images/plus.gif"> symbol will go away. 
          Hence the line of code </p>
          <table border='0' width='80%' bgcolor='#F8F8F8' cellspacing='0' cellpadding='2'>
  <tr>
    <td width='100%'>
      <p class='code'>oNode.Nodes.Add(&quot;&quot;)</p>
    </td>
  </tr>
</table>
          <p>This introduces an alternative add method which takes a string 
          instead of a <font face="Courier New">TreeNode</font> object.</p>
          <p align="justify">The last thing worth looking at in this subroutine 
          is the <i>Try/Catch</i> error handling. Almost every other language has had 
          this kind of error handling syntax since inception. It’s much better 
          than the VB <font face="Courier New">On Error Resume…</font> syntax and results in far fewer lines of 
          code devoted to handling exceptions.</p>
          <p>If you run the program as it currently stands all you’ll see is a 
          C: node which does nothing.</p>
        </blockquote>
          <p class="ArticleH2">Reacting to events</p>
        <blockquote>
          <p align="justify">There are two events we need to react to. They occur when the user 
          expands or collapses a node in the tree. The expand event is most 
          complex so we’ll discuss it first.</p>
          <p>In the left combo box select <font face="Courier New">TreeView1</font> and in the 
          right combo box select <font face="Courier New">BeforeExpand</font>. Insert the code so the event 
          handler looks like this…</p>
          <table border='0' width='80%' bgcolor='#F8F8F8' cellspacing='0' cellpadding='2'>
  <tr>
    <td width='100%'>
      <p class='code'><font color="#000080">Private&nbsp;Sub&nbsp;</font>TreeView1_BeforeExpand(<font color="#000080">ByVal&nbsp;</font>sender&nbsp;<font color="#000080">As&nbsp;Object</font>,&nbsp;<font color="#000080">ByVal&nbsp;</font>e&nbsp;<font color="#000080">As&nbsp;</font>_&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.Windows.Forms.TreeViewCancelEventArgs)&nbsp;Handles&nbsp;_&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TreeView1.BeforeExpand&nbsp;<br>
&nbsp;<br>
<font color="#000080">&nbsp;&nbsp;&nbsp; If&nbsp;</font>e.Node.ImageIndex&nbsp;=&nbsp;2&nbsp;<font color="#000080">Then&nbsp;Exit&nbsp;Sub&nbsp;</font><br>
&nbsp;<br>
      <font color="#000080">&nbsp;&nbsp;&nbsp;
Try</font>&nbsp;<br>
&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;<font color="#000080">If&nbsp;</font>e.Node.GetNodeCount(<font color="#000080">False</font>)&nbsp;=&nbsp;1&nbsp;<font color="#000080">And&nbsp;</font>e.Node.Nodes(0).Text&nbsp;=&nbsp;<font color="#808080">""</font>&nbsp;<font color="#000080">Then&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.Node.Nodes(0).Remove()&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EnumerateChildren(e.Node)&nbsp;<br>
&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;<font color="#000080">End&nbsp;If&nbsp;</font><br>
      <font color="#000080">&nbsp;&nbsp;&nbsp;
Catch</font>&nbsp;ex&nbsp;<font color="#000080">As&nbsp;</font>Exception&nbsp;<br>
&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;MsgBox(<font color="#808080">"Unable&nbsp;to&nbsp;expand&nbsp;"</font>&nbsp;&&nbsp;e.Node.FullPath&nbsp;&&nbsp;<font color="#808080">":"</font>&nbsp;&&nbsp;ex.ToString)&nbsp;<br>
      <font color="#000080">&nbsp;&nbsp;&nbsp; End&nbsp;Try</font>&nbsp;<br>
&nbsp;<br>
<font color="#000080">&nbsp;&nbsp;&nbsp; If&nbsp;</font>e.Node.GetNodeCount(<font color="#000080">False</font>)&nbsp;>&nbsp;0&nbsp;<font color="#000080">Then&nbsp;</font>&nbsp;<br>
&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;e.Node.ImageIndex&nbsp;=&nbsp;1&nbsp;<br>
&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;e.Node.SelectedImageIndex&nbsp;=&nbsp;1&nbsp;<br>
<font color="#000080">&nbsp;&nbsp;&nbsp; End&nbsp;If&nbsp;</font><br>
&nbsp;<br>
<font color="#000080">End&nbsp;Sub&nbsp;</font><br>
      </p>
    </td>
  </tr>
</table>
          <p align="justify">How do we know which node is being expanded? If you browse through 
          the <font face="Courier New">sender</font> and 
          <font face="Courier New">e</font> objects passed to the event handler you’ll find all 
          sorts of interesting things. For this event, the 
          <font face="Courier New">e</font> object contains the
          <font face="Courier New">TreeNode</font> object being expanded.</p>
          <p align="justify">We don’t want to expand leaf nodes (files) so how can we tell the 
          node represents a file? We could use the treenode’s
          <font face="Courier New">Tag</font> property to 
          store this information as we create it, or we could subclass the
          <font face="Courier New">TreeNode</font> class to add custom properties. I chose to use the fact that 
          the <font face="Courier New">ImageIndex</font> for any node that represents a file will be 2. That’s 
          why we added leaf.bmp last.</p>
          <p align="justify">Once we’ve decided we’re expanding a folder, we look to see if 
          there exactly one child node with no text. If this is the case, we’ve 
          never expanded this node before so we need to root around in the file 
          system to see what folders and files are in this folder. Before we do 
          that, we remove the dummy child.</p>
          <p align="justify">When we’ve finished expanding the node we look to see how many 
          children it has. If it has any, we alter the <font face="Courier New">
          ImageIndex</font> to point to an 
          open folder image. If it doesn’t have any children, we leave the image 
          as it is (a closed folder).</p>
          <p align="justify">This leaves us with a subroutine to write – 
          <font face="Courier New">EnumerateChildren</font></p>
          <table border='0' width='80%' bgcolor='#F8F8F8' cellspacing='0' cellpadding='2'>
  <tr>
    <td width='100%'>
      <p class='code'><font color="#000080">Private&nbsp;Sub&nbsp;</font>EnumerateChildren(<font color="#000080">ByVal&nbsp;</font>oParent&nbsp;<font color="#000080">As&nbsp;</font>System.Windows.Forms.TreeNode)&nbsp;<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;<font color="#000080">Dim&nbsp;</font>oFS&nbsp;<font color="#000080">As&nbsp;New&nbsp;</font>DirectoryInfo(oParent.FullPath&nbsp;&&nbsp;<font color="#808080">"\"</font>)&nbsp;<br>
&nbsp;&nbsp;&nbsp;<font color="#000080">Dim&nbsp;</font>oDir&nbsp;<font color="#000080">As&nbsp;</font>DirectoryInfo&nbsp;<br>
&nbsp;&nbsp;&nbsp;<font color="#000080">Dim&nbsp;</font>oFile&nbsp;<font color="#000080">As&nbsp;</font>FileInfo&nbsp;<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;<font color="#000080">Try</font>&nbsp;<br>
<font color="#000080">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; For&nbsp;Each&nbsp;</font>oDir&nbsp;<font color="#000080">In&nbsp;</font>oFS.GetDirectories()&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<font color="#000080">Dim&nbsp;</font>oNode&nbsp;<font color="#000080">As&nbsp;New&nbsp;</font>System.Windows.Forms.TreeNode()&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;oNode.Text&nbsp;=&nbsp;oDir.Name&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;oNode.ImageIndex&nbsp;=&nbsp;0&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;oNode.SelectedImageIndex&nbsp;=&nbsp;0&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;oParent.Nodes.Add(oNode)&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;oNode.Nodes.Add(<font color="#808080">""</font>)&nbsp;<br>
<font color="#000080">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Next&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;<font color="#000080">Catch</font>&nbsp;ex&nbsp;<font color="#000080">As&nbsp;</font>Exception&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MsgBox(<font color="#808080">"Cannot&nbsp;list&nbsp;folders&nbsp;of&nbsp;"</font>&nbsp;&&nbsp;oParent.FullPath&nbsp;&&nbsp;<font color="#808080">":"</font>&nbsp;&&nbsp;ex.ToString)&nbsp;<br>
&nbsp;&nbsp;&nbsp;<font color="#000080">End&nbsp;Try</font>&nbsp;<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;<font color="#000080">Try</font>&nbsp;<br>
<font color="#000080">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; For&nbsp;Each&nbsp;</font>oFile&nbsp;<font color="#000080">In&nbsp;</font>oFS.GetFiles()&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<font color="#000080">Dim&nbsp;</font>oNode&nbsp;<font color="#000080">As&nbsp;New&nbsp;</font>System.Windows.Forms.TreeNode()&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;oNode.Text&nbsp;=&nbsp;oFile.Name&nbsp;&&nbsp;<font color="#808080">"&nbsp;("</font>&nbsp;&&nbsp;oFile.Length&nbsp;&&nbsp;<font color="#808080">"&nbsp;bytes)"</font>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;oNode.ImageIndex&nbsp;=&nbsp;2&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;oNode.SelectedImageIndex&nbsp;=&nbsp;2&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;oParent.Nodes.Add(oNode)&nbsp;<br>
<font color="#000080">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Next&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;<font color="#000080">Catch</font>&nbsp;ex&nbsp;<font color="#000080">As&nbsp;</font>Exception&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MsgBox(<font color="#808080">"Cannot&nbsp;list&nbsp;files&nbsp;in&nbsp;"</font>&nbsp;&&nbsp;oParent.FullPath&nbsp;&&nbsp;<font color="#808080">":"</font>&nbsp;&&nbsp;ex.ToString)&nbsp;<br>
&nbsp;&nbsp;&nbsp;<font color="#000080">End&nbsp;Try</font>&nbsp;<br>
&nbsp;<br>
<font color="#000080">End&nbsp;Sub&nbsp;</font><br>
      </p>
    </td>
  </tr>
</table>
          <p align="justify">Note that VB.Net does not object to the two 
          <font face="Courier New">Dim oNode</font> statements. 
          It’s smart enough to realize they have non-overlapping scopes. VB6 
          would not have compiled this.</p>
          <p align="justify">This routine expects a <font face="Courier New">TreeNode</font> object. This might have a text 
          such as &quot;WinZip7&quot;. We need to find all the children of the &quot;WinZip7&quot; 
          folder but to do that we need the full path. Fortunately, the
          <font face="Courier New">TreeNode</font> 
          object has a <font face="Courier New">FullPath</font> property which is really a concatenation of all 
          the texts of the node’s parents separated by the &quot;\&quot; character (as 
          specified in <font face="Courier New">TreeView1.PathSeparator</font>). So if the tree looks like this</p>
          <p align="center">
          <span lang="EN-US" style="font-size: 12.0pt; font-family: Tahoma">
          <img width="300" height="139" src="dir-in3.jpg" v:shapes="_x0000_i1025"></span></p>
          <p align="justify">and the user expands the <i>WinZip7</i> node, the fullpath property of the 
          node will be <i>C:\download\WinZip7</i>. This is perfect for passing to the 
          constructor of the <font face="Courier New">DirectoryInfo</font> class.</p>
          <p align="justify">We create the <font face="Courier New">DirectoryInfo</font> object by pointing it at a directory. 
          When we execute the <font face="Courier New">GetDirectories()</font> method we get back an array of
          <font face="Courier New">DirectoryInfo</font> objects which we can iterate through, creating a new 
          child node for each directory. They start with an 
          <font face="Courier New">ImageIndex</font> of 0 
          meaning a closed folder.</p>
          <p align="justify">When we execute the <font face="Courier New">GetFiles()</font> method we get back an array of
          <font face="Courier New">FileInfo</font> objects which we can iterate through, creating a new child 
          for each file. They start with an <font face="Courier New">ImageIndex</font> of 2.</p>
        </blockquote>
          <p class="ArticleH2">We’re almost done</p>
        <blockquote>
          <p align="justify">When a node is collapsed we want to close the folder icon for the 
          node. The following code in the <font face="Courier New">TreeView1.BeforeCollapse</font> event handler 
          does this.</p>
          <table border='0' width='80%' bgcolor='#F8F8F8' cellspacing='0' cellpadding='2'>
  <tr>
    <td width='100%'>
      <p class='code'><font color="#000080">Private&nbsp;Sub&nbsp;</font>TreeView1_BeforeCollapse(<font color="#000080">ByVal&nbsp;</font>sender&nbsp;<font color="#000080">As&nbsp;Object</font>,&nbsp;<font color="#000080">ByVal&nbsp;</font>e&nbsp;<font color="#000080">As&nbsp;</font>_&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.Windows.Forms.TreeViewCancelEventArgs)&nbsp;<font color="#000080">Handles</font>&nbsp;_&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TreeView1.BeforeCollapse&nbsp;<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;
e.Node.ImageIndex&nbsp;=&nbsp;0&nbsp;<br>
&nbsp;&nbsp;&nbsp;
e.Node.SelectedImageIndex&nbsp;=&nbsp;0&nbsp;<br>
      <br>
<font color="#000080">End&nbsp;Sub&nbsp;</font>&nbsp;<br>
      </p>
    </td>
  </tr>
</table>
          <p>When the form is resized we want the tree view control to fill the 
          entire client area. The following code in the<font face="Courier New"> frmDirDemo Resize</font> event 
          handler will do this.</p>
          <table border='0' width='80%' bgcolor='#F8F8F8' cellspacing='0' cellpadding='2'>
  <tr>
    <td width='100%'>
      <p class='code'><font color="#000080">Private&nbsp;Sub&nbsp;</font>frmDirDemo_Resize(<font color="#000080">ByVal&nbsp;</font>sender&nbsp;<font color="#000080">As&nbsp;Object</font>,&nbsp;<font color="#000080">ByVal&nbsp;</font>e&nbsp;<font color="#000080">As&nbsp;</font>_&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.EventArgs)&nbsp;<font color="#000080">Handles</font>&nbsp;MyBase.Resize&nbsp;<br>
&nbsp;<br>
<font color="#000080">&nbsp;&nbsp;&nbsp; If&nbsp;</font>Me.WindowState&nbsp;=&nbsp;FormWindowState.Minimized&nbsp;<font color="#000080">Then&nbsp;Exit&nbsp;Sub&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;TreeView1.Bounds&nbsp;=&nbsp;<font color="#000080">New&nbsp;</font>Rectangle(0,&nbsp;0,&nbsp;Me.ClientSize.Width,&nbsp;_<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;Me.ClientSize.Height)&nbsp;<br>
&nbsp;<br>
<font color="#000080">End&nbsp;Sub&nbsp;</font><br>
      </p>
    </td>
  </tr>
</table>
          <p>Note the <font face="Courier New">Bounds</font> property can be used to set the location and size 
          of a control at the same time. It takes a rectangle object as its 
          parameter.</p>
          <p>The <font face="Courier New">Form.Unload</font> event no longer exists. Instead, use the 
          <font face="Courier New">Leave</font> 
          event to terminate the program.</p>
          <table border='0' width='80%' bgcolor='#F8F8F8' cellspacing='0' cellpadding='2'>
  <tr>
    <td width='100%'>
      <p class='code'><font color="#000080">Private&nbsp;Sub&nbsp;</font>frmDirDemo_Leave(<font color="#000080">ByVal&nbsp;</font>sender&nbsp;<font color="#000080">As&nbsp;Object</font>,&nbsp;<font color="#000080">ByVal&nbsp;</font>e&nbsp;<font color="#000080">As&nbsp;</font>_&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.EventArgs)&nbsp;<font color="#000080">Handles</font>&nbsp;MyBase.Leave&nbsp;<br>
&nbsp;<br>
<font color="#000080">&nbsp;&nbsp;&nbsp; End&nbsp;</font><br>
<font color="#000080">End&nbsp;Sub&nbsp;</font><br>
&nbsp;<br>
      </p>
    </td>
  </tr>
</table>
          <p>There is one more thing to note. In VB6 we are used to having a 
          <font face="Courier New">Form.Resize</font> event raised as soon as the form loads. This does not 
          occur in VB.Net.</p>
        </blockquote>
<p>        
    <hr noshade color="#FF9933">
    <table width="90%" align="center" border="0">
      <tr>
        <td width="25%">
          <img border="0" src="../../../images/comments.gif">
        </td>
        <td width="75%">
          Please, post here only feedback for the article/tutorial/sample you
          have read above.<br>
          If you have any question and like to get an answer, post your messages in the <a href="http://www.vbip.com/forum/">Forum</a>.
        <td>
      </tr>
    </table>
    
    
			<p><b><font face="Arial" size="2" color="#800000"><a href="../../../comment.asp?898">nice article</a></font></b><br>
			<i><font color="#808080" face="Times New Roman" size="2">shane Thursday, May 30, 2002</font></i>	
			</p>
			
			<p><b><font face="Arial" size="2" color="#800000"><a href="../../../comment.asp?918">Excellent article - thanks!!</a></font></b><br>
			<i><font color="#808080" face="Times New Roman" size="2">Mike Tuesday, June 11, 2002</font></i>	
			</p>
			
			<p><b><font face="Arial" size="2" color="#800000"><a href="../../../comment.asp?934">Just What the Doctor Ordered.</a></font></b><br>
			<i><font color="#808080" face="Times New Roman" size="2">Chuck Snyder Monday, June 17, 2002</font></i>	
			</p>
			
        <p>
        <form name="newcomm" method="POST" action="../../../add_comments.asp">
          <p><input align="right" border="0" src="../../../images/addyours2.gif" name="I1" type="image"></p>
          <input type="hidden" name="page" value="/miscellaneous/directory-info/dir-info-01.asp">
          <input type="hidden" name="title">
	  <input type="hidden" name="actionID" value="add">
        </form>
        <SCRIPT LANGUAGE="JavaScript">
        	{document.newcomm.title.value = document.title}
        </SCRIPT>
	<br>
        <p>
        <hr noshade color="#FF9933">
</p>   
      </blockquote>
<p><center>
<!-- start BITS ad HTML -- bottom of page 468x60 banner www.bitsonthewire.com         --> 
  <iframe src="http://ads.bitsonthewire.com/admgriframe.asp?siteid=1126&ad_type=2" width=468 height=60 marginwidth=0 marginheight=0 hspace=0 vspace=0 frameborder=0 scrolling=no> 
    <a href="http://ads.bitsonthewire.com/adrdrmanager.asp?loc=2">
      <p>
      <img border="0" src="http://ads.bitsonthewire.com/admanager.asp?loc=2&siteid=1126&ad_type=2">
    </a>
  </iframe> 
<!-- stop BITS ad HTML -- bottom of page 468x60 banner                                --> 
</center></p>
    </td>
</table>
<table border="1" width="100%" cellspacing="1" cellpadding="2" bordercolor="#800000">
  <tr>
    <td width="100%" bgcolor="#FF9933">
      <font color="#FFFFCC">
      <table border="0" width="100%" cellspacing="0" cellpadding="0">
        <tr>
          <td width="37%"></td>
          <td width="63%">
      <font color="#FFFFCC">
            <p align="right" class="tbcaption">
            <a href="../../default.asp" class="tbcaption">Home</a> -
            <a href="../../tools.asp" class="tbcaption">Tools&amp;Technologies</a> 
            - Miscellaneous - DirectoryInfo</font></td>
        </tr>
      </table>
      </font>
    </td>
  </tr>
</table>
&nbsp;<table border="0" width="100%" cellspacing="0" cellpadding="0">
  <tr>
    <td width="121" valign="top">
<!-- START OF WEBTRENDS LIVE TAG -->
<!-- Copyright 2001 NetIQ Corporation -->
<!--  For privacy concerns, check our Privacy Policy at http://www.webtrendslive.com/privacy_policy.htm -->
<SCRIPT LANGUAGE="JavaScript">
<!--
// Modification of this code is not allowed and will permanently disable your account!
// SiteName:  Visual Basic Internet Programming
function wtl_Tag4_27048()
{
	function D8( d)
	{
		var fwd=1, seed= new Date('01/01/2000'), key= "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";
		var s= key.charAt( d.getFullYear()-2000)+key.charAt( d.getMonth()+1)+key.charAt( d.getDate());
		s+= key.charAt( d.getHours())+key.charAt( d.getMinutes())+key.charAt( d.getSeconds());
		while( seed.getDay()!=fwd) seed= new Date(seed.getTime() + 86400000);
		var w= Math.floor( (d.getTime()-(seed.getTime()+86400000)) / 604800000 );
		s+= key.charAt( (w-(w%16))/16 );
		s+= key.charAt( w%16);
		return s;
	}

	var t = new Date();
	var W="tagver=4&si=27048&fw=1&bn=13";
	W+="&tz="+escape(t.getTimezoneOffset());
	W+="&ch="+escape(t.getHours());
	W+="&cl="+escape(D8(t));
	W+="&ti="+escape(document.title);
	W+="&url="+escape(window.document.URL);
	W+="&rf="+escape(window.document.referrer);
	W+="&js=Yes";
	W+="&ul="+(navigator.appName=="Netscape"?navigator.language:navigator.userLanguage);
	if(typeof(screen)=="object")
	{
	W+="&sr="+screen.width+"x"+screen.height;
	W+="&cd="+screen.colorDepth;
	W+="&jo="+(navigator.javaEnabled()?"Yes":"No");
	}
	
	
	document.write('<A TARGET="_blank" HREF="http://www.webtrendslive.com/redirect.asp?siteID=27048">');
	document.write('<IMG ID="WTL_TAG" BORDER="0" WIDTH="100" HEIGHT="30" ALT="This Site Tracked by WebTrendsLive." SRC="http://p.wtlive.com/S003-00-9-14-186109-27048/button4.asp?'+W+'">');
	document.write('</A>');
	
}	

wtl_Tag4_27048();
//-->
</SCRIPT>


<NOSCRIPT>
<A TARGET="_blank" HREF="http://www.webtrendslive.com/redirect.asp?siteID=27048">
<IMG BORDER="0" WIDTH="100" HEIGHT="30" ALT="This Site Tracked by WebTrendsLive." SRC="http://p.wtlive.com/S003-00-9-14-186109-27048/button4.asp?tagver=4&si=27048&fw=1&bn=13&js=No&"></A></NOSCRIPT>


<!-- END OF WEBTRENDS LIVE TAG -->

     
      </td>
    <td>
<p align="center" class="barsidecaption"><a href="../../default.asp">Home</a> | <a href="../../whatsnew.asp">What's
New</a> | <a href="../../tools.asp"> Tools
&amp; Technologies</a> | <a href="../../resources.asp">Resources</a> | <a href="../../resources/books/default.asp">Books</a>
 | <a href="../../forum/">Forum</a></p>
<p align="center" class="barsidecaption">Report about any problems and errors to <a href="mailto:webmaster@vbip.com">webmaster@vbip.com</a><br>
Copyright © 1998 - 2002 by <a href="mailto:oleg@vbip.com"> Oleg Gdalevich</a></p>
    </td>
    <td valign="top" width="140">
<p align="center">
<a target="_blank" href="http://www.amazon.com/exec/obidos/ASIN/B00005AFI2/vbipvisualbasici">
<img border="0" src="../../images/frontpage_button.gif" align="right" width="100" height="38"></a>
    </td>
  </tr>
</table>
</body>

</html>
