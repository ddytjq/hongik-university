ID=F0063
URL=http://www.vbsquare.com/misc/tip491.html
SIZE=45333
DATE=09/07/2002
TIME=13:13:38
DATASET=Visual Basic
HTML=<html>
<head>
<title>VB Square - Miscellaneous - Base Conversion</title>
<meta name="keywords" content=",,visual basic,vb,visual,basic,win32,vb4,vb5,vb6,visual basic,vb,visual,basic,win32,vb4,vb5,vb6">
<meta name="description" content="Provides conversion between numbers in different bases.">
<STYLE type=text/css>
.blfont {
  COLOR: #007F00;
}
.redfont {
  COLOR: #cc0033;
}
.yllwfont {
  font-family: Verdana, Arial; 
  font-size: 11px;
  font-weight: bold;
  COLOR: #FFFF33;
}
.bluefont {
  COLOR: #007F00;
  font-family: Verdana, Arial; 
  font-size: 11px;
}
.navbit {
  font-family: Verdana, Geneva, Lucida, Arial; 
  font-size: 11px;
}
.whitefont {
  COLOR: #000000;
}
A:hover {
  COLOR: #ff0000;
}
A:link {
  COLOR: #0000FF;
}
</STYLE>
</head>
<body background="/images/bground.gif" bgcolor="#ffffff" text="#000000">
<!-- Start Header -->
<a name="top"></a>

<!-- Start Branding Table -->
<table border="0" cellPadding="0" cellSpacing="0" width="100%"><TBODY>
<tr><td width="110" valign="top">
<a href="/"><img src="/images/vbsquare.gif" width="90" height="64" border="0"></a>
<img src="/images/clear.gif" height="1" width="110"></td>
<td width="4"><img src="/images/clear.gif" height="1" width="4"></td>
<td width="100%" valign="top">

<!-- Begin Adslot1 -->
<!-- $ adslot1 -->
<!-- End Adslot1 -->

</td></tr>
</tbody></table>
<!-- End Branding Table -->

<!-- Start Content Table -->

<table border="0" cellPadding="0" cellSpacing="0" width="100%">
<TBODY>
<tr><td width="110" valign="top">

<!-- Start left nav bar -->
<FONT SIZE="-1" FACE="verdana, arial, helvetica">

<p align="left"><font color="#FFFF33" class=yllwfont><b>Topic Areas</b></font><br>
<a href="/activex/"><font color="#99CCFF" class=bluefont>ActiveX</font></a><br>
<a href="/api/"><font color="#99CCFF" class=bluefont>API</font></a><br>
<a href="/beginning/"><font color="#99CCFF" class=bluefont>Beginning</font></a><br>
<a href="/controls/"><font color="#99CCFF" class=bluefont>Controls/Forms</font></a><br>
<a href="/databases/"><font color="#99CCFF" class=bluefont>Databases</font></a><br>
<a href="/files/"><font color="#99CCFF" class=bluefont>File/Directory</font></a><br>
<a href="/graphics/"><font color="#99CCFF" class=bluefont>Graphics</font></a><br>
<a href="/internet/"><font color="#99CCFF" class=bluefont>Internet</font></a><br>
<a href="/misc/"><font color="#99CCFF" class=bluefont>Miscellaneous</font></a><br>
<a href="/mouse/"><font color="#99CCFF" class=bluefont>Mouse/Keyboard</font></a><br>
<a href="/registry/"><font color="#99CCFF" class=bluefont>Registry</font></a></p>

<p align="left"><font color="#FFFF33" class=yllwfont><b>Contents</b></font><br>
<a href="/articles/"><font color="#99CCFF" class=bluefont>Articles</font></a><br>
<a href="/tips/"><font color="#99CCFF" class=bluefont>Tips</font></a><br>
<a href="/demos/"><font color="#99CCFF" class=bluefont>Demo Projects</font></a><br>
<a href="/books/"><font color="#99CCFF" class=bluefont>Books</font></a><br>

<p><font color="#FFFF33" class=yllwfont><b>Resources</b></font><br>
<a href="http://www.vbforums.com/?styleid=3"><font color="#99CCFF" class=bluefont>Q and A</font></a><br>
<a href="http://www.vbworld.com/news/"><font color="#99CCFF" class=bluefont>Tech News</font></a><br>
<a href="/newsletters/"><font color="#99CCFF" class=bluefont>Newsletters</font></a><br>
<a href="/php-bin/contactus.php"><font color="#99CCFF" class=bluefont>Contact Us</font></a><br>

</font>
<!-- end left nav bar -->

    <img src="/images/clear.gif" height="1" width="110">
    </td></td>
    <td width="4"><img src="/images/clear.gif" height="1" width="4"></td>
    <td width="100%" valign="top">
    <!-- Start Main page content -->

<!-- End Header -->
<!-- Breadcrumb -->
<table border="0" cellPadding="3" cellSpacing="0" width="100%">
<TBODY><tr>
<td align="left" bgColor="#FFCC00" vAlign="top" width="100%">
<font FACE="Verdana, Arial, Helvetica" SIZE="2">
<b>&nbsp;&nbsp;
<a href="/"><FONT color=#ffffff class=whitefont>Home</font></a> 

<FONT color=#000000>&nbsp;&gt;</font> 
<a href="/misc/"><FONT color=#000000 class=whitefont>Miscellaneous</font></a><FONT color=#000000>&nbsp;&gt;</font> 
<a href="/misc/tips.html"><FONT color=#000000 class=whitefont>Tips</font></a>

</b></font></td></tr>
</TBODY></table>

<table width="100%" border=0 cellspacing=0 cellpadding=0 bgcolor="#eeeeee"><tr align=center valign=middle>
<td width="25%" align="center" nowrap>
<FONT face="MS Sans Serif, Geneva" size=-2><a href="/tips/">Visual Basic Code</a></font>
</td><td width="50%" height=40 align=center nowrap>
<!-- Start Search box table -->
<table border=0 cellspacing=0 cellpadding=0 height=40 bgcolor="#EEEEEE">
<form method="GET" action="/php-bin/search.php">
<input type="hidden" name="searchview" value="priority">
<tr align=center valign=middle>
<td height=40 align=right nowrap>&nbsp;</td>
<td align=left nowrap><FONT face="MS Sans Serif, Geneva" size=-2><b>Search VB Square:</b></font></td>
<td height=40 align=right nowrap>&nbsp;</td>
<td align=left><input type="Text" name="query" size="18" maxlength="255"></td>
<td>&nbsp;<input type="submit" value="Go">&nbsp;</td>
</tr></form></table>
<!-- End search box table -->
</td><td width="25%">
<FONT face="MS Sans Serif, Geneva" size=-2><a href="/articles/">Detailed VB Articles</a></font>
</td></tr></table>

<!-- End Breadcrumb -->

<table border="0" cellPadding="0" cellSpacing="0" width="100%">
<TBODY>

<tr><td vAlign="top" width="100%">
<FONT SIZE="-1" FACE="verdana, arial, helvetica">
<br>
<p><font face="Arial, Helvetica" size="+1"><b>Base Conversion</b></font></p>
<p><i>Tip by <a href="/php-bin/authorbio.php?authorid=36&associd=491&assoctype=3">Richard Deeming</a></i></p>

<table border="0" width="100%" bgcolor="#FFCC00">
  <tr>
<td width="100%"><font face="Arial" size="2"><b>Tip description</b></font></td>  </tr>
</table>
<br>
<table border="1" width="100%" bordercolor="#FFFFFF">
  <tr>
<td width="100%" bordercolor="#000000"><font face="Arial" size="2">Provides conversion between numbers in different bases.</font></td>  </tr>
</table><br>
<table border="0" width="100%" bgcolor="#FFCC00">
  <tr>
<td width="100%"><font face="Arial" size="2"><b>Tip Code</b></font></td>  </tr>
</table>
<br>
<table border="1" width="100%" bordercolor="#FFFFFF">
  <tr>
<td width="100%" bordercolor="#000000"><font face="arial" size="-1" ><p></font><pre>
<font color="#007F00">'-----------------------------------------------------------------</font>
<font color="#007F00">'   Module:     mBases</font>
<font color="#007F00">'   ©2000 Trinet Ltd, http://www.trinet.co.uk</font>
<font color="#007F00">'   Author:     R. Deeming (richard@trinet.co.uk)</font>
<font color="#007F00">'</font>
<font color="#007F00">'   Purpose:    <font color="#00007F">To</font> provide simple conversion between different</font>
<font color="#007F00">'               number bases, including fractional parts.</font>
<font color="#007F00">'</font>
<font color="#007F00">'               An example of advanced conversion is included:</font>
<font color="#007F00">'               the sexagesimal (base 60) system. <font color="#00007F">For</font> this</font>
<font color="#007F00">'               example, the numbers are represented as a</font>
<font color="#007F00">'               2-digit number from 0 to 59, followed by a colon.</font>
<font color="#007F00">'               <font color="#00007F">For</font> example, ConvertBase("12:30:", ebSexagesimal)</font>
<font color="#007F00">'               will return 750 (12 * 60 + 30). Note that the</font>
<font color="#007F00">'               structure of the number is strict - "12:30" and</font>
<font color="#007F00">'               "12:5:" are not valid numbers, but "12:30:" and</font>
<font color="#007F00">'               "12:05:" are.</font>
<font color="#007F00">'</font>
<font color="#007F00">'               When there are errors in the number, the code</font>
<font color="#007F00">'               will raise error 13, with a meaningful message.</font>
<font color="#007F00">'               <font color="#00007F">To</font> change the error number, change the constant</font>
<font color="#007F00">'               ERROR_NUMBER, or modify the code.</font>
<font color="#007F00">'</font>
<font color="#007F00">'   You may use and distribute this code, but you may not charge</font>
<font color="#007F00">'   for it or present it as your own work. <font color="#00007F">If</font> you find any bugs</font>
<font color="#007F00">'   in this code, please notify the author.</font>
<font color="#007F00">'   This code is provided "As-Is" - if it doesn't work, we accept</font>
<font color="#007F00">'   no responsibility.</font>
<font color="#007F00">'-----------------------------------------------------------------</font>

<font color="#007F00">'-----------------------------------------------------------------</font>
<font color="#007F00">' A complete explanation of bases is beyond the scope of this</font>
<font color="#007F00">' code, but a brief explanation is included.</font>
<font color="#007F00">'</font>
<font color="#007F00">' A number is represented as a series of digits, arranged in</font>
<font color="#007F00">' columns. The number of available digits is the same as the</font>
<font color="#007F00">' base of the number. <font color="#00007F">Each</font> column is indexed, starting at 0 for</font>
<font color="#007F00">' the "units" column, and the value of the column is equal to</font>
<font color="#007F00">' the base raised to the power of the index. We are accustomed to</font>
<font color="#007F00">' seeing this in decimal (base 10):</font>
<font color="#007F00">'</font>
<font color="#007F00">'   Index   2   1   0   .   -1  -2</font>
<font color="#007F00">'   ------------------------------</font>
<font color="#007F00">'   Value   2   3   4   .    2   5</font>
<font color="#007F00">'</font>
<font color="#007F00">' representing two hundred and thirty four and one quarter. This</font>
<font color="#007F00">' also applies to other bases. <font color="#00007F">For</font> example, in binary (base 2):</font>
<font color="#007F00">'</font>
<font color="#007F00">'   Index   2   1   0   .   -1  -2</font>
<font color="#007F00">'   ------------------------------</font>
<font color="#007F00">'   Value   1   0   1   .    0   1</font>
<font color="#007F00">'</font>
<font color="#007F00">' represents five and one quarter -</font>
<font color="#007F00">' 1 * 2^2 + 0 * 2^1 + 1 * 2^0 + 0 * 2^-1 + 1 * 2^-2</font>
<font color="#007F00">' = 4 + 0 + 1 + 0 + 0.25 = 5.25</font>
<font color="#007F00">'</font>
<font color="#007F00">' This concept extends to bases of any whole number greater than</font>
<font color="#007F00">' 1, and is limited only by the number of available symbols.</font>
<font color="#007F00">'-----------------------------------------------------------------</font>

<font color="#007F00">'-----------------------------------------------------------------</font>
<font color="#007F00">' <font color="#00007F">To</font> add more bases, perform the following steps:</font>
<font color="#007F00">'   1. <font color="#00007F">Add</font> the base to the Bases enum, and set its value to</font>
<font color="#007F00">'      the base (e.g. for base 4, add "ebBase4 = 4&"</font>
<font color="#007F00">'</font>
<font color="#007F00">'   2. <font color="#00007F">If</font> the base is greater than 10, or requires non-standard</font>
<font color="#007F00">'      representation of the numbers, add a private const with</font>
<font color="#007F00">'      the characters used to represent the digits (see</font>
<font color="#007F00">'      hexadecimal for an example), or modify the DigitLength</font>
<font color="#007F00">'      function and other functions (see ebSexagesimal)</font>
<font color="#007F00">'</font>
<font color="#007F00">'   3. <font color="#00007F">In</font> the procedures ConvertDigit and DeconvertDigit, add</font>
<font color="#007F00">'      the new base to the select statement. <font color="#00007F">If</font> you are using a</font>
<font color="#007F00">'      standard representation of a base </font><= 10, add the new enum
<font color="#007F00">'      value to the first select statement. Otherwise, copy and</font>
<font color="#007F00">'      modify the hexadecimal option.</font>
<font color="#007F00">'</font>
<font color="#007F00">' Example:</font>
<font color="#007F00">'   <font color="#00007F">Add</font> ebAlphabet, a base 26 option in which all digits are</font>
<font color="#007F00">'   represented as letters of the alphabet.</font>
<font color="#007F00">'</font>
<font color="#007F00">'   <font color="#00007F">Private</font> <font color="#00007F">Const</font> AlphaChars = "ABCDEFGHIJKLMNOPQRSTUVWXYZ"</font>
<font color="#007F00">'</font>
<font color="#007F00">'   <font color="#00007F">Public</font> Enum Bases</font>
<font color="#007F00">'   ...</font>
<font color="#007F00">'       ebAlphabet = 26&</font>
<font color="#007F00">'</font>
<font color="#007F00">'   <font color="#00007F">Private</font> <font color="#00007F">Function</font> ConvertDigit(...)</font>
<font color="#007F00">'   ...</font>
<font color="#007F00">'       <font color="#00007F">Case</font> ebAlphabet:</font>
<font color="#007F00">'           ConvertDigit = <font color="#00007F">Mid</font>$(AlphaChars, lngDigit + 1, 1)</font>
<font color="#007F00">'</font>
<font color="#007F00">'   <font color="#00007F">Private</font> <font color="#00007F">Function</font> DeconvertDigit(...)</font>
<font color="#007F00">'   ...</font>
<font color="#007F00">'       <font color="#00007F">Case</font> ebAlphabet:</font>
<font color="#007F00">'           lngTemp = <font color="#00007F">InStr</font>(1, AlphaChars, strDigit)</font>
<font color="#007F00">'           <font color="#00007F">If</font> lngTemp = 0 <font color="#00007F">Then</font></font>
<font color="#007F00">'               err.raise error_number, "DeconvertDigit", "Invalid Alpha Character"</font>
<font color="#007F00">'           <font color="#00007F">Else</font></font>
<font color="#007F00">'               DeconvertDigit = lngTemp - 1</font>
<font color="#007F00">'           <font color="#00007F">End</font> <font color="#00007F">If</font></font>
<font color="#007F00">'</font>
<font color="#007F00">'-----------------------------------------------------------------</font>
<font color="#00007F">Option</font> <font color="#00007F">Explicit</font>

<font color="#00007F">Private</font> <font color="#00007F">Const</font> ERROR_NUMBER = 13&

<font color="#00007F">Private</font> <font color="#00007F">Const</font> HexChars = "0123456789ABCDEF"

<font color="#00007F">Public</font> Enum Bases
    ebBinary = 2&
    ebOctal = 8&
    ebDecimal = 10&
    ebHexadecimal = 16&
    ebSexagesimal = 60&     <font color="#007F00">'Base 60, e.g. time</font>
<font color="#00007F">End</font> Enum

<font color="#00007F">Private</font> <font color="#00007F">Function</font> DigitLength(BASE <font color="#00007F">As</font> Bases) <font color="#00007F">As</font> <font color="#00007F">Long</font>
<font color="#007F00">'Return the length of a digit in a given base</font>
    <font color="#00007F">Select</font> <font color="#00007F">Case</font> BASE
        <font color="#00007F">Case</font> ebSexagesimal:
            DigitLength = 3
        
        <font color="#007F00">'Add other special cases here</font>
        
        <font color="#00007F">Case</font> <font color="#00007F">Else</font>   <font color="#007F00">'ebBinary, ebOctal, ebDecimal, ebHexadecimal</font>
            DigitLength = 1
    <font color="#00007F">End</font> <font color="#00007F">Select</font>
<font color="#00007F">End</font> <font color="#00007F">Function</font>

<font color="#00007F">Private</font> <font color="#00007F">Function</font> Floor(<font color="#00007F">ByVal</font> Number <font color="#00007F">As</font> <font color="#00007F">Double</font>) <font color="#00007F">As</font> <font color="#00007F">Double</font>
<font color="#007F00">'Return the floor of the number</font>
<font color="#007F00">'(the highest whole number less than or equal to the number)</font>
    <font color="#00007F">If</font> <font color="#00007F">Int</font>(Number) > Number <font color="#00007F">Then</font>
        Floor = <font color="#00007F">Int</font>(Number) - 1
    <font color="#00007F">Else</font>
        Floor = <font color="#00007F">Int</font>(Number)
    <font color="#00007F">End</font> <font color="#00007F">If</font>
<font color="#00007F">End</font> <font color="#00007F">Function</font>

<font color="#00007F">Private</font> <font color="#00007F">Function</font> GetNumDec(dblTemp <font color="#00007F">As</font> <font color="#00007F">Double</font>, PadTo <font color="#00007F">As</font> <font color="#00007F">Long</font>, BASE <font color="#00007F">As</font> Bases) <font color="#00007F">As</font> <font color="#00007F">Long</font>
<font color="#007F00">'Return the number of digits required to represent</font>
<font color="#007F00">'the number dblTemp in the specified base, padded</font>
<font color="#007F00">'to the nearest multiple of PadTo</font>

<font color="#00007F">Dim</font> lTemp <font color="#00007F">As</font> <font color="#00007F">Long</font>, lTempPad <font color="#00007F">As</font> <font color="#00007F">Double</font>

    <font color="#00007F">If</font> dblTemp = 0 <font color="#00007F">Then</font>
      lTemp = 1
    <font color="#00007F">Else</font>
      lTemp = Floor(<font color="#00007F">Log</font>(dblTemp) / <font color="#00007F">Log</font>(BASE)) + 1
    <font color="#00007F">End</font> <font color="#00007F">If</font>
    <font color="#00007F">If</font> PadTo > 1 <font color="#00007F">Then</font>
        lTempPad = lTemp / CDbl(PadTo)
        <font color="#00007F">If</font> lTempPad > Floor(lTempPad) <font color="#00007F">Then</font>
            lTempPad = 1 + Floor(lTempPad) - lTempPad
            lTempPad = lTempPad * PadTo
            
            lTemp = lTemp + lTempPad
        <font color="#00007F">End</font> <font color="#00007F">If</font>
    <font color="#00007F">End</font> <font color="#00007F">If</font>
    GetNumDec = lTemp
<font color="#00007F">End</font> <font color="#00007F">Function</font>

<font color="#00007F">Private</font> <font color="#00007F">Function</font> ConvertDigit(lngDigit <font color="#00007F">As</font> <font color="#00007F">Long</font>, BASE <font color="#00007F">As</font> Bases) <font color="#00007F">As</font> <font color="#00007F">String</font>
<font color="#007F00">'Convert a single digit to the specified base</font>
    <font color="#00007F">If</font> lngDigit >= BASE <font color="#00007F">Then</font>
        <font color="#00007F">Err</font>.<font color="#00007F">Raise</font> ERROR_NUMBER, "ConvertDigit", "Invalid digit for base"
    <font color="#00007F">Else</font>
        <font color="#00007F">Select</font> <font color="#00007F">Case</font> BASE
            <font color="#00007F">Case</font> ebBinary, ebOctal, ebDecimal:
                ConvertDigit = <font color="#00007F">CStr</font>(lngDigit)
            
            <font color="#00007F">Case</font> ebHexadecimal:
                ConvertDigit = <font color="#00007F">Mid</font>$(HexChars, lngDigit + 1, 1)
            
            <font color="#00007F">Case</font> ebSexagesimal:
                ConvertDigit = <font color="#00007F">Right</font>$("00" & <font color="#00007F">CStr</font>(lngDigit), 2) & ":"
                
            <font color="#007F00">'Add other bases here</font>
            <font color="#00007F">Case</font> Else: <font color="#00007F">Err</font>.<font color="#00007F">Raise</font> ERROR_NUMBER, "ConvertDigit", "Unknown base"
        <font color="#00007F">End</font> <font color="#00007F">Select</font>
    <font color="#00007F">End</font> <font color="#00007F">If</font>
<font color="#00007F">End</font> <font color="#00007F">Function</font>

<font color="#00007F">Private</font> <font color="#00007F">Function</font> DeconvertDigit(strDigit <font color="#00007F">As</font> <font color="#00007F">String</font>, BASE <font color="#00007F">As</font> Bases) <font color="#00007F">As</font> <font color="#00007F">Long</font>
<font color="#007F00">'Convert a single digit from the specified base to decimal</font>
<font color="#00007F">Dim</font> lngTemp <font color="#00007F">As</font> <font color="#00007F">Long</font>
    <font color="#00007F">Select</font> <font color="#00007F">Case</font> BASE
        <font color="#00007F">Case</font> ebBinary, ebOctal, ebDecimal:
            <font color="#00007F">If</font> <font color="#00007F">IsNumeric</font>(strDigit) <font color="#00007F">Then</font>
                lngTemp = <font color="#00007F">CLng</font>(strDigit)
                <font color="#00007F">If</font> lngTemp < BASE <font color="#00007F">Then</font>
                    DeconvertDigit = lngTemp
                <font color="#00007F">Else</font>
                    <font color="#00007F">Err</font>.<font color="#00007F">Raise</font> ERROR_NUMBER, "DeconvertDigit", "Invalid digit for base"
                <font color="#00007F">End</font> <font color="#00007F">If</font>
            <font color="#00007F">Else</font>
                <font color="#00007F">Err</font>.<font color="#00007F">Raise</font> ERROR_NUMBER, "DeconvertDigit", "Invalid character"
            <font color="#00007F">End</font> <font color="#00007F">If</font>
            
        <font color="#00007F">Case</font> ebHexadecimal:
            lngTemp = <font color="#00007F">InStr</font>(1, HexChars, strDigit)
            <font color="#00007F">If</font> lngTemp = 0 <font color="#00007F">Then</font>
                <font color="#00007F">Err</font>.<font color="#00007F">Raise</font> ERROR_NUMBER, "DeconvertDigit", "Invalid digit for base"
            <font color="#00007F">Else</font>
                DeconvertDigit = lngTemp - 1
            <font color="#00007F">End</font> <font color="#00007F">If</font>
            
        <font color="#00007F">Case</font> ebSexagesimal:
            <font color="#00007F">If</font> <font color="#00007F">Len</font>(strDigit) = 3 <font color="#00007F">Then</font>
                <font color="#00007F">If</font> <font color="#00007F">Right</font>$(strDigit, 1) = ":" <font color="#00007F">And</font> <font color="#00007F">IsNumeric</font>(<font color="#00007F">Left</font>$(strDigit, 2)) <font color="#00007F">Then</font>
                    lngTemp = <font color="#00007F">CLng</font>(<font color="#00007F">Left</font>$(strDigit, 2))
                    <font color="#00007F">If</font> lngTemp < BASE <font color="#00007F">Then</font>
                        DeconvertDigit = lngTemp
                    <font color="#00007F">Else</font>
                        <font color="#00007F">Err</font>.<font color="#00007F">Raise</font> ERROR_NUMBER, "DeconvertDigit", "Invalid digit for base"
                    <font color="#00007F">End</font> <font color="#00007F">If</font>
                <font color="#00007F">Else</font>
                    <font color="#00007F">Err</font>.<font color="#00007F">Raise</font> ERROR_NUMBER, "DeconvertDigit", "Invalid digit for base"
                <font color="#00007F">End</font> <font color="#00007F">If</font>
            <font color="#00007F">Else</font>
                <font color="#00007F">Err</font>.<font color="#00007F">Raise</font> ERROR_NUMBER, "DeconvertDigit", "Invalid digit for base"
            <font color="#00007F">End</font> <font color="#00007F">If</font>
        
        <font color="#007F00">'Add other bases here</font>
        
        <font color="#00007F">Case</font> Else:
            <font color="#00007F">Err</font>.<font color="#00007F">Raise</font> ERROR_NUMBER, "DeconvertDigit", "Unknown base"
    <font color="#00007F">End</font> <font color="#00007F">Select</font>
<font color="#00007F">End</font> <font color="#00007F">Function</font>

<font color="#00007F">Private</font> <font color="#00007F">Function</font> ConvertDec2Base(<font color="#00007F">ByVal</font> Number, <font color="#00007F">ByVal</font> BASE <font color="#00007F">As</font> Bases, Optional NumDecimals <font color="#00007F">As</font> <font color="#00007F">Long</font> = -1, Optional Tolerance <font color="#00007F">As</font> <font color="#00007F">Double</font> = 1E-27, Optional PadTo <font color="#00007F">As</font> <font color="#00007F">Long</font> = 0) <font color="#00007F">As</font> <font color="#00007F">String</font>
<font color="#007F00">'Convert Number from decimal to the specified base,</font>
<font color="#007F00">'with NumDecimals fractional digits (or to within tolerance),</font>
<font color="#007F00">'padded to the nearest multiple of PadTo</font>

<font color="#00007F">Dim</font> dblTemp <font color="#00007F">As</font> <font color="#00007F">Double</font>
<font color="#00007F">Dim</font> lCDec <font color="#00007F">As</font> <font color="#00007F">Long</font>
<font color="#00007F">Dim</font> lDigit <font color="#00007F">As</font> <font color="#00007F">Long</font>
<font color="#00007F">Dim</font> dblPwr <font color="#00007F">As</font> <font color="#00007F">Double</font>
<font color="#00007F">Dim</font> strTemp <font color="#00007F">As</font> <font color="#00007F">String</font>

    <font color="#00007F">If</font> <font color="#00007F">Not</font> <font color="#00007F">IsNumeric</font>(Number) <font color="#00007F">Then</font>
        <font color="#00007F">Err</font>.<font color="#00007F">Raise</font> ERROR_NUMBER, "ConvertDec2Base", "Number must be decimal"
    <font color="#00007F">ElseIf</font> BASE < 2 <font color="#00007F">Then</font>
        <font color="#00007F">Err</font>.<font color="#00007F">Raise</font> ERROR_NUMBER, "ConvertDec2Base", "Invalid base"
    <font color="#00007F">Else</font>
        <font color="#007F00">'Negative tolerance could cause loops</font>
        Tolerance = <font color="#00007F">Abs</font>(Tolerance)
        
        dblTemp = CDbl(Number)
        <font color="#00007F">If</font> dblTemp < 0 <font color="#00007F">Then</font>
            strTemp = "-"
            dblTemp = -dblTemp
        <font color="#00007F">End</font> <font color="#00007F">If</font>
        
        lCDec = GetNumDec(dblTemp, PadTo, BASE)
        
        <font color="#007F00">'Integer part</font>
        <font color="#00007F">If</font> lCDec = 0 <font color="#00007F">Then</font>
            strTemp = strTemp & "0"
        <font color="#00007F">Else</font>
            <font color="#00007F">Do</font> <font color="#00007F">Until</font> lCDec = 0
                lCDec = lCDec - 1
                dblPwr = BASE ^ lCDec
                lDigit = 0
                <font color="#00007F">Do</font> <font color="#00007F">While</font> dblTemp >= dblPwr
                    lDigit = lDigit + 1
                    dblTemp = dblTemp - dblPwr
                <font color="#00007F">Loop</font>
                strTemp = strTemp & ConvertDigit(lDigit, BASE)
            <font color="#00007F">Loop</font>
        <font color="#00007F">End</font> <font color="#00007F">If</font>
        
        <font color="#007F00">'Fractional part</font>
        <font color="#00007F">If</font> dblTemp > Tolerance <font color="#00007F">And</font> (NumDecimals > 0 <font color="#00007F">Or</font> (NumDecimals = -1 <font color="#00007F">And</font> Tolerance > 0)) <font color="#00007F">Then</font>
            strTemp = strTemp & "."
            <font color="#00007F">Do</font> <font color="#00007F">While</font> dblTemp > Tolerance <font color="#00007F">And</font> (lCDec > (-NumDecimals) <font color="#00007F">Or</font> NumDecimals = -1)
                lCDec = lCDec - 1
                dblPwr = BASE ^ lCDec
                lDigit = 0
                <font color="#00007F">Do</font> <font color="#00007F">While</font> dblTemp >= dblPwr
                    lDigit = lDigit + 1
                    dblTemp = dblTemp - dblPwr
                <font color="#00007F">Loop</font>
                strTemp = strTemp & ConvertDigit(lDigit, BASE)
            <font color="#00007F">Loop</font>
        <font color="#00007F">End</font> <font color="#00007F">If</font>
        ConvertDec2Base = strTemp
    <font color="#00007F">End</font> <font color="#00007F">If</font>
<font color="#00007F">End</font> <font color="#00007F">Function</font>

<font color="#00007F">Private</font> <font color="#00007F">Function</font> ConvertBase2Dec(<font color="#00007F">ByVal</font> Number <font color="#00007F">As</font> <font color="#00007F">String</font>, <font color="#00007F">ByVal</font> BASE <font color="#00007F">As</font> Bases) <font color="#00007F">As</font> <font color="#00007F">Double</font>
<font color="#007F00">'Convert the number from the specified base to decimal</font>
<font color="#00007F">Dim</font> dblTemp <font color="#00007F">As</font> <font color="#00007F">Double</font>
<font color="#00007F">Dim</font> strDigit <font color="#00007F">As</font> <font color="#00007F">String</font>, lngDigit <font color="#00007F">As</font> <font color="#00007F">Long</font>, i <font color="#00007F">As</font> <font color="#00007F">Long</font>
<font color="#00007F">Dim</font> lngPwr <font color="#00007F">As</font> <font color="#00007F">Long</font>, lngSign <font color="#00007F">As</font> <font color="#00007F">Long</font>, lngDigitSize
    
    <font color="#00007F">If</font> BASE < 2 <font color="#00007F">Then</font>
        <font color="#00007F">Err</font>.<font color="#00007F">Raise</font> ERROR_NUMBER, "ConvertBase2Dec", "Invalid Base"
    <font color="#00007F">Else</font>
        lngDigitSize = DigitLength(BASE)
        lngPwr = 0
        lngSign = 1
        i = 1
        <font color="#00007F">Do</font> <font color="#00007F">Until</font> i > <font color="#00007F">Len</font>(Number)
            strDigit = <font color="#00007F">Mid</font>$(Number, i, lngDigitSize)
            <font color="#00007F">If</font> <font color="#00007F">Left</font>$(strDigit, 1) = "." <font color="#00007F">Then</font>
                i = i + 1
                <font color="#00007F">If</font> lngPwr = 0 <font color="#00007F">Then</font>
                    lngPwr = 1
                <font color="#00007F">Else</font>
                    <font color="#00007F">Err</font>.<font color="#00007F">Raise</font> ERROR_NUMBER, "ConvertBase2Dec", "More than one decimal point"
                <font color="#00007F">End</font> <font color="#00007F">If</font>
            <font color="#00007F">ElseIf</font> <font color="#00007F">Left</font>$(strDigit, 1) = "-" <font color="#00007F">Then</font>
                i = i + 1
                <font color="#00007F">If</font> lngPwr = 0 <font color="#00007F">And</font> dblTemp = 0 <font color="#00007F">Then</font>
                    lngSign = -lngSign
                <font color="#00007F">Else</font>
                    <font color="#00007F">Err</font>.<font color="#00007F">Raise</font> ERROR_NUMBER, "ConvertBase2Dec", "Invalid negation"
                <font color="#00007F">End</font> <font color="#00007F">If</font>
            <font color="#00007F">Else</font>
                i = i + lngDigitSize
                lngDigit = DeconvertDigit(strDigit, BASE)
                dblTemp = dblTemp * BASE + lngDigit
                lngPwr = lngPwr * BASE
            <font color="#00007F">End</font> <font color="#00007F">If</font>
        <font color="#00007F">Loop</font>
        <font color="#00007F">If</font> lngPwr > 1 <font color="#00007F">Then</font>
            ConvertBase2Dec = CDbl(lngSign) * (dblTemp / CDbl(lngPwr))
        <font color="#00007F">Else</font>
            ConvertBase2Dec = CDbl(lngSign) * dblTemp
        <font color="#00007F">End</font> <font color="#00007F">If</font>
    <font color="#00007F">End</font> <font color="#00007F">If</font>
<font color="#00007F">End</font> <font color="#00007F">Function</font>

<font color="#00007F">Public</font> <font color="#00007F">Function</font> ConvertBase(<font color="#00007F">ByVal</font> Number, <font color="#00007F">ByVal</font> FromBASE <font color="#00007F">As</font> Bases, Optional <font color="#00007F">ByVal</font> ToBASE <font color="#00007F">As</font> Bases = ebDecimal, Optional NumDecimals <font color="#00007F">As</font> <font color="#00007F">Long</font> = -1, Optional Tolerance <font color="#00007F">As</font> <font color="#00007F">Double</font> = 1E-27, Optional PadTo <font color="#00007F">As</font> <font color="#00007F">Long</font> = 0) <font color="#00007F">As</font> <font color="#00007F">Variant</font>
<font color="#007F00">'Convert a number from one base to another.</font>
<font color="#007F00">'Parameters:</font>
<font color="#007F00">'       Number      A numeric value (when FromBASE = ebDecimal) or</font>
<font color="#007F00">'                   a string representing the number to convert</font>
<font color="#007F00">'</font>
<font color="#007F00">'       FromBASE    The base to convert from (enumeration)</font>
<font color="#007F00">'</font>
<font color="#007F00">'       ToBASE      (Optional) The base to convert to. Default = Decimal</font>
<font color="#007F00">'</font>
<font color="#007F00">'       NumDecimals (Optional) The number of decimal places to include</font>
<font color="#007F00">'                   when converting a fractional number to a non-decimal</font>
<font color="#007F00">'                   Specify 0 for integer only, or -1 to use tolerance.</font>
<font color="#007F00">'                   (This prevents problems with infinte loops)</font>
<font color="#007F00">'</font>
<font color="#007F00">'       Tolerance   (Optional) The value at which to terminate the</font>
<font color="#007F00">'                   fractional representation. <font color="#00007F">If</font> NumDecimals = -1</font>
<font color="#007F00">'                   and Tolerance = 0, no attempt will be made, to</font>
<font color="#007F00">'                   avoid an infinite loop. The sign of the tolerance</font>
<font color="#007F00">'                   is ignored.</font>
<font color="#007F00">'</font>
<font color="#007F00">'       PadTo       (Optional) Used to pad the non-decimal number</font>
<font color="#007F00">'                   to a given length. EG, binary numbers are</font>
<font color="#007F00">'                   normally shown with a multiple of 8 digits, so</font>
<font color="#007F00">'                   you would specify 8. Use 0 to avoid padding.</font>
<font color="#007F00">'</font>
<font color="#007F00">'Returns:</font>
<font color="#007F00">'       Either a double (if ToBASE = ebDecimal) or a string representing</font>
<font color="#007F00">'       the converted number.</font>

<font color="#00007F">Dim</font> dblDec <font color="#00007F">As</font> <font color="#00007F">Double</font>
    <font color="#00007F">If</font> FromBASE = ebDecimal <font color="#00007F">Then</font>
        <font color="#00007F">If</font> <font color="#00007F">IsNumeric</font>(Number) <font color="#00007F">Then</font>
            dblDec = CDbl(Number)
        <font color="#00007F">Else</font>
            <font color="#00007F">Err</font>.<font color="#00007F">Raise</font> ERROR_NUMBER, "ConvertBase", "Not a decimal number"
        <font color="#00007F">End</font> <font color="#00007F">If</font>
    <font color="#00007F">Else</font>
        dblDec = ConvertBase2Dec(<font color="#00007F">CStr</font>(Number), FromBASE)
    <font color="#00007F">End</font> <font color="#00007F">If</font>
    <font color="#00007F">If</font> ToBASE = ebDecimal <font color="#00007F">Then</font>
        ConvertBase = dblDec
    <font color="#00007F">Else</font>
        ConvertBase = ConvertDec2Base(dblDec, ToBASE, NumDecimals, Tolerance, PadTo)
    <font color="#00007F">End</font> <font color="#00007F">If</font>
<font color="#00007F">End</font> <font color="#00007F">Function</font>
</pre><FONT SIZE="-1" FACE="verdana, arial, helvetica"></p></font></td></tr></table>
<br>
<center><table border=0><tr>
<td><a href="/php-bin/feedback.php?action=viewtopics&associd=491&assoctype=3">
<img src="/images/fbicon1.gif" width="27" height="31" border="0"></a></td>
<td><a href="/php-bin/feedback.php?action=viewtopics&associd=491&assoctype=3"><FONT SIZE="-1" FACE="verdana, arial, helvetica"><a href="/php-bin/feedback.php?action=viewtopics&associd=491&assoctype=3"><b>Question, Query, Criticism?<br>Post your feedback now!</a></b> 0 comments.</font></td>
</tr></table></center>


</font>
</td>
<td width="8"><img src="/images/clear.gif" width="8"></td>
<td vAlign="top" width="125">
<br>

<!-- Start Related -->
<TABLE border=0 cellPadding=0 cellSpacing=0 width=125>
<TBODY><TR><TD bgColor=#FFCC00 vAlign=top width=125>
<CENTER><FONT face=arial,helvetica size=2>
<B>Related</B>
</FONT></CENTER>
</TD></TR></tbody></table>
<TABLE border=0 cellPadding=2 cellSpacing=0 width=125><TBODY>
<TR>
<TD vAlign=top width=5><FONT size=-2><b>-</b><FONT SIZE="-1" FACE="verdana, arial, helvetica"></TD>
<TD vAlign=center><font size="-1" class=navbit><A href="/misc/efficient/">Writing Efficient VB Software</A></font></TD>
</TR><TR>
<TD vAlign=top width=5><FONT size=-2><b>-</b><FONT SIZE="-1" FACE="verdana, arial, helvetica"></TD>
<TD vAlign=center><font size="-1" class=navbit><A href="/misc/adsi/">ADSI for beginners</A></font></TD>
</TR><TR>
<TD vAlign=top width=5><FONT size=-2><b>-</b><FONT SIZE="-1" FACE="verdana, arial, helvetica"></TD>
<TD vAlign=center><font size="-1" class=navbit><A href="/misc/dotnet/">Dot net  dot what?</A></font></TD>
</TR><TR>
<TD vAlign=top width=5><FONT size=-2><b>-</b><FONT SIZE="-1" FACE="verdana, arial, helvetica"></TD>
<TD vAlign=center><font size="-1" class=navbit><A href="/misc/begagent3/">Beginning MS Agent: Part 3</A></font></TD>
</TR><TR>
<TD vAlign=top width=5><FONT size=-2><b>-</b><FONT SIZE="-1" FACE="verdana, arial, helvetica"></TD>
<TD vAlign=center><font size="-1" class=navbit><A href="/misc/begagent2/">Beginning MS Agent: Part 2</A></font></TD>
</TR>
</TBODY></TABLE>
<br>
<!-- End Related -->
<!-- Start Options -->
<TABLE border=0 cellPadding=2 cellSpacing=0 width=125 bgcolor="#FFCC00"><TBODY>
<TR>
<TD vAlign=middle width=16><img src="/images/email_button.gif" width="16" height="16" border="0"></TD>
<TD vAlign=middle><font size="-1" class=navbit><A href="/php-bin/sendtofriend.php?subject=Base+Conversion">Email this page</A></font></TD>
</TR><TR>
<TD vAlign=middle width=16><img src="/images/print_button.gif" width="16" height="16" border="0"></TD>
<TD vAlign=middle><font size="-1" class=navbit><A href="/php-bin/printfriendly.php?tipid=491">Printer Friendly</A></font></TD>
</TR>
<TR>
<TD vAlign=middle width=16><img src="/images/more_button.gif" width="16" height="16" border="0"></TD>
<TD vAlign=middle><font size="-1" class=navbit><A href="/php-bin/authorbio.php?authorid=36&associd=491&assoctype=3">More From Richard</A></font></TD>
</TR>
<TR>
<TD vAlign=middle width=16><img src="/images/feedback_button.gif" width="16" height="16" border="0"></TD>
<TD vAlign=middle><font size="-1" class=navbit><A href="/php-bin/feedback.php?action=viewtopics&associd=491&assoctype=3">Post Feedback</A></font></TD>
</TR>
</TBODY></TABLE>

<br>
<!-- End Options -->

<!-- Start Hot Picks -->
<TABLE border=0 cellPadding=0 cellSpacing=0 width=125>
<TBODY><TR><TD bgColor=#FFCC00 vAlign=top width=125>
<CENTER><FONT face=arial,helvetica size=2>
<B>Hot Picks</B>
</FONT></CENTER>
</TD></TR></tbody></table>
<TABLE border=0 cellPadding=2 cellSpacing=0 width=125><TBODY>
<TR>
<TD vAlign=top width=5><FONT size=-2><b>-</b><FONT SIZE="-1" FACE="verdana, arial, helvetica"></TD>
<TD vAlign=center><font size="-1" class=navbit><A href="/internet/inet1/">Using the inet control</A></font></TD>
</TR><TR>
<TD vAlign=top width=5><FONT size=-2><b>-</b><FONT SIZE="-1" FACE="verdana, arial, helvetica"></TD>
<TD vAlign=center><font size="-1" class=navbit><A href="/articles/graph/">Make a  Chart control!</A></font></TD>
</TR><TR>
<TD vAlign=top width=5><FONT size=-2><b>-</b><FONT SIZE="-1" FACE="verdana, arial, helvetica"></TD>
<TD vAlign=center><font size="-1" class=navbit><A href="/articles/diary/">Life of a VB programmer</A></font></TD>
</TR><TR>
<TD vAlign=top width=5><FONT size=-2><b>-</b><FONT SIZE="-1" FACE="verdana, arial, helvetica"></TD>
<TD vAlign=center><font size="-1" class=navbit><A href="/articles/wordobj1/">MS Object Models</A></font></TD>
</TR>
</TBODY></TABLE>
<br>
<!-- End Hot Picks -->
<!-- Start Newsletter -->
<TABLE bgColor=#FFCC00 border=0 cellPadding=2 cellSpacing=0 width=125>
<TBODY><tr><td vAlign=center width=100%>
<CENTER><FONT face=arial,helvetica size=2><B>Free Newsletter</b></font></center>
</td></tr><tr><td valign=center width=100%>
<table cellspacing="0" cellpadding="0" border=0>
<tr><td bgcolor="#FFCC00"><FORM action="http://inbound.postmastergeneral.com/cgi-bin/pmg_subscribe.pl" method=post><input type="TEXT" name="email_address" size="10" value="enter email">&nbsp;
</td><td valign="top" bgcolor="#FFCC00">
<input type="hidden" name="list" value="vbsquare">
<input type="SUBMIT" name="server_action:Subscribe" value="GO"></td>
</tr></form></table>
</td></TR></TBODY></TABLE><BR>
<!-- End Newsletter -->

<!-- Start Discuss -->
<TABLE border=0 cellPadding=0 cellSpacing=0 width=125>
<TBODY><TR><TD bgColor=#FFCC00 vAlign=top width=125>
<CENTER><FONT face=arial,helvetica size=2>
<B>Discuss</B>
</FONT></CENTER>
</TD></TR></tbody></table>
<TABLE border=0 cellPadding=2 cellSpacing=0 width=125><TBODY>
<TR>
<TD vAlign=top width=5><FONT size=-2><b>-</b><FONT SIZE="-1" FACE="verdana, arial, helvetica"></TD>
<TD vAlign=center><font size="-1" class=navbit><A href="http://www.vbforums.com/showthread.php?threadid=178817">Using Cd Drive Id To Open/close...</A></font></TD>
</TR><TR>
<TD vAlign=top width=5><FONT size=-2><b>-</b><FONT SIZE="-1" FACE="verdana, arial, helvetica"></TD>
<TD vAlign=center><font size="-1" class=navbit><A href="http://www.vbforums.com/showthread.php?threadid=178948">Create Table In Ado DB</A></font></TD>
</TR><TR>
<TD vAlign=top width=5><FONT size=-2><b>-</b><FONT SIZE="-1" FACE="verdana, arial, helvetica"></TD>
<TD vAlign=center><font size="-1" class=navbit><A href="http://www.vbforums.com/showthread.php?threadid=178986">Layout</A></font></TD>
</TR><TR>
<TD vAlign=top width=5><FONT size=-2><b>-</b><FONT SIZE="-1" FACE="verdana, arial, helvetica"></TD>
<TD vAlign=center><font size="-1" class=navbit><A href="http://www.vbforums.com/showthread.php?threadid=178776">Due Date</A></font></TD>
</TR><TR>
<TD vAlign=top width=5><FONT size=-2><b>-</b><FONT SIZE="-1" FACE="verdana, arial, helvetica"></TD>
<TD vAlign=center><font size="-1" class=navbit><A href="http://www.vbforums.com/showthread.php?threadid=178063">Automating Excel Spreadsheets...</A></font></TD>
</TR>
</TBODY></TABLE>
<br>
<!-- End Discuss -->

<img src="/images/clear.gif" width="125" height="1">

<!-- End Main Page Content -->
</td></tr></tbody></table>
</td></tr></tbody></table>

<!-- Start End Branding Table -->

<table border="0" cellPadding="0" cellSpacing="0" width="100%">
<TBODY><tr>
<td width="110"><img src="/images/clear.gif" width="110" height="1" border="0"></td>
<td width="4"><img src="/images/clear.gif" width="4" height="1" border="0"></td>
<td width="100%">
<TABLE bgColor=#ffffff border=0 cellPadding=0 cellSpacing=0 width="100%">
<TBODY><TR><TD bgColor="#FFCC00" width="100%">
<b><font FACE="Verdana, Arial, Helvetica" SIZE="-1">&nbsp;VB Square Today</font></b>
</td></tr><tr><td width=100%>
<font FACE="Verdana, Arial, Helvetica" SIZE="-1">
<a href="/activex/begobjects/">Beginning Objects in VB</a> - Learn all you ever wanted to know about objects in our weekly series.<br>
<a href="/internet/xml/index.html">Learn XML</a> - Catch up on this new technology as Sam Huggill reveals all.<br>
<a href="/internet/aspvb/">Using ASP with VB components</a> - Leverage your VB skills and use ASP to provide your data to a wider audience<br>
<a href="/articles/mcsd/">Is MCSD Worth It?</a> - Mack Male finds out just how much MCSD does for you as a programmer.<br>

</font>
</td></tr></tbody></table>
</td></tr></tbody></table>

<!-- End End Branding Table -->

<table border="0" cellPadding="0" cellSpacing="0" width="100%">
<TBODY><tr>
<td width="110" align="center"><img src="/images/clear.gif" width="110" height="1" border="0"><br><a href="#top"><img src="/images/gototop.gif" alt="Top" WIDTH="23" HEIGHT="21" BORDER="0"></a></td>
<td width="4"><img src="/images/clear.gif" width="4" height="1" border="0"></td>
<td width="100%">
<hr>
<p align="center"><font face="Verdana, Arial, Helvetica" size="-2">
Copyright &copy;1997-2001 Lighthouse Internet Solutions. All rights reserved. <a href="/privacy.html">Privacy Policy</a>.
</font></p>
</td></tr>
</tbody></table>

</body></html>
