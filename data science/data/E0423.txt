ID=E0423
URL=http://msdn.microsoft.com/visualc/techinfo/training/tour3.asp
SIZE=40994
DATE=12/07/02
TIME=19:20:49
DATASET=C
HTML=
<html>
<head>
<title>Linking and Implementing the Controls</title>
<meta name="KEYWORDS" content=" " />
<meta name="DESCRIPTION" content="Microsoft Visual C++ Evaluation  Guide" />
<meta name="MS.LOCALE" content="EN-US" />
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1" />
<meta name="DTC_TEMPLATE" content="TEMPLATE=endnode" />

		          <link rel="stylesheet" href="/visualc/css.asp?template=EP" type="text/css" />
          

     <meta http-equiv="PICS-Label" CONTENT='(PICS-1.1 "http://www.rsac.org/ratingsv01.html" l comment "RSACi North America Server" by "inet@microsoft.com" r (n 0 s 0 v 0 l 0))' />
     <script src="/products/shared/global.js" type="text/javascript"></script>
     
<link rel="stylesheet" type="text/css" href="/library/flyoutmenu/default.css" />


	
	<script type="text/javascript"><!--
	
	sImgDefaultArrow = "/products/shared/images/imgArrwUp_VS.gif";
	sImgExpandedArrow = "/products/shared/images/imgArrwDwn_VS.gif";

	if (sImgDefaultArrow == ""){
		sImgDefaultArrow = "/products/shared/images/arrow_default.gif";
	}
	if (sImgExpandedArrow == ""){
		sImgExpandedArrow = "/products/shared/images/arrow_expand.gif";
	}
	
	//-->
	</script>
   
</head>
<body bgcolor="#ffffff" topmargin="0" leftmargin="0" marginheight="0" marginwidth="0">	


          <span id="donotprint">
<!-- Start: ToolBar V2.0-->
<script type="text/javascript" language="JavaScript" src="/library/toolbar/toolbar.js"></script>
<script type="text/javascript" language="JavaScript" src="/library/toolbar/en-us/globalMNP.js"></script>
<script type="text/javascript" language="JavaScript" src="/products/shared/toolbar_vstudio.js"></script>
<!-- Start: ToolBar for down-level browsers-->
<span id="TBDownLevelDiv">
	<table width="100%" cellpadding="0" cellspacing="0" border="0" bgcolor="#6699CC">
		<tr>
			<td bgcolor="#6699CC" valign="top" width="250" rowspan="2"><a href="/visualc/" target="_top"><img src="/products/shared/images/bnr_VisualStudio.gif" alt="Visual C++ Home" border="0" /></a></td>
			<td bgcolor="#6699CC" valign="top" height="20" width="19" align="right"><img src="/library/toolbar/images/curve.gif" /></td>
			<td bgcolor="#000000" valign="middle" height="20" align="right" nowrap colspan="2"><font color="#ffffff" face="Verdana, Arial, Helvetica" size="1">
					&nbsp;&nbsp;<a style="color:#ffffff;text-decoration:none;" href="http://www.microsoft.com/products/" target="_top"><font color="#ffffff">All Products</font></a>&nbsp;&nbsp;<font color="#ffffff">|</font>
					&nbsp;&nbsp;<a style="color:#ffffff;text-decoration:none;" href="http://www.microsoft.com/support/" target="_top"><font color="#ffffff">Support</font></a>&nbsp;&nbsp;<font color="#ffffff">|</font>
					&nbsp;&nbsp;<a style="color:#ffffff;text-decoration:none;" href="http://search.microsoft.com/" target="_top"><font color="#ffffff">Search</font></a>&nbsp;&nbsp;<font color="#ffffff">|</font>
					&nbsp;&nbsp;<a style="color:#ffffff;text-decoration:none;" href="http://www.microsoft.com/" target="_top"><font color="#ffffff">microsoft.com Guide</font></a>&nbsp;&nbsp;</font></td>
		</tr>
		<tr>
			<td bgcolor="#6699CC" valign="top" height="40" width="19"><img src="/library/Images/Gifs/General/Trans.gif" width="1" height="1" border="0" alt></td>
			<td valign="top" height="40" align="right" nowrap colspan="2"><a href="/isapi/gomscom.asp?target=/" target="_top"><img src="/library/toolbar/images/mslogo6699CC.gif" width="112" height="40" alt="microsoft.com home" border="0"></a></td>
		</tr>
		<tr>
	<!-- Start: Local menus -->
		<td bgcolor="#6699CC" height="20" VALIGN="MIDDLE" NOWRAP COLSPAN="4">
			<font color="#FFFFFF" class="fontSize1"><b>
				&nbsp;&nbsp;<a style="color:#FFFFFF;text-decoration:none;" href="/visualc/" target="_top"><font color="#FFFFFF">Visual C++ Home</font></a>&nbsp;&nbsp;<font color="#FFFFFF">|</font>
		
			</b></font>
		</td>
	<!-- End: Local menus -->
		</tr>
	</table>
</span>
<!-- End: ToolBar for old browsers-->

<script language="JavaScript" type="text/javascript">
<!--// Hide from old browsers

var ToolBar_Supported = ToolBar_Supported;
if (ToolBar_Supported != null && ToolBar_Supported == true && (navigator.platform=="Win32"))
{
	TBDownLevelDiv.style.display ='none';
	drawToolbar();
	var fBrowserOK = true;
}

//-->
</script>
<!-- End: ToolBar V2.0-->



</span>
          <a name="top"></a>
          <table border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td bgcolor="#ffffff" height="1"><img src="/products/shared/images/ts.gif" height="1" width="1" /></td>
			</tr>
		</table>
          <table cellpadding="0" cellspacing="0" border="0" width="100%">
               <tr valign="top">
                    <td valign="top">
                         <table cellpadding="0" cellspacing="0" border="0" width="100%">
                              <tr valign="top">
                                   <td width="178" valign="top" id="donotprint" > 

									<!-- start leftnav And search code -->
										<table border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#6699CC">
											<tr height="38">
												<td bgcolor="#6699CC" align="center">
													<!-- quick search-->
													<table cellpadding="0" cellspacing="0" border="0" width="179">
													
													<form action="http://search.microsoft.com/us/products/vs/visualc/advanced_search.asp" method="GET" id="form1" name="form1">
													
														<tr>
															<td><img src="/products/shared/images/Trans.gif" height="1" width="5"></td>
															<td>
														<!--[if IE ]><span class="fontSize1" style="color:#FFFFFF">Search This Site</span><br>														<input type="hidden" name="IntCat" value="0" />														<input type="hidden" name="Boolean" value="ALL" />																													<input type="hidden" name="Nq" value="new" />																													<input type="text" name="qu" size="14" maxlength="255" style="height:20 px; width: 125 px;" />																													<img src="/products/shared/images/trans.gif" height="1" width="2" border="0" />															<input alt="go" type="submit" name="finish" value="Go" class="btnSearch">														<![endif]-->
														<![if ! ie ]>
															<span class="fontSize1" style="color:#FFFFFF">Search This Site<br>
															<input type="HIDDEN" name="IntCat" value="0" />
															<input type="HIDDEN" name="Boolean" value="ALL" />
															<input type="HIDDEN" name="Nq" value="NEW" />
															<input type="TEXT" name="qu" size="10" maxlength="255" />
															<input alt="Go" type="SUBMIT" name="FINISH" value="Go" />
															</span>
														<![endif]>
														</td>
														</tr>
										      		</form>
													</table>
													<!--end quick search -->
												</td>
												<td width="1" bgcolor="#6699CC"><img src="/products/shared/images/Trans.gif" alt height="0" width="1" border="0"></td>
											</tr>
											<tr>
												<td>
													<table cellpadding="0" cellspacing="0" border="0" width="100%" bgcolor="#6699CC">
														<tr>
															<td><img src="/products/shared/images/Trans.gif" height="1" width="3"></td>
															<td VALIGN="TOP" class="AdvSearch"><a HREF="http://search.microsoft.com/us/products/vs/visualc/advanced_search.asp?IntCat=0">Advanced Search</a></td>
														</tr>
													</table>
												</td>
											</tr>
										</table>
										<table border="0" cellpadding="0" cellspacing="0" width="100%" onmouseover="if(document.readyState=='complete'&amp;&amp;fBrowserOK)delayRemove();" onmouseout="if (document.readyState=='complete'&amp;&amp;fBrowserOK)cancelDelay();">
										<tr>
										<td bgcolor="#6699CC"><img src="/products/shared/images/Trans.gif" alt height="9" width="179"></td>
										<td width="1" bgcolor="#6699CC"><img src="/products/shared/images/Trans.gif" alt height="0" width="1" border="0"></td>
										</tr>
										</table>

										<table cellpadding="0" cellspacing="0" border="0" width="100%">
										    <tr>
										         <td>
										         
<table class="flyoutMenu" menudata="/visualc/inc/MnpXmlDataGen.asp?subroot=techinfo" width="180" cellpadding="2" cellspacing="0" border="0" >
	<tr>
		<td>

			<table width="175" cellpadding="0" cellspacing="0" border="0">
				<tr>
				
					<td class="flyoutLink" ><a href="/vstudio/default.asp">Visual Studio Home</a></td>
				
				</tr>
			</table>

			<table width="175" cellpadding="0" cellspacing="0" border="0">
				<tr>
				
					<td class="flyoutLink" ><a href="/visualc/default.asp">Visual C++ Home</a></td>
				
				</tr>
			</table>

			<table width="175" cellpadding="0" cellspacing="0" border="0">
				<tr>
				
					<td class="flyoutLink" handle="1001"><a href="/visualc/productinfo/default.asp">Product Information</a></td>
				
				</tr>
			</table>

			<table width="175" cellpadding="0" cellspacing="0" border="0">
				<tr>
				
					<td class="flyoutLink" handle="1074"><a href="/visualc/howtobuy/default.asp">How to Buy</a></td>
				
				</tr>
			</table>

			<table width="175" cellpadding="0" cellspacing="0" border="0">
				<tr>
				
					<td class="flyoutLink" handle="1078"><a href="/visualc/techinfo/default.asp">Technical Resources</a></td>
				
				</tr>
			</table>

			<table width="175" cellpadding="0" cellspacing="0" border="0">
				<tr>
				
					<td class="flyoutLink" handle="1084"><a href="/visualc/downloads/default.asp">Downloads</a></td>
				
				</tr>
			</table>

			<table width="175" cellpadding="0" cellspacing="0" border="0">
				<tr>
				
					<td class="flyoutLink" handle="1082"><a href="/visualc/support/default.asp">Support</a></td>
				
				</tr>
			</table>

			<table width="175" cellpadding="0" cellspacing="0" border="0">
				<tr>
				
					<td class="flyoutLink" handle="1142"><a href="/visualc/community/default.asp">Community</a></td>
				
				</tr>
			</table>
			
		</td>
	</tr>
</table>

<table class="flyoutMenu" menudata="/vstudio/templateMembers.xml" width="180" cellpadding="2" cellspacing="0" border="0" >
	<tr>
		<td>

			<table width="175" cellpadding="0" cellspacing="0" border="0">
				<tr>
				
					<td class="flyoutLink" handle="0420"><a href="/vstudio/">Developer Tools</a></td>
				
				</tr>
			</table>


<html>
<head>
<!--TOOLBAR_START-->
<!--TOOLBAR_EXEMPT-->
<!--TOOLBAR_END-->
</head>
<body>
</body>
</html>			
		</td>
	</tr>
</table>

												</td>
												</tr>
											</table>
										<!-- end leftnav And search code -->
									<table cellpadding="0" cellspacing="0" border="0" width="100%">
									    <tr>
									         <td><br>

     <!-- -->

		
                                                  </td>
                                             </tr>
                                        </table>
                                   </td>
                                   <td width="100%"> 
								<table cellpadding="20" cellspacing="0" border="0" width="100%">
                                             <tr>
                                                  <td style="padding: 11px 20px 20px 20px;">
<!-- -->

                              <table cellpadding="0" cellspacing="0" border="0" width="100%">
		                         <tr>
		                    		<td><span id="donotprint" class="fontSize1" style="color: #0066cc;"><a href="/visualc/productinfo/default.asp" class="eyebrow" TARGET="_top">Visual C++ .NET Product Information</a>
			
			&nbsp;&gt;&nbsp;<a href="/visualc/productinfo/previous/default.asp" class="eyebrow" TARGET="_top">Visual C++ 6.0</a>
			
			&nbsp;&gt;&nbsp;<a href="/visualc/techinfo/training/tour.asp" class="eyebrow" TARGET="_top">Tour</a>
			
			</span></td>
		                    	</tr>
		                    	<tr>
		                    		<td><span id="donotprint"><img src="/products/shared/images/ts.gif" width="1" height="5" alt=""></span></td>
		                     	</tr>
		                    	<tr>
		                    		<td><h1>Linking and Implementing the Controls</h1></td>
		                    	</tr>
		                     	<tr>
		                     		<td><h2 class="Subtitle"></h2></td>
		                     	</tr>
		                     	<tr>
		                    		<td><img src="/products/shared/images/ts.gif" width="1" height="5" alt=""></td>
		                     	</tr>
		                     	<tr>
		                    		<td height="1" bgcolor="#cccccc" width="100%"><img src="/products/shared/images/ts.gif" width="1" height="1" alt=""></td>
		                    	</tr>
		                    	<tr>
		                    		<td>
		                    			<table cellpadding="0" cellspacing="0" border="0" width="100%">
		                    				<tr>
		                    					<td align="left">
		                    						<table cellpadding="0" cellspacing="0" border="0">
		                    							<tr>
		                    								
		                    								<td><img src="/products/shared/images/ts.gif" width="28" height="20" alt=""></td>
		                    							</tr>
		                    						</table>		
		                    					</td>							 
		                    					<td align="right" >
		                    						
		                    					</td>
		                    				</tr>
		                    			</table>
		                    		</td>						
		                    	</tr>
		                     	<tr>
		                    		<td height="1" bgcolor="#CCCCCC" width="100%"><img src="/products/shared/images/ts.gif" width="1" height="1" alt=""></td>
		                    	</tr>
		                    </table>
		                    <table cellspacing="0" cellpadding="0" border="0" width="100%">
		                    	<tr>
		                    		<td><img src="/products/shared/images/ts.gif" height="10" width="1" alt=""></td>
		                    	</tr>
		                    </table>
                                                       <table cellpadding="0" cellspacing="0" border="0" width="100%">
                                                            <tr>
                                                                 <td align="left" valign="top">		                    
	                                                             		                    	                                           
<!-- -->
<!-- Main Content Area START -->


     <table id="donotprint" align="right" cellpadding="0" cellspacing="0" border="0" width="175">
          <tr><td><img src="/products/shared/images/ts.gif" width="1" height="4" alt></td><td><img src="/products/shared/images/ts.gif" width="1" height="1" alt></td></tr>
          <tr>
               <td><img src="/products/shared/images/ts.gif" width="10" height="1" alt></td>
               <td>

    
		<table cellpadding="0" cellspacing="0" border="0" width="175">
			<tr>
				<td width="175" height="19" class="componentHeader"><img src="/products/shared/images/ts.gif" width="8" border="0">Read Document</td>
			</tr>
			<tr>
				<td><img src="/products/shared/images/ts.gif" width="1" height="5" border="0"></td>
			</tr>
		</table>

		<table cellpadding="0" cellspacing="0" border="0" width="175">
			
               <tr style="padding-top:0;padding-left:0;">
				<td width="8" class="componentBodyText"><img src="/products/shared/images/ts.gif" width="8" height="1" border="0"></td>
                    <td class="componentBodyText" style="width:175px"><a href="http://download.microsoft.com/download/vc60pro/Update/6.0/WIN98Me/EN-US/VC6GuidedTour.exe"><img src="/products/shared/images/wordIcon.gif" border="0" width="20" height="13" alt="Read Document"></a><a href="http://download.microsoft.com/download/vc60pro/Update/6.0/WIN98Me/EN-US/VC6GuidedTour.exe">VC6GuidedTour.exe</a></td>
               </tr>
               <tr>
				<td width="8" class="componentBodyText"><img src="/products/shared/images/ts.gif" width="8" height="1" border="0"></td>
                    <td class="componentBodyText">780 KB  Microsoft Word file</td>
			</tr>
			
               <tr>
				<td width="8" class="componentBodyText"><img src="/products/shared/images/ts.gif" width="8" height="1" border="0"></td>
                    <td class="componentBodyText">4 min @ 28.8 Kbps</td>
			</tr>
			
			<tr><td><img src="/products/shared/images/ts.gif" width="8" height="15" border="0"></td></tr>
		</table>

		<table cellpadding="0" cellspacing="0" border="0" width="175">
			<tr>
				<td width="8" class="componentBodyText"><img src="/products/shared/images/ts.gif" width="8" height="1" border="0"></td> <!-- this is a gutter -->
                    <td class="componentBodyText"><a href="http://go.microsoft.com/fwlink/?LinkId=6450">Get Office file viewers</a></td>
               </tr>
			<tr><td><img src="/products/shared/images/ts.gif" width="8" height="15" border="0"></td></tr>
		</table>

          <table cellpadding="0" cellspacing="0" border="0">
               <tr valign="top" align="left">
                    <td width="175" class="componentFooter"><img src="/products/shared/images/ts.gif" height="2"></td>
               </tr>
          </table>
		<br>

     
                         <span id="donotprint">
                         <table cellpadding="0" cellspacing="0" border="0">
                              <tr valign="top" align="left">
                                   <td bgcolor="#66CCFF">
                                        <table cellpadding="3" cellspacing="0" border="0" width="175">
                                             <tr>
                                                  <td class="componentHeader" width="175">
                                                       <img src="/products/shared/images/ts.gif" width="6" border="0">
                                                       In This Article
                                                  </td>
                                             </tr>
                                        </table>
                                   </td>
                              </tr>
                         </table>
                         <table cellpadding="9" cellspacing="0" border="0">
                              <tr valign="top" align="left">
                                   <td width="175">

                                        <table cellpadding="0" cellspacing="0" border="0" width="100%">
                                             <tr>
                                                  <td valign="top"><img src="/products/shared/images/reLink2.gif" width="11" border="0" height="11"></td>
                                                  <td class="componentBodyText"><a href="/visualc/techinfo/training/tour.asp">Getting Started</a></td>
                                             </tr>
                                             <tr>
                                                  <td width="11"><img src="/products/shared/images/ts.gif" width="1" border="0" height="11"></td>
                                                  <td width="139"><img src="/products/shared/images/ts.gif" width="1" border="0" height="11"></td>
                                             </tr>
                                        </table>

                                        <table cellpadding="0" cellspacing="0" border="0" width="100%">
                                             <tr>
                                                  <td valign="top"><img src="/products/shared/images/reLink2.gif" width="11" border="0" height="11"></td>
                                                  <td class="componentBodyText"><a href="/visualc/techinfo/training/tour1.asp">Setup Instructions</a></td>
                                             </tr>
                                             <tr>
                                                  <td width="11"><img src="/products/shared/images/ts.gif" width="1" border="0" height="11"></td>
                                                  <td width="139"><img src="/products/shared/images/ts.gif" width="1" border="0" height="11"></td>
                                             </tr>
                                        </table>

                                        <table cellpadding="0" cellspacing="0" border="0" width="100%">
                                             <tr>
                                                  <td valign="top"><img src="/products/shared/images/reLink2.gif" width="11" border="0" height="11"></td>
                                                  <td class="componentBodyText"><a href="/visualc/techinfo/training/tour2.asp">Creating the Project and Adding Components</a></td>
                                             </tr>
                                             <tr>
                                                  <td width="11"><img src="/products/shared/images/ts.gif" width="1" border="0" height="11"></td>
                                                  <td width="139"><img src="/products/shared/images/ts.gif" width="1" border="0" height="11"></td>
                                             </tr>
                                        </table>

                                        <table cellpadding="0" cellspacing="0" border="0" width="100%">
                                             <tr>
                                                  <td valign="top"><img src="/products/shared/images/reLink2.gif" width="11" border="0" height="11"></td>
                                                  <td class="componentBodyText"><a href="/visualc/techinfo/training/tour3.asp">Linking and Implementing Controls</a></td>
                                             </tr>
                                             <tr>
                                                  <td width="11"><img src="/products/shared/images/ts.gif" width="1" border="0" height="11"></td>
                                                  <td width="139"><img src="/products/shared/images/ts.gif" width="1" border="0" height="11"></td>
                                             </tr>
                                        </table>

                                        <table cellpadding="0" cellspacing="0" border="0" width="100%">
                                             <tr>
                                                  <td valign="top"><img src="/products/shared/images/reLink2.gif" width="11" border="0" height="11"></td>
                                                  <td class="componentBodyText"><a href="/visualc/techinfo/training/tour4.asp">Running and Testing the Control</a></td>
                                             </tr>
                                             <tr>
                                                  <td width="11"><img src="/products/shared/images/ts.gif" width="1" border="0" height="11"></td>
                                                  <td width="139"><img src="/products/shared/images/ts.gif" width="1" border="0" height="11"></td>
                                             </tr>
                                        </table>

                                        <table cellpadding="0" cellspacing="0" border="0" width="100%">
                                             <tr>
                                                  <td valign="top"><img src="/products/shared/images/reLink2.gif" width="11" border="0" height="11"></td>
                                                  <td class="componentBodyText"><a href="/visualc/techinfo/training/tour5.asp">Building the MFC Application</a></td>
                                             </tr>
                                             <tr>
                                                  <td width="11"><img src="/products/shared/images/ts.gif" width="1" border="0" height="11"></td>
                                                  <td width="139"><img src="/products/shared/images/ts.gif" width="1" border="0" height="11"></td>
                                             </tr>
                                        </table>

                                        <table cellpadding="0" cellspacing="0" border="0" width="100%">
                                             <tr>
                                                  <td valign="top"><img src="/products/shared/images/reLink2.gif" width="11" border="0" height="11"></td>
                                                  <td class="componentBodyText"><a href="/visualc/techinfo/training/tour6.asp">Advanced Debugging</a></td>
                                             </tr>
                                             <tr>
                                                  <td width="11"><img src="/products/shared/images/ts.gif" width="1" border="0" height="11"></td>
                                                  <td width="139"><img src="/products/shared/images/ts.gif" width="1" border="0" height="11"></td>
                                             </tr>
                                        </table>

                                        <table cellpadding="0" cellspacing="0" border="0" width="100%">
                                             <tr>
                                                  <td valign="top"><img src="/products/shared/images/reLink2.gif" width="11" border="0" height="11"></td>
                                                  <td class="componentBodyText"><a href="/visualc/techinfo/training/tour7.asp">Taking it to the Web</a></td>
                                             </tr>
                                             <tr>
                                                  <td width="11"><img src="/products/shared/images/ts.gif" width="1" border="0" height="11"></td>
                                                  <td width="139"><img src="/products/shared/images/ts.gif" width="1" border="0" height="11"></td>
                                             </tr>
                                        </table>

                                   </td>
                              </tr>
                         </table>
                         <table cellpadding="0" cellspacing="0" border="0">
                              <tr valign="top" align="left">
                                   <td width="175" class="componentFooter"><img src="/products/shared/images/ts.gif" height="2"></td>
                              </tr>
                         </table><br>
                         </span>

      
               </td>
               <td><img src="/products/shared/images/ts.gif" width="10" height="1" alt></td>
          </tr>
          <tr><td><img src="/products/shared/images/ts.gif" width="1" height="4" alt></td><td><img src="/products/shared/images/ts.gif" width="1" height="1" alt></td></tr>          
     </table>




<h2>Wiring up the Controls</h2>
<p>Now you&#146;ll use some of the new features in Visual C++ 6.0 that make linking up these controls more straightforward than ever before. The controls have already been placed on the same dialog and will thus appear together graphically when the host control is instantiated.</p>
<ol>

<li>Right click in a gray area of the dialog and select <b>Events</b> from the <b>Pop-up </b>menu. Select the WM_INITDIALOG event and click <b>Add Handler.</b> This adds the OnInitDialog function to the CCourseCtl class. Click <b>OK.</li>
</b>
<br><br>When you added support for connection points to the Composite Control, the wizard in Visual C++ 6.0 added a default event interface for you. In Visual C++ 5.0 developers were required to do this operation manually for each step, from generating a GUID to editing the IDL file. <br><br>
<li>The interface added by Visual C++ 6.0 is _ICourseCtlEvents. View this interface by switching to the <b>ClassView</b> tab on the left side of the screen (make sure that CourseIntro is fully expanded). Add a method to _ICourseCtlEvents by right-clicking on it and selecting <b>Add Method.</li>
</b><li>When the Add Method to Interface window appears, enter <i>CourseSelected </i>as the Method Name and click <b>OK.</b> You&#146;ll see that a plus sign immediately appears next to _ICourseCtlEvents in ClassView. </li>
</ol>

<h2>Adding Data Support to the Control</h2>
<p>Since all of the Fitch &amp; Mather educational information is accessed via a database, you need to add data support to populate the List Box control with information on courses. To ensure high performance and to add data support easily, you&#146;ll use the OLE DB support that&#146;s new to Visual C++ 6.0. In this case, you want to add OLE DB consumer templates to your Composite Control, using the ATL Object Wizard again as you did to create the Composite Control.</p>
<ol>

<li>From the <b>Insert</b> menu, select <b>New ATL Object.</li>
</b><li>Choose the <b>Data Access</b> category on the left side of the window and select <b>Consumer.</b> Click <b>Next.</li>
</b><li>Click <b>Select Datasource.</li>
</b><li>From the list of OLE DB Providers, choose <b>Microsoft OLE DB Provider for ODBC Drivers</b> and click <b>Next.</b> The consumer code you add will communicate with this provider to retrieve records from the database. </li>
<li>On the <b>Connection</b> tab, choose the <b>Training</b> database that you set up previously by clicking on the drop-down menu under <b>Use data source name</b> and select <b>Training.</b> Click <b>OK</b> once you have selected the data source. (You can click <b>Test Connection</b> to ensure that the database was set up properly. If you are unable to connect, repeat the database connection steps from above.)</li>
<li>Select the <b>Courses</b> table from the Select Database Table window and click <b>OK </b>(see Figure 6). The information you want to place in the list box is in this table.</li>

<br><br><img src="image105.gif" WIDTH="400" HEIGHT="248">
<br><br><i>Figure 6: Select the Courses table of the database.
<br><br>
</i>
<li>Back at the ATL Object Wizard Properties window (notice that the wizard has populated the dialog for you), select <b>Table</b> under <b>Type</b> and click <b>OK. </li>
</b>
<br><br>This ensures that your OLE DB code is as lean as possible, optimized for non-parameterized queries from database tables. Later on you&#146;ll use the Command option to return information from a parameterized query. Also, this OLE DB consumer will not be updating data in any way, so the checkboxes at the bottom of the window can remain unchecked.
<br><br>
<li>The ATL Object Wizard generated two classes for you, visible in ClassView. They are CCourses and CCoursesAccessor. </li></ol>

<h2>Using the COM Compiler Support to Generate C++ Interface Definitions</h2>
<p>You can use the COM compiler support in Visual C++ 6.0 to generate the C++ interface definitions from the imported COM because you&#146;re using the ActiveMovieControl. This makes native C++ usage of the COM control simple.</p>
<ol>

<li>First of all, you need to import the COM component. Using ClassView, locate and double-click on <b>CCourseCtl class.</b> This will take you to the CCourseCtl header file (CourseCtl.h).</li>
<li>At the top of this header file, beneath the other #includes, add the following lines of code:
<pre>
#import &lt;msdxm.ocx&gt; no_namespace
#include &quot;Courses.h&quot;
</pre>
<b>Note:</b> If you experience build or compile issues with the #import statement above, you can try including the path along with the filename. For example:
<pre>
#import &lt;c:\win95\system\msdxm.ocx&gt; no_namespace
</pre>
<li>In the ClassView, expand CCourseCtl and double-click on the <b>OnInitDialog</b> function.</li>
<br><br>Now you will add variables to your code to store important control values. In the steps below, as you type <i>CSimpleArray&lt;,</i> the new IntelliSense technology in Visual&nbsp;C++ 6.0 will give you a Parameter Info pop-up tip indicating that CSimpleArray takes &lt;typename T&gt;. This is one example of IntelliSense at work in Visual C++ 6.0. 
<br><br>If you have the ClassView visible while adding these variables, you will see an example of Dynamic ClassView updating, which displays the added variables immediately, eliminating the need for a build. This makes navigation efficient for developers since there&#146;s no waiting for the IDE to be updated.
<br><br>
<li>Beneath the closing curly brace of the OnInitDialog function and above the closing curly brace for the CCourseCtl class, add the following member variables:
<pre>
IMediaPlayerPtr	m_spPlayer;
CWindow	m_ctlList;
CAxWindow	m_ctlMovie;
CSimpleArray&lt;CCoursesAccessor&gt;	m_rgCourse;
</pre>
CSimpleArray is used to store all retrieved records in memory for the highest performance. There is no need to repeatedly access the database unless data is updated.
<br><br>The variables have been added and you can now move on to adding the OnInitDialog implementation code. When you type <i>course</i> in as shown in the code below and then a period &quot;.&quot; to access the methods and properties of the course object, you see another example of IntelliSense. The List Members functionality analyzes the object and displays the appropriate methods and properties, which spares developers from having to remember or look up object properties.
<br><br>Parameter Info on the MoveNext method supplies information for the overloaded forms of MoveNext.
<br><br>
<li>Select the green TODO text in the OnInitDialog method directly above the variables you just added. In it&#146;s place, add the following code:
<pre>
CCourses course;
LONG	 nIndex;
HRESULT&nbsp;&nbsp;hr;

m_ctlList.Attach(GetDlgItem(IDC_COURSES));
m_ctlMovie.Attach(GetDlgItem(IDC_MOVIE));
m_ctlMovie.QueryControl(&amp;m_spPlayer);

hr = course.Open();
if (FAILED(hr))
{
ATLTRACE(&quot;Couldn't open Course table\n&quot;);
return 0;
}
while (course.MoveNext() == S_OK)
{
m_rgCourse.Add(course);

nIndex = m_ctlList.SendMessage(LB_ADDSTRING, 0,
 (LPARAM)course.m_Title);
}
</pre>
</ol>
<p>The code above creates a course object that contains data from the Courses table in the database. This data is then iterated through with the MoveNext() command and the course titles from each record are added as strings to the list box.</p>

<h2>Keeping Track of the User&#146;s Selection</h2>
<p>The list box is populated with course titles from the database and you need to keep track of which title the user has selected so that you can play the corresponding multimedia file. Update the movie control to show the appropriate first frame (assuming the multimedia includes video) as the user navigates through list box.</p>
<ol>

<li>Right-click on <b>CCourseCtl</b> in <b>ClassView</b> and choose <b>Add Windows Message Handler.</b> </li>
<li>Select <b>IDC_COURSES</b> from <b>Class</b> or <b>Object to Handle</b> and LBN_SELCHANGE from <b>New Windows</b> <b>messages/events.</b> Click <b>Add </b>and <b>Edit </b>and accept the default name <i>OnSelchangeCourses</i> by clicking <b>OK.</li>
</b><li>In the OnSelchangeCourses method, add some code to set the filename of multimedia you want to play. Select the green <b>TODO </b>comment and overtype this code:
<pre>
LONG	nIndex = m_ctlList.SendMessage(LB_GETCURSEL, 0, 0);

// Set the filename of the multimedia file to play
m_spPlayer-&gt;FileName = m_rgCourse[nIndex].m_Video;

Fire_CourseSelected();
</pre>
The above code sets the filename of the file to be played based on the current selection in the list box and fires CourseSelected to begin the process of displaying the appropriate PowerPoint slides.
<br><br>
<li>Since you&#146;ve made changes to the COM code in the project, compiling the IDL file will ensure that the project is up-to-date. From the FileView, navigate into the CourseIntro project source files and right-click on <b>CourseIntro.idl.</b> Select <b>Compile CourseIntro.idl</b> from the <b>Pop-up</b> menu. The Build Status window near the bottom of the development environment shows the status of the compilation.</li>
<li>When you have compiled the IDL file, right click on the <b>CCourseCtl </b>class in ClassView and select <b>Implement Connection Point.</b> Place a check in the box next to <b>_ICourseControlEvents</b> and click <b>OK.</b> </li>
<li>In ClassView, double-click on the <b>CCourseCtl </b>class and scroll down in the CoursesCtl.h file to the CONNECTION_POINT_MAP. Add a capital <i>D</i> before IID in the second connection point entry so that it reads: 
<pre>
CONNECTION_POINT_ENTRY(DIID__ICourseCtlEvents)
</pre>
This ensures that this connection point supports dispatch.
</ol>



<h2>Making Sure the Slides Load</h2>
<p>The slides displayed by your application are PowerPoint presentations stored in C:\Visual C++ 6.0 Guided Tour. Your application is able to locate and load them because these locations are also stored in the database.</p>
<ol>

<li>Right-click on <b>ICourseCtl</b> in ClassView (right above the Globals) and select <b>Add Property </b>from the menu. </li>
<li>In the Add Property to Interface window, select <b>BSTR</b> as the <b>Property Type</b> since you want to handle a string. The Property Name is <b>Slides</b>. Uncheck <b>Put Function </b>under<b> Function Type</b> as this function is read-only (see Figure 7). Click <b>OK.</li>
</b>
<br><br><img src="image106.gif" WIDTH="400" HEIGHT="405">
<br><br>
<i>Figure 7: Setting the properties for the ICourseCtl interface.
<br><br>
</i>
As you type the two colons before SysAllocString in the step below, IntelliSense provides the most comprehensive list it can. The menu includes the Win32 API, MFC, ATL, custom classes, libraries, and more. This list gives an idea of how comprehensive IntelliSense is in Visual C++ 6.0. Developers have the productivity of IntelliSense on their side for the widest array of programming challenges.
<li>In ClassView, navigate to the <b>CCourseCtl class</b> and expand <b>ICourseCtl.</b> Double-click on <b>get_slides</b> and add the following code above return S_OK, replacing the TODO line:</li>
<pre>
 USES_CONVERSION;
 // Get current selection in the list box
 LONG nIndex = m_ctlList.SendMessage(LB_GETCURSEL, 0, 0);

 *pVal = ::SysAllocString(T2OLE(m_rgCourse[nIndex].m_Slides));
</pre>
Based on the selection in the list box, this code passes the file system location for the PowerPoint slides to the <b>Slides</b> property added above.
</ol>

<!-- Main Content Area END -->


													</td>
                                                            </tr>
                                                            <tr>
                                                                 <td>				
				<br>
				<table cellpadding="0" cellspacing="0" border="0" width="100%" id="donotprint">
					<tr valign="bottom">
						<td align="left"><a href="#top"><img src="/products/shared/images/top_v1.gif" width="40" height="20" alt="To top of page" border="0" /></a></td>
						<td align="right">	
										
						</td>
					</tr>
				</table>
                                                                 </td>
                                                            </tr>  
                                                       </table>					
<!-- -->

										</td>
                                             </tr>
                                        </table>
     
                                   </td> 
                              </tr>
                         </table>
                    </td>
               </tr>
               <tr valign="top">
                    <td>
                         <table border="0" cellpadding="0" cellspacing="0" width="100%">
                              <tr>
                                   <td width="100%">
                                        <span id="donotprint">
	<span id="pgFooter">

		<table cellpadding="0" cellspacing="0" width="100%" height="20" border="0" class="FooterBranding">
			<tr>
				<td align="left">
					<table cellpadding="0" cellspacing="0" border="0" height="100%">
						<tr class="MNPFooterRow1">
							<td width="10">&nbsp;&nbsp;</td>

							<td nowrap><a href="/isapi/goregwiz.asp?target=/contactus30/contactus.asp?domain=devtools/vc" target="_top">Contact Us</a></td>
							<td width="10">&nbsp;&nbsp;</td>

						<script language="javascript"  type="text/javascript">
							var sItemURL = "mailto:?subject=A link from Microsoft&body=This link is from the Visual C++ Web site" + " "  + top.parent.location.href
							document.write('<td nowrap><a href="' + sItemURL + '"  target=>E-Mail This Page</a></td>')
							document.write ('<td>&nbsp;&nbsp;</td>')
						</script>
	
						</tr>
					</table>
				</td>
			</tr>
		</table>

		<table cellpadding="0" cellspacing="0" width="100%" height="30" border="0" class="FooterBranding">
			<tr>
				<td align="left">
					<table cellpadding="0" cellspacing="0" border="0" height="100%">
						<tr class="MNPFooterRow2">
							<td width="10">&nbsp;&nbsp;</td>

							<td nowrap><a href="http://www.microsoft.com/info/cpyright.htm" target="_top">© 2002 Microsoft Corporation. All rights reserved.  Terms of Use.</a></td>
							<td width="10">&nbsp;&nbsp;</td>

							<td nowrap><a href="http://www.microsoft.com/info/privacy.htm" target="_top">Privacy Statement</a></td>
							<td width="10">&nbsp;&nbsp;</td>

							<td nowrap><a href="http://www.microsoft.com/enable/" target="_top">Accessibility</a></td>
							<td width="10">&nbsp;&nbsp;</td>

						</tr>
					</table>
				</td>
			</tr>
		</table>

	</span>
</span>
                                   </td>
                              </tr>
                         </table>
                    </td>
               </tr>
          </table>     
     

</body>
</html>

