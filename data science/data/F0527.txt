ID=F0527
URL=http://www.geocities.com/SiliconValley/Campus/9449/Tips/tip06.htm
SIZE=5337
DATE=09/07/2002
TIME=13:22:02
DATASET=Visual Basic
HTML=<HTML>
<HEAD>
   <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
   <META NAME="GENERATOR" CONTENT="Mozilla/4.01 [en] (Win95; U) [Netscape]">
   <TITLE>Gradient Background</TITLE>
<STYLE  TYPE="text/css">

td {  font-family: Arial, Helvetica, sans-serif; font-size: 10pt}

</STYLE>
</HEAD>
<BODY TEXT="#000000" BGCOLOR="#66FF99" LINK="#0000EE" VLINK="#551A8B" ALINK="#FF0000">
&nbsp;
<CENTER><TABLE BORDER=0 WIDTH="550" BGCOLOR="#C0C0C0" >
<TR>
<TD>
<CENTER><B><FONT FACE="Arial,Helvetica"><FONT COLOR="#FF0000"><FONT SIZE=-1>Playing
Wave Files from VB</FONT></FONT></FONT></B></CENTER>
<FONT FACE="Arial,Helvetica">&nbsp;&nbsp;</FONT>&nbsp;

<P><FONT FACE="Arial,Helvetica"><FONT SIZE=-1>There are many functions
used to play wavs in VB. The probably most used is sndPlaySound.</FONT></FONT><FONT FACE="Arial,Helvetica"><FONT SIZE=-1></FONT></FONT>

<P><FONT FACE="Arial,Helvetica"><FONT SIZE=-1>To accomplish this task,
place the code that follows inside a module:</FONT></FONT><FONT FACE="Arial,Helvetica"><FONT SIZE=-1></FONT></FONT>

<P><FONT FACE="Arial,Helvetica"><FONT COLOR="#000099"><FONT SIZE=-1>Declare
Function sndPlaySound Lib "winmm.dll" Alias "sndPlaySoundA" (ByVal lpszSoundName
As String, ByVal uFlags As Long) As Long</FONT></FONT></FONT><FONT FACE="Arial,Helvetica"><FONT SIZE=-1></FONT></FONT>

<P><FONT FACE="Arial,Helvetica"><FONT SIZE=-1><FONT COLOR="#FF0000">'lpszSoundName</FONT>
- the file you want to play&nbsp;&nbsp;</FONT></FONT>
<BR><FONT FACE="Arial,Helvetica"><FONT SIZE=-1><FONT COLOR="#FF0000">'uFlags</FONT>
- how you want to play it.&nbsp;&nbsp;</FONT></FONT><FONT FACE="Arial,Helvetica"><FONT SIZE=-1></FONT></FONT>

<P><FONT FACE="Arial,Helvetica"><FONT COLOR="#006600"><FONT SIZE=-1>'The
uFlags are:&nbsp;&nbsp;</FONT></FONT></FONT><FONT FACE="Arial,Helvetica"><FONT SIZE=-1></FONT></FONT>

<P><FONT FACE="Arial,Helvetica"><FONT SIZE=-1><FONT COLOR="#000099">Public
Const SND_SYNC = 0</FONT><FONT COLOR="#006600"> ' Freeze program until
sound is done&nbsp;&nbsp;</FONT></FONT></FONT><FONT FACE="Arial,Helvetica"><FONT COLOR="#000099"><FONT SIZE=-1></FONT></FONT></FONT>

<P><FONT FACE="Arial,Helvetica"><FONT SIZE=-1><FONT COLOR="#000099">Public
Const SND_ASYNC = 1</FONT><FONT COLOR="#006600"> ' Continue program while
sound plays&nbsp;</FONT><FONT COLOR="#000099">&nbsp;</FONT></FONT></FONT><FONT FACE="Arial,Helvetica"><FONT COLOR="#000099"><FONT SIZE=-1></FONT></FONT></FONT>

<P><FONT FACE="Arial,Helvetica"><FONT SIZE=-1><FONT COLOR="#000099">Public
Const SND_NODEFAULT = 2</FONT><FONT COLOR="#006600"> ' Don't beep if sound
not found&nbsp;&nbsp;</FONT></FONT></FONT><FONT FACE="Arial,Helvetica"><FONT COLOR="#000099"><FONT SIZE=-1></FONT></FONT></FONT>

<P><FONT FACE="Arial,Helvetica"><FONT COLOR="#000099"><FONT SIZE=-1>Public
Const SND_LOOP = 8</FONT></FONT></FONT>
<BR><FONT FACE="Arial,Helvetica"><FONT COLOR="#006600"><FONT SIZE=-1>'
Loops the sound. To stop the loop, call the function again with SND_ASYNC
and&nbsp;</FONT></FONT></FONT>
<BR><FONT FACE="Arial,Helvetica"><FONT COLOR="#006600"><FONT SIZE=-1>'
SND_NODEFAULT combined with the logical <B>Or</B> operator, and "" as the
file name</FONT></FONT></FONT><FONT FACE="Arial,Helvetica"><FONT COLOR="#006600"><FONT SIZE=-1></FONT></FONT></FONT>

<P><FONT FACE="Arial,Helvetica"><FONT SIZE=-1><FONT COLOR="#000099">Public
Const SND_NOSTOP = 16</FONT><FONT COLOR="#006600"> ' The function returns
false if another sound is playing&nbsp;&nbsp;</FONT></FONT></FONT><FONT FACE="Arial,Helvetica"><FONT SIZE=-1></FONT></FONT>

<P><FONT FACE="Arial,Helvetica"><FONT SIZE=-1>So let's create an easier
function to use:</FONT></FONT>
<BR><FONT FACE="Arial,Helvetica"><FONT SIZE=-1></FONT></FONT>&nbsp;<FONT FACE="Arial,Helvetica"><FONT SIZE=-1></FONT></FONT>

<P><FONT FACE="Arial,Helvetica"><FONT COLOR="#000099"><FONT SIZE=-1><B>Public
Sub</B> PlaySnd<B>(</B> Filename <B>As String)</B></FONT></FONT></FONT><FONT FACE="Arial,Helvetica"><FONT COLOR="#000099"><FONT SIZE=-1></FONT></FONT></FONT>

<P><FONT FACE="Arial,Helvetica"><FONT COLOR="#000099"><FONT SIZE=-1><B>Call</B>
sndPlaySound <B>(</B>Filename, SND_ASYNC Or SND_NODEFAULT Or SND_NOSTOP<B>)</B></FONT></FONT></FONT><FONT FACE="Arial,Helvetica"><FONT COLOR="#000099"><FONT SIZE=-1></FONT></FONT></FONT>

<P><B><FONT FACE="Arial,Helvetica"><FONT COLOR="#000099"><FONT SIZE=-1>End
Sub</FONT></FONT></FONT></B><FONT FACE="Arial,Helvetica"><FONT SIZE=-1></FONT></FONT>

<P><FONT FACE="Arial,Helvetica"><FONT SIZE=-1>The sub plays a sound without
freezing the program. If the file doesn't exist, or if there's another
sound playing, nothing happens.</FONT></FONT></TD>
</TR>
</TABLE></CENTER>
<B>&nbsp;</B>
</BODY>
</HTML>
<!-- text below generated by server. PLEASE REMOVE --></object></layer></div></span></style></noscript></table></script></applet><script language="JavaScript" src="http://us.i1.yimg.com/us.yimg.com/i/mc/mc.js"></script><script language="JavaScript" src="http://us.geocities.com/js_source/geov2.js"></script><script language="javascript">geovisit();</script><noscript><img src="http://visit.geocities.com/visit.gif?1026142933" border=0 width=1 height=1></noscript>
<IMG SRC="http://geo.yahoo.com/serv?s=76001067&t=1026142933" ALT=1 WIDTH=1 HEIGHT=1>

