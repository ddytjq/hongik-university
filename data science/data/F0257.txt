ID=F0257
URL=http://www.vbip.com/miscellaneous/new-standard-gui/new-standard-gui-01.asp
SIZE=48077
DATE=09/07/2002
TIME=13:17:46
DATASET=Visual Basic
HTML=
<html>

<head>
<meta name="description" content="In this article, I'll introduce some neat coding techniques that can make your program users think you or your company are/is bigger than actuality.">
<title>Developing with a new standard in UI</title>
<meta name="GENERATOR" content="Microsoft FrontPage 5.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<meta name="ROBOTS" content="INDEX,FOLLOW">

	<link rel="stylesheet" type="text/css" href="../../../vbip_nn.css">

</head>

<body bgcolor="#FFFFFF">
<form name="GlobalForm" ID="GlobalForm">
<table border="0" width="100%" cellspacing="0" cellpadding="0">
  <tr>
    <td width="100%">
      <table border="0" width="100%" cellspacing="0" cellpadding="0">
        <tr>
          <td width="120"><img border="0" src="../../_borders/vbip_logo3.gif" width="132" height="50"></td>
          <td valign="middle">
				<p align="center">
              <!-- start BITS ad HTML -- top of page -- 468x60 banner www.bitsonthewire.com         --> 
               <iframe src="http://ads.bitsonthewire.com/admgriframe.asp?siteid=1126&ad_type=0" width=468 height=60 marginwidth=0 marginheight=0 hspace=0 vspace=0 frameborder=0 scrolling=no> 
                 <a href="http://ads.bitsonthewire.com/adrdrmanager.asp?loc=1">
                   <img border="0" src="http://ads.bitsonthewire.com/admanager.asp?loc=1&siteid=1126&ad_type=0">
                 </a></iframe> 
              <!-- stop BITS ad HTML -- top of page -- 468x60 banner                                --> 
				&nbsp;
              <a href="http://www.amazon.com/exec/obidos/redirect-home/vbipvisualbasici">
              <img border="0" src="../../images/gnused120x60.gif" width="120" height="60"></a></p>
          </td>
        </tr>
      </table>
    </td>
  </tr>
  <tr>
    <td width="100%" height="1" valign="top">
      <hr noshade color="#FF9933">
    </td>
  </tr>
  <tr>
    <td width="100%" height="1" valign="top">
    <p class="barsidecaption">
    	<a href="../../default.asp">Home</a> -
      	<a href="../../whatsnew.asp"> What's New</a> - <a href="../../tools.asp"> Tools&amp;Technologies</a> -
      	<a href="../../resources.asp"> Resources</a> - <a href="../../resources/books/default.asp">Books</a>
        - <a href="../../forum/">Forum</a>
    </p>
    </td>
  </tr>
  <tr>
    <td width="100%" height="1" valign="top">
      <hr noshade color="#FF9933">
    </td>
  </tr>
</table>

<table width="100%" cellspacing="1" cellpadding="2" bordercolor="#800000" border="1">
  <tr>
    <td width="100%" bgcolor="#FF9933">
      <font color="#FFFFCC">
      <table border="0" width="100%" cellspacing="0" cellpadding="0">
        <tr>
          <td width="37%">
          <SCRIPT LANGUAGE=javascript>
          <!--
          if(navigator.appName.indexOf('Microsoft')>=0)
          {
          document.write('<a HREF="javascript:void(0);" class="tbcaption" onClick="window.external.AddFavorite(location.href, document.title);">Add to Favorites</a>');
          }
          // -->
          </SCRIPT>
          </td>
          <td width="63%">
            <p align="right" class="tbcaption">
            <a href="../../default.asp" class="tbcaption">Home</a> -
            <a href="../../tools.asp" class="tbcaption">Tools&amp;Technologies</a> 
            - Miscellaneous - Developing with a new standard in UI</td>
        </tr>
      </table>
      </font>
    </td>
  </tr>
</table>
<table border="0" width="100%" cellspacing="0" cellpadding="0">

<!--table-->
    <td width="125" valign="top"  style="border-left: 1px solid #800000; border-right: 1px solid #800000; " bgcolor="#FF9933">

    <table border="0" width="100%">
     <tr>
        <td width="100%" bgcolor="#FFCC00" style="border-left: 1px solid #800000; border-right: 1px solid #FFFFCC; border-top: 1px solid #800000; border-bottom: 1px solid #FFFFCC; " height="20">
          <p align="center" class="barsidecaption">[Advertisement]</td>
      </tr>
      <tr>
        <td width="100%" style="border: 1px solid #800000; " height="120">
<!-- start BITS ad HTML -- first 125x125 banner www.bitsonthewire.com                 --> 
<iframe src="http://ads.bitsonthewire.com/admgriframe.asp?siteid=1126&ad_type=-6" width=125 height=125 marginwidth=0 marginheight=0 hspace=0 vspace=0 frameborder=0 scrolling=no>
<a href="http://ads.bitsonthewire.com/adrdrmanager.asp?loc=3"><img border="0" src="http://ads.bitsonthewire.com/admanager.asp?loc=3&siteid=1126&ad_type=-6"></a></iframe> 
<!-- stop BITS ad HTML -- 125x125 banner                                             --> 	
        </td>
      </tr>
         
      <tr>
        <td width="100%" style="border-left: 1px solid #800000; border-right: 1px solid #FFFFCC; border-top: 1px solid #800000; border-bottom: 1px solid #FFFFCC; " bgcolor="#FFCC00" height="21">
          <p align="center" class="barsidecaption">[Search vbip.com]</td>
      </tr>
      <tr>
      
        <td valign="top" width="100%" height="21">
        
			<input type="text" size="7" name="search_site">&nbsp;
			<input type="button"  value="Go" onclick='location.href="http://www.vbip.com/search2/search.asp?Realm=vbip.com&Match=1&Terms="+document.GlobalForm.search_site.value;'>	
		
        </td>
      </tr>
         
      <tr>
        <td width="100%" style="border-left: 1px solid #800000; border-right: 1px solid #FFFFCC; border-top: 1px solid #800000; border-bottom: 1px solid #FFFFCC; " bgcolor="#FFCC00" height="21">
          <p align="center" class="barsidecaption">[Search other VB sites]</td>
      </tr>
      <tr>
        <td valign="top" width="100%" height="21">
        
			<input type="text" size="7" name="search_web">&nbsp;
			<input type="button"  value="Go" onclick='location.href="http://www.vbip.com/search2/search.asp?Realm=Other+VB+Websites&Match=1&Terms="+document.GlobalForm.search_web.value;'>	
		      
      </tr>
     
      <tr>
        <td width="100%" style="border-left: 1px solid #800000; border-right: 1px solid #FFFFCC; border-top: 1px solid #800000; border-bottom: 1px solid #FFFFCC; " bgcolor="#FFCC00" height="21">
          <p align="center" class="barsidecaption">[Featured Book]</td>
      </tr>
      <tr>
        <td valign="top" width="100%" height="21">
<center><center>
<a href="http://www.vbip.com/appdev.asp">
<img src="http://www.vbip.com/images/appdev120x240.jpg">
</a>
</center></center>
        </td>
      </tr>
     
      <tr>
        <td width="100%" style="border-left: 1px solid #800000; border-right: 1px solid #FFFFCC; border-top: 1px solid #800000; border-bottom: 1px solid #FFFFCC; " bgcolor="#FFCC00" height="21">
          <p align="center" class="barsidecaption">[Newsletter]</td>
      </tr>
      <tr>
        <td width="100%" height="56">
          <form method="POST" action="../../sub.asp" onSubmit="">
            <table border="0" width="100%" cellspacing="0">
              <tr>
                <td width="84%">
                <input type="text" name="T1" size="8" style="font-family: Tahoma; color: #800000; font-size: 8pt; background-color: #FFCC99; border-left: 1px solid #800000; border-right: 1px solid #FFFFCC; border-top: 1px solid #800000; border-bottom: 1px solid #FFFFCC; " value="your e-mail"></td>
                <td width="16%"><input type="submit" value="Sub" name="B1" style="font-family: Tahoma; font-size: 8pt; color: #800000"></td>
              </tr>
              <tr>
                <td width="100%" colspan="2"><input type="radio" value="V1" checked name="R1"><span class="barsidecaption">HTML</span>
                  <input type="radio" name="R1" value="V2"><span class="barsidecaption">Text</span></td>
              </tr>
            </table>
          </form>
        </td>
      </tr>

      <tr>
        <td width="100%" style="border-left: 1px solid #800000; border-right: 1px solid #FFFFCC; border-top: 1px solid #800000; border-bottom: 1px solid #FFFFCC; " bgcolor="#FFCC00" height="21">
      <p align="center" class="barsidecaption">
      [Partners]
      </tr>
	
  <tr>
        <td width="100%" height="22">
      <p align="center"><a href="http://www.vbcity.com" target="_blank"><img border="0" src="../..//images/vbcity2_100x30.gif" width="100" height="30"></a>
  </tr>
  <tr>
        <td width="100%" height="22">
      <p align="center"><a href="http://www.vbweb.co.uk/" target="_blank"><img border="0" src="../..//images/vbweb_button.gif" width="100" height="30"></a>
  </tr>  
      <tr>
        <td width="100%" height="12" align="center">
      <a href="http://www.vbwire.com" target="_blank"><img border="0" src="../..//images/VBWire-btn.gif" width="100" height="30"></a>
      </tr>

  <tr>
        <td width="100%" height="22">
      <p align="center"><a href="http://www.developersdex.com/vb" target="_blank"><img border="0" src="../..//images/vbdex.gif" width="100" height="30"></a>
  </tr>  
  <tr>
        <td width="100%" height="3">
        <center>
        <!-- BEGIN ACKY CODE -->
		<a href="http://www.acky.net" target="_blank"><img
		src="http://www.acky.net/banners/ackbut3.gif" width="88" height="31"
		border="0" alt="Acky.net is your one stop shop for all of your web
		developing needs"></a>
		<!-- END ACKY CODE -->
		</center>
  </tr>
    </table>

    </td>
    <td valign="top" bgcolor="#FFFFFF">
      <blockquote>
        <p class="ChapterTitle"><br>
        <span lang="en-us"><img border="0" src="new-gui.gif" align="right">Developing with a new standard in UI</span></p>
        <p><b><font face="Arial" size="2" color="#800000">
              by John T. Yung, MCSD</font></b></p>
          <hr noshade color="#FF9933" size="1">
        <p>In this new century we enter, everything relating to software should 
        have a standard of quality. For small time programmers, that doesn't 
        necessarily mean having quick turnaround or technical support response. 
        No, for quality, I mean having features that can make your user 
        interface smart and easier to use; thus giving a feel of quality and a 
        polish reputation for your programming &quot;PROWESS&quot; among your peers.</p>
        <p><span lang="EN-US">Have you ever seen programs that have small neat 
        user interface features that make you think, &quot;Ummm, that’s pretty cool 
        (and useful).&quot;&nbsp; Well, have you ever made the leap of faith and said in a 
        stuttering manner to yourself, &quot;I should do that! Yeah....&nbsp; uh yeah I 
        should do that.... &quot; But yet, you just don't know how?&nbsp; Well, here in 
        the “Pseudo l Conceptual Institute of Johnny's VB Support”, we have the 
        code and expertise to solve your dilemma.&nbsp; We are confident in our 
        skills to rehabilitate your programming knowledge because &quot;I'm not just 
        the programmer, I'm also a client.&quot; </span>
        <span lang="EN-US" style="font-size: 9.5pt; font-family: Wingdings">J</span></p>
        <p>Now seriously....</p>
        <p>In this article, I'll introduce some neat coding techniques that can 
        make your program users think you or your company are/is bigger than 
        actuality.</p>
        <p>Here’s a list of what you will read in this first of a series of 
        articles: </p>
        <ol>
          <li>Screen Edge Snapping for the your Form </li>
          <li>Program Taskbar alert </li>
          <li>Always stay on Top </li>
        </ol>
        <p>When I get through the topics with you, you probably jump right in to 
        implementing this yourself. Before you do so, consider using it wisely 
        “grasshopper”. Use it selectively and elegantly, certain features only 
        make a good user experience when used at opportune and justified times.</p>
        <p class="ArticleH2">Screen Edge Snapping</p>
        <blockquote>
        <p>The purposes of this feature is to help users automatically snap the 
        position your program’s form inline &quot;exactly&quot; with the edge of the 
        screen. This helps them from spending time slowing reading and moving 
        their mouse and form so they can concentrate on working on their tasks.</p>
          <p>
          <img width="239" height="92" src="new-st1.jpg" v:shapes="_x0000_s1027">&nbsp;&nbsp;&nbsp;
          <img width="209" height="53" src="new-st2.jpg" v:shapes="_x0000_s1028"><br clear="ALL">
&nbsp;</p>
        <p><b>(illustration 1) this is an example of screen edge snapping.</b></p>
        <p>This behavior is pretty neat. It doesn't require the user to learn 
        anything new in particular, it is more of an enhance usability. To do 
        this in code, you have to open a regular project with a dialog form. Set 
        the form's caption to nothing and set the ControlBox Setting to &quot;false&quot; 
        (see illustration 2). </p>
        <p>
        <img width="204" height="324" src="new-st3.jpg" v:shapes="_x0000_s1030"></p>
        <p><b>(illustration 2) this shows the properties of the form set with 
        caption of “” and ControBox selection to false.</b></p>
        <p>Now go inside the code for the form. There are two private form 
        functions you need to address. They are MouseMove and MouseDown. These 
        two function will detect the click and drag of the form. The code will 
        simply detect the position of the form if its near the edge of the 
        screen and if so, reposition or &quot;snap&quot; it inline to the nearest edge of 
        the screen. (see illustration 3)</p>
          <table cellpadding="0" cellspacing="0" align="left">
            <tr>
              <td>
              <img width="623" height="57" src="new-st4.jpg" v:shapes="_x0000_s1029"></td>
            </tr>
          </table>
          <p><br clear="ALL">
&nbsp;</p>
        <p><b>(illustration 3) this is the form code selection box; Notice the 
        Form function MouseDown and MouseMove.</b></p>
        <p>Now that you know the territory of where the action will happen, we 
        have to build a foundation for it. A class needs to be made that handles 
        the user enhancements. Let me point out that developing this class 
        provides reusability to your future projects. In the project, you add in 
        a class, name it “clsDockingHandler” and add the following to the class:</p>
          <table border='0' width='80%' bgcolor='#F8F8F8' cellspacing='0' cellpadding='2'>
  <tr>
    <td width='100%'>
      <p class='code'><font color="#008000">'Code&nbsp;For&nbsp;class&nbsp;<br>
      'The&nbsp;variable&nbsp;declaration&nbsp;are&nbsp;self&nbsp;explanatory&nbsp;</font><br>
<font color="#000080">Private&nbsp;</font>mParentForm&nbsp;<font color="#000080">As&nbsp;</font>Form&nbsp;<br>
<font color="#000080">Private&nbsp;</font>mAlwaysOnTop&nbsp;<font color="#000080">As&nbsp;Boolean&nbsp;</font><br>
<font color="#000080">Private&nbsp;</font>mSnapDistance&nbsp;<font color="#000080">As&nbsp;Long&nbsp;</font><br>
&nbsp;<br>
<font color="#008000">'&nbsp;Internally&nbsp;set&nbsp;variables&nbsp;</font><br>
<font color="#000080">Private&nbsp;</font>mStartDragX&nbsp;<font color="#000080">As&nbsp;Single&nbsp;</font><br>
<font color="#000080">Private&nbsp;</font>mStartDragY&nbsp;<font color="#000080">As&nbsp;Single&nbsp;</font><br>
&nbsp;<br>
<font color="#000080">Private&nbsp;</font>mWorkAreaRect&nbsp;<font color="#000080">As&nbsp;</font>RECT&nbsp;<br>
&nbsp;<br>
<font color="#008000">'&nbsp;Are&nbsp;we&nbsp;attached&nbsp;to&nbsp;some&nbsp;edge&nbsp;of&nbsp;the&nbsp;screen?&nbsp;</font><br>
<font color="#000080">Private&nbsp;</font>mAttachedToRight&nbsp;<font color="#000080">As&nbsp;Boolean&nbsp;</font><br>
<font color="#000080">Private&nbsp;</font>mAttachedToLeft&nbsp;<font color="#000080">As&nbsp;Boolean&nbsp;</font><br>
<font color="#000080">Private&nbsp;</font>mAttachedToTop&nbsp;<font color="#000080">As&nbsp;Boolean&nbsp;</font><br>
<font color="#000080">Private&nbsp;</font>mAttachedToBottom&nbsp;<font color="#000080">As&nbsp;Boolean&nbsp;</font><br>
&nbsp;<br>
<font color="#000080">Private&nbsp;</font>mWindowStyle&nbsp;<font color="#000080">As&nbsp;Long&nbsp;</font><br>
&nbsp;<br>
<font color="#000080">Public&nbsp;Sub&nbsp;</font>StartDockDrag(<font color="#000080">ByVal&nbsp;</font>x&nbsp;<font color="#000080">As&nbsp;Single</font>,&nbsp;<font color="#000080">ByVal&nbsp;</font>y&nbsp;<font color="#000080">As&nbsp;Single</font>)&nbsp;<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">'&nbsp;Get&nbsp;the&nbsp;WorkArea&nbsp;-&nbsp;the&nbsp;area&nbsp;of&nbsp;the&nbsp;desktop&nbsp;not&nbsp;taken&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">'&nbsp;by&nbsp;the&nbsp;taskbar,&nbsp;using&nbsp;a&nbsp;little&nbsp;known&nbsp;but&nbsp;interesting&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">'&nbsp;API&nbsp;call&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;SystemParametersInfo&nbsp;SPI_GETWORKAREA,&nbsp;0&,&nbsp;mWorkAreaRect,&nbsp;0&&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">'&nbsp;Convert&nbsp;from&nbsp;pixels&nbsp;to&nbsp;twips&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;mWorkAreaRect.Top&nbsp;=&nbsp;mWorkAreaRect.Top&nbsp;*&nbsp;Screen.TwipsPerPixelY&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;mWorkAreaRect.Left&nbsp;=&nbsp;mWorkAreaRect.Left&nbsp;*&nbsp;Screen.TwipsPerPixelX&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;mWorkAreaRect.Bottom&nbsp;=&nbsp;mWorkAreaRect.Bottom&nbsp;*&nbsp;Screen.TwipsPerPixelY&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;mWorkAreaRect.Right&nbsp;=&nbsp;mWorkAreaRect.Right&nbsp;*&nbsp;Screen.TwipsPerPixelX&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;mStartDragX&nbsp;=&nbsp;x&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;mStartDragY&nbsp;=&nbsp;y&nbsp;<br>
&nbsp;<br>
<font color="#000080">End&nbsp;Sub&nbsp;</font><br>
&nbsp;<br>
<font color="#000080">Public&nbsp;Sub&nbsp;</font>UpdateDockDrag(<font color="#000080">ByVal&nbsp;</font>x&nbsp;<font color="#000080">As&nbsp;Single</font>,&nbsp;<font color="#000080">ByVal&nbsp;</font>y&nbsp;<font color="#000080">As&nbsp;Single</font>)&nbsp;<br>
<font color="#000080">Dim&nbsp;</font>DiffX&nbsp;<font color="#000080">As&nbsp;Long</font>,&nbsp;DiffY&nbsp;<font color="#000080">As&nbsp;Long&nbsp;</font><br>
<font color="#000080">Dim&nbsp;</font>NewX&nbsp;<font color="#000080">As&nbsp;Long</font>,&nbsp;NewY&nbsp;<font color="#000080">As&nbsp;Long&nbsp;</font><br>
<font color="#000080">Dim&nbsp;</font>ToLeftDistance&nbsp;<font color="#000080">As&nbsp;Long&nbsp;</font><br>
<font color="#000080">Dim&nbsp;</font>ToRightDistance&nbsp;<font color="#000080">As&nbsp;Long&nbsp;</font><br>
<font color="#000080">Dim&nbsp;</font>ToTopDistance&nbsp;<font color="#000080">As&nbsp;Long&nbsp;</font><br>
<font color="#000080">Dim&nbsp;</font>ToBottomDistance&nbsp;<font color="#000080">As&nbsp;Long&nbsp;</font><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">If&nbsp;</font>ParentForm&nbsp;<font color="#000080">Is&nbsp;Nothing&nbsp;Then&nbsp;Exit&nbsp;Sub&nbsp;</font><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;DiffX&nbsp;=&nbsp;x&nbsp;-&nbsp;mStartDragX&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;DiffY&nbsp;=&nbsp;y&nbsp;-&nbsp;mStartDragY&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">If&nbsp;</font>DiffX&nbsp;=&nbsp;0&nbsp;<font color="#000080">And&nbsp;</font>DiffY&nbsp;=&nbsp;0&nbsp;<font color="#000080">Then&nbsp;Exit&nbsp;Sub&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;NewX&nbsp;=&nbsp;mParentForm.Left&nbsp;+&nbsp;DiffX&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;NewY&nbsp;=&nbsp;mParentForm.Top&nbsp;+&nbsp;DiffY&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">'&nbsp;Find&nbsp;the&nbsp;distance&nbsp;to&nbsp;the&nbsp;screen&nbsp;edges&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;ToRightDistance&nbsp;=&nbsp;mWorkAreaRect.Right&nbsp;-&nbsp;(NewX&nbsp;+&nbsp;mParentForm.Width)&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;ToLeftDistance&nbsp;=&nbsp;NewX&nbsp;-&nbsp;mWorkAreaRect.Left&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;ToBottomDistance&nbsp;=&nbsp;mWorkAreaRect.Bottom&nbsp;-&nbsp;(NewY&nbsp;+&nbsp;mParentForm.Height)&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;ToTopDistance&nbsp;=&nbsp;NewY&nbsp;-&nbsp;mWorkAreaRect.Top&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">'&nbsp;The&nbsp;idea&nbsp;in&nbsp;all&nbsp;the&nbsp;following&nbsp;code&nbsp;is&nbsp;the&nbsp;same:&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">'&nbsp;If&nbsp;we’re&nbsp;not&nbsp;already&nbsp;attached&nbsp;some&nbsp;specific&nbsp;edge,&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">'&nbsp;find&nbsp;out&nbsp;if&nbsp;we&nbsp;should.&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">'&nbsp;If&nbsp;we’re&nbsp;already&nbsp;attached,&nbsp;find&nbsp;out&nbsp;whether&nbsp;we&nbsp;should&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">'&nbsp;"break"&nbsp;the&nbsp;attachment,&nbsp;or&nbsp;stay&nbsp;put.&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">If&nbsp;Not&nbsp;</font>mAttachedToBottom&nbsp;<font color="#000080">Then&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">If&nbsp;</font>Abs(ToBottomDistance)&nbsp;<=&nbsp;mSnapDistance&nbsp;<font color="#000080">Then&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">'&nbsp;Attach&nbsp;to&nbsp;edge&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NewY&nbsp;=&nbsp;mParentForm.Top&nbsp;+&nbsp;ToBottomDistance&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mAttachedToBottom&nbsp;=&nbsp;<font color="#000080">True&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">End&nbsp;If&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">Else&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">If&nbsp;</font>Abs(ToBottomDistance)&nbsp;>&nbsp;mSnapDistance&nbsp;<font color="#000080">Then&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">'&nbsp;Break&nbsp;the&nbsp;attachment&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mAttachedToBottom&nbsp;=&nbsp;<font color="#000080">False&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">Else&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">'&nbsp;Stay&nbsp;at&nbsp;current&nbsp;position&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NewY&nbsp;=&nbsp;mParentForm.Top&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">End&nbsp;If&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">End&nbsp;If&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">If&nbsp;Not&nbsp;</font>mAttachedToTop&nbsp;<font color="#000080">Then&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">If&nbsp;</font>Abs(ToTopDistance)&nbsp;<=&nbsp;mSnapDistance&nbsp;<font color="#000080">Then&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NewY&nbsp;=&nbsp;mWorkAreaRect.Top&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mAttachedToTop&nbsp;=&nbsp;<font color="#000080">True&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">End&nbsp;If&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">Else&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">If&nbsp;</font>Abs(ToTopDistance)&nbsp;>&nbsp;mSnapDistance&nbsp;<font color="#000080">Then&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mAttachedToTop&nbsp;=&nbsp;<font color="#000080">False&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">Else&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NewY&nbsp;=&nbsp;mParentForm.Top&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">End&nbsp;If&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">End&nbsp;If&nbsp;</font><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">If&nbsp;Not&nbsp;</font>mAttachedToRight&nbsp;<font color="#000080">Then&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">If&nbsp;</font>Abs(ToRightDistance)&nbsp;<=&nbsp;mSnapDistance&nbsp;<font color="#000080">Then&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NewX&nbsp;=&nbsp;mWorkAreaRect.Right&nbsp;-&nbsp;mParentForm.Width&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mAttachedToRight&nbsp;=&nbsp;<font color="#000080">True&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">End&nbsp;If&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">Else&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">If&nbsp;</font>Abs(ToRightDistance)&nbsp;>&nbsp;mSnapDistance&nbsp;<font color="#000080">Then&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mAttachedToRight&nbsp;=&nbsp;<font color="#000080">False&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">Else&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NewX&nbsp;=&nbsp;mParentForm.Left&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">End&nbsp;If&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">End&nbsp;If&nbsp;</font><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">If&nbsp;Not&nbsp;</font>mAttachedToLeft&nbsp;<font color="#000080">Then&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">If&nbsp;</font>Abs(ToLeftDistance)&nbsp;<=&nbsp;mSnapDistance&nbsp;<font color="#000080">Then&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NewX&nbsp;=&nbsp;mWorkAreaRect.Left&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mAttachedToLeft&nbsp;=&nbsp;<font color="#000080">True&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">End&nbsp;If&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">Else&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">If&nbsp;</font>Abs(ToLeftDistance)&nbsp;>&nbsp;mSnapDistance&nbsp;<font color="#000080">Then&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mAttachedToLeft&nbsp;=&nbsp;<font color="#000080">False&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">Else&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NewX&nbsp;=&nbsp;mParentForm.Left&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">End&nbsp;If&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">End&nbsp;If&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">'&nbsp;Position&nbsp;the&nbsp;window,&nbsp;converting&nbsp;to&nbsp;pixels&nbsp;again&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;SetWindowPos&nbsp;mParentForm.hwnd,&nbsp;mWindowStyle,&nbsp;_&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NewX&nbsp;/&nbsp;Screen.TwipsPerPixelX,&nbsp;_&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NewY&nbsp;/&nbsp;Screen.TwipsPerPixelY,&nbsp;_&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mParentForm.Width&nbsp;/&nbsp;Screen.TwipsPerPixelX,&nbsp;_&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mParentForm.Height&nbsp;/&nbsp;Screen.TwipsPerPixelY,&nbsp;0&nbsp;<br>
&nbsp;<br>
<font color="#000080">End&nbsp;Sub&nbsp;</font><br>
&nbsp;<br>
<font color="#000080">Public&nbsp;Property&nbsp;Set&nbsp;</font>ParentForm(vData&nbsp;<font color="#000080">As&nbsp;</font>Form)&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">Set&nbsp;</font>mParentForm&nbsp;=&nbsp;vData&nbsp;<br>
<font color="#000080">End&nbsp;Property&nbsp;</font><br>
&nbsp;<br>
<font color="#000080">Public&nbsp;Property&nbsp;Get&nbsp;</font>ParentForm()&nbsp;<font color="#000080">As&nbsp;</font>Form&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">Set&nbsp;</font>ParentForm&nbsp;=&nbsp;mParentForm&nbsp;<br>
<font color="#000080">End&nbsp;Property&nbsp;</font><br>
&nbsp;<br>
<font color="#008000">'&nbsp;This&nbsp;is&nbsp;just&nbsp;a&nbsp;small&nbsp;bonus,&nbsp;since&nbsp;you&nbsp;may&nbsp;</font><br>
<font color="#008000">'&nbsp;want&nbsp;your&nbsp;form&nbsp;to&nbsp;be&nbsp;a&nbsp;sticky&nbsp;one.&nbsp;</font><br>
<font color="#000080">Public&nbsp;Property&nbsp;Let&nbsp;</font>AlwaysOnTop(vData&nbsp;<font color="#000080">As&nbsp;Boolean</font>)&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;mAlwaysOnTop&nbsp;=&nbsp;vData&nbsp;<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">'&nbsp;Change&nbsp;the&nbsp;window&nbsp;style&nbsp;and&nbsp;update&nbsp;the&nbsp;window&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">If&nbsp;</font>mAlwaysOnTop&nbsp;<font color="#000080">Then&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mWindowStyle&nbsp;=&nbsp;HWND_TOPMOST&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">Else&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mWindowStyle&nbsp;=&nbsp;HWND_NOTOPMOST&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">End&nbsp;If&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">If&nbsp;Not&nbsp;</font>ParentForm&nbsp;<font color="#000080">Is&nbsp;Nothing&nbsp;Then&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SetWindowPos&nbsp;mParentForm.hwnd,&nbsp;mWindowStyle,&nbsp;_&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mParentForm.Left&nbsp;/&nbsp;Screen.TwipsPerPixelX,&nbsp;_&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mParentForm.Top&nbsp;/&nbsp;Screen.TwipsPerPixelY,&nbsp;_&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mParentForm.Width&nbsp;/&nbsp;Screen.TwipsPerPixelX,&nbsp;_&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mParentForm.Height&nbsp;/&nbsp;Screen.TwipsPerPixelY,&nbsp;0&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000080">End&nbsp;If&nbsp;</font><br>
&nbsp;<br>
<font color="#000080">End&nbsp;Property&nbsp;</font><br>
&nbsp;<br>
<font color="#000080">Public&nbsp;Property&nbsp;Get&nbsp;</font>AlwaysOnTop()&nbsp;<font color="#000080">As&nbsp;Boolean&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;AlwaysOnTop&nbsp;=&nbsp;mAlwaysOnTop&nbsp;<br>
<font color="#000080">End&nbsp;Property&nbsp;</font><br>
&nbsp;<br>
<font color="#000080">Public&nbsp;Property&nbsp;Let&nbsp;</font>SnapDistance(vData&nbsp;<font color="#000080">As&nbsp;Long</font>)&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;mSnapDistance&nbsp;=&nbsp;vData&nbsp;<br>
<font color="#000080">End&nbsp;Property&nbsp;</font><br>
&nbsp;<br>
<font color="#000080">Public&nbsp;Property&nbsp;Get&nbsp;</font>SnapDistance()&nbsp;<font color="#000080">As&nbsp;Long&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;SnapDistance&nbsp;=&nbsp;mSnapDistance&nbsp;<br>
<font color="#000080">End&nbsp;Property&nbsp;</font><br>
&nbsp;<br>
<font color="#000080">Private&nbsp;Sub&nbsp;</font>Class_Initialize()&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">'&nbsp;Default&nbsp;window&nbsp;style&nbsp;is&nbsp;normal&nbsp;window&nbsp;(not&nbsp;always&nbsp;on&nbsp;top)&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;mWindowStyle&nbsp;=&nbsp;HWND_NOTOPMOST&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">'&nbsp;Default&nbsp;snap&nbsp;distance&nbsp;is&nbsp;10&nbsp;pixels&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;mSnapDistance&nbsp;=&nbsp;10&nbsp;*&nbsp;Screen.TwipsPerPixelX&nbsp;<br>
&nbsp;<br>
<font color="#000080">End&nbsp;Sub&nbsp;</font><br>
&nbsp;<br>
      </p>
    </td>
  </tr>
</table>
        <p>OK on the MouseMove private function of the Form, add the following 
        code</p>
          <table border='0' width='80%' bgcolor='#F8F8F8' cellspacing='0' cellpadding='2'>
  <tr>
    <td width='100%'>
      <p class='code'><font color="#000080">If&nbsp;</font>Button&nbsp;=&nbsp;vbLeftButton&nbsp;<font color="#000080">Then&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;
DockHandler.UpdateDockDrag&nbsp;x,&nbsp;y&nbsp;<br>
<font color="#000080">End&nbsp;If&nbsp;</font><br>
&nbsp;<br>
      </p>
    </td>
  </tr>
</table>
        <p>What the code here simply is to check if the left button is clicked. 
        If so, it will update the position to the class member function &quot;UpdateDockDrag&quot;. 
        The position is used to measure the proximity to the edge of the screen 
        and if snapping action is necessary. Simple enough.</p>
        <p>In the MouseDown, the code is straight forward. Check if the left 
        mouse is click. If so, pass the position to the member function &quot;StartDockDrag&quot;.</p>
          <table border='0' width='80%' bgcolor='#F8F8F8' cellspacing='0' cellpadding='2'>
  <tr>
    <td width='100%'>
      <p class='code'><font color="#000080">If&nbsp;</font>Button&nbsp;=&nbsp;vbLeftButton&nbsp;<font color="#000080">Then&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">'&nbsp;OK&nbsp;-&nbsp;Here&nbsp;we&nbsp;go.&nbsp;We&nbsp;pass&nbsp;the&nbsp;cursor&nbsp;coordinates&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">'&nbsp;at&nbsp;the&nbsp;start&nbsp;of&nbsp;the&nbsp;drag&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DockHandler.StartDockDrag&nbsp;x,&nbsp;y&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
<font color="#000080">End&nbsp;If&nbsp;</font><br>
&nbsp;<br>
      </p>
    </td>
  </tr>
</table>
        <p>In another module add the following code:</p>
          <table border='0' width='80%' bgcolor='#F8F8F8' cellspacing='0' cellpadding='2'>
  <tr>
    <td width='100%'>
      <p class='code'><font color="#000080">Option&nbsp;Explicit&nbsp;</font><br>
&nbsp;<br>
<font color="#000080">Public&nbsp;Type&nbsp;</font>RECT&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Left&nbsp;<font color="#000080">As&nbsp;Long&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Top&nbsp;<font color="#000080">As&nbsp;Long&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Right&nbsp;<font color="#000080">As&nbsp;Long&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Bottom&nbsp;<font color="#000080">As&nbsp;Long&nbsp;</font><br>
<font color="#000080">End&nbsp;Type&nbsp;</font><br>
&nbsp;<br>
<font color="#000080">Public&nbsp;Const&nbsp;</font>HWND_TOPMOST&nbsp;=&nbsp;-1&nbsp;<br>
<font color="#000080">Public&nbsp;Const&nbsp;</font>HWND_NOTOPMOST&nbsp;=&nbsp;-2&nbsp;<br>
<font color="#000080">Public&nbsp;Const&nbsp;</font>SPI_GETWORKAREA&nbsp;=&nbsp;48&nbsp;<br>
&nbsp;<br>
<font color="#000080">Public&nbsp;Declare&nbsp;Function&nbsp;</font>SetWindowPos&nbsp;<font color="#000080">Lib&nbsp;<font color="#808080">"user32"</font></font>&nbsp;(<font color="#000080">ByVal&nbsp;</font>hwnd&nbsp;<font color="#000080">As&nbsp;Long</font>,&nbsp;<font color="#000080">_<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ByVal&nbsp;</font>hWndInsertAfter&nbsp;<font color="#000080">As&nbsp;Long</font>,&nbsp;<font color="#000080">ByVal&nbsp;</font>x&nbsp;<font color="#000080">As&nbsp;Long</font>,&nbsp;<font color="#000080">ByVal&nbsp;</font>y&nbsp;<font color="#000080">As&nbsp;Long</font>,&nbsp;<font color="#000080">_<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ByVal&nbsp;</font>cx&nbsp;<font color="#000080">As&nbsp;Long</font>,&nbsp;<font color="#000080">ByVal&nbsp;</font>cy&nbsp;<font color="#000080">As&nbsp;Long</font>,&nbsp;<font color="#000080">ByVal&nbsp;</font>wFlags&nbsp;<font color="#000080">As&nbsp;Long</font>)&nbsp;<font color="#000080">As&nbsp;Long&nbsp;</font><br>
<font color="#000080">Public&nbsp;Declare&nbsp;Function&nbsp;</font>SystemParametersInfo&nbsp;<font color="#000080">Lib&nbsp;<font color="#808080">"user32"</font></font>&nbsp;<font color="#000080">Alias&nbsp;<font color="#808080">"SystemParametersInfoA"</font></font>&nbsp;_<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (<font color="#000080">ByVal&nbsp;</font>uAction&nbsp;<font color="#000080">As&nbsp;Long</font>,&nbsp;<font color="#000080">ByVal&nbsp;</font>uParam&nbsp;<font color="#000080">As&nbsp;Long</font>,&nbsp;<font color="#000080">_<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ByRef&nbsp;</font>lpvParam&nbsp;<font color="#000080">As&nbsp;Any</font>,&nbsp;<font color="#000080">ByVal&nbsp;</font>fuWinIni&nbsp;<font color="#000080">As&nbsp;Long</font>)&nbsp;<font color="#000080">As&nbsp;Long&nbsp;</font><br>
&nbsp;<br>
      </p>
    </td>
  </tr>
</table>
        <p>The need for another module is to declare API functions and to define 
        a structure.</p>
        <p>Now make sure to create an instance of the class in your program like 
        Form Load and use the class functions:</p>
          <table border='0' width='80%' bgcolor='#F8F8F8' cellspacing='0' cellpadding='2'>
  <tr>
    <td width='100%'>
      <p class='code'><font color="#000080">Dim&nbsp;</font>DockHandler&nbsp;<font color="#000080">As&nbsp;New&nbsp;</font>clsDockingHandler&nbsp;<br>
      </p>
    </td>
  </tr>
</table>
        <p>When your form loads, initialize the following:</p>
          <table border='0' width='80%' bgcolor='#F8F8F8' cellspacing='0' cellpadding='2'>
  <tr>
    <td width='100%'>
      <p class='code'><font color="#000080">Set&nbsp;</font>DockHandler.ParentForm&nbsp;=&nbsp;Me&nbsp;<br>
      DockHandler.SnapDistance&nbsp;=&nbsp;250&nbsp;<br>
      </p>
    </td>
  </tr>
</table>
        <p>In essence that’s the gist of developing this feature.</p>
        </blockquote>
        <p class="ArticleH2">Program Taskbar alert</p>
        <blockquote>
        <p>OK, I hope you are still good to go for the next one. I put the code 
        intense ones in the front so you have energy for the next one.</p>
        <p>This taskbar alert is pretty easy. This behavior is best exemplified 
        by the Office suite software. Its use to notify the user of an event, 
        such as a task is over or some notification is needed without 
        interrupting what the user is doing.</p>
        <p>You will need in use an API function:</p>
          <table border='0' width='80%' bgcolor='#F8F8F8' cellspacing='0' cellpadding='2'>
  <tr>
    <td width='100%'>
      <p class='code'><font color="#000080">Public&nbsp;Declare&nbsp;Function&nbsp;</font>FlashWindow&nbsp;<font color="#000080">Lib&nbsp;<font color="#808080">"user32"</font></font>&nbsp;(<font color="#000080">ByVal&nbsp;</font>hwnd&nbsp;<font color="#000080">As&nbsp;Long</font>,&nbsp;<font color="#000080">_<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ByVal&nbsp;</font>bInvert&nbsp;<font color="#000080">As&nbsp;Long</font>)&nbsp;<font color="#000080">As&nbsp;Long&nbsp;</font><br>
      </p>
    </td>
  </tr>
</table>
        <p>Now when ever you feel you need to notify the user in a non 
        interruptive way, just do this:</p>
          <table border='0' width='80%' bgcolor='#F8F8F8' cellspacing='0' cellpadding='2'>
  <tr>
    <td width='100%'>
      <p class='code'>i&nbsp;=&nbsp;FlashWindow(Form1.hwnd,&nbsp;<font color="#000080">True</font>)&nbsp;<br>
      </p>
    </td>
  </tr>
</table>
        <p>And you will see your program flash in the taskbar, getting attention 
        and making it self known to the user that its better than all the other 
        programs crowding that’s crowding its space.
        <font face="Wingdings" size="2">J</font> “The wheel that squeaks the 
        loudest gets the oil.”</p>
        <p>
        <img width="77" height="72" src="new-st5.gif" v:shapes="_x0000_s1031"><br clear="ALL">
&nbsp;</p>
        </blockquote>
        <p class="ArticleH2">Always stay on Top</p>
        <blockquote>
        <p>Stay on Top, whatever happens &quot;stay on top&quot;.</p>
        <p>Uh Ummm, anyway, its useful to use this code when you want your 
        program to be on the top when its out of focus. If you are displaying 
        some information that needs to be seen or needs to be displayed. This is 
        very useful. Luckily for you, we are inputting the code in the class so 
        this will save you time and reusability .(see illustration)</p>
        <p>When you want to use it, type the code:</p>
          <table border='0' width='80%' bgcolor='#F8F8F8' cellspacing='0' cellpadding='2'>
  <tr>
    <td width='100%'>
      <p class='code'>DockHandler.AlwaysOnTop&nbsp;=&nbsp;<font color="#000080">True&nbsp;</font><br>
      </p>
    </td>
  </tr>
</table>
        <p>You see the sample program stays on top while the focus is on the 
        Visual Basic program.</p>
        <p>
        <img width="509" height="230" src="new-st6.gif" v:shapes="_x0000_s1033"></p>
        <p>I guess you are surprise by brief codes for the last two features. 
        Well, I understand the first one is long and probably the most 
        difficult, that’s why I pushed up front so you would have the energy to 
        understand the hard part and save the easier section last. From my 
        experience, that’s the most effective consumption of energy and 
        enthusiasm in learning the material. Hey by the way, if you need someone 
        to help out in programming a some features of your project or your 
        company’s project, I am available. Just let me know, the MCSD is here to 
        help.</p>
        <p>I hope reading this will help you develop smarter and better 
        programs. If you want to read the later articles, tell your website 
        administrator to demand and syndicate it.</p>
        <p>Happy Programming.... and Happy Safe Holidays</p>
        </blockquote>
        <p class="ArticleH2">About the Author</p>
        <blockquote>
        <p><b>John Yung</b> is a MCSD Visual Basic programmer base in New York. 
        He works for Webadviso Inc and also does consulting work for companies 
        to develop programs in various areas such as ADO, MSXML, Voice 
        Recognition, User interface design and etc. He develops his own search 
        engine website at <a target="_blank" href="http://www.debuting.com/">
        http://www.debuting.com</a>. In his free time, he enjoys taking bike 
        trips, site seeing and watching movies. He can be contacted by email
        <a href="mailto:johntyung@yahoo.com">johntyung@yahoo.com</a> for help 
        and contracting.</p>
        </blockquote>
        <p align="right">&nbsp;</p>
<p>        
    <hr noshade color="#FF9933">
    <table width="90%" align="center" border="0">
      <tr>
        <td width="25%">
          <img border="0" src="../../../images/comments.gif">
        </td>
        <td width="75%">
          Please, post here only feedback for the article/tutorial/sample you
          have read above.<br>
          If you have any question and like to get an answer, post your messages in the <a href="http://www.vbip.com/forum/">Forum</a>.
        <td>
      </tr>
    </table>
    
    
			<p><b><font face="Arial" size="2" color="#800000"><a href="../../../comment.asp?696">Comments...</a></font></b><br>
			<i><font color="#808080" face="Times New Roman" size="2">GreyArea Friday, January 11, 2002</font></i>	
			</p>
			
			<p><b><font face="Arial" size="2" color="#800000"><a href="../../../comment.asp?697">Even better window flashing</a></font></b><br>
			<i><font color="#808080" face="Times New Roman" size="2">Devon Strawn Friday, January 11, 2002</font></i>	
			</p>
			
        <p>
        <form name="newcomm" method="POST" action="../../../add_comments.asp">
          <p><input align="right" border="0" src="../../../images/addyours2.gif" name="I1" type="image"></p>
          <input type="hidden" name="page" value="/miscellaneous/new-standard-gui/new-standard-gui-01.asp">
          <input type="hidden" name="title">
	  <input type="hidden" name="actionID" value="add">
        </form>
        <SCRIPT LANGUAGE="JavaScript">
        	{document.newcomm.title.value = document.title}
        </SCRIPT>
	<br>
        <p>
        <hr noshade color="#FF9933">
</p>   
        </blockquote>
<p><center>
<!-- start BITS ad HTML -- bottom of page 468x60 banner www.bitsonthewire.com         --> 
  <iframe src="http://ads.bitsonthewire.com/admgriframe.asp?siteid=1126&ad_type=2" width=468 height=60 marginwidth=0 marginheight=0 hspace=0 vspace=0 frameborder=0 scrolling=no> 
    <a href="http://ads.bitsonthewire.com/adrdrmanager.asp?loc=2">
      <p>
      <img border="0" src="http://ads.bitsonthewire.com/admanager.asp?loc=2&siteid=1126&ad_type=2">
    </a>
  </iframe> 
<!-- stop BITS ad HTML -- bottom of page 468x60 banner                                --> 
</center></p>
    </td>
</table>
<table border="1" width="100%" cellspacing="1" cellpadding="2" bordercolor="#800000">
  <tr>
    <td width="100%" bgcolor="#FF9933">
      <font color="#FFFFCC">
      <table border="0" width="100%" cellspacing="0" cellpadding="0">
        <tr>
          <td width="37%"></td>
          <td width="63%">
      <font color="#FFFFCC">
            <p align="right" class="tbcaption">
            <a href="../../default.asp" class="tbcaption">Home</a> -
            <a href="../../tools.asp" class="tbcaption">Tools&amp;Technologies</a> 
            - Miscellaneous - Developing with a new standard in UI</font></td>
        </tr>
      </table>
      </font>
    </td>
  </tr>
</table>
&nbsp;<table border="0" width="100%" cellspacing="0" cellpadding="0">
  <tr>
    <td width="121" valign="top">
<!-- START OF WEBTRENDS LIVE TAG -->
<!-- Copyright 2001 NetIQ Corporation -->
<!--  For privacy concerns, check our Privacy Policy at http://www.webtrendslive.com/privacy_policy.htm -->
<SCRIPT LANGUAGE="JavaScript">
<!--
// Modification of this code is not allowed and will permanently disable your account!
// SiteName:  Visual Basic Internet Programming
function wtl_Tag4_27048()
{
	function D8( d)
	{
		var fwd=1, seed= new Date('01/01/2000'), key= "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";
		var s= key.charAt( d.getFullYear()-2000)+key.charAt( d.getMonth()+1)+key.charAt( d.getDate());
		s+= key.charAt( d.getHours())+key.charAt( d.getMinutes())+key.charAt( d.getSeconds());
		while( seed.getDay()!=fwd) seed= new Date(seed.getTime() + 86400000);
		var w= Math.floor( (d.getTime()-(seed.getTime()+86400000)) / 604800000 );
		s+= key.charAt( (w-(w%16))/16 );
		s+= key.charAt( w%16);
		return s;
	}

	var t = new Date();
	var W="tagver=4&si=27048&fw=1&bn=13";
	W+="&tz="+escape(t.getTimezoneOffset());
	W+="&ch="+escape(t.getHours());
	W+="&cl="+escape(D8(t));
	W+="&ti="+escape(document.title);
	W+="&url="+escape(window.document.URL);
	W+="&rf="+escape(window.document.referrer);
	W+="&js=Yes";
	W+="&ul="+(navigator.appName=="Netscape"?navigator.language:navigator.userLanguage);
	if(typeof(screen)=="object")
	{
	W+="&sr="+screen.width+"x"+screen.height;
	W+="&cd="+screen.colorDepth;
	W+="&jo="+(navigator.javaEnabled()?"Yes":"No");
	}
	
	
	document.write('<A TARGET="_blank" HREF="http://www.webtrendslive.com/redirect.asp?siteID=27048">');
	document.write('<IMG ID="WTL_TAG" BORDER="0" WIDTH="100" HEIGHT="30" ALT="This Site Tracked by WebTrendsLive." SRC="http://p.wtlive.com/S003-00-9-14-186109-27048/button4.asp?'+W+'">');
	document.write('</A>');
	
}	

wtl_Tag4_27048();
//-->
</SCRIPT>


<NOSCRIPT>
<A TARGET="_blank" HREF="http://www.webtrendslive.com/redirect.asp?siteID=27048">
<IMG BORDER="0" WIDTH="100" HEIGHT="30" ALT="This Site Tracked by WebTrendsLive." SRC="http://p.wtlive.com/S003-00-9-14-186109-27048/button4.asp?tagver=4&si=27048&fw=1&bn=13&js=No&"></A></NOSCRIPT>


<!-- END OF WEBTRENDS LIVE TAG -->

     
      </td>
    <td>
<p align="center" class="barsidecaption"><a href="../../default.asp">Home</a> | <a href="../../whatsnew.asp">What's
New</a> | <a href="../../tools.asp"> Tools
&amp; Technologies</a> | <a href="../../resources.asp">Resources</a> | <a href="../../resources/books/default.asp">Books</a>
 | <a href="../../forum/">Forum</a></p>
<p align="center" class="barsidecaption">Report about any problems and errors to <a href="mailto:webmaster@vbip.com">webmaster@vbip.com</a><br>
Copyright © 1998 - 2002 by <a href="mailto:oleg@vbip.com"> Oleg Gdalevich</a></p>
    </td>
    <td valign="top" width="140">
<p align="center">
<a target="_blank" href="http://www.amazon.com/exec/obidos/ASIN/B00005AFI2/vbipvisualbasici">
<img border="0" src="../../images/frontpage_button.gif" align="right" width="100" height="38"></a>
    </td>
  </tr>
</table>
</body>

</html>
