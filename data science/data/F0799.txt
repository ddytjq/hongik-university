ID=F0799
URL=http://vbtechniques.com/forum.asp?a=rm&id=897
SIZE=7153
DATE=09/07/2002
TIME=13:26:00
DATASET=Visual Basic
HTML=<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<title>VB Techniques: Visual Basic 6.0 Bible Forum</title>
<style type="text/css" title="Techniques Style Sheet">
<!-- This is the toolbar at the top of the page -->
.headingbar {
	background-color : Black;
	color: White;
}
.headinglink {
	color : White;
	text-decoration : none;
	font-family : Tahoma, Arial, sans-serif;
	font-size : 8pt;
}

<!-- All standard text in the page gets this style -->
.text {
	color: Black;
	font-family: Tahoma, Arial, sans-serif;
	font-size: 10pt;
}

.text_grayed {
	color: Silver;
	font-family: Tahoma, Arial, sans-serif;
	font-size: 10pt;
}

.text_error {
	color: Red;
	font-family: Tahoma, Arial, sans-serif;
	font-size: 10pt;
}

<!-- The title on the page uses this style -->
.pageheading {
	color: #000080;
	font-family: Verdana, Arial, sans-serif;
	font-size: 16pt;
	font-weight: bold;
	
}
.subheading {
	color: #000080;
	font-family: Verdana, Arial, sans-serif;
	font-size: 12pt;
	font-weight: bold;
}
.copyright
{
    COLOR: #000000;
    TEXT-ALIGN: left;
    FONT-FAMILY: Tahoma, Arial, sans-serif;
    FONT-SIZE: 8pt
}

<!-- Prompts and boxes in forms use this style -->
.form {
	font-family: Arial, sans-serif;
	font-size: 8pt;
}
.tableheading {
	font-family: Arial, sans-serif;
	font-size: 8pt;
	color: white;
	background-color: #000080;
	text-align : center;
}
.table {
	font-family: Arial, sans-serif;
	font-size: 8pt;
	background-color: White;
}
.tableshaded {
	font-family: Arial, sans-serif;
	font-size: 8pt;
	background-color: Silver;
}
.tabletoday {
	font-family: Arial, sans-serif;
	font-size: 8pt;
	background-color: Silver;
}
PRE {
   padding-top: 10px;
   padding-bottom: 10px;
   padding-left: 10px;
   background-color: #EEEEEE;
}

</style>
<script language="JavaScript">
function onLink(L)
{
	if (L.style.color = 'White')
	{
	   L.style.color = 'Yellow';
		L.style.textDecoration = "underline";
	}
}
function offLink(L)
{
	if (L.style.color = 'Yellow')
	{
		L.style.color = 'White';
		L.style.textDecoration = "none";
	}
		
}
</script>
</head>
<body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" bgcolor="#FFFFFF">
<table width=100% cellspacing=0 cellpadding=4 border=0>
<tr><td width="250" background="/images/stripe_vb.gif"><img src="/images/logo_vb.gif" valign="middle" width=250 height=80 border=0></td><td width="100%" background="/images/stripe_vb.gif"><a href="http://click.linksynergy.com/fs-bin/stat?id=0DYcYQoW7OM&subid=0"><IMG alt=icon border=0 hspace=50 vspace=10  width=468 height=60 src="http://ad.linksynergy.com/fs-bin/show?id=0DYcYQoW7OM&bids=+22117.10000191+22117.10000192+22117.10000196+27778+29496+29744+31083&gridnum=1&subid=0"></a></td></tr>
<tr><td colspan=2 class=headingbar bgcolor="#000000##"><span class=headinglink>
<a href="default.asp"><span class="headinglink" onmouseover="onLink(this);" onmouseout="offLink(this);">Home</span></a>
&nbsp;&#8226;&nbsp;
<a href="search.asp"><span class="headinglink" onmouseover="onLink(this);" onmouseout="offLink(this);">Search</span></a>
&nbsp;&#8226;&nbsp;
<a href="forum.asp"><span class="headinglink" onmouseover="onLink(this);" onmouseout="offLink(this);">Forums</span></a>
&nbsp;&#8226;&nbsp;
<a href="content.asp?a=se&sID=5"><span class="headinglink" onmouseover="onLink(this);" onmouseout="offLink(this);">Articles</span></a>
&nbsp;&#8226;&nbsp;
<a href="content.asp?a=se&sID=8"><span class="headinglink" onmouseover="onLink(this);" onmouseout="offLink(this);">Interviews</span></a>
&nbsp;&#8226;&nbsp;
<a href="content.asp?a=se&sID=9"><span class="headinglink" onmouseover="onLink(this);" onmouseout="offLink(this);">Links</span></a>
&nbsp;&#8226;&nbsp;
<a href="content.asp?a=se&sID=6"><span class="headinglink" onmouseover="onLink(this);" onmouseout="offLink(this);">Reviews</span></a>
&nbsp;&#8226;&nbsp;
<a href="content.asp?a=se&sID=28"><span class="headinglink" onmouseover="onLink(this);" onmouseout="offLink(this);">Tip Archive</span></a>
&nbsp;&#8226;&nbsp;
<a href="content.asp?a=se&sID=34"><span class="headinglink" onmouseover="onLink(this);" onmouseout="offLink(this);">VB 6.0 Toolkit</span></a>
&nbsp;&#8226;&nbsp;
<a href="content.asp?a=se&sID=7"><span class="headinglink" onmouseover="onLink(this);" onmouseout="offLink(this);">Visual Basic 6.0 Bible</span></a>
&nbsp;&#8226;&nbsp;
<a href="about.asp"><span class="headinglink" onmouseover="onLink(this);" onmouseout="offLink(this);">About</span></a>
</td></tr>
<tr><td colspan=2 valign=top width="800">
<p class="pageheading">View Messages in Thread</p>
<table cellpadding=3 cellspacing=0 border=0 width=600>
<tr class=tableshaded><td class=tableshaded>Subject:</td>
<td class=tableshaded>A doubt in datagrid</td></tr>
<tr class=tableshaded><td class=tableshaded>Author:</td>
<td class=tableshaded><a href="mailto:writetokarthi@yahoo.com">Karthikeyan</a></td></tr>
<tr class=tableshaded><td class=tableshaded>Date:</td><td class=tableshaded>3/28/2002 6:12:12 AM</td></tr>
<tr class=table><td colspan=2 class=table><p>I want to drop down a combo box containing many items when I click a cell on the datagrid.<br>   How do I do this?<br>   Please mail me at writetokarthi@yahoo.com</p>
</td></tr>
<tr class=table><td colspan=2 class=table><p><b>Actions:</b> 
<a href="/forum.asp?a=po&fid=6">Post New Message</a>&nbsp;|&nbsp;
<a href="/forum.asp?a=re&id=897&fid=6">Post Reply</a></td></tr>
<tr><td colspan=2>&nbsp;&nbsp;</td></tr>
<tr class=tableshaded><td class=tableshaded>Subject:</td>
<td class=tableshaded>Re: A doubt in datagrid</td></tr>
<tr class=tableshaded><td class=tableshaded>Author:</td>
<td class=tableshaded><a href="mailto:asu37@hotmail.com">Sean</a></td></tr>
<tr class=tableshaded><td class=tableshaded>Date:</td><td class=tableshaded>6/21/2002 2:03:18 AM</td></tr>
<tr class=table><td colspan=2 class=table><p>Using the ComboBox control as a repository for the contents of the lookup table isn't a casual decision. In fact, with some wizardry we can even use the ComboBox to let the user select a new value for the SupplierID field. All we have to do is make the ComboBox control appear in front of the DataGrid control, exactly over the cell edited by the user, and then update the underlying SupplierID field when the user selects a new value from the list. For the best visual effect, you also need to trap a few events so that the ComboBox is always in the correct position, as in Figure 15-4. Here's the code that does the trick:<br><br>Private Sub MoveCombo()<br>    ' In case of error, hide the ComboBox.<br>    On Error GoTo Error_Handler<br>    Dim gcol As MSDataGridLib.Column<br>    Set gcol = DataGrid1.Columns(DataGrid1.col)<br>    <br>    If gcol.Caption = &quot;SupplierID&quot; And DataGrid1.CurrentCellVisible Then<br>        ' Move the ComboBox inside the SupplierID column<br>        ' if it is the current column and it is visible.<br>        cboSuppliers.Move DataGrid1.Left + gcol.Left, _<br>            DataGrid1.Top + DataGrid1.RowTop(DataGrid1.row), gcol.Width<br>        cboSuppliers.ZOrder<br>        cboSuppliers.SetFocus<br>        cboSuppliers.Text = gcol.Text<br>        Exit Sub<br>    End If<br>Error_Handler:<br>    ' In all other cases, hide the ComboBox.<br>    cboSuppliers.Move _10000<br>    If DataGrid1.Visible Then DataGrid1.SetFocus<br>End Sub<br><br>Private Sub cboSuppliers_Click()<br>    ' Change the value of the underlying grid cell.<br>    DataGrid1.Columns(&quot;SupplierID&quot;).Value = _<br>        cboSuppliers.ItemData(cboSuppliers.ListIndex)<br>End Sub<br><br>Private Sub DataGrid1_RowColChange(LastRow As Variant, _<br>    ByVal LastCol As Integer)<br>    MoveCombo<br>End Sub<br><br>Private Sub DataGrid1_RowResize(Cancel As Integer)<br>    MoveCombo<br>End Sub<br><br>Private Sub DataGrid1_ColResize(ByVal ColIndex As Integer, _<br>    Cancel As Integer)<br>    MoveCombo<br>End Sub<br><br>Private Sub DataGrid1_Scroll(Cancel As Integer)<br>    MoveCombo<br>End Sub<br><br>Private Sub DataGrid1_SplitChange()<br>    MoveCombo<br>End Sub<br><br> <br><br><br>This code requires that the DataGrid control's RowHeight property match the ComboBox's Height property. Because the latter is read-only at run time, execute the following statement in the Form_Load event procedure:<br><br>' Have the row height match the ComboBox's height.<br>DataGrid1.RowHeight = cboSuppliers.Height<br><br> <br><br></p>
</td></tr>
<tr class=table><td colspan=2 class=table><p><b>Actions:</b> 
<a href="/forum.asp?a=po&fid=6">Post New Message</a>&nbsp;|&nbsp;
<a href="/forum.asp?a=re&id=962&fid=6">Post Reply</a></td></tr>
<tr><td colspan=2>&nbsp;&nbsp;</td></tr>
</table>
<p class=text><a href="/forum.asp?a=ram&id=6">Return to Forum</a></p>
</td></tr></table>
<table width="100%" cellpadding=4><tr><td>
<br><br><br><hr noshade>
<span class=copyright>
Copyright &copy; 2002 by Northstar Computer Systems.<br>
Contact the <a href="mailto:editor@vbtechniques.com">webmaster</a> with any comments, questions or problems with the site.</span>
</td></tr></table>
</body></html>

