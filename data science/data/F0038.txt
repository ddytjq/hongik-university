ID=F0038
URL=http://www.visualbasicbooks.com/begvbsqlsample/30640602.htm
SIZE=67205
DATE=09/07/2002
TIME=13:12:51
DATASET=Visual Basic
HTML=<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="filelist.xml">
<link rel=Edit-Time-Data href="editdata.mso">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->
<title>Visual Basic SQL Server 7.0</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Joy Armitage</o:Author>
  <o:Template>Normal</o:Template>
  <o:LastAuthor>Joy Armitage</o:LastAuthor>
  <o:Revision>2</o:Revision>
  <o:TotalTime>1</o:TotalTime>
  <o:Created>2000-03-29T08:51:00Z</o:Created>
  <o:LastSaved>2000-03-29T08:51:00Z</o:LastSaved>
  <o:Pages>12</o:Pages>
  <o:Words>2224</o:Words>
  <o:Characters>12682</o:Characters>
  <o:Company>Wrox Press Ltd</o:Company>
  <o:Lines>105</o:Lines>
  <o:Paragraphs>25</o:Paragraphs>
  <o:CharactersWithSpaces>15574</o:CharactersWithSpaces>
  <o:Version>9.2720</o:Version>
 </o:DocumentProperties>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
@font-face
	{font-family:Times;
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:Helvetica;
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:Courier;
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:modern;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:Palatino;
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:"ITC Franklin Gothic Book";
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:FrGothHeavy;
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-alt:"Arial Narrow";
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:FranklinGothic;
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:ZapfDingbats;
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:decorative;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:Arial;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
h1
	{mso-style-parent:"";
	mso-style-next:Normal;
	margin-top:22.0pt;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:1;
	font-size:19.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"ITC Franklin Gothic Book";
	color:black;
	mso-font-kerning:14.0pt;
	mso-bidi-font-weight:normal;}
h2
	{mso-style-parent:"";
	mso-style-next:Normal;
	margin-top:14.0pt;
	margin-right:0in;
	margin-bottom:8.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:2;
	font-size:16.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"ITC Franklin Gothic Book";
	color:black;
	mso-bidi-font-weight:normal;}
h3
	{mso-style-parent:"";
	mso-style-next:Normal;
	margin-top:11.0pt;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:3;
	font-size:13.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"ITC Franklin Gothic Book";
	mso-bidi-font-weight:normal;
	font-style:italic;
	mso-bidi-font-style:normal;}
h5
	{mso-style-parent:"";
	mso-style-next:Normal;
	margin-top:11.0pt;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	mso-outline-level:5;
	background:black;
	mso-shading:windowtext;
	mso-pattern:solid auto;
	border:none;
	mso-border-alt:solid black 2.25pt;
	padding:0in;
	mso-padding-alt:1.0pt 1.0pt 1.0pt 1.0pt;
	font-size:10.0pt;
	font-family:"ITC Franklin Gothic Book";
	mso-bidi-font-weight:normal;}
p.MsoIndex1, li.MsoIndex1, div.MsoIndex1
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:12.0pt;
	margin-bottom:.0001pt;
	text-indent:-12.0pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:Arial;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
span.MsoCommentReference
	{mso-ansi-font-size:8.0pt;
	mso-bidi-font-size:8.0pt;}
p.ChapterNumber, li.ChapterNumber, div.ChapterNumber
	{mso-style-name:"Chapter Number";
	mso-style-update:auto;
	mso-style-parent:"Chapter Title";
	margin-top:40.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:380.15pt;
	margin-bottom:.0001pt;
	text-align:center;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	font-size:48.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:FrGothHeavy;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	color:black;
	mso-font-kerning:14.0pt;}
p.ChapterTitle, li.ChapterTitle, div.ChapterTitle
	{mso-style-name:"Chapter Title";
	mso-style-update:auto;
	mso-style-parent:"";
	margin-top:40.0pt;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	text-align:center;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	font-size:26.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:FrGothHeavy;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	color:black;
	mso-font-kerning:14.0pt;}
span.ImportantWords
	{mso-style-name:"Important Words";
	mso-style-parent:"";
	mso-ansi-font-size:9.0pt;
	mso-ascii-font-family:Times;
	mso-hansi-font-family:Times;
	color:black;
	letter-spacing:.2pt;
	font-weight:bold;}
p.Bullet, li.Bullet, div.Bullet
	{mso-style-name:Bullet;
	mso-style-update:auto;
	mso-style-parent:"";
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:46.2pt;
	text-indent:-17.85pt;
	mso-pagination:widow-orphan;
	mso-list:l5 level1 lfo8;
	mso-hyphenate:none;
	tab-stops:list 46.35pt;
	font-size:9.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:Palatino;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	letter-spacing:.2pt;}
span.CodeinText
	{mso-style-name:"Code in Text";
	mso-style-parent:"";
	mso-ansi-font-size:9.0pt;
	mso-ascii-font-family:Courier;
	mso-hansi-font-family:Courier;
	color:black;
	letter-spacing:.2pt;}
p.CodeForeground, li.CodeForeground, div.CodeForeground
	{mso-style-name:"Code Foreground";
	mso-style-update:auto;
	mso-style-parent:"";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:17.3pt;
	margin-bottom:.0001pt;
	line-height:10.0pt;
	mso-pagination:widow-orphan;
	mso-hyphenate:none;
	tab-stops:56.9pt 84.95pt 141.85pt 169.9pt;
	background:#F2F2F2;
	mso-shading:windowtext;
	mso-pattern:gray-5 auto;
	font-size:8.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:Courier;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	color:black;
	mso-font-kerning:72.0pt;}
p.Background, li.Background, div.Background
	{mso-style-name:Background;
	mso-style-update:auto;
	mso-style-parent:"";
	margin-top:6.0pt;
	margin-right:33.85pt;
	margin-bottom:6.0pt;
	margin-left:33.85pt;
	mso-pagination:widow-orphan;
	mso-hyphenate:none;
	font-size:9.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:Palatino;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	color:black;
	letter-spacing:.2pt;
	mso-font-kerning:72.0pt;
	font-style:italic;
	mso-bidi-font-style:normal;}
span.Screentext
	{mso-style-name:Screentext;
	mso-style-parent:"";
	mso-ansi-font-size:9.0pt;
	mso-ascii-font-family:Helvetica;
	mso-hansi-font-family:Helvetica;
	letter-spacing:.2pt;}
p.NumberedBulletsUSETHIS, li.NumberedBulletsUSETHIS, div.NumberedBulletsUSETHIS
	{mso-style-name:"Numbered Bullets USE THIS";
	mso-style-update:auto;
	mso-style-parent:"";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:51.05pt;
	text-indent:-22.7pt;
	mso-pagination:widow-orphan;
	mso-list:l6 level1 lfo9;
	tab-stops:0in 28.35pt list 51.05pt;
	font-size:9.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:Palatino;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	letter-spacing:.2pt;}
p.NumberedBulletsnonumber, li.NumberedBulletsnonumber, div.NumberedBulletsnonumber
	{mso-style-name:"Numbered Bullets \(no number\)";
	mso-style-update:auto;
	mso-style-parent:"";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:51.05pt;
	mso-pagination:widow-orphan;
	tab-stops:0in 28.35pt;
	font-size:9.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:Palatino;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	letter-spacing:.2pt;}
p.LayoutNotes, li.LayoutNotes, div.LayoutNotes
	{mso-style-name:"Layout Notes";
	mso-style-update:auto;
	margin-top:0in;
	margin-right:-5.65pt;
	margin-bottom:0in;
	margin-left:28.1pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	mso-hyphenate:none;
	font-size:11.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:Palatino;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	color:red;
	letter-spacing:.2pt;
	font-style:italic;
	mso-bidi-font-style:normal;}
span.msoIns
	{mso-style-type:export-only;
	mso-style-name:"";
	text-decoration:underline;
	text-underline:single;
	color:teal;}
span.msoDel
	{mso-style-type:export-only;
	mso-style-name:"";
	text-decoration:line-through;
	color:red;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
 /* List Definitions */
@list l0
	{mso-list-id:-132;
	mso-list-type:simple;
	mso-list-template-ids:-1237918082;}
@list l0:level1
	{mso-level-tab-stop:74.6pt;
	mso-level-number-position:left;
	margin-left:74.6pt;
	text-indent:-.25in;}
@list l1
	{mso-list-id:-131;
	mso-list-type:simple;
	mso-list-template-ids:-84222848;}
@list l1:level1
	{mso-level-tab-stop:60.45pt;
	mso-level-number-position:left;
	margin-left:60.45pt;
	text-indent:-.25in;}
@list l2
	{mso-list-id:-130;
	mso-list-type:simple;
	mso-list-template-ids:-2114795724;}
@list l2:level1
	{mso-level-tab-stop:46.3pt;
	mso-level-number-position:left;
	margin-left:46.3pt;
	text-indent:-.25in;}
@list l3
	{mso-list-id:234583780;
	mso-list-type:simple;
	mso-list-template-ids:-1763806554;}
@list l3:level1
	{mso-level-tab-stop:51.05pt;
	mso-level-number-position:left;
	margin-left:51.05pt;
	text-indent:-22.7pt;
	mso-ansi-font-size:11.0pt;
	font-family:FranklinGothic;
	mso-ansi-font-weight:bold;
	mso-ansi-font-style:normal;}
@list l4
	{mso-list-id:274095209;
	mso-list-type:simple;
	mso-list-template-ids:-1455633370;}
@list l4:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F071;
	mso-level-tab-stop:70.9pt;
	mso-level-number-position:left;
	margin-left:70.9pt;
	text-indent:-32.65pt;
	mso-ansi-font-size:8.0pt;
	font-family:Wingdings;}
@list l5
	{mso-list-id:1148518419;
	mso-list-type:simple;
	mso-list-template-ids:-1362331118;}
@list l5:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F071;
	mso-level-tab-stop:46.35pt;
	mso-level-number-position:left;
	margin-left:46.2pt;
	text-indent:-17.85pt;
	mso-ansi-font-size:8.0pt;
	font-family:ZapfDingbats;}
@list l6
	{mso-list-id:1231842714;
	mso-list-type:simple;
	mso-list-template-ids:-1264430030;}
@list l6:level1
	{mso-level-tab-stop:51.05pt;
	mso-level-number-position:left;
	margin-left:51.05pt;
	text-indent:-22.7pt;
	mso-ansi-font-size:11.0pt;
	font-family:"ITC Franklin Gothic Book";
	mso-ansi-font-weight:bold;
	mso-ansi-font-style:normal;}
@list l7
	{mso-list-id:1673868784;
	mso-list-type:simple;
	mso-list-template-ids:242933782;}
@list l7:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F071;
	mso-level-tab-stop:46.35pt;
	mso-level-number-position:left;
	margin-left:46.2pt;
	text-indent:-17.85pt;
	mso-ansi-font-size:8.0pt;
	font-family:Wingdings;}
ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>
</head>

<body bgcolor="#6373B5" text="#000000" link="0000ff" vlink="#666666" alink="#CC9900" lang=EN-US style='tab-interval:.5in'>


<center>
<!-- BEGIN RICH-MEDIA BURST! CODE --> 
       <script language="JavaScript"> 
       <!-- /* © 1997-1999 BURST! Media, LLC. All Rights Reserved.*/ 
       var TheAdcode = 'ad5645a'; 
       var bN = navigator.appName; 
       var bV = parseInt(navigator.appVersion); 
       var base='http://www.burstnet.com/'; 
       var Tv=''; 
       var agt=navigator.userAgent.toLowerCase(); 
       if (bV>=4) 
         {ts=window.location.pathname+window.location.search; 
          i=0; Tv=0; while (i< ts.length) 
             { Tv=Tv+ts.charCodeAt(i); i=i+1; } Tv="/"+Tv;} 
         else   {Tv=escape(window.location.pathname); 
          if( Tv.charAt(0)!='/' ) Tv="/"+Tv; 
                 else if (Tv.charAt(1)=="/")
       Tv=""; 
         if( Tv.charAt(Tv.length-1) == "/") 
           Tv = Tv + "_";} 
       if (bN=='Netscape'){ 
            if ((bV>=4)&&(agt.indexOf("mac")==-1))
       {  document.write('<s'+'cript src="'+ 
             base+'cgi-bin/ads/'+TheAdcode+'.cgi/RETURN-CODE/JS' 
             +Tv+'">'); 
            document.write('</'+'script>');    
       } 
            else if (bV>=3) {document.write('<'+'a href="'+base+'ads/'+ 
               TheAdcode+'-map.cgi'+Tv+'"target=_top>'); 
               document.write('<img src="' + base + 'cgi-bin/ads/' + 
               TheAdcode + '.cgi' + Tv + '" ismap width=468 height=60' + 
               ' border=0 alt="Click Here"></a>');} 
        } 
       if (bN=='Microsoft Internet Explorer') 
        document.write('<ifr'+'ame id=BURST src="'+base+'cgi-bin/ads/'
       + 
         TheAdcode + '.cgi' + Tv + '/RETURN-CODE" width=468 height=60' + 
         'marginwidth=0 marginheight=0 hspace=0 vspace=0 ' + 
         'frameborder=0 scrolling=no></ifr'+'ame>'); 
       // --> 
       </script> 
       <noscript><a href="http://www.burstnet.com/ads/ad5645a-map.cgi" target=_top> 
       <img src="http://www.burstnet.com/cgi-bin/ads/ad5645a.cgi" 
        width=468 height=60 border=0 alt="Click Here"></a> 
       </noscript> 
       <!-- END BURST CODE --> 
</center>
<table border="0" bgcolor="" cellpadding="0" cellspacing="0">
<tr><td><p align="center"><img src="../images/vblogo.jpg" border="0" alt="vb logo"></td></tr>
<tr> 
<td rowspan="3" valign="top" height="1"> <p>&nbsp;</p>

<p align="left"><font face= "verdana" color="#000000"><b>Visual Basic Books</b></font><br>
<a href="../index.html" vlink="#666666"><font color="#FFFFFF">Home</font></a><br>
<a href="../beginner.html"><font color="#FFFFFF">Visual Basic Beginner Books</font></a><br>
<a href="../database.html"><font color="#FFFFFF">Visual Basic Database Books</font></a><br>
<a href="../activex.html"><font color="#FFFFFF">Visual Basic ActiveX Books</font></a><br>
<a href="../advanced.html"><font color="#FFFFFF">Visual Basic Advanced Books</font></a><br>
<a href="../vbinternet.html"><font color="#FFFFFF">VB Internet Programming Books</font></a><br>


</p>
<p><font face= "verdana" color="#000000"><b>Resources</b></font><br>
<a href="../links.html"><font color="#FFFFFF">Visual Basic Links</font></a><br>
<a href="../addlink.html"><font color="#FFFFFF">Add a Link</font></a><br>
<a href="../esubscribe.html"><font color="#FFFFFF">Subscribe to Mailing List</font></a>
</p>
</font>
</td>
<td bgcolor="#ffffff" valign="bottom"><h1 align="center"><img src="../images/anibook.gif" alt="" width="32" height="32"><font face="trebuchet ms, arial, helvetica" color="#000000"> Visual Basic Books </font><img src="../images/anibook.gif" alt="" width="32" height="32"></h1></td>
</tr><tr>
<td bgcolor="#ffffff" colspan="1" valign="top">



<table cellpadding="5"><tr><td width="600">


<font FACE="Verdana, Arial, Helvetica" SIZE="-1">

<P>
<CENTER>
<A HREF="30640601.htm"><IMG SRC="back.gif" WIDTH=65 HEIGHT=34 BORDER=0 ALT="Back"></A>
<A HREF="contents.htm"><IMG SRC="contents.gif" WIDTH=69 HEIGHT=34 BORDER=0 ALT="Contents"></A>
<A HREF="30640603.htm"><IMG SRC="next.gif" WIDTH=62 HEIGHT=34 BORDER=0 ALT="Next"></A>
</CENTER>
<HR>

<div class=Section1>

<h1>DSN Connections</h1>

<p class=MsoNormal><a name=c5dsn>As we mentioned at the beginning</a><!--[if supportFields]><span
style='mso-bookmark:c5dsn'></span><span style='mso-element:field-begin'></span><span
style='mso-bookmark:c5dsn'> XE &quot;databases:connecting:DSN connections&quot;
\r “c5dsn” </span><![endif]--><span style='mso-bookmark:c5dsn'></span><!--[if supportFields]><span
style='mso-bookmark:c5dsn'></span><span style='mso-element:field-end'></span><![endif]--><span
style='mso-bookmark:c5dsn'><span style="mso-spacerun: yes"> </span></span><!--[if supportFields]><span
style='mso-bookmark:c5dsn'></span><span style='mso-element:field-begin'></span><span
style='mso-bookmark:c5dsn'><span style="mso-spacerun: yes"> </span>XE
&quot;DSNs:connections&quot; \r “c5dsn”</span><![endif]--><span
style='mso-bookmark:c5dsn'></span><!--[if supportFields]><span
style='mso-bookmark:c5dsn'></span><span style='mso-element:field-end'></span><![endif]--><span
style='mso-bookmark:c5dsn'>of this chapter, there are several ways to establish
a connection from your Visual Basic program to SQL Server. This section
explores the DSN connection. That is, we use a DSN to connect to SQL Server.
Using a DSN in Visual Basic server components is probably the most</span><!--[if supportFields]><span
style='mso-bookmark:c5dsn'></span><span style='mso-element:field-begin'></span><span
style='mso-bookmark:c5dsn'> XE &quot;server components:DSNs&quot; </span><![endif]--><span
style='mso-bookmark:c5dsn'></span><!--[if supportFields]><span
style='mso-bookmark:c5dsn'></span><span style='mso-element:field-end'></span><![endif]--><span
style='mso-bookmark:c5dsn'><span style="mso-spacerun: yes"> </span>common use
of DSNs. A server component is an ActiveX DLL that implements business rules
and performs specific business tasks. We are going to be using a DSN in a
front-end program within this chapter for demonstration purposes. Chapter 14
will explore server components in more depth and we will also be using a DSN
with our components in that chapter.</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsn'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsn'>We are going to use the </span><span
style='mso-bookmark:c5dsn'><span class=CodeinText><span style='font-size:9.0pt;
mso-bidi-font-size:12.0pt;font-family:Courier;color:black'>Open</span></span>
method syntax of the </span><span style='mso-bookmark:c5dsn'><span
class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Courier;color:black'>Connection</span></span> object that was
described earlier in this chapter, so your connection statement will look
similar to the code fragment below. You, of course, will have to substitute the
</span><span style='mso-bookmark:c5dsn'><span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Palatino;
color:black'>user ID</span></span> and </span><span style='mso-bookmark:c5dsn'><span
class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Palatino;color:black'>password</span></span> for one of the test
users you set up, or any user ID that uses SQL Server authentication. We'll
explain why you need to use a SQL Server authentication login ID in a few
moments.</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsn'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'>objConn.Open
&quot;DSN=Wrox Auto Works;UserID=margie;PWD=margie&quot;</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsn'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsn'>Of course, the </span><span
style='mso-bookmark:c5dsn'><span class=CodeinText><span style='font-size:9.0pt;
mso-bidi-font-size:12.0pt;font-family:Courier;color:black'>ConnectString</span></span>
does not have to be hard coded and really shouldn't be. There are many reasons
for not hard coding your </span><span style='mso-bookmark:c5dsn'><span
class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Courier;color:black'>ConnectString</span></span> and the main
reason is security of your </span><span style='mso-bookmark:c5dsn'><span
class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Palatino;color:black'>user ID</span></span> and </span><span
style='mso-bookmark:c5dsn'><span class=CodeinText><span style='font-size:9.0pt;
mso-bidi-font-size:12.0pt;font-family:Palatino;color:black'>password</span></span>.
This </span><span style='mso-bookmark:c5dsn'><span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Courier;
color:black'>ConnectString</span></span> could be passed in as a string
variable that has been read from the registry or supplied as information when a
user logs on.</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsn'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsn'>After you have opened a
connection, </span><!--[if supportFields]><span style='mso-bookmark:c5dsn'></span><span
style='mso-element:field-begin'></span><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes"> </span>XE &quot;Connection object:connections,
verifying&quot; </span><![endif]--><span style='mso-bookmark:c5dsn'></span><!--[if supportFields]><span
style='mso-bookmark:c5dsn'></span><span style='mso-element:field-end'></span><![endif]--><span
style='mso-bookmark:c5dsn'></span><!--[if supportFields]><span
style='mso-bookmark:c5dsn'></span><span style='mso-element:field-begin'></span><span
style='mso-bookmark:c5dsn'><span style="mso-spacerun: yes"> </span>XE
&quot;Connection object:State property&quot; </span><![endif]--><span
style='mso-bookmark:c5dsn'></span><!--[if supportFields]><span
style='mso-bookmark:c5dsn'></span><span style='mso-element:field-end'></span><![endif]--><span
style='mso-bookmark:c5dsn'></span><!--[if supportFields]><span
style='mso-bookmark:c5dsn'></span><span style='mso-element:field-begin'></span><span
style='mso-bookmark:c5dsn'><span style="mso-spacerun: yes"> </span>XE
&quot;State property:connections, verifying&quot; </span><![endif]--><span
style='mso-bookmark:c5dsn'></span><!--[if supportFields]><span
style='mso-bookmark:c5dsn'></span><span style='mso-element:field-end'></span><![endif]--><span
style='mso-bookmark:c5dsn'>you should verify the state of the connection using
the </span><span style='mso-bookmark:c5dsn'><span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Courier;
color:black'>State</span></span> property of the </span><span style='mso-bookmark:
c5dsn'><span class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:
12.0pt;font-family:Courier;color:black'>Connection</span></span> object. This
property will tell you if the </span><span style='mso-bookmark:c5dsn'><span
class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Courier;color:black'>Connection</span></span> object is open,
closed, connecting, executing or fetching. More on this in a moment.</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsn'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<div style='border:solid black 2.25pt;padding:1.0pt 1.0pt 1.0pt 1.0pt;
background:black;mso-shading:windowtext;mso-pattern:solid auto'>

<h5><span style='mso-bookmark:c5dsn'>Try It Out – Using a DSN Connection</span></h5>

</div>

<p class=MsoNormal><span style='mso-bookmark:c5dsn'>Since we have entered </span><!--[if supportFields]><span
style='mso-bookmark:c5dsn'></span><span style='mso-element:field-begin'></span><span
style='mso-bookmark:c5dsn'><span style="mso-spacerun: yes"> </span>XE
&quot;DSNs:using&quot; </span><![endif]--><span style='mso-bookmark:c5dsn'></span><!--[if supportFields]><span
style='mso-bookmark:c5dsn'></span><span style='mso-element:field-end'></span><![endif]--><span
style='mso-bookmark:c5dsn'>at least one record in the </span><span
style='mso-bookmark:c5dsn'><span class=CodeinText><span style='font-size:9.0pt;
mso-bidi-font-size:12.0pt;font-family:Courier;color:black'>State_T</span></span>
table, let's create a simple front-end program that will connect to the
database using a DSN connection, open a recordset returning data from the </span><span
style='mso-bookmark:c5dsn'><span class=CodeinText><span style='font-size:9.0pt;
mso-bidi-font-size:12.0pt;font-family:Courier;color:black'>State_T</span></span>
table, and display the first state on the form.</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsn'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=NumberedBulletsUSETHIS style='text-indent:-51.05pt;mso-text-indent-alt:
-22.7pt;mso-list:l6 level1 lfo10;mso-list-change:"%1\:1\:0\:\." "Thearon Willis" 19991216T0525'><span
style='mso-bookmark:c5dsn'><![if !supportLists]><b style='mso-bidi-font-weight:
normal'><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;font-family:
"ITC Franklin Gothic Book"'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></b><![endif]>Open a new </span><span style='mso-bookmark:c5dsn'><span
class=Screentext><span style='font-family:Helvetica'>Standard EXE</span></span>
project in Visual Basic and set a reference to the </span><span
style='mso-bookmark:c5dsn'><span class=Screentext><span style='font-family:
Helvetica'>Microsoft ActiveX Data Objects Library</span></span>. This should be
the latest release you have installed, preferably release </span><span
style='mso-bookmark:c5dsn'><span class=Screentext><span style='font-family:
Helvetica'>2.5</span></span>. This is done from the </span><span
style='mso-bookmark:c5dsn'><span class=Screentext><span style='font-family:
Helvetica'>Project</span></span> menu, by clicking </span><span
style='mso-bookmark:c5dsn'><span class=Screentext><span style='font-family:
Helvetica'>References</span></span> to invoke the </span><span
style='mso-bookmark:c5dsn'><span class=Screentext><span style='font-family:
Helvetica'>References</span></span> dialog. Find the </span><span
style='mso-bookmark:c5dsn'><span class=Screentext><span style='font-family:
Helvetica'>Microsoft ActiveX Data Objects Library</span></span>, check the
checkbox, and then click </span><span style='mso-bookmark:c5dsn'><span
class=Screentext><span style='font-family:Helvetica'>OK</span></span> to
dismiss the dialog:</span></p>

<p class=NumberedBulletsUSETHIS style='mso-list:none;tab-stops:0in 28.35pt'><span
style='mso-bookmark:c5dsn'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=NumberedBulletsUSETHIS style='mso-list:none;tab-stops:0in 28.35pt'><span
style='mso-bookmark:c5dsn'><!--[if gte vml 1]><v:shapetype id="_x0000_t75"
 coordsize="21600,21600" o:spt="75" o:preferrelative="t" path="m@4@5l@4@11@9@11@9@5xe"
 filled="f" stroked="f">
 <v:stroke joinstyle="miter"/>
 <v:formulas>
  <v:f eqn="if lineDrawn pixelLineWidth 0"/>
  <v:f eqn="sum @0 1 0"/>
  <v:f eqn="sum 0 0 @1"/>
  <v:f eqn="prod @2 1 2"/>
  <v:f eqn="prod @3 21600 pixelWidth"/>
  <v:f eqn="prod @3 21600 pixelHeight"/>
  <v:f eqn="sum @0 0 1"/>
  <v:f eqn="prod @6 1 2"/>
  <v:f eqn="prod @7 21600 pixelWidth"/>
  <v:f eqn="sum @8 21600 0"/>
  <v:f eqn="prod @7 21600 pixelHeight"/>
  <v:f eqn="sum @10 21600 0"/>
 </v:formulas>
 <v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/>
 <o:lock v:ext="edit" aspectratio="t"/>
</v:shapetype><v:shape id="_x0000_i1025" type="#_x0000_t75" style='width:313.5pt;
 height:259.5pt' fillcolor="window">
 <v:imagedata src="image001.png" o:title="Fig10a_C5"/>
</v:shape><![endif]--><![if !vml]><img width=418 height=346
src="image002.jpg" v:shapes="_x0000_i1025"><![endif]></span></p>

<p class=LayoutNotes><span style='mso-bookmark:c5dsn'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=NumberedBulletsUSETHIS style='mso-list:l6 level1 lfo10'><span
style='mso-bookmark:c5dsn'><![if !supportLists]><b style='mso-bidi-font-weight:
normal'><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;font-family:
"ITC Franklin Gothic Book"'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></b><![endif]>Change the name of the form to </span><span
style='mso-bookmark:c5dsn'><span class=CodeinText><span style='font-family:
Courier;color:black'>frmTryItOut2</span></span> and change the form caption to </span><span
style='mso-bookmark:c5dsn'><span class=CodeinText><span style='font-family:
Courier;color:black'>Try</span></span><span class=CodeinText><span
style='mso-ascii-font-family:Palatino;mso-hansi-font-family:Palatino;
color:black'> </span></span></span><span style='mso-bookmark:c5dsn'><span
class=CodeinText><span style='font-family:Courier;color:black'>It</span></span><span
class=CodeinText><span style='mso-ascii-font-family:Palatino;mso-hansi-font-family:
Palatino;color:black'> </span></span></span><span style='mso-bookmark:c5dsn'><span
class=CodeinText><span style='font-family:Courier;color:black'>Out</span></span><span
class=CodeinText><span style='mso-ascii-font-family:Palatino;mso-hansi-font-family:
Palatino;color:black'> </span></span></span><span style='mso-bookmark:c5dsn'><span
class=CodeinText><span style='font-family:Courier;color:black'>#2</span></span><span
class=CodeinText><span style='mso-ascii-font-family:Palatino;mso-hansi-font-family:
Palatino;color:black'> </span></span></span><span style='mso-bookmark:c5dsn'><span
class=CodeinText><span style='font-family:Courier;color:black'>-</span></span><span
class=CodeinText><span style='mso-ascii-font-family:Palatino;mso-hansi-font-family:
Palatino;color:black'> </span></span></span><span style='mso-bookmark:c5dsn'><span
class=CodeinText><span style='font-family:Courier;color:black'>DSN</span></span><span
class=CodeinText><span style='mso-ascii-font-family:Palatino;mso-hansi-font-family:
Palatino;color:black'> </span></span></span><span style='mso-bookmark:c5dsn'><span
class=CodeinText><span style='font-family:Courier;color:black'>Connection</span></span><span
class=CodeinText><span style='mso-ascii-font-family:Palatino;mso-hansi-font-family:
Palatino;color:black'>,</span></span> if you wish.</span></p>

<p class=NumberedBulletsUSETHIS style='mso-list:l6 level1 lfo10'><span
style='mso-bookmark:c5dsn'><![if !supportLists]><b style='mso-bidi-font-weight:
normal'><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;font-family:
"ITC Franklin Gothic Book"'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></b><![endif]>On the form, place a label control and use the
default name of </span><span style='mso-bookmark:c5dsn'><span class=Screentext><span
style='font-family:Helvetica'>Label1</span></span>. Enter the following code,
which is available as </span><span style='mso-bookmark:c5dsn'><span
class=CodeinText><span style='font-family:Courier;color:black'>frmTryItOut2.frm</span></span>,
changing the </span><span style='mso-bookmark:c5dsn'><span class=CodeinText><span
style='font-family:Courier;color:black'>UID</span></span> and </span><span
style='mso-bookmark:c5dsn'><span class=CodeinText><span style='font-family:
Courier;color:black'>PWD</span></span> if necessary. Then run your project.</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsn'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'>Private Sub
Form_Load()</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">   </span>'Use the standard Windows icon</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">   </span>Me.Icon = Nothing</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">   </span>'Declare database objects</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">   </span>Dim objConn As New ADODB.Connection</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">   </span>Dim objRS As New ADODB.Recordset</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">   </span>Dim objErr As ADODB.Error</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">   </span></span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">   </span>'Establish a database connection using SQL
Server Authentication</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">   </span>objConn.Open &quot;DSN=Wrox Auto
Works;UID=margie;PWD=margie&quot;</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">   </span></span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">   </span>'Check the state of the connection to
ensure we are connected</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">   </span>If objConn.State = adStateOpen Then</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">   </span></span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">      </span>'Open a recordset</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">      </span>objRS.Open &quot;State_T&quot;, objConn,
adOpenForwardOnly, adLockReadOnly, adCmdTable</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">      </span>If Not objRS.EOF And Not objRS.BOF Then</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">         </span>Label1.Caption = objRS!State_Name_VC</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">      </span>End If</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">      </span>objRS.Close</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">      </span></span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">   </span>Else</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">      </span></span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">      </span>'Display all errors</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">      </span>For Each objErr In objConn.Errors</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">         </span>Debug.Print objErr.Description</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">      </span>Next</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">     </span></span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">   </span>End If</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">   </span></span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">   </span>'De-reference the database objects</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">   </span>Set objRS = Nothing</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">   </span>objConn.Close</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">   </span>Set objConn = Nothing</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'>End Sub</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsn'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsn'>You will see the following:</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsn'><span class=msoDel><del
cite="mailto:Thearon%20Willis" datetime="1999-12-16T06:33"><!--[if gte vml 1]><v:shape
 id="_x0000_i1026" type="#_x0000_t75" style='width:219pt;height:132.75pt'
 fillcolor="window">
 <v:imagedata src="image003.gif" o:title="Fig11_C5_new"/>
</v:shape><![endif]--><![if !vml]><img width=292 height=177
src="image003.gif" v:shapes="_x0000_i1026"><![endif]></del></span></span></p>

<p class=LayoutNotes><span style='mso-bookmark:c5dsn'><!--[if gte vml 1]><v:shape
 id="_x0000_i1027" type="#_x0000_t75" style='width:192pt;height:110.25pt'
 fillcolor="window">
 <v:imagedata src="image004.png" o:title="Fig11_C5"/>
</v:shape><![endif]--><![if !vml]><img width=256 height=147
src="image005.jpg" v:shapes="_x0000_i1027"><![endif]><span
class=msoIns><ins cite="mailto:Thearon%20Willis" datetime="1999-12-16T06:34"><o:p></o:p></ins></span></span></p>

<p class=LayoutNotes style='text-indent:-28.1pt;mso-text-indent-alt:0in;
mso-list:none;mso-list-ins:"Thearon Willis" 19991216T0634'><span
style='mso-bookmark:c5dsn'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=HowItWorks><span style='mso-bookmark:c5dsn'>How It Works – Using A DSN
Connection</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsn'>This example is pretty
straightforward, but we will step through the code just to make sure everyone
is comfortable with what we are doing. All of this code was placed in the </span><span
style='mso-bookmark:c5dsn'><span class=CodeinText><span style='font-size:9.0pt;
mso-bidi-font-size:12.0pt;font-family:Courier;color:black'>Form_Load</span></span>
event to keep this example simple.</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsn'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsn'>If you take a look at the form
in design view, you will notice that the icon on the form is the default form
icon provided by VB. Instead of replacing it with some other icon, we enter the
first line of code to set the current form icon to </span><span
style='mso-bookmark:c5dsn'><span class=CodeinText><span style='font-size:9.0pt;
mso-bidi-font-size:12.0pt;font-family:Courier;color:black'>Nothing</span></span>,
which then gets replaced with the Windows default icon when the program is run.
We can use </span><!--[if supportFields]><span style='mso-bookmark:c5dsn'></span><span
style='mso-element:field-begin'></span><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes"> </span>XE &quot;Me keyword&quot; </span><![endif]--><span
style='mso-bookmark:c5dsn'></span><!--[if supportFields]><span
style='mso-bookmark:c5dsn'></span><span style='mso-element:field-end'></span><![endif]--><span
style='mso-bookmark:c5dsn'>the </span><span style='mso-bookmark:c5dsn'><span
class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Courier;color:black'>Me</span></span> keyword to represent the
current object, in this case </span><span style='mso-bookmark:c5dsn'><span
class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Courier;color:black'>frmTryItOut2</span></span>. This provides an
easier means to reference the properties and methods of the form without trying
to type a long form name:</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsn'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'>Private Sub
Form_Load()</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">   </span>'Use the standard Windows icon</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">   </span>Me.Icon = Nothing</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsn'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsn'>Then we declare the
database objects that we need, in this case a </span><span style='mso-bookmark:
c5dsn'><span class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:
12.0pt;font-family:Courier;color:black'>Connection</span></span> object to
establish a connection to the database, a </span><span style='mso-bookmark:
c5dsn'><span class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:
12.0pt;font-family:Courier;color:black'>Recordset</span></span> object to hold
the returned records, and an </span><span style='mso-bookmark:c5dsn'><span
class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Courier;color:black'>Error</span></span> object – just in case we
encounter any errors:</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsn'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">   </span>'Declare database objects</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">   </span>Dim objConn As New ADODB.Connection</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">   </span>Dim objRS As New ADODB.Recordset</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">   </span>Dim objErr As ADODB.Error</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsn'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsn'>Next, we establish a
connection with the database, specifying our DSN in the </span><span
style='mso-bookmark:c5dsn'><span class=CodeinText><span style='font-size:9.0pt;
mso-bidi-font-size:12.0pt;font-family:Courier;color:black'>ConnectString</span></span>.
But wait, the </span><span style='mso-bookmark:c5dsn'><span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Palatino;
color:black'>user ID</span></span> and p</span><span style='mso-bookmark:c5dsn'><span
class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Palatino;color:black'>assword</span></span> are part of the </span><span
style='mso-bookmark:c5dsn'><span class=CodeinText><span style='font-size:9.0pt;
mso-bidi-font-size:12.0pt;font-family:Courier;color:black'>ConnectString</span></span>
and are not specified separately. According to the syntax of the </span><span
style='mso-bookmark:c5dsn'><span class=CodeinText><span style='font-size:9.0pt;
mso-bidi-font-size:12.0pt;font-family:Courier;color:black'>Open</span></span>
method that we explored above, we need to specify the </span><span
style='mso-bookmark:c5dsn'><span class=CodeinText><span style='font-size:9.0pt;
mso-bidi-font-size:12.0pt;font-family:Palatino;color:black'>user ID</span></span>
and p</span><span style='mso-bookmark:c5dsn'><span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Palatino;
color:black'>assword</span></span> separately from the </span><span
style='mso-bookmark:c5dsn'><span class=CodeinText><span style='font-size:9.0pt;
mso-bidi-font-size:12.0pt;font-family:Courier;color:black'>ConnectString</span></span>.
Well, this is not quite true. All parameters of the </span><span
style='mso-bookmark:c5dsn'><span class=CodeinText><span style='font-size:9.0pt;
mso-bidi-font-size:12.0pt;font-family:Courier;color:black'>Open</span></span>
method are optional, and since our DSN requires a </span><span
style='mso-bookmark:c5dsn'><span class=CodeinText><span style='font-size:9.0pt;
mso-bidi-font-size:12.0pt;font-family:Palatino;color:black'>user ID</span></span>
and p</span><span style='mso-bookmark:c5dsn'><span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Palatino;
color:black'>assword</span></span>, we can pass them as parameters of the </span><span
style='mso-bookmark:c5dsn'><span class=CodeinText><span style='font-size:9.0pt;
mso-bidi-font-size:12.0pt;font-family:Courier;color:black'>ConnectString</span></span>
as we have done in the code fragment below:</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsn'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'>'Establish a database
connection using SQL Server Authentication</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">   </span>objConn.Open &quot;DSN=Wrox Auto
Works;UID=margie;PWD=margie&quot;</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsn'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsn'>The </span><span
style='mso-bookmark:c5dsn'><span class=CodeinText><span style='font-size:9.0pt;
mso-bidi-font-size:12.0pt;font-family:Courier;color:black'>UID</span></span>
and </span><span style='mso-bookmark:c5dsn'><span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Courier;
color:black'>PWD</span></span></span><span style='mso-bookmark:c5dsn'></span><!--[if supportFields]><span
style='mso-bookmark:c5dsn'></span><span style='mso-element:field-begin'></span><span
style='mso-bookmark:c5dsn'><span class=CodeinText><span style='font-size:9.0pt;
mso-bidi-font-size:12.0pt;font-family:Palatino;color:black'> XE &quot;Used
IDs:DSN connections&quot; </span></span></span><![endif]--><span
style='mso-bookmark:c5dsn'></span><!--[if supportFields]><span
style='mso-bookmark:c5dsn'></span><span style='mso-element:field-end'></span><![endif]--><span
style='mso-bookmark:c5dsn'></span><!--[if supportFields]><span
style='mso-bookmark:c5dsn'></span><span style='mso-element:field-begin'></span><span
style='mso-bookmark:c5dsn'><span class=CodeinText><span style='font-size:9.0pt;
mso-bidi-font-size:12.0pt;font-family:Palatino;color:black'><span
style="mso-spacerun: yes"> </span>XE &quot;passwords:DSN connections&quot; </span></span></span><![endif]--><span
style='mso-bookmark:c5dsn'></span><!--[if supportFields]><span
style='mso-bookmark:c5dsn'></span><span style='mso-element:field-end'></span><![endif]--><span
style='mso-bookmark:c5dsn'></span><!--[if supportFields]><span
style='mso-bookmark:c5dsn'></span><span style='mso-element:field-begin'></span><span
style='mso-bookmark:c5dsn'><span class=CodeinText><span style='font-size:9.0pt;
mso-bidi-font-size:12.0pt;font-family:Palatino;color:black'><span
style="mso-spacerun: yes"> </span>XE &quot;DSNs:passwords&quot; </span></span></span><![endif]--><span
style='mso-bookmark:c5dsn'></span><!--[if supportFields]><span
style='mso-bookmark:c5dsn'></span><span style='mso-element:field-end'></span><![endif]--><span
style='mso-bookmark:c5dsn'></span><!--[if supportFields]><span
style='mso-bookmark:c5dsn'></span><span style='mso-element:field-begin'></span><span
style='mso-bookmark:c5dsn'><span class=CodeinText><span style='font-size:9.0pt;
mso-bidi-font-size:12.0pt;font-family:Palatino;color:black'><span
style="mso-spacerun: yes"> </span>XE &quot;DSNs:user IDs&quot; </span></span></span><![endif]--><span
style='mso-bookmark:c5dsn'></span><!--[if supportFields]><span
style='mso-bookmark:c5dsn'></span><span style='mso-element:field-end'></span><![endif]--><span
style='mso-bookmark:c5dsn'><span style="mso-spacerun: yes"> </span>parameters
in the </span><span style='mso-bookmark:c5dsn'><span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Courier;
color:black'>Connect String</span></span> can be passed as parameters of the
connection string, or can be passed separately as parameters of the </span><span
style='mso-bookmark:c5dsn'><span class=CodeinText><span style='font-size:9.0pt;
mso-bidi-font-size:12.0pt;font-family:Courier;color:black'>Connection</span></span>
object's </span><span style='mso-bookmark:c5dsn'><span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Courier;
color:black'>Open</span></span> method. Just to prove our point, substitute the
following line of code, using your </span><span style='mso-bookmark:c5dsn'><span
class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Palatino;color:black'>user ID</span></span> and p</span><span
style='mso-bookmark:c5dsn'><span class=CodeinText><span style='font-size:9.0pt;
mso-bidi-font-size:12.0pt;font-family:Palatino;color:black'>assword</span></span>,
and run your project. Notice that this also works. The </span><span
style='mso-bookmark:c5dsn'><span class=CodeinText><span style='font-size:9.0pt;
mso-bidi-font-size:12.0pt;font-family:Palatino;color:black'>user ID</span></span>
and p</span><span style='mso-bookmark:c5dsn'><span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Palatino;
color:black'>assword</span></span>, although specified separately, are passed
to the DSN so a connection can be established:</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsn'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'>'Establish a database
connection using SQL Server Authentication</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">   </span>objConn.Open &quot;DSN=Wrox Auto
Works&quot;, &quot;margie&quot;, &quot;margie&quot;</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsn'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsn'>This section of code
applies to those readers who have set up their login ID in SQL Server using NT
authentication. Since you are running on Windows NT, you don't have to specify
a </span><span style='mso-bookmark:c5dsn'><span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Palatino;
color:black'>user ID</span></span> and </span><span style='mso-bookmark:c5dsn'><span
class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Palatino;color:black'>password</span></span> at all, as is
demonstrated in the next code fragment:</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsn'><span style='font-size:
8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";mso-bidi-font-family:
"Times New Roman";mso-font-kerning:72.0pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'>'Establish a database
connection using NT Authentication</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">   </span>objConn.Open &quot;DSN=Wrox Auto
Works&quot;</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsn'><span style='font-size:
8.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";mso-bidi-font-family:
"Times New Roman";mso-font-kerning:72.0pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsn'>In fact, if you try to pass
a </span><span style='mso-bookmark:c5dsn'><span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Palatino;
color:black'>user ID</span></span> and </span><span style='mso-bookmark:c5dsn'><span
class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Palatino;color:black'>password</span></span> that use NT
authentication in SQL Server, you will get the error shown below. This is
because SQL Server will think that the </span><span style='mso-bookmark:c5dsn'><span
class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Palatino;color:black'>user ID</span></span> and </span><span
style='mso-bookmark:c5dsn'><span class=CodeinText><span style='font-size:9.0pt;
mso-bidi-font-size:12.0pt;font-family:Palatino;color:black'>password</span></span>
you are passing are using SQL Server authentication.</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsn'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsn'><!--[if gte vml 1]><v:shape
 id="_x0000_i1028" type="#_x0000_t75" style='width:258.75pt;height:144.75pt'
 fillcolor="window">
 <v:imagedata src="image006.png" o:title="Fig11A_C5"/>
</v:shape><![endif]--><![if !vml]><img width=345 height=193
src="image007.jpg" v:shapes="_x0000_i1028"><![endif]></span></p>

<p class=LayoutNotes><span style='mso-bookmark:c5dsn'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsn'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsn'>Moving on, we next check
the state of the connection using the </span><span style='mso-bookmark:c5dsn'><span
class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Courier;color:black'>Connection</span></span> object's </span><span
style='mso-bookmark:c5dsn'><span class=CodeinText><span style='font-size:9.0pt;
mso-bidi-font-size:12.0pt;font-family:Courier;color:black'>State</span></span>
property. Remember earlier we said that the </span><span style='mso-bookmark:
c5dsn'><span class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:
12.0pt;font-family:Courier;color:black'>State</span></span> property indicates
the current state of the </span><span style='mso-bookmark:c5dsn'><span
class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Courier;color:black'>Connection</span></span> object. We are using</span><!--[if supportFields]><span
style='mso-bookmark:c5dsn'></span><span style='mso-element:field-begin'></span><span
style='mso-bookmark:c5dsn'> XE &quot;adStateOpen constant:State property&quot; </span><![endif]--><span
style='mso-bookmark:c5dsn'></span><!--[if supportFields]><span
style='mso-bookmark:c5dsn'></span><span style='mso-element:field-end'></span><![endif]--><span
style='mso-bookmark:c5dsn'></span><!--[if supportFields]><span
style='mso-bookmark:c5dsn'></span><span style='mso-element:field-begin'></span><span
style='mso-bookmark:c5dsn'><span style="mso-spacerun: yes"> </span>XE
&quot;State property:adStateOpen constant&quot; </span><![endif]--><span
style='mso-bookmark:c5dsn'></span><!--[if supportFields]><span
style='mso-bookmark:c5dsn'></span><span style='mso-element:field-end'></span><![endif]--><span
style='mso-bookmark:c5dsn'><span style="mso-spacerun: yes"> </span>the </span><span
style='mso-bookmark:c5dsn'><span class=CodeinText><span style='font-size:9.0pt;
mso-bidi-font-size:12.0pt;font-family:Courier;color:black'>adStateOpen</span></span>
constant from the </span><span style='mso-bookmark:c5dsn'><span
class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Courier;color:black'>ObjectStateEnum</span></span> enumeration to
compare to the current state of the </span><span style='mso-bookmark:c5dsn'><span
class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Courier;color:black'>Connection</span></span> object:</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsn'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">   </span>'Check the state of the connection to
ensure we are connected</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">   </span>If objConn.State = adStateOpen Then</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsn'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsn'>If the </span><span
style='mso-bookmark:c5dsn'><span class=CodeinText><span style='font-size:9.0pt;
mso-bidi-font-size:12.0pt;font-family:Courier;color:black'>State</span></span>
of the </span><span style='mso-bookmark:c5dsn'><span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Courier;
color:black'>Connection</span></span> object is open then we execute the next
few lines of code. But before we examine them, let's take a quick look at the
parameters of </span><!--[if supportFields]><span style='mso-bookmark:c5dsn'></span><span
style='mso-element:field-begin'></span><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes"> </span>XE &quot;Open method:Recordset
object:parameters&quot; </span><![endif]--><span style='mso-bookmark:c5dsn'></span><!--[if supportFields]><span
style='mso-bookmark:c5dsn'></span><span style='mso-element:field-end'></span><![endif]--><span
style='mso-bookmark:c5dsn'></span><!--[if supportFields]><span
style='mso-bookmark:c5dsn'></span><span style='mso-element:field-begin'></span><span
style='mso-bookmark:c5dsn'><span style="mso-spacerun: yes"> </span>XE
&quot;Recordset object:Open method:parameters&quot; </span><![endif]--><span
style='mso-bookmark:c5dsn'></span><!--[if supportFields]><span
style='mso-bookmark:c5dsn'></span><span style='mso-element:field-end'></span><![endif]--><span
style='mso-bookmark:c5dsn'>the </span><span style='mso-bookmark:c5dsn'><span
class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Courier;color:black'>Open</span></span> method of the </span><span
style='mso-bookmark:c5dsn'><span class=CodeinText><span style='font-size:9.0pt;
mso-bidi-font-size:12.0pt;font-family:Courier;color:black'>Recordset</span></span>
object:</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsn'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=Bullet style='text-indent:-46.2pt;mso-text-indent-alt:-17.85pt;
mso-list:l5 level1 lfo8;mso-list-change:\F071 "Thearon Willis" 19991216T0525'><span
style='mso-bookmark:c5dsn'><![if !supportLists]><span style='font-size:8.0pt;
mso-bidi-font-size:10.0pt;font-family:ZapfDingbats'>q<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>The first parameter is the </span><span
style='mso-bookmark:c5dsn'><span class=CodeinText><span style='font-family:
Courier;color:black'>Source</span></span> parameter </span><!--[if supportFields]><span
style='mso-bookmark:c5dsn'></span><span style='mso-element:field-begin'></span><span
style='mso-bookmark:c5dsn'><span style="mso-spacerun: yes"> </span>XE
&quot;Source parameter:Recordset object&quot; </span><![endif]--><span
style='mso-bookmark:c5dsn'></span><!--[if supportFields]><span
style='mso-bookmark:c5dsn'></span><span style='mso-element:field-end'></span><![endif]--><span
style='mso-bookmark:c5dsn'>and specifies a table name to be opened, in-line SQL
statements, or the stored procedure to be executed.</span></p>

<p class=Bullet style='mso-list:l5 level1 lfo8;mso-list-change:\F071 "Thearon Willis" 19991216T0525'><span
style='mso-bookmark:c5dsn'><![if !supportLists]><span style='font-size:8.0pt;
mso-bidi-font-size:10.0pt;font-family:ZapfDingbats'>q<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>The </span><span style='mso-bookmark:c5dsn'><span
class=CodeinText><span style='font-family:Courier;color:black'>ActiveConnection</span></span>
parameter lets </span><!--[if supportFields]><span style='mso-bookmark:c5dsn'></span><span
style='mso-element:field-begin'></span><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes"> </span>XE &quot;ActiveConnection parameter:Recordset
object &quot; </span><![endif]--><span style='mso-bookmark:c5dsn'></span><!--[if supportFields]><span
style='mso-bookmark:c5dsn'></span><span style='mso-element:field-end'></span><![endif]--><span
style='mso-bookmark:c5dsn'>the </span><span style='mso-bookmark:c5dsn'><span
class=CodeinText><span style='font-family:Courier;color:black'>Open</span></span>
method know how it should access the database. This parameter can be in the
form of a </span><span style='mso-bookmark:c5dsn'><span class=CodeinText><span
style='font-family:Courier;color:black'>Connection</span></span> object or a <span
class=CodeinText><span style='mso-ascii-font-family:Palatino;mso-hansi-font-family:
Palatino;color:black'>connection</span></span> string.</span></p>

<p class=Bullet style='text-indent:-46.2pt;mso-text-indent-alt:-17.85pt;
mso-list:l5 level1 lfo8;mso-list-change:\F071 "Thearon Willis" 19991216T0525'><span
style='mso-bookmark:c5dsn'><![if !supportLists]><span style='font-size:8.0pt;
mso-bidi-font-size:10.0pt;font-family:ZapfDingbats'>q<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>The </span><span style='mso-bookmark:c5dsn'><span
class=CodeinText><span style='font-family:Courier;color:black'>CursorType</span></span>
parameter </span><!--[if supportFields]><span style='mso-bookmark:c5dsn'></span><span
style='mso-element:field-begin'></span><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes"> </span>XE &quot;CursorType parameter:Recordset
object &quot; </span><![endif]--><span style='mso-bookmark:c5dsn'></span><!--[if supportFields]><span
style='mso-bookmark:c5dsn'></span><span style='mso-element:field-end'></span><![endif]--><span
style='mso-bookmark:c5dsn'>specifies what type of cursor the database should
use when opening the recordset. A cursor controls how the recordset is
navigated and how the data is updated in the recordset.</span></p>

<p class=Bullet style='text-indent:-46.2pt;mso-text-indent-alt:-17.85pt;
mso-list:l5 level1 lfo8;mso-list-change:\F071 "Thearon Willis" 19991216T0525'><span
style='mso-bookmark:c5dsn'><![if !supportLists]><span style='font-size:8.0pt;
mso-bidi-font-size:10.0pt;font-family:ZapfDingbats'>q<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span class=CodeinText><span style='font-family:Courier;
color:black'>LockType</span></span> specifies what type </span><!--[if supportFields]><span
style='mso-bookmark:c5dsn'></span><span style='mso-element:field-begin'></span><span
style='mso-bookmark:c5dsn'><span style="mso-spacerun: yes"> </span>XE
&quot;LockType parameter:Recordset object &quot; </span><![endif]--><span
style='mso-bookmark:c5dsn'></span><!--[if supportFields]><span
style='mso-bookmark:c5dsn'></span><span style='mso-element:field-end'></span><![endif]--><span
style='mso-bookmark:c5dsn'>of locking the database should use on the recordset
when editing of records occurs.</span></p>

<p class=Bullet style='text-indent:-46.2pt;mso-text-indent-alt:-17.85pt;
mso-list:l5 level1 lfo8;mso-list-change:\F071 "Thearon Willis" 19991216T0525'><span
style='mso-bookmark:c5dsn'><![if !supportLists]><span style='font-size:8.0pt;
mso-bidi-font-size:10.0pt;font-family:ZapfDingbats'>q<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>The last parameter of the </span><span
style='mso-bookmark:c5dsn'><span class=CodeinText><span style='font-family:
Courier;color:black'>Open</span></span> method is</span><!--[if supportFields]><span
style='mso-bookmark:c5dsn'></span><span style='mso-element:field-begin'></span><span
style='mso-bookmark:c5dsn'> XE &quot;Options parameter:Recordset object &quot; </span><![endif]--><span
style='mso-bookmark:c5dsn'></span><!--[if supportFields]><span
style='mso-bookmark:c5dsn'></span><span style='mso-element:field-end'></span><![endif]--><span
style='mso-bookmark:c5dsn'><span style="mso-spacerun: yes"> </span>the </span><span
style='mso-bookmark:c5dsn'><span class=CodeinText><span style='font-family:
Courier;color:black'>Options</span></span> parameter. It tells the database how
it should interpret the </span><span style='mso-bookmark:c5dsn'><span
class=CodeinText><span style='font-family:Courier;color:black'>Source</span></span>
parameter. This is an optional parameter, but by specifying it, we can improve the
performance of our code, because the processor doesn't need to work out for
itself what type of </span><span style='mso-bookmark:c5dsn'><span
class=CodeinText><span style='font-family:Courier;color:black'>Source</span></span>
parameter we are supplying. </span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsn'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsn'>The </span><span
style='mso-bookmark:c5dsn'><span class=CodeinText><span style='font-size:9.0pt;
mso-bidi-font-size:12.0pt;font-family:Courier;color:black'>Recordset.Open</span></span>
parameters must be specified in order. If you leave out a parameter to use the
default that is provided by ADO, then you must insert a comma in its place
before specifying the next parameter, as shown below:</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsn'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'>objRS.Open
&quot;State_T&quot;, objConn, , , adCmdTable</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsn'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsn'>Getting back to our code,
first we open the </span><span style='mso-bookmark:c5dsn'><span
class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Courier;color:black'>Recordset</span></span> object, passing it the
following parameters. The </span><span style='mso-bookmark:c5dsn'><span
class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Courier;color:black'>Source</span></span> parameter is set to the </span><span
style='mso-bookmark:c5dsn'><span class=CodeinText><span style='font-size:9.0pt;
mso-bidi-font-size:12.0pt;font-family:Courier;color:black'>State_T</span></span>
table and the </span><span style='mso-bookmark:c5dsn'><span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Courier;
color:black'>ActiveConnection</span></span> parameter is set to the </span><span
style='mso-bookmark:c5dsn'><span class=CodeinText><span style='font-size:9.0pt;
mso-bidi-font-size:12.0pt;font-family:Courier;color:black'>Connection</span></span>
object. We have </span><!--[if supportFields]><span style='mso-bookmark:c5dsn'></span><span
style='mso-element:field-begin'></span><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes"> </span>XE &quot;adOpenForwardOnly&quot; </span><![endif]--><span
style='mso-bookmark:c5dsn'></span><!--[if supportFields]><span
style='mso-bookmark:c5dsn'></span><span style='mso-element:field-end'></span><![endif]--><span
style='mso-bookmark:c5dsn'></span><!--[if supportFields]><span
style='mso-bookmark:c5dsn'></span><span style='mso-element:field-begin'></span><span
style='mso-bookmark:c5dsn'><span style="mso-spacerun: yes"> </span>XE
&quot;cursors:adOpenForwardOnly&quot; </span><![endif]--><span
style='mso-bookmark:c5dsn'></span><!--[if supportFields]><span
style='mso-bookmark:c5dsn'></span><span style='mso-element:field-end'></span><![endif]--><span
style='mso-bookmark:c5dsn'>specified </span><span style='mso-bookmark:c5dsn'><span
class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Courier;color:black'>adOpenForwardOnly</span></span> as the </span><span
style='mso-bookmark:c5dsn'><span class=CodeinText><span style='font-size:9.0pt;
mso-bidi-font-size:12.0pt;font-family:Courier;color:black'>CursorType</span></span>
parameter because we only want to read the recordset in one direction. This
constant is listed in the </span><span style='mso-bookmark:c5dsn'><span
class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Courier;color:black'>CursorTypeEnum</span></span> enumeration. The </span><span
style='mso-bookmark:c5dsn'><span class=CodeinText><span style='font-size:9.0pt;
mso-bidi-font-size:12.0pt;font-family:Courier;color:black'>LockType</span></span>
parameter uses the </span><span style='mso-bookmark:c5dsn'><span
class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Courier;color:black'>adLockReadOnly</span></span> constant</span><!--[if supportFields]><span
style='mso-bookmark:c5dsn'></span><span style='mso-element:field-begin'></span><span
style='mso-bookmark:c5dsn'> XE &quot;adLockReadOnly&quot; </span><![endif]--><span
style='mso-bookmark:c5dsn'></span><!--[if supportFields]><span
style='mso-bookmark:c5dsn'></span><span style='mso-element:field-end'></span><![endif]--><span
style='mso-bookmark:c5dsn'><span style="mso-spacerun: yes"> </span>from the </span><span
style='mso-bookmark:c5dsn'><span class=CodeinText><span style='font-size:9.0pt;
mso-bidi-font-size:12.0pt;font-family:Courier;color:black'>LockTypeEnum</span></span>
enumeration. Since we are only reading this data, there is less overhead
associated with this lock type. And finally, the </span><span style='mso-bookmark:
c5dsn'><span class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:
12.0pt;font-family:Courier;color:black'>adCmdTable</span></span> constant from
the </span><span style='mso-bookmark:c5dsn'><span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Courier;
color:black'>CommandTypeEnum</span></span> enumeration has been specified for
the </span><span style='mso-bookmark:c5dsn'><span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Courier;
color:black'>Options</span></span> parameter. All of these enumerations are
viewable in the Object Browser in VB. </span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsn'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsn'>After opening the </span><span
style='mso-bookmark:c5dsn'><span class=CodeinText><span style='font-size:9.0pt;
mso-bidi-font-size:12.0pt;font-family:Courier;color:black'>Recordset</span></span>
object, we check for an end of file (</span><span style='mso-bookmark:c5dsn'><span
class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Courier;color:black'>EOF</span></span>) and a beginning of file (</span><span
style='mso-bookmark:c5dsn'><span class=CodeinText><span style='font-size:9.0pt;
mso-bidi-font-size:12.0pt;font-family:Courier;color:black'>BOF</span></span>)
condition. If both the BOF and EOF properties are </span><span
style='mso-bookmark:c5dsn'><span class=CodeinText><span style='font-size:9.0pt;
mso-bidi-font-size:12.0pt;font-family:Courier;color:black'>True</span></span>,
it would indicate that our recordset is empty. If it is not empty, then we
execute the next line of code. This sets the caption of the label control to
the state name contained in the </span><span style='mso-bookmark:c5dsn'><span
class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Courier;color:black'>State_Name_VC</span></span> field of the first
record of our recordset:</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsn'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">      </span>'Open a recordset</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">      </span>objRS.Open &quot;State_T&quot;, objConn,
adOpenForwardOnly, adLockReadOnly, adCmdTable</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">      </span>If Not objRS.EOF And Not objRS.BOF Then</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">         </span>Label1.Caption = objRS!State_Name_VC</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">      </span>End If</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">      </span>objRS.Close</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsn'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsn'>If the </span><span
style='mso-bookmark:c5dsn'><span class=CodeinText><span style='font-size:9.0pt;
mso-bidi-font-size:12.0pt;font-family:Courier;color:black'>State</span></span>
of the </span><span style='mso-bookmark:c5dsn'><span class=CodeinText><span
style='font-size:9.0pt;mso-bidi-font-size:12.0pt;font-family:Courier;
color:black'>Connection</span></span> object is not equal to open, then we
display each error in the debug window. We do this by using a </span><span
style='mso-bookmark:c5dsn'><span class=CodeinText><span style='font-size:9.0pt;
mso-bidi-font-size:12.0pt;font-family:Courier;color:black'>For</span></span></span><span
style='mso-bookmark:c5dsn'><span class=CodeinText><span style='font-size:9.0pt;
mso-bidi-font-size:12.0pt;font-family:Palatino;color:black'> </span></span></span><span
style='mso-bookmark:c5dsn'><span class=CodeinText><span style='font-size:9.0pt;
mso-bidi-font-size:12.0pt;font-family:Courier;color:black'>Each</span></span>
loop, enumerating through each of the errors in the </span><span
style='mso-bookmark:c5dsn'><span class=CodeinText><span style='font-size:9.0pt;
mso-bidi-font-size:12.0pt;font-family:Courier;color:black'>Errors</span></span>
collection of the </span><span style='mso-bookmark:c5dsn'><span
class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Courier;color:black'>Connection</span></span> object. We are only
displaying the error description, but you could display more error information
if you wanted to. See the </span><span style='mso-bookmark:c5dsn'><span
class=CodeinText><span style='font-size:9.0pt;mso-bidi-font-size:12.0pt;
font-family:Courier;color:black'>Error</span></span> object in Appendix B, the
ADO help file, or MSDN Library for all the available </span><span
style='mso-bookmark:c5dsn'><span class=CodeinText><span style='font-size:9.0pt;
mso-bidi-font-size:12.0pt;font-family:Palatino;color:black'>properties</span></span>
that can be displayed.</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsn'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">   </span>Else</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">      </span></span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">      </span>'Display all errors</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">      </span>For Each objErr In objConn.Errors</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">         </span>Debug.Print objErr.Description</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">      </span>Next</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">      </span></span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">   </span>End If</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsn'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsn'>Last, we close and
de-reference all of our database objects:</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsn'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">   </span>'De-reference the database objects</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">   </span>Set objRS = Nothing</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">   </span>objConn.Close</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'><span
style="mso-spacerun: yes">   </span>Set objConn = Nothing</span></p>

<p class=CodeForeground><span style='mso-bookmark:c5dsn'>End Sub</span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsn'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bookmark:c5dsn'>This section has covered
the DSN connection and has shown you various ways to connect using a DSN and
SQL Server authentication. We have also covered using a DSN connection with NT
authentication. We have explained why you should use SQL Server authentication
when setting up your DSN, and explained why you set your DSN up as a System DSN
as opposed to a User or File DSN.</span></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

</div>

<HR>
<CENTER>
<A HREF="30640601.htm"><IMG SRC="back.gif" WIDTH=65 HEIGHT=34 BORDER=0 ALT="Back"></A><A HREF="contents.htm"><IMG SRC="contents.gif" WIDTH=69 HEIGHT=34 BORDER=0 ALT="Contents"></A><A HREF="30640603.htm"><IMG SRC="next.gif" WIDTH=62 HEIGHT=34 BORDER=0 ALT="Next"></A>
</CENTER>
<FONT SIZE=1>&copy;1999 <A HREF="http://www.wrox.com"> Wrox Press Limited</A>, US and UK.</FONT><p>
</td></tr></table></table><tr><td bgcolor="#991100"><center>
<font FACE="Verdana, Arial, Helvetica" SIZE="-1"><font color="#FFFFFF">Email us your comments:<a href="mailto:contact@vbbooks.freeservers.com"><img src="../images/emailed.gif"alt="mail" border=0></a><br>Fax: 1(916)404-7719<br>

 &copy;1999-2000 Visual Basic Books. All rights reserved.</font><br>

<img src="../images/vbbutton.gif">



</center>
</body>

</html>

