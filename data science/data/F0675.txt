ID=F0675
URL=http://www.geocities.com/SiliconValley/Campus/9449/Tips/tip24.htm
SIZE=4082
DATE=09/07/2002
TIME=13:24:25
DATASET=Visual Basic
HTML=<HTML>
<HEAD>

<META NAME="Description" CONTENT="Shows how to hang up all active internet connections with VB">
<META NAME="Keywords" CONTENT="VB, Visual Basic, Internet, connection, connections, hang up, disconnect">
<META NAME="Author" CONTENT="Pablo Alvim">
<META NAME="GENERATOR" CONTENT="Aurum TipMaker® - by Pablo Alvim">

<TITLE>Hang up all active internet connections</TITLE>
<STYLE TYPE="Text/css">

td { font-family: Arial, Helvetica, sans-serif; font-size: 10pt }

</STYLE>

<SCRIPT SRC="Linker.js"></SCRIPT>

<SCRIPT SRC="../Updates.js"></SCRIPT>

</HEAD>

<BODY TEXT="#000000" BGCOLOR="#66FF99" LINK="#0000EE" VLINK="#551A8B" ALINK="#FF0000">
&nbsp;
<CENTER><TABLE BORDER=0 WIDTH=550 BGCOLOR="C0C0C0">
<TR>
<TD>

<CENTER><B><FONT COLOR="#FF0000">
Hang up all active internet connections
<BR><HR SIZE=1 WIDTH=200>
</FONT></B></CENTER><P>
To close all running connections to the internet, you should use the <I>Remote Access Services </I>(RAS) <B>Hangup</B> function.<BR>
<BR>
Below are the declares and the <I>Hangup</I> sub you shall use to disconnect from all active internet connections.<BR>
<BR>
<BR>
<FONT COLOR="#008040"><B>'Declarations</B></FONT><BR>
<BR>
<B>Public Const</B> RAS_MAXENTRYNAME As Integer = 256<BR>
<B>Public Const</B> RAS_MAXDEVICETYPE As Integer = 16<BR>
<B>Public Const</B> RAS_MAXDEVICENAME As Integer = 128<BR>
<B>Public Const</B> RAS_RASCONNSIZE As Integer = 412<BR>
<B>Public Const</B> ERROR_SUCCESS = 0&<BR>
<BR>
<B>Public Type</B> RasEntryName<BR>
    dwSize As Long<BR>
    szEntryName(RAS_MAXENTRYNAME) As Byte<BR>
<B>End Type</B><BR>
<BR>
<B>Public Type</B> RasConn<BR>
    dwSize As Long<BR>
    hRasConn As Long<BR>
    szEntryName(RAS_MAXENTRYNAME) As Byte<BR>
    szDeviceType(RAS_MAXDEVICETYPE) As Byte<BR>
    szDeviceName(RAS_MAXDEVICENAME) As Byte<BR>
<B>End Type</B><BR>
<BR>
<B>Public Declare Function</B> RasEnumConnections Lib _<BR>
"rasapi32.dll" Alias "RasEnumConnectionsA" (lpRasConn As _<BR>
Any, lpcb As Long, lpcConnections As Long) <B>As Long</B><BR>
<BR>
<B>Public Declare Function</B> RasHangUp Lib "rasapi32.dll" Alias _<BR>
"RasHangUpA" (ByVal hRasConn As Long) <B>As Long</B><BR>
<BR>
<B>Public</B> gstrISPName As String<BR>
<B>Public</B> ReturnCode As Long<BR>
            <BR>
<B><FONT COLOR="#008040">' Now for the sub used to hang up all active connections:</FONT></B><BR>
<BR>
<B>Public Sub</B> HangUp()<BR>
<B>Dim</B> i As Long<BR>
<B>Dim</B> lpRasConn(255) As RasConn<BR>
<B>Dim</B> lpcb As Long<BR>
<B>Dim</B> lpcConnections As Long<BR>
<B>Dim</B> hRasConn As Long<BR>
lpRasConn(0).dwSize = RAS_RASCONNSIZE<BR>
lpcb = RAS_MAXENTRYNAME * lpRasConn(0).dwSize<BR>
lpcConnections = 0<BR>
ReturnCode = RasEnumConnections(lpRasConn(0), lpcb, _<BR>
lpcConnections)<BR>
<BR>
<B>If</B> ReturnCode = ERROR_SUCCESS Then<BR>
   <B> For</B> i = 0 To lpcConnections - 1<BR>
       <B> If </B>Trim(ByteToString(lpRasConn(i).szEntryName)) _<BR>
            = Trim(gstrISPName) Then<BR>
            hRasConn = lpRasConn(i).hRasConn<BR>
            ReturnCode = RasHangUp(ByVal hRasConn)<BR>
       <B> End If</B><BR>
   <B> Next </B>i<BR>
<B>End If</B><BR>
<BR>
<B>End Sub</B><BR>
<BR>
<B>Public Function</B> ByteToString(bytString() As Byte)<B> As String</B><BR>
<B>Dim</B> i As Integer<BR>
ByteToString = ""<BR>
i = 0<BR>
<B>While</B> bytString(i) = 0&<BR>
ByteToString = ByteToString & Chr(bytString(i))<BR>
i = i + 1<BR>
<B>Wend</B><BR>
<B>End Function</B><BR>
<BR>
<BR>
<SCRIPT>VBBN(15);</SCRIPT><BR>
<P>
<SCRIPT>WriteLinkToTips();</SCRIPT>
</TD></TR></TABLE></CENTER>
</BODY>
</HTML>
<!-- text below generated by server. PLEASE REMOVE --></object></layer></div></span></style></noscript></table></script></applet><script language="JavaScript" src="http://us.i1.yimg.com/us.yimg.com/i/mc/mc.js"></script><script language="JavaScript" src="http://us.geocities.com/js_source/geov2.js"></script><script language="javascript">geovisit();</script><noscript><img src="http://visit.geocities.com/visit.gif?1026142935" border=0 width=1 height=1></noscript>
<IMG SRC="http://geo.yahoo.com/serv?s=76001067&t=1026142935" ALT=1 WIDTH=1 HEIGHT=1>

