ID=F0042
URL=http://jadebox.dreamhost.com/vbprog/html/listing_4b_-_metademo.frm.html
SIZE=19265
DATE=09/07/2002
TIME=13:12:53
DATASET=Visual Basic
HTML=<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">

<HTML>
<HEAD>
<TITLE>Listing 4b - METADEMO.FRM</TITLE>
<meta name="keywords" content="Visual Basic,VB,VB5,VB6,Programming,Application,Development,Debug,Debugging,Basic,Metafiles,WMF,JPEG,JPG,GIF,Image,Images">

<META NAME="Generator" CONTENT="NetObjects Fusion 2.0.2 for Windows">

</HEAD>

<BODY BGCOLOR="#FFFFFF" LINK="#800000" VLINK="#808080" TEXT="#000000">
<TABLE CELLPADDING=0 CELLSPACING=0 BORDER=0 WIDTH=1341>
<TR VALIGN="top" ALIGN="left">
<TD>

  <TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH=98>
   <TR VALIGN="top" ALIGN="left">
	<TD WIDTH=2 HEIGHT =75><IMG SRC="../assets/auto_generated_images/img_3dfbb805.gif" WIDTH =2 HEIGHT =1 BORDER=0></TD>
	<TD WIDTH=96><IMG SRC="../assets/auto_generated_images/img_3dfbb805.gif" WIDTH =96 HEIGHT =1 BORDER=0></TD>
   </TR>
   <TR VALIGN="top" ALIGN="left">
	<TD HEIGHT =230></TD>
	<TD WIDTH=96>
	  <TABLE BORDER=0 CELLSPACING=0 CELLPADDING=3 >
	 <TR VALIGN="top" ALIGN="left">
		<TD WIDTH=90 HEIGHT=40><A HREF="../index.html"><IMG HEIGHT=40 WIDTH=90 SRC="../assets/auto_generated_images/img_49ab4036.gif"  BORDER=0  ALT=" Home " ></A></TD>
	 </TR>
	 <TR VALIGN="top" ALIGN="left">
		<TD WIDTH=90 HEIGHT=40><A HREF="../html/meta_files.html"><IMG HEIGHT=40 WIDTH=90 SRC="../assets/auto_generated_images/img_49b45df1a.gif"  BORDER=0  ALT=" Meta Files " ></A></TD>
	 </TR>
	 <TR VALIGN="top" ALIGN="left">
		<TD WIDTH=90 HEIGHT=40><A HREF="../html/review__hardcore_visual_basic.html"><IMG HEIGHT=40 WIDTH=90 SRC="../assets/auto_generated_images/img_4c083bc1.gif"  BORDER=0  ALT=" Hardcore VB " ></A></TD>
	 </TR>
	 <TR VALIGN="top" ALIGN="left">
		<TD WIDTH=90 HEIGHT=40><A HREF="../html/what_s_wrong_with_vb_.html"><IMG HEIGHT=40 WIDTH=90 SRC="../assets/auto_generated_images/img_4c0841a2.gif"  BORDER=0  ALT=" What's Wrong? " ></A></TD>
	 </TR>
	 <TR VALIGN="top" ALIGN="left">
		<TD WIDTH=90 HEIGHT=40><A HREF="../html/jpg_and_gif_sizes.html"><IMG HEIGHT=40 WIDTH=90 SRC="../assets/auto_generated_images/img_5138a491.gif"  BORDER=0  ALT=" Image Sizes " ></A></TD>
	 </TR>
	  </TABLE></TD>
   </TR>
   <TR VALIGN="top" ALIGN="left">
	<TD COLSPAN=2 HEIGHT =4916></TD>
   </TR>
  </TABLE>
</TD>
<TD>

  <TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH=1243>
   <TR VALIGN="top" ALIGN="left">
	<TD HEIGHT =71></TD>
	<TD WIDTH=468 COLSPAN=2><A HREF="http://www.jadebox.com/arrow/"><IMG HEIGHT=60 WIDTH=468 SRC="../assets/images/aniarrow.gif"  BORDER=0  ALT="Arrow" ></A></TD>
	<TD></TD>
   </TR>
   <TR VALIGN="top" ALIGN="left">
	<TD WIDTH=12 HEIGHT =40><IMG SRC="../assets/auto_generated_images/img_3dfbb805.gif" WIDTH =12 HEIGHT =1 BORDER=0></TD>
	<TD WIDTH=310><IMG HEIGHT=40 WIDTH=310 SRC="../assets/auto_generated_images/img_4a95f58109.gif"  BORDER=0  ALT=" Listing 4b - METADEMO.FRM " ></TD>
	<TD WIDTH=158><IMG SRC="../assets/auto_generated_images/img_3dfbb805.gif" WIDTH =158 HEIGHT =1 BORDER=0></TD>
	<TD WIDTH=763><IMG SRC="../assets/auto_generated_images/img_3dfbb805.gif" WIDTH =763 HEIGHT =1 BORDER=0></TD>
   </TR>
   <TR VALIGN="top" ALIGN="left">
	<TD COLSPAN=4 HEIGHT =10></TD>
   </TR>
   <TR VALIGN="top" ALIGN="left">
	<TD HEIGHT =48></TD>
	<TD WIDTH=468 COLSPAN=2 ALIGN="left" VALIGN="top"><A HREF="../html/listings.html"><IMG HEIGHT=48 WIDTH=48 SRC="../assets/images/Hand_Icon_Up.gif"  BORDER=0  ALT="Picture" ></A></TD>
	<TD></TD>
   </TR>
  </TABLE>

  <TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH=1243>
   <TR VALIGN="top" ALIGN="left">
	<TD WIDTH=12 HEIGHT =7><IMG SRC="../assets/auto_generated_images/img_3dfbb805.gif" WIDTH =12 HEIGHT =1 BORDER=0></TD>
	<TD WIDTH=494><IMG SRC="../assets/auto_generated_images/img_3dfbb805.gif" WIDTH =494 HEIGHT =1 BORDER=0></TD>
	<TD WIDTH=737><IMG SRC="../assets/auto_generated_images/img_3dfbb805.gif" WIDTH =737 HEIGHT =1 BORDER=0></TD>
   </TR>
   <TR VALIGN="top" ALIGN="left">
	<TD></TD>
	<TD WIDTH=494><P><FONT SIZE="-2" FACE="Courier New,Courier">VERSION 2.00</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">Begin Form MetaDemo </FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp;&nbsp; Caption&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =&nbsp;&nbsp; &quot;Metafile Demo&quot;</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp;&nbsp; ClientHeight&nbsp;&nbsp;&nbsp; =&nbsp;&nbsp; 3084</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp;&nbsp; ClientLeft&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =&nbsp;&nbsp; 888</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp;&nbsp; ClientTop&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =&nbsp;&nbsp; 2052</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp;&nbsp; ClientWidth&nbsp;&nbsp;&nbsp;&nbsp; =&nbsp;&nbsp; 4284</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp;&nbsp; Height&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =&nbsp;&nbsp; 3828</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp;&nbsp; Left&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =&nbsp;&nbsp; 840</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp;&nbsp; LinkTopic&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =&nbsp;&nbsp; &quot;Form2&quot;</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp;&nbsp; ScaleHeight&nbsp;&nbsp;&nbsp;&nbsp; =&nbsp;&nbsp; 3084</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp;&nbsp; ScaleWidth&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =&nbsp;&nbsp; 4284</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp;&nbsp; Top&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =&nbsp;&nbsp; 1356</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp;&nbsp; Width&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =&nbsp;&nbsp; 4380</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp;&nbsp; Begin CommonDialog Common_Dialog </FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Left&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =&nbsp;&nbsp; 120</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Top&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =&nbsp;&nbsp; 2640</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp;&nbsp; End</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp;&nbsp; Begin PictureBox Picture_Box </FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Height&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =&nbsp;&nbsp; 2412</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Left&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =&nbsp;&nbsp; 120</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ScaleHeight&nbsp;&nbsp;&nbsp;&nbsp; =&nbsp;&nbsp; 2388</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ScaleWidth&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =&nbsp;&nbsp; 4068</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TabIndex&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =&nbsp;&nbsp; 0</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Top&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =&nbsp;&nbsp; 120</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Width&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =&nbsp;&nbsp; 4092</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp;&nbsp; End</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp;&nbsp; Begin Menu Menu_File </FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Caption&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =&nbsp;&nbsp; &quot;&amp;File&quot;</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Begin Menu Menu_File_Create </FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Caption&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =&nbsp;&nbsp; &quot;&amp;Create ...&quot;</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Begin Menu Menu_File_Open </FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Caption&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =&nbsp;&nbsp; &quot;&amp;Open ...&quot;</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Begin Menu Menu_Bar1 </FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Caption&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =&nbsp;&nbsp; &quot;-&quot;</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Begin Menu Menu_File_Exit </FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Caption&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =&nbsp;&nbsp; &quot;E&amp;xit&quot;</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp;&nbsp; End</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">End</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">' METADEMO.FRM</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">Option Explicit</FONT></P><P>&nbsp;</P><P><FONT SIZE="-2" FACE="Courier New,Courier">Sub Form_Load ()</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; ' Center the form on the screen</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; Left = Screen.Width / 2 - ScaleWidth / 2</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; Top = Screen.Height / 2 - ScaleHeight / 2</FONT></P><P>&nbsp;</P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; ' Initialize the Common Dialog control</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; Common_Dialog.CancelError = True</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; Common_Dialog.DefaultExt = &quot;WMF&quot;</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; Common_Dialog.Filter = &quot;All Files (*.*)|*.*|Metafiles (*.WMF)|*.WMF&quot;</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; Common_Dialog.FilterIndex = 2</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; Common_Dialog.InitDir = App.Path</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">End Sub</FONT></P><P>&nbsp;</P><P><FONT SIZE="-2" FACE="Courier New,Courier">Sub Form_Resize ()</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; Picture_Box.Top = 100</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; Picture_Box.Left = 100</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; Picture_Box.Width = ScaleWidth - 200</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; Picture_Box.Height = ScaleHeight - 200</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">End Sub</FONT></P><P>&nbsp;</P><P><FONT SIZE="-2" FACE="Courier New,Courier">Sub Menu_File_Create_Click ()</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; Dim metafile As Integer</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; Dim ivar As Integer</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; Dim lvar As Long</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; Dim lb As LOGBRUSH</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; Dim brush As Integer</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; Dim oldbrush As Integer</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; Dim i As Integer</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; Dim x As Integer</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; Dim y As Integer</FONT></P><P>&nbsp;</P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; ' Get a filename</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; Common_Dialog.DialogTitle = &quot;Create Metafile&quot;</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; Common_Dialog.Flags = &amp;H802&amp;</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; On Local Error GoTo Create_Metafile_Error</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; Common_Dialog.Action = 2</FONT></P><P>&nbsp;</P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; Screen.MousePointer = 11</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; </FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; ' Open the metafile</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; metafile = Meta_File_Create((Common_Dialog.Filename), -500, 499, -500, 499, 1000)</FONT></P><P>&nbsp;</P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; ' Set mapping</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; ivar = Meta_SetWindowOrg(metafile, -500, 499)</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; ivar = Meta_SetWindowExt(metafile, 1000, -1000)</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; ivar = Meta_SetMapMode(metafile, MM_ANISOTROPIC)</FONT></P><P>&nbsp;</P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; ' Draw lines</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; ivar = Meta_MoveTo(metafile, 300, 0)</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; For i = 0 To 6283 Step 118</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp;&nbsp;&nbsp; x = Cos(i / 100#) * 300</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp;&nbsp;&nbsp; y = Sin(i / 100#) * 300</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp;&nbsp;&nbsp; ivar = Meta_LineTo(metafile, x, y)</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; Next</FONT></P><P>&nbsp;</P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; ' Set fill style and color</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; lb.lbStyle = BS_HATCHED</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; lb.lbColor = QBColor(5)</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; lb.lbHatch = HS_DIAGCROSS</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; brush = Meta_CreateBrushIndirect(metafile, lb)</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; oldbrush = Meta_SelectObject(metafile, brush)</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp;</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; ' Draw an ellipse</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; ivar = Meta_Ellipse(metafile, -100, -100, 100, 100)</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; </FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; ' Free the brush</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; oldbrush = Meta_SelectObject(metafile, oldbrush)</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; ivar = Meta_DeleteObject(metafile, brush)</FONT></P><P>&nbsp;</P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; ' Close the metafile</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; Meta_File_Close (metafile)</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; </FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; Screen.MousePointer = 0</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; </FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; MsgBox Common_Dialog.Filename, 48, &quot;Created&quot;</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; Exit Sub</FONT></P><P>&nbsp;</P><P><FONT SIZE="-2" FACE="Courier New,Courier">Create_Metafile_Error:</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; If Err = 32755 Then Exit Sub 'Cancel</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; MsgBox Error$, 48, Common_Dialog.Filename</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; Exit Sub</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">End Sub</FONT></P><P>&nbsp;</P><P><FONT SIZE="-2" FACE="Courier New,Courier">Sub Menu_File_Exit_Click ()</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; Hide</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; Unload Me</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">End Sub</FONT></P><P>&nbsp;</P><P><FONT SIZE="-2" FACE="Courier New,Courier">Sub Menu_File_Open_Click ()</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; ' Get filename</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; Common_Dialog.DialogTitle = &quot;Open Metafile&quot;</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; Common_Dialog.Flags = &amp;H1004&amp;</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; On Local Error GoTo Open_Metafile_Error</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; Common_Dialog.Action = 1</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; </FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; ' Display Picture</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; Picture_Box.Cls</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; Picture_Box.Picture = LoadPicture(Common_Dialog.Filename)</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; </FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; Exit Sub</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">Open_Metafile_Error:</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; If Err = 32755 Then Exit Sub 'Cancel</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; MsgBox Error$, 48, Common_Dialog.Filename</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">&nbsp; Exit Sub</FONT></P><P><FONT SIZE="-2" FACE="Courier New,Courier">End Sub</FONT></TD>

	<TD></TD>
   </TR>
  </TABLE>

  <TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0>
   <TR VALIGN="top" ALIGN="left">
	<TD WIDTH=19 HEIGHT =23><IMG SRC="../assets/auto_generated_images/img_3dfbb805.gif" WIDTH =19 HEIGHT =1 BORDER=0></TD>
	<TD WIDTH=431><IMG SRC="../assets/auto_generated_images/img_3dfbb805.gif" WIDTH =431 HEIGHT =1 BORDER=0></TD>
	<TD WIDTH=793><IMG SRC="../assets/auto_generated_images/img_3dfbb805.gif" WIDTH =793 HEIGHT =1 BORDER=0></TD>
   </TR>
   <TR VALIGN="top" ALIGN="left">
	<TD></TD>
	<TD NOWRAP> [<A HREF="../index.html">Home</A>]  [<A HREF="../html/meta_files.html">Meta&nbsp;Files</A>]  [<A HREF="../html/review__hardcore_visual_basic.html">Hardcore&nbsp;VB</A>]  [<A HREF="../html/what_s_wrong_with_vb_.html">What's&nbsp;Wrong?</A>]  [<A HREF="../html/jpg_and_gif_sizes.html">Image&nbsp;Sizes</A>] </TD>
	<TD></TD>
   </TR>
   <TR VALIGN="top" ALIGN="left">
	<TD COLSPAN=3 HEIGHT =975></TD>
   </TR>
  </TABLE>
</TD>
</TR>
</TABLE>
</BODY>
</HTML>

