ID=F0092
URL=http://www.vbsquare.com/php-bin/jump.php?linkid=52
SIZE=37030
DATE=09/07/2002
TIME=13:14:38
DATASET=Visual Basic
HTML=
<HTML>

<HEAD>

   <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">

   <META NAME="Author" CONTENT="Zafir Anjum">

   <TITLE>VB CodeGuru: [an error occurred while processing this directive]FTP Access through a Class Module for VB5/6 - Requires WinInet.DLL</TITLE>

</HEAD>




<TITLE>Codeguru - Visual Basic</TITLE>

<META NAME="Author" CONTENT="developer.com">


<META NAME="Keywords" CONTENT="visual c++ java vb source code software downloads freeware shareware visual basic c++ web development general internet internet security news articles directory reference sample example guide tutorial help resource developer discussion earthweb developer.com">

<META NAME="description" CONTENT="Developer.com offers dedicated downloads for the IT professional developer. Features include visual c++, java, visual basic, vb, source code and more.>
<META NAME="distribution" CONTENT="global">
<META NAME="resource-type" CONTENT="document">
<META NAME="language" CONTENT="en">
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000" 
LINK="#DD0000" VLINK="#999999" ALINK="#FF0000" ALT="wave">

<!-- OLD: <BODY BACKGROUND="/images/curve_codeguru.gif" BGCOLOR="#FFFFFF" TEXT="#000000" LINK="#DD0000" VLINK="#999999" ALINK="#FF0000" ALT="wave">-->


<!-- begin logo and top banner ad table -->

<TABLE width="100%" cellpadding="0" cellspacing="0">
<TR>
<TD VALIGN="TOP">

  <A HREF="http://www.earthweb.com" TARGET="_top">
  <IMG SRC="/images/eweb_banner.gif" WIDTH="640" HEIGHT="25" BORDER="0"
  ALT="EarthWeb"></a>

<TR>
<TD align="center">

<table width="750" cellpadding="0" cellspacing="0" border="0" background="http://www.codeguru.com/RealMedia/ads/Creatives/House_Interactive_Research_1a/bg.gif"><tr><td width="265" valign="top"><a href="http://www.codeguru.com/RealMedia/ads/click_lx.ads/ew/ewsoftware/www.codeguru.com/vb/articles/1852.shtml/31454/468x60-1/House_Interactive_Research_1a/Interactive_Research_banner.html/38366531313035623364326164333930?_RM_REDIR_=www.intmediaresearch.com">
<img src="http://www.codeguru.com/RealMedia/ads/Creatives/House_Interactive_Research_1a/intresearchbanner1.gif" width="265" height="81" border="0"></a></td><td width="485"><table width="485" cellpadding="0" cellspacing="0" border="0"><tr><td width="485" colspan="3">
<img src="http://www.codeguru.com/RealMedia/ads/Creatives/House_Interactive_Research_1a/intresearchbanner2.gif" width="485" height="25" border="0"></td></tr><tr><td width="25" valign="top">
<img src="http://www.codeguru.com/RealMedia/ads/Creatives/House_Interactive_Research_1a/l-top.gif" width="25" height="17" border="0"></td><td width="440" rowspan="3" background="http://www.codeguru.com/RealMedia/ads/Creatives/House_Interactive_Research_1a/w.gif">
<img src="http://www.codeguru.com/RealMedia/ads/Creatives/House_Interactive_Research_1a/sp.gif" width="440" height="1"><br><font face="verdana,arial,helvetica" size="-2">
<!--begin content--><a href="http://www.codeguru.com/RealMedia/ads/click_lx.ads/ew/ewsoftware/www.codeguru.com/vb/articles/1852.shtml/31454/468x60-1/House_Interactive_Research_1a/Interactive_Research_banner.html/38366531313035623364326164333930?_RM_REDIR_=redir.internet.com/houseads/research/allnetresearch.internet.com/item/0,3008,2333961_1,00.html">Enterprise IM: A Baseline Study of Business Trends</a><br>
<a href="http://www.codeguru.com/RealMedia/ads/click_lx.ads/ew/ewsoftware/www.codeguru.com/vb/articles/1852.shtml/31454/468x60-1/House_Interactive_Research_1a/Interactive_Research_banner.html/38366531313035623364326164333930?_RM_REDIR_=redir.internet.com/houseads/research/allnetresearch.internet.com/item/0,3008,2334477_1,00.html">ISP Evolution: Providing Services for the 21st Century</a><br>
<a href="http://www.codeguru.com/RealMedia/ads/click_lx.ads/ew/ewsoftware/www.codeguru.com/vb/articles/1852.shtml/31454/468x60-1/House_Interactive_Research_1a/Interactive_Research_banner.html/38366531313035623364326164333930?_RM_REDIR_=redir.internet.com/houseads/research/allnetresearch.internet.com/item/0,3008,2333923_1,00.html">VoiceXML for Business Managers</a><br>
<a href="http://www.codeguru.com/RealMedia/ads/click_lx.ads/ew/ewsoftware/www.codeguru.com/vb/articles/1852.shtml/31454/468x60-1/House_Interactive_Research_1a/Interactive_Research_banner.html/38366531313035623364326164333930?_RM_REDIR_=redir.internet.com/houseads/research/allnetresearch.internet.com/item/0,3008,2333855_1,00.html">Dissecting the.NET Framework</a><br>
<a href="http://www.codeguru.com/RealMedia/ads/click_lx.ads/ew/ewsoftware/www.codeguru.com/vb/articles/1852.shtml/31454/468x60-1/House_Interactive_Research_1a/Interactive_Research_banner.html/38366531313035623364326164333930?_RM_REDIR_=redir.internet.com/houseads/research/allnetresearch.internet.com/item/0,3008,2331783_1,00.html">Search Engine Submission Essentials</a><br>
<!--end content-->
</font></td><td width="20" valign="top"><img src="http://www.codeguru.com/RealMedia/ads/Creatives/House_Interactive_Research_1a/r-top.gif" width="20" height="17" border="0"></td></tr><tr><td width="25" background="http://www.codeguru.com/RealMedia/ads/Creatives/House_Interactive_Research_1a/l-bg.gif"><img src="http://www.codeguru.com/RealMedia/ads/Creatives/House_Interactive_Research_1a/sp.gif" width="25" height="33"></td><td width="20" background="http://www.codeguru.com/RealMedia/ads/Creatives/House_Interactive_Research_1a/r-bg.gif"><img src="http://www.codeguru.com/RealMedia/ads/Creatives/House_Interactive_Research_1a/sp.gif" width="20" height="33"></td></tr><tr><td width="25"><img src="http://www.codeguru.com/RealMedia/ads/Creatives/House_Interactive_Research_1a/l-btm.gif" width="25" height="15"></td><td width="20">
<img src="http://www.codeguru.com/RealMedia/ads/Creatives/House_Interactive_Research_1a/r-btm.gif" width="20" height="15"></td></tr><tr><td width="485" valign="bottom" colspan="3">
<img src="http://www.codeguru.com/RealMedia/ads/Creatives/House_Interactive_Research_1a/btm.gif" width="485" height="10" border="0"></td></tr></table></td></tr></table><IMG SRC="http://www.codeguru.com/RealMedia/ads/adstream_lx.cgi/ew/ewsoftware/www.codeguru.com/vb/articles/1852.shtml/31454/468x60-1/House_Interactive_Research_1a/Interactive_Research_banner.html/38366531313035623364326164333930?_RM_EMPTY_" WIDTH=1 HEIGHT=1>


</TD>
</TR>
</TABLE>

<!-- end logo and top banner ad table -->

<!-- begin lower outer table -->
<TABLE width=100% cellpadding="0" cellspacing="0" border="0">
  <TR align="top">
    <TD VALIGN="TOP" >
      <!-- navbar-downloads-codeguru-vb.html - navbar info -->

    <link rel="stylesheet" href="/global/global.css">

<table border=1 cellpadding=0 cellspacing=0 bgcolor="#EFEFEF">
<tr><td>

<table border=0 cellpadding=5 cellspacing=0 width=150>
   <tr>
     <td align="center">
      <A HREF="/">
        <IMG SRC="/images/logo_cobrand.gif" BORDER="0" ALT="Developer.com">
      </a>
      </td>
   </tr>
   <tr>
     <td align="center">
     <A HREF="http://www.codeguru.com/RealMedia/ads/click_lx.cgi/ew/ewsoftware/www.codeguru.com/vb/articles/1852.shtml/10005/125x125-1/House_Career_Channel_11g/webopediajobs-125.gif/38366531313035623364326164333930" target="_top"><IMG SRC="http://www.codeguru.com/RealMedia/ads/Creatives/House_Career_Channel_11g/webopediajobs-125.gif"  WIDTH=125 HEIGHT=125 ALT=""  BORDER="0"></A><img src="http://www.codeguru.com/RealMedia/ads/adstream_lx.cgi/ew/ewsoftware/www.codeguru.com/vb/articles/1852.shtml/10005/125x125-1/House_Career_Channel_11g/webopediajobs-125.gif/38366531313035623364326164333930?_RM_EMPTY_" Width="1" Height="1" Border="0">
     </td>
   </tr>
<!--</table> blj-xyz -->

<!-- </td></tr> blj-xyz -->
<tr><td>
<!-- changed by Allison McHenry 4/6/2001 #3 -->
<table width=130 border=0 cellpadding=0 cellspacing=0>

	<tr>

		<td>
	<!-- SEARCH FORM-->
    <form method="post"
action="http://search.internet.com/codeguru.earthweb.com">
    <input type="hidden" name="IC_StartNumber" value="0">
    <input type="hidden" name="IC_BatchSize" value="10">
    <input type="hidden" name="IC_RelevanceThreshold" value="30">
    <input type="hidden"
name="IC_QueryDatabase"  value="codeguru.earthweb.com">
    <input type="text"   name="IC_QueryText" value="" size="10">
    <input type="submit" value="Search">
    </form>
<!-- END OF SEARCH FORM -->


<!--		<IMG src="http://codeguru.developer.com/images/rule.gif" width="105" vspace=3 height="2" ALT="-----">-->
<!-- Removed a </form> tag from here. - Brad!-->
   </td>

	</tr>

</table>



</tr></td>

<tr><td>
<span class="navBarH1">CodeGuru Sites</span>
</td></tr>
<tr><td>
   <small>
     <a href="/index.shtml">Visual C++ / MFC / C++</a><br>
     <a HREF="/csharp/index.shtml">.NET (C# and more)</a><br>
     <a href="/vb/index.shtml">Visual Basic</a><br>
     <a href="http://www.gamelan.com">Gamelan (Java)</a><br>
     <a href="http://www.jars.com">JARs (Java Applets)</a><br>
     <hr>
   </small>

    <a href="/SubmissionsGuidelines.html">
    <font face="verdana, helvetica" color="#000000" size=1>
       submission guidelines
    </font></a>
<br>

<hr>

</td></tr>


<tr><td>
<span class="navBarH1">Interact</span>
</td></tr>
<tr><td>
<small>
   <a href="/cgi-bin/bbs/wt/wwwthreads.pl">Discussion Board</a><br>
<!--   <a href="/vb/NewsGroups" target=_top>Newsgroup</a><BR>-->
   <a href="/vb/openfaq/open_faq.shtml">Open FAQ</a><br>
   <a href = "/vb/cool">What's Cool!</a><br>
<!--   <a href="/vb/sharecode.shtml">Share Code</a><br>-->
   <a TARGET=_top href="/cgi-bin/recommend.cgi">Recommend Us!</a><br>
   <a href="/Guestbook/guestbook.shtml">Guest Book</a><br>
<hr>
 </small>
</td></tr>

<tr><td><span class="navBarH1">Of Interest</span></td></tr>
    <tr><td nowrap>
        <small>
       <a href="/announcements/dotnetbooks.html">Books on .NET</a><br>
       <a HREF="/bookReviews/index.shtml">Book Reviews</a><br>
       <a href="/newsletters/index.shtml">Newsletters (archived)</a><br> 
          <a href="/about.shtml">About Us</a><br>
          <hr>
        </small>
  </td></tr>

<tr><td>

<tr><td><span class="navBarH1">VB Resources</span></td></tr>
    <tr><td nowrap>
 <small>
   <a href="/vb/links/add.cgi">add resource</a><br>
   <a href="/vb/links/modify.cgi">modify resource</a><br>
   <a href="/vb/new">new resource</a><br>    
 </small>
<hr>
</td></tr>


    <tr><td><span class="navBarH1">Visual Basic<br>Article Sections</span></td></tr>

    <tr><td>
      <span class="navBarH2">Controls</span><br>
      <small>
        <a href="/vbnet_controls/index.shtml">controls</a><br>
      <br><em>Articles and sections are being moved here! Stay tuned!</em>


      </small><hr>
    </td></tr>



  <tr><td>
 <!-- JOB BUTTON --> 
    <table border=0 cellpadding=5 cellspacing=0 width=150>
    <tr><td align="center">
       <a href="http://jobs.internet.com" target="new">
         <IMG SRC="http://www.codeguru.com/jobs.gif" alt="[Internet Jobs]">
       </a>
    </td></tr>
    </table>
</td></tr>


<!-- Commerce bar stuff added temporarily -->
<tr><td>
<br>
<table align="center" border="0" cellpadding="3" width="148">
<tr bgcolor="black"><td>
<font face="Arial" color="white" size="1" >
<b><center>internet.commerce</center></b></font></td></tr>


<tr bgcolor="lightgrey"><td>
<font face="Arial" size="1" >
<a href="http://www.internet.com/partners/">Be a Commerce Partner</A><BR>
<a href="http://www.codeguru.com/RealMedia/ads/click_lx.cgi/ew/ewsoftware/www.codeguru.com/vb/articles/1852.shtml/9613/cp1/PriceGrabber.com_2d/ComparisonShopping.html/38366531313035623364326164333930">Comparison Shopping</a>
<IMG SRC="http://www.codeguru.com/RealMedia/ads/adstream_lx.cgi/ew/ewsoftware/www.codeguru.com/vb/articles/1852.shtml/9613/cp1/PriceGrabber.com_2d/ComparisonShopping.html/38366531313035623364326164333930?_RM_EMPTY_" WIDTH=1 HEIGHT=1>
<BR>
<a href="http://www.codeguru.com/RealMedia/ads/click_lx.cgi/ew/ewsoftware/www.codeguru.com/vb/articles/1852.shtml/31461/cp2/DealTime_3b/dealtime.html/38366531313035623364326164333930">Compare Prices</a>
<IMG SRC="http://www.codeguru.com/RealMedia/ads/adstream_lx.cgi/ew/ewsoftware/www.codeguru.com/vb/articles/1852.shtml/31461/cp2/DealTime_3b/dealtime.html/38366531313035623364326164333930?_RM_EMPTY_" WIDTH=1 HEIGHT=1><BR>
<a href="http://www.codeguru.com/RealMedia/ads/click_lx.cgi/ew/ewsoftware/www.codeguru.com/vb/articles/1852.shtml/20540/cp3/Imsisoft_2a/ForWebGraphics.html/38366531313035623364326164333930">For Web Graphics</a>
<IMG SRC="http://www.codeguru.com/RealMedia/ads/adstream_lx.cgi/ew/ewsoftware/www.codeguru.com/vb/articles/1852.shtml/20540/cp3/Imsisoft_2a/ForWebGraphics.html/38366531313035623364326164333930?_RM_EMPTY_" WIDTH=1 HEIGHT=1><BR>
<a href="http://www.codeguru.com/RealMedia/ads/click_lx.cgi/ew/ewsoftware/www.codeguru.com/vb/articles/1852.shtml/9620/cp4/UltraDNS_9e/FreeDNSOffer.html/38366531313035623364326164333930">Free DNS Offer</a>
<IMG SRC="http://www.codeguru.com/RealMedia/ads/adstream_lx.cgi/ew/ewsoftware/www.codeguru.com/vb/articles/1852.shtml/9620/cp4/UltraDNS_9e/FreeDNSOffer.html/38366531313035623364326164333930?_RM_EMPTY_" WIDTH=1 HEIGHT=1><BR>
<a href="http://www.codeguru.com/RealMedia/ads/click_lx.cgi/ew/ewsoftware/www.codeguru.com/vb/articles/1852.shtml/31467/cp5/Global_Reports_2a/FindAnnualReports.html/38366531313035623364326164333930">Find Annual Reports</a>
<IMG SRC="http://www.codeguru.com/RealMedia/ads/adstream_lx.cgi/ew/ewsoftware/www.codeguru.com/vb/articles/1852.shtml/31467/cp5/Global_Reports_2a/FindAnnualReports.html/38366531313035623364326164333930?_RM_EMPTY_" WIDTH=1 HEIGHT=1>
<BR>
<a href="http://www.codeguru.com/RealMedia/ads/click_lx.cgi/ew/ewsoftware/www.codeguru.com/vb/articles/1852.shtml/20547/cp6/Rawhide_3b/Rawhide_text.html/38366531313035623364326164333930">Search Marketplace</a>
<IMG SRC="http://www.codeguru.com/RealMedia/ads/adstream_lx.cgi/ew/ewsoftware/www.codeguru.com/vb/articles/1852.shtml/20547/cp6/Rawhide_3b/Rawhide_text.html/38366531313035623364326164333930?_RM_EMPTY_" WIDTH=1 HEIGHT=1><BR>
<a href="http://www.codeguru.com/RealMedia/ads/click_lx.cgi/ew/ewsoftware/www.codeguru.com/vb/articles/1852.shtml/9626/cp7/Dice_16b/dice_careerbuilder_text.html/38366531313035623364326164333930">Internet Jobs</a>


<IMG SRC="http://www.codeguru.com/RealMedia/ads/adstream_lx.cgi/ew/ewsoftware/www.codeguru.com/vb/articles/1852.shtml/9626/cp7/Dice_16b/dice_careerbuilder_text.html/38366531313035623364326164333930?_RM_EMPTY_" WIDTH=1 HEIGHT=1>
<BR>
<a href="http://www.codeguru.com/RealMedia/ads/click_lx.cgi/ew/ewsoftware/www.codeguru.com/vb/articles/1852.shtml/31474/cp8/Kaspersky_Lab_4d/AntiVirusSoftware.html/38366531313035623364326164333930">Anti-Virus Software</a>
<IMG SRC="http://www.codeguru.com/RealMedia/ads/adstream_lx.cgi/ew/ewsoftware/www.codeguru.com/vb/articles/1852.shtml/31474/cp8/Kaspersky_Lab_4d/AntiVirusSoftware.html/38366531313035623364326164333930?_RM_EMPTY_" WIDTH=1 HEIGHT=1>
<BR>
<a href="http://www.codeguru.com/RealMedia/ads/click_lx.cgi/ew/ewsoftware/www.codeguru.com/vb/articles/1852.shtml/20553/cp9/rfpMarket_Inc_8c/FindAWebDeveloper.html/38366531313035623364326164333930">Find A Web Developer</a>
<IMG SRC="http://www.codeguru.com/RealMedia/ads/adstream_lx.cgi/ew/ewsoftware/www.codeguru.com/vb/articles/1852.shtml/20553/cp9/rfpMarket_Inc_8c/FindAWebDeveloper.html/38366531313035623364326164333930?_RM_EMPTY_" WIDTH=1 HEIGHT=1>
<BR>
<a href="http://www.codeguru.com/RealMedia/ads/click_lx.cgi/ew/ewsoftware/www.codeguru.com/vb/articles/1852.shtml/9633/cp10/IBart.com_13c/ibart.html/38366531313035623364326164333930">Free Barter Account</a>
<IMG SRC="http://www.codeguru.com/RealMedia/ads/adstream_lx.cgi/ew/ewsoftware/www.codeguru.com/vb/articles/1852.shtml/9633/cp10/IBart.com_13c/ibart.html/38366531313035623364326164333930?_RM_EMPTY_" WIDTH=1 HEIGHT=1>
<BR>

</font>
</td></tr>
</table>
<br>
</td>
</tr>
<!-- End of Commerce bar stuff -->

</table> <!--blj-xyz-->

<br>
 </table>
<!--/navbar>

    </TD>

    <td valign="top" width="20">&nbsp;</font></td>

    <TD VALIGN="TOP" width="468" >
      <table cellpadding="0" cellspacing="0" bgcolor="#EFEFEF">
      <tr align="top">
      <!-- Chris Eastwood, March 2000 - Test -->
      <td valign="top">
      <!-- Chris Eastwood - End -->

      <!-- begin main content column -->

      <!-- 
      <TD VALIGN="TOP" width="360">
      <P>
      <a href="/downloads/code">
      <img src="/images/downloads_code.gif" width="360" height="67" alt="DOWNLOADS: Code" border="0"></a>
      <br>
      -->







<center><h2>FTP Access through a Class Module for VB5/6 - Requires WinInet.DLL</h2></center>
<hr><blockquote>
Author: <A HREF="mailto:chris.eastwood@codeguru.com">Chris Eastwood</A><br>
Author's WebSite: <a href="http://www.eastwood60.freeserve.co.uk">http://www.eastwood60.freeserve.co.uk</a>
<P><h4>FTP Access through a Class Module - Requires WinInet.DLL </h4>  

<p>The attached project contains a re-usable class module that encapsulates the FTP API commands available through the WinInet.DLL.  

<p><img SRC="1852_Image1.gif" ALT="Screen shot ">  

<p>It should be pointed out that this class module uses a Disconnected Recordset and therefore requires a reference to Microsoft ActiveX Data Objects Recordset Library 2.1 Library. You could remove this dependancy by simply returning a collection of Objects for each file found in the FTP directory.  

<p>All of the FTP work is carried out in the class module supplied with the project. The <b>cFTP </b> class can be dropped into any project that needs FTP access, and exposes the properties :  

<p>- <b>Host </b> 
<br>- <b>User </b> 
<br>- <b>Password </b> 
<br>- <b>Directory </b> 
<br>- <b>Connected </b>  - (returns True/False depending on connection state)  

<p>The following methods are also provided :  

<p><pre><tt><font COLOR=#990000>
<font color=#0000ff>public</font> Function Connect(<font color=#0000ff>optional</font> Host <font color=#0000ff>as</font> <font color=#0000ff>string</font>, _
    <font color=#0000ff>optional</font> User <font color=#0000ff>as</font> <font color=#0000ff>string</font>, _
    <font color=#0000ff>optional</font> Password <font color=#0000ff>as</font> <font color=#0000ff>string</font>) <font color=#0000ff>as</font> Boolean
<br></font></tt></pre>  

<p>- This function connects to the required FTP server using the User and Password parameters (if supplied - otherwise, the standard properties are used).  

<p><pre><tt><font COLOR=#990000>
<font color=#0000ff>public</font> Function GetFile(<font color=#0000ff>byval</font> ServerFileAndPath <font color=#0000ff>as</font> <font color=#0000ff>string</font>, _
	<font color=#0000ff>byval</font> DestinationFileAndPath <font color=#0000ff>as</font> <font color=#0000ff>string</font>, _
	<font color=#0000ff>optional</font> TransferType <font color=#0000ff>as</font> FileTransferType = ftAscii) <font color=#0000ff>as</font> Boolean
<br></font></tt></pre>  

<p>- Downloads a file from the FTP server  

<p><pre><tt><font COLOR=#990000>
<font color=#0000ff>public</font> Function PutFile(<font color=#0000ff>byval</font> LocalFileAndPath <font color=#0000ff>as</font> <font color=#0000ff>string</font>, _
	<font color=#0000ff>byval</font> ServerFileAndPath <font color=#0000ff>as</font> <font color=#0000ff>string</font>, _
	<font color=#0000ff>optional</font> TransferType <font color=#0000ff>as</font> FileTransferType) <font color=#0000ff>as</font> Boolean
<br></font></tt></pre>  

<p>- Uploads a file to the FTP server  

<p><pre><tt><font COLOR=#990000>
<font color=#0000ff>public</font> Function RenameFile(<font color=#0000ff>byval</font> ExistingName <font color=#0000ff>as</font> <font color=#0000ff>string</font>, _
	<font color=#0000ff>byval</font> NewName <font color=#0000ff>as</font> <font color=#0000ff>string</font>) <font color=#0000ff>as</font> Boolean
<br></font></tt></pre>  

<p>- renames a file on the FTP server  

<p><pre><tt><font COLOR=#990000>
<font color=#0000ff>public</font> Function DeleteFile(<font color=#0000ff>byval</font> ExistingName <font color=#0000ff>as</font> <font color=#0000ff>string</font>) <font color=#0000ff>as</font> Boolean
<br></font></tt></pre>  

<p>- delete's a file from the FTP server  

<p><pre><tt><font COLOR=#990000>
<font color=#0000ff>public</font> Function GetDirectoryList(<font color=#0000ff>optional</font> Directory <font color=#0000ff>as</font> <font color=#0000ff>string</font>, _
	<font color=#0000ff>optional</font> FilterString <font color=#0000ff>as</font> <font color=#0000ff>string</font>) <font color=#0000ff>as</font> ADOR.Recordset
<br></font></tt></pre>  

<p>- this routine returns a disconnected RecordSet containing the current
<br>directory listing from the FTP server. You could easily change the code 
<br>in this routine to identify Directories, different file types etc. I've 
<br>left the recordset containing just the Name of the file entry so that 
<br>it can be modified as required.  

<p>
<br>If you don't have ADO 2 installed on your machine, you can remove the 
<br>reference and simply return a collection of filenames / objects / 
<br>whatever from this routine.  

<p><pre><tt><font COLOR=#990000>
<font color=#0000ff>public</font> Function Disconnect() <font color=#0000ff>as</font> Boolean
<br></font></tt></pre>  

<p>- Disconnects from the FTP server  

<p> 
<br>A sample of using the code in another project could be :  

<p><pre><tt><font COLOR=#990000>

Dim oFTP <font color=#0000ff>as</font> cFTP
<font color=#009900>'</font>
<font color=#0000ff>set</font> oFTP = <font color=#0000ff>new</font> cFTP
oFTP.Connect &quot;ftp.somewhere.com&quot;, &quot;anonymous&quot;, &quot;chris@here.now&quot;
oFTP.Directory = &quot;downloads&quot;
oFTP.GetFile &quot;test.zip&quot;, &quot;c:\downloads\test.zip&quot;
oFTP.Disconnect
<font color=#0000ff>set</font> oFTP = <font color=#0000ff>nothing</font>

<p></font></tt></pre>

<p>That's really all there is to it - Enjoy the code !

<p><a HREF="1852_CGFTP.zip">Download Zipped Project File (20k) </a>
<br>
<P>Posted On: 30-Jul-1999
</blockquote>
<!--comments-->
<h3>Comments:</h3><ul>
<!--startlist-->
<li><a href="/vb/comments/1124.shtml">Code for timeout on connection</a> - Olav Alexander Mjelde (2002/06/20)

<li><a href="/vb/comments/1123.shtml">Code for going into the folders (with listbox)</a> - Olav Alexander Mjelde (2002/06/20)

<li><a href="/vb/comments/1122.shtml">Download function with ascii/binary detector</a> - Olav Alexander Mjelde (2002/06/20)

<li><a href="/vb/comments/1121.shtml">I will make a download function</a> - Olav Alexander Mjelde (2002/06/20)

<li><a href="/vb/comments/1120.shtml">Here is code for going up one folder</a> - Olav Alexander Mjelde (2002/06/20)

<li><a href="/vb/comments/1102.shtml">Many Thanks</a> - Allen (2002/06/07)

<li><a href="/vb/comments/1098.shtml">How generous!</a> - Bill (2002/06/05)

<li><a href="/vb/comments/1066.shtml">how to stop a transfer in progress</a> - sandeep (2002/05/19)

<li><a href="/vb/comments/1047.shtml">FTP Access through a Class Module for VB5/6 - Requires WinInet.DLL</a> - Datta Shetty (2002/05/02)

<li><a href="/vb/comments/1031.shtml">Great  class</a> - DaveMack (2002/04/24)

<li><a href="/vb/comments/1025.shtml">How can i get the Information of Special File in the FTP Site?</a> - HJ, Yoo (2002/04/19)

<li><a href="/vb/comments/1018.shtml">Proxy</a> - Frank (2002/04/12)

<li><a href="/vb/comments/984.shtml">How do I download? Anyone know a code?</a> - Evil X Genie (2002/03/21)

<li><a href="/vb/comments/983.shtml">How do I download? Anyone know a code?</a> - Evil X Genie (2002/03/21)

<li><a href="/vb/comments/914.shtml">Date and Time of A File</a> - Rajan Bansal (2002/01/25)

<li><a href="/vb/comments/905.shtml">Cannot download!! [Could not get file.....]</a> - Timpi (2002/01/19)

<li><a href="/vb/comments/897.shtml">File date time information</a> - Cyprien de Cosson (2002/01/15)

<li><a href="/vb/comments/896.shtml">Ca marche !</a> - Thierry (2002/01/15)

<li><a href="/vb/comments/889.shtml">Need Guidance for using this code on VSAT links, 100 users simultns...</a> - Rohit (2002/01/13)

<li><a href="/vb/comments/869.shtml">FTP-Upload/Download Buttons</a> - Vijay (2001/12/28)

<li><a href="/vb/comments/851.shtml">Thanks</a> - Rita (2001/12/11)

<li><a href="/vb/comments/849.shtml">Error during downloading</a> - Anindita (2001/12/10)

<li><a href="/vb/comments/846.shtml">userid and password</a> - Anindita (2001/12/07)

<li><a href="/vb/comments/844.shtml">Image Files </a> - claue (2001/12/04)

<li><a href="/vb/comments/833.shtml">Wildcards with FTPGetFile</a> - FeReNZCy (2001/11/27)

<li><a href="/vb/comments/831.shtml">Progress and or Status.</a> - Niels Middeldorp (2001/11/26)

<li><a href="/vb/comments/817.shtml">Some code not supported in Excel 97?</a> - Texrat (2001/11/15)

<li><a href="/vb/comments/812.shtml">Access in Password File!?</a> - KaTsAriDaS (2001/11/11)

<li><a href="/vb/comments/736.shtml">Change port</a> - Gein (2001/09/30)

<li><a href="/vb/comments/733.shtml">Downloading a file from Web</a> - Kavuri (2001/09/29)

<li><a href="/vb/comments/728.shtml">Can i create an ftp user account for a user programatically</a> - deepak Narain (2001/09/26)

<li><a href="/vb/comments/722.shtml">Cannot connect through Proxy Server. HELP!</a> - Melvin Brooks (2001/09/20)

<li><a href="/vb/comments/718.shtml">Seema Sharma</a> - Seema Sharma (2001/09/18)

<li><a href="/vb/comments/688.shtml">None</a> - ehong (2001/08/23)

<li><a href="/vb/comments/657.shtml">and what about passive mode...???</a> - matmaxx (2001/07/23)

<li><a href="/vb/comments/644.shtml">How to set timeout??? If connection hangs the whole prog hangs too</a> - Walli (2001/06/30)

<li><a href="/vb/comments/643.shtml">ADOR.Recordset Help</a> - Jason Grover (2001/06/29)

<li><a href="/vb/comments/620.shtml">Como puedo hacer un get de varios archivos a la ves..</a> - JEAN CARLOS (2001/05/30)

<li><a href="/vb/comments/619.shtml">Progess Bar</a> - Jason (2001/05/29)

<li><a href="/vb/comments/616.shtml">Como puedo hacer un get de varios archivos a la ves..</a> - JEAN CARLOS (2001/05/26)

<li><a href="/vb/comments/611.shtml">can some one please help me</a> - Gavin (2001/05/21)

<li><a href="/vb/comments/610.shtml">cFTP - excellent code</a> - Eben Yong (2001/05/21)

<li><a href="/vb/comments/601.shtml">HELP !!! unable to download files</a> - philred (2001/05/16)

<li><a href="/vb/comments/599.shtml">Error code</a> - Alberto (2001/05/11)

<li><a href="/vb/comments/594.shtml">How can I set the time-out of the connection?</a> - gerardo (2001/05/08)

<li><a href="/vb/comments/587.shtml">Can't Delete the file after GET</a> - William Chan (2001/05/03)

<li><a href="/vb/comments/585.shtml">Sorting by Date</a> - Ben Hobgood (2001/04/30)

<li><a href="/vb/comments/584.shtml">Keep getting Error User Define type not Define</a> - Mike Vasquez (2001/04/29)

<li><a href="/vb/comments/582.shtml">HELP - server address, username and password as variable?</a> - Kyle (2001/04/28)

<li><a href="/vb/comments/574.shtml">How do you use a Progress bar with this?</a> - Darren (2001/04/18)

<li><a href="/vb/comments/562.shtml">Dont forget to patch the code</a> - Afd (2001/04/10)

<li><a href="/vb/comments/561.shtml">Great code !!!</a> - gerardo (2001/04/10)

<li><a href="/vb/comments/560.shtml">How to run this as a com object</a> - jt (2001/04/09)

<li><a href="/vb/comments/557.shtml">Does anyone know if there is a remote command routine in winInet</a> - Robert Pope (2001/04/05)

<li><a href="/vb/comments/553.shtml">Append function/command</a> - Peter Bui (2001/04/04)

<li><a href="/vb/comments/552.shtml">Good class but..... some bugs??</a> - Jorge (2001/04/03)

<li><a href="/vb/comments/550.shtml">cFTP</a> - Robert Pope (2001/04/03)

<li><a href="/vb/comments/544.shtml">Really great class</a> - webspezi (2001/04/02)

<li><a href="/vb/comments/543.shtml">Really great class</a> - webspezi (2001/04/02)

<li><a href="/vb/comments/531.shtml">URGENT - Files get truncated during upload....</a> - Avin (2001/03/23)

<li><a href="/vb/comments/530.shtml">Excellent but binary....solution!</a> - x.villamuera (2001/03/22)

<li><a href="/vb/comments/507.shtml">Great class, but .... !!!</a> - Riad (2001/02/18)

<li><a href="/vb/comments/495.shtml">FTP: GET How to clear cache?</a> - Andreas Göring (2001/02/02)

<li><a href="/vb/comments/482.shtml">Upload Complete?</a> - Michael Rosola (2001/01/18)

<li><a href="/vb/comments/476.shtml">Error events</a> - Sherman (2001/01/10)

<li><a href="/vb/comments/474.shtml">Problem with WinInet.DLL </a> - Manish Vij (2001/01/09)

<li><a href="/vb/comments/471.shtml">How can others upload to my computer me being the server, then the client</a> - Ben (2001/01/06)

<li><a href="/vb/comments/464.shtml">Error Trapping</a> - Robb (2001/01/05)

<li><a href="/vb/comments/456.shtml">Awsum! Thanks</a> - Pixote (2000/12/28)

<li><a href="/vb/comments/449.shtml">How can you delineate between files and directories on the server side in a list box</a> - Tony Foster (2000/12/21)

<li><a href="/vb/comments/437.shtml">Great class!</a> - KiTuTaNa (2000/12/12)

<li><a href="/vb/comments/427.shtml">GetFile flags: cache problem</a> - Roberto de Fernex (2000/12/05)

<li><a href="/vb/comments/426.shtml">Get directory listing with filter string not working</a> - natarajan Krishnan (2000/12/05)

<li><a href="/vb/comments/423.shtml">Great class!!!  Added  ftpCommand method</a> - Suzanne (2000/12/01)

<li><a href="/vb/comments/415.shtml">using FTP</a> - Sendil (2000/11/22)

<li><a href="/vb/comments/410.shtml">Potential problems</a> - Nicolas LeBlanc (2000/11/18)

<li><a href="/vb/comments/392.shtml">How to add resume capability for download and upload?</a> - Jason (2000/11/08)

<li><a href="/vb/comments/379.shtml">Does it work with Access 97</a> - chris (2000/10/16)

<li><a href="/vb/comments/375.shtml">Error &quot; 'retained' is an invalid Key&quot; etc</a> - Earl Brown (2000/10/12)

<li><a href="/vb/comments/374.shtml">Cutting Files?</a> - Cgcomp (2000/10/11)

<li><a href="/vb/comments/369.shtml">CFtp grapping a ghost file??</a> - Cgcomp (2000/10/05)

<li><a href="/vb/comments/365.shtml">FTPCommand implementation with Wininet.dll question????</a> - Leon  (2000/09/29)

<li><a href="/vb/comments/357.shtml">Error trapping for incorrect username, password or connection.</a> - GeoAlfa (2000/09/20)

<li><a href="/vb/comments/356.shtml">How can i get a progressbar for uploading files</a> - GeoAlfa (2000/09/20)

<li><a href="/vb/comments/355.shtml">need help!!how i use VB component or command to dail up modem.</a> - kamphol (2000/09/20)

<li><a href="/vb/comments/336.shtml">Help! GetFile Function adds 3 bytes to the end of received file...</a> - Hydr0P0nix (2000/08/31)

<li><a href="/vb/comments/332.shtml">Help FTP Access through a Class Module for VB5/6 - Requires WinInet.DLL</a> - cooro (2000/08/26)

<li><a href="/vb/comments/325.shtml">Getting File size on a server</a> - Derek (2000/08/18)

<li><a href="/vb/comments/315.shtml">Sweet!!!</a> - Joe Myrick (2000/08/10)

<li><a href="/vb/comments/307.shtml">How to use this download multiple files</a> - Gaby5_5 (2000/08/02)

<li><a href="/vb/comments/299.shtml">Again, Problem</a> - Paul (2000/05/30)

<li><a href="/vb/comments/295.shtml">Help Needed</a> - Paul (2000/05/25)

<li><a href="/vb/comments/294.shtml">Help Needed</a> - Paul (2000/05/25)

<li><a href="/vb/comments/286.shtml">Calling it from an ASP...</a> - Sunil D'Monte (2000/05/20)

<li><a href="/vb/comments/282.shtml">Exelent!</a> - Fredrik (2000/05/17)

<li><a href="/vb/comments/276.shtml">Exactly what I was looking for</a> - Jeremie (2000/05/12)

<li><a href="/vb/comments/272.shtml">ProgressBar For Downloading More Files In One Progress</a> - MAGiC MANiAC^mTo (2000/05/06)

<li><a href="/vb/comments/266.shtml">HELP desperaetely wanted</a> - Nilanjan (2000/05/01)

<li><a href="/vb/comments/264.shtml">This actually works!!</a> - Stevie Howard (2000/04/27)

<li><a href="/vb/comments/259.shtml">FTP Server</a> - Martin Cloutier (2000/04/20)

<li><a href="/vb/comments/258.shtml">FTP problem on web server</a> - Nilanjan (2000/04/18)

<li><a href="/vb/comments/256.shtml">How to use ftp in Browser</a> - anand (2000/04/15)

<li><a href="/vb/comments/229.shtml">I don't know about WIN32_FIND_DATA</a> - ninetom (2000/03/07)

<li><a href="/vb/comments/207.shtml">Disconnecting from the ISP</a> - Valluri (2000/02/09)

<li><a href="/vb/comments/203.shtml">Recursion</a> - Darren (2000/01/28)

<li><a href="/vb/comments/192.shtml">GetFile problem with large files.</a> - H.J. Baard (2000/01/12)

<li><a href="/vb/comments/183.shtml">What about proxy connections?</a> - Mateusz Kierepka (2000/01/03)

<li><a href="/vb/comments/175.shtml">ftp delete..., and can you do mdelete?</a> - lana (1999/12/14)

<li><a href="/vb/comments/171.shtml">How to know FTP_server is Connected or Disconnected??</a> - BYungKEuk (1999/12/07)

<li><a href="/vb/comments/166.shtml">Careful with the boolean return type</a> - Eran Gerstenfeld (1999/12/01)

<li><a href="/vb/comments/156.shtml">mistake in cFTP.</a> - genki (1999/11/23)

<li><a href="/vb/comments/134.shtml">so useful for inet memory crash</a> - gwnki (1999/10/01)

<li><a href="/vb/comments/132.shtml">Progress Bar</a> - Sang il Han (1999/09/27)

<li><a href="/vb/comments/130.shtml">FTPCommand</a> - Zintis Petersons (1999/09/15)

<li><a href="/vb/comments/104.shtml">Downloading progress</a> - Sang (1999/08/05)

</ul>
<blockquote>
<P>
<strong><a href="/cgi-bin/addpage/addpage.cgi?cfg=addvblcomment&action=Comment">
Add Comment</a></strong>

</blockquote>
<p><hr>
<P>

</td>

<td valign="top">
 <!--BLJAds - Added right side tower ad -->
      <A HREF="http://www.codeguru.com/RealMedia/ads/click_lx.cgi/ew/ewsoftware/www.codeguru.com/vb/articles/1852.shtml/31481/125x800/House_VoiceXML_For_BusMgrs_1b/voicexmlbusm_125600.gif/38366531313035623364326164333930" target="_top"><IMG SRC="http://www.codeguru.com/RealMedia/ads/Creatives/House_VoiceXML_For_BusMgrs_1b/voicexmlbusm_125600.gif"  ALT=""  BORDER="0"></A><img src="http://www.codeguru.com/RealMedia/ads/adstream_lx.cgi/ew/ewsoftware/www.codeguru.com/vb/articles/1852.shtml/31481/125x800/House_VoiceXML_For_BusMgrs_1b/voicexmlbusm_125600.gif/38366531313035623364326164333930?_RM_EMPTY_" Width="1" Height="1" Border="0">
</td>
<!--
Fix by chris eastwood, 15 feb 2000
-->
</tr>
</table>

<!-- End Fix -->
<!-- end main content column -->

<!-- begin spots column -->

<TD VALIGN="TOP" width="88">
</td>
</tr>

<!-- end main content column -->

<!-- begin lower ad and footer section -->

<tr>
<td>
<p>

<!-- end see also/paid links table -->



</td></tr></table>


<table width="100%"  cellpadding="0" cellspacing="0" valign="bottom"><tr><td nowrap>

<!-- begin footer information -->

<CENTER>

<A HREF="http://www.codeguru.com/RealMedia/ads/click_lx.cgi/ew/ewsoftware/www.codeguru.com/vb/articles/1852.shtml/8779/468x60-2/House_Career_Channel_11a/jobs5.gif/38366531313035623364326164333930" target="_top"><IMG SRC="http://www.codeguru.com/RealMedia/ads/Creatives/House_Career_Channel_11a/jobs5.gif"  WIDTH=468 HEIGHT=60 ALT=""  BORDER="0"></A><img src="http://www.codeguru.com/RealMedia/ads/adstream_lx.cgi/ew/ewsoftware/www.codeguru.com/vb/articles/1852.shtml/8779/468x60-2/House_Career_Channel_11a/jobs5.gif/38366531313035623364326164333930?_RM_EMPTY_" Width="1" Height="1" Border="0">

<br>

<FONT SIZE="-1">EarthWeb is a service of INT Media Group, Incorporated.<br>
Copyright 2002 INT Media Group, Incorporated. All Rights Reserved.<BR>
<A HREF="http://www.internet.com/help/feedback.html">Feedback</A>, &nbsp;
<A HREF="http://www.itmarketer.com">Advertising Info</A>, &nbsp; 
<A HREF="http://www.internet.com/corporate/legal.html">Legal Notices</A>,&nbsp;
<A HREF="http://www.internet.com/corporate/reprints.html#Licensing">Licensing</A>, 
<A HREF="http://www.internet.com/corporate/reprints.html#Reprints">Reprints</A>, &amp; 
<A HREF="http://www.internet.com/corporate/reprints.html#Permissions">Permissions</A>, &nbsp;
<A HREF="http://www.internet.com/corporate/privacy/privacypolicy.html">Privacy Policy</A>.
<BR>
<A HREF="http://www.internet.com"><IMG SRC="/images/internetcom.gif"
ALT="http://www.internet.com/" WIDTH="161" HEIGHT="18"
BORDER="0"></A></FONT>
</CENTER>
</td></tr></table>
<!-- end footer information -->
</TD></TR></TABLE>
<!-- end lower ad and footer section -->
</TD><!-- end main content column -->
</TR></TABLE>
</p></BODY></HTML>




