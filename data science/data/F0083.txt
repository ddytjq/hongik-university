ID=F0083
URL=http://www.vbip.com/winsock/winsock_simple_sender.asp
SIZE=56590
DATE=09/07/2002
TIME=13:14:34
DATASET=Visual Basic
HTML=
<html>

<head>
<title>Visual Basic Internet Programming - MS Winsock Control - Simple Mail Sender Sample Project</title>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<meta http-equiv="Content-Language" content="en-us">
<meta name="description" content="The tutorial on this page will help you to create the simple application that you can use to send simple e-mail messages..">
<meta name="keywords" content="mail state case server winsock1 smtp send message data command code response session string senddata private error helo current quit byval winsock connect dataarrival rcptto commands sending control project form property variable rcpt connection sample vb port application">
<meta name="ROBOTS" content="INDEX,FOLLOW">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<meta name="ProgId" content="FrontPage.Editor.Document">

	<link rel="stylesheet" type="text/css" href="../../vbip_nn.css">

</head>

<body bgcolor="#FFFFFF">
<form name="GlobalForm" ID="GlobalForm">
<table border="0" width="100%" cellspacing="0" cellpadding="0">
  <tr>
    <td width="100%">
      <table border="0" width="100%" cellspacing="0" cellpadding="0">
        <tr>
          <td width="120"><img border="0" src="../_borders/vbip_logo3.gif" width="132" height="50"></td>
          <td valign="middle">
				<p align="center">
              <!-- start BITS ad HTML -- top of page -- 468x60 banner www.bitsonthewire.com         --> 
               <iframe src="http://ads.bitsonthewire.com/admgriframe.asp?siteid=1126&ad_type=0" width=468 height=60 marginwidth=0 marginheight=0 hspace=0 vspace=0 frameborder=0 scrolling=no> 
                 <a href="http://ads.bitsonthewire.com/adrdrmanager.asp?loc=1">
                   <img border="0" src="http://ads.bitsonthewire.com/admanager.asp?loc=1&siteid=1126&ad_type=0">
                 </a></iframe> 
              <!-- stop BITS ad HTML -- top of page -- 468x60 banner                                --> 
				&nbsp;
              <a href="http://www.amazon.com/exec/obidos/redirect-home/vbipvisualbasici">
              <img border="0" src="../images/gnused120x60.gif" width="120" height="60"></a></p>
          </td>
        </tr>
      </table>
    </td>
  </tr>
  <tr>
    <td width="100%" height="1" valign="top">
      <hr noshade color="#FF9933">
    </td>
  </tr>
  <tr>
    <td width="100%" height="1" valign="top">
    <p class="barsidecaption">
    	<a href="../default.asp">Home</a> -
      	<a href="../whatsnew.asp"> What's New</a> - <a href="../tools.asp"> Tools&amp;Technologies</a> -
      	<a href="../resources.asp"> Resources</a> - <a href="../resources/books/default.asp">Books</a>
        - <a href="../forum/">Forum</a>
    </p>
    </td>
  </tr>
  <tr>
    <td width="100%" height="1" valign="top">
      <hr noshade color="#FF9933">
    </td>
  </tr>
</table>

<table width="100%" cellspacing="1" cellpadding="2" bordercolor="#800000" border="1">
  <tr>
    <td width="100%" bgcolor="#FF9933">
      <font color="#FFFFCC">
      <table border="0" width="100%" cellspacing="0" cellpadding="0">
        <tr>
          <td width="37%">
          <SCRIPT LANGUAGE=javascript>
          <!--
          if(navigator.appName.indexOf('Microsoft')>=0)
          {
          document.write('<a HREF="javascript:void(0);" class="tbcaption" onClick="window.external.AddFavorite(location.href, document.title);">Add to Favorites</a>');
          }
          // -->
          </SCRIPT>
          </td>
          <td width="63%">
            <p align="right" class="tbcaption"><a href="../default.asp" class="tbcaption">Home</a> -
            <a href="../tools.asp" class="tbcaption">Tools&amp;Technologies</a> -
            <a href="index.asp" class="tbcaption"> MS Winsock Control</a> -
            Simple Mail Sender Sample</td>
        </tr>
      </table>
      </font>
    </td>
  </tr>
</table>
<table border="0" width="100%" cellspacing="0" cellpadding="0">

<!--table-->
    <td width="125" valign="top"  style="border-left: 1px solid #800000; border-right: 1px solid #800000; " bgcolor="#FF9933">

    <table border="0" width="100%">
     <tr>
        <td width="100%" bgcolor="#FFCC00" style="border-left: 1px solid #800000; border-right: 1px solid #FFFFCC; border-top: 1px solid #800000; border-bottom: 1px solid #FFFFCC; " height="20">
          <p align="center" class="barsidecaption">[Advertisement]</td>
      </tr>
      <tr>
        <td width="100%" style="border: 1px solid #800000; " height="120">
<!-- start BITS ad HTML -- first 125x125 banner www.bitsonthewire.com                 --> 
<iframe src="http://ads.bitsonthewire.com/admgriframe.asp?siteid=1126&ad_type=-6" width=125 height=125 marginwidth=0 marginheight=0 hspace=0 vspace=0 frameborder=0 scrolling=no>
<a href="http://ads.bitsonthewire.com/adrdrmanager.asp?loc=3"><img border="0" src="http://ads.bitsonthewire.com/admanager.asp?loc=3&siteid=1126&ad_type=-6"></a></iframe> 
<!-- stop BITS ad HTML -- 125x125 banner                                             --> 	
        </td>
      </tr>
         
      <tr>
        <td width="100%" style="border-left: 1px solid #800000; border-right: 1px solid #FFFFCC; border-top: 1px solid #800000; border-bottom: 1px solid #FFFFCC; " bgcolor="#FFCC00" height="21">
          <p align="center" class="barsidecaption">[Search vbip.com]</td>
      </tr>
      <tr>
      
        <td valign="top" width="100%" height="21">
        
			<input type="text" size="7" name="search_site">&nbsp;
			<input type="button"  value="Go" onclick='location.href="http://www.vbip.com/search2/search.asp?Realm=vbip.com&Match=1&Terms="+document.GlobalForm.search_site.value;'>	
		
        </td>
      </tr>
         
      <tr>
        <td width="100%" style="border-left: 1px solid #800000; border-right: 1px solid #FFFFCC; border-top: 1px solid #800000; border-bottom: 1px solid #FFFFCC; " bgcolor="#FFCC00" height="21">
          <p align="center" class="barsidecaption">[Search other VB sites]</td>
      </tr>
      <tr>
        <td valign="top" width="100%" height="21">
        
			<input type="text" size="7" name="search_web">&nbsp;
			<input type="button"  value="Go" onclick='location.href="http://www.vbip.com/search2/search.asp?Realm=Other+VB+Websites&Match=1&Terms="+document.GlobalForm.search_web.value;'>	
		      
      </tr>
     
      <tr>
        <td width="100%" style="border-left: 1px solid #800000; border-right: 1px solid #FFFFCC; border-top: 1px solid #800000; border-bottom: 1px solid #FFFFCC; " bgcolor="#FFCC00" height="21">
          <p align="center" class="barsidecaption">[Featured Book]</td>
      </tr>
      <tr>
        <td valign="top" width="100%" height="21">
<center><script src="http://rcm.amazon.com/e/cm?t=vbipvisualbasici&l=st1&search=vb%20net&mode=books&p=8&o=1" type="text/JavaScript"></script><noscript>
<MAP NAME="boxmap"><AREA SHAPE="RECT" COORDS="14, 200, 103, 207" HREF="http://rcm.amazon.com/e/cm/privacy-policy.html?o=1"><AREA COORDS="0,0,10000,10000" HREF="http://www.amazon.com/exec/obidos/redirect-home/vbipvisualbasici"></MAP><img src="http://rcm-images.amazon.com/images/G/01/rcm/120x240.gif" width="120" height="240" border="0" usemap="#boxmap" alt="Shop at Amazon.com">

</noscript>

</center>
        </td>
      </tr>
     
      <tr>
        <td width="100%" style="border-left: 1px solid #800000; border-right: 1px solid #FFFFCC; border-top: 1px solid #800000; border-bottom: 1px solid #FFFFCC; " bgcolor="#FFCC00" height="21">
          <p align="center" class="barsidecaption">[Newsletter]</td>
      </tr>
      <tr>
        <td width="100%" height="56">
          <form method="POST" action="../sub.asp" onSubmit="">
            <table border="0" width="100%" cellspacing="0">
              <tr>
                <td width="84%">
                <input type="text" name="T1" size="8" style="font-family: Tahoma; color: #800000; font-size: 8pt; background-color: #FFCC99; border-left: 1px solid #800000; border-right: 1px solid #FFFFCC; border-top: 1px solid #800000; border-bottom: 1px solid #FFFFCC; " value="your e-mail"></td>
                <td width="16%"><input type="submit" value="Sub" name="B1" style="font-family: Tahoma; font-size: 8pt; color: #800000"></td>
              </tr>
              <tr>
                <td width="100%" colspan="2"><input type="radio" value="V1" checked name="R1"><span class="barsidecaption">HTML</span>
                  <input type="radio" name="R1" value="V2"><span class="barsidecaption">Text</span></td>
              </tr>
            </table>
          </form>
        </td>
      </tr>

      <tr>
        <td width="100%" style="border-left: 1px solid #800000; border-right: 1px solid #FFFFCC; border-top: 1px solid #800000; border-bottom: 1px solid #FFFFCC; " bgcolor="#FFCC00" height="21">
      <p align="center" class="barsidecaption">
      [Partners]
      </tr>
	
  <tr>
        <td width="100%" height="22">
      <p align="center"><a href="http://www.vbcity.com" target="_blank"><img border="0" src="..//images/vbcity2_100x30.gif" width="100" height="30"></a>
  </tr>
  <tr>
        <td width="100%" height="22">
      <p align="center"><a href="http://www.vbweb.co.uk/" target="_blank"><img border="0" src="..//images/vbweb_button.gif" width="100" height="30"></a>
  </tr>  
      <tr>
        <td width="100%" height="12" align="center">
      <a href="http://www.vbwire.com" target="_blank"><img border="0" src="..//images/VBWire-btn.gif" width="100" height="30"></a>
      </tr>

  <tr>
        <td width="100%" height="22">
      <p align="center"><a href="http://www.developersdex.com/vb" target="_blank"><img border="0" src="..//images/vbdex.gif" width="100" height="30"></a>
  </tr>  
  <tr>
        <td width="100%" height="3">
        <center>
        <!-- BEGIN ACKY CODE -->
		<a href="http://www.acky.net" target="_blank"><img
		src="http://www.acky.net/banners/ackbut3.gif" width="88" height="31"
		border="0" alt="Acky.net is your one stop shop for all of your web
		developing needs"></a>
		<!-- END ACKY CODE -->
		</center>
  </tr>
    </table>

    </td>
    <td valign="top" bgcolor="#FFFFFF">
      <blockquote>
        <p><br>
        <b><font face="Arial" color="#006666" size="2">Simple Mail Sender</font></b></p>
        <p><a href="files/sendmail.zip"><font face="Arial">Download Simple Mail Sender Sample
        Project (sendmail.zip, 4kb)</font></a></p>
        <p>The information below will help you to create application, which offers the ability to send simple e-mail messages. "Simple" means that this message can be send to only one recipient and can contain
        only the plain text.</p>
        <p>Create new project (Standard Exe). The Form1 will be created by default.</p>
        <p>Change the Name property of the form to &quot;frmSendMail&quot; and Caption to "Simple Mail sender". Change the BorderStyle
        property value&nbsp; to "1 - Fixed Single" as well.</p>
        <p>Add MS Winsock Control to the project and place one instance of the control to the form.
        Add another controls and place them on the form as shown below:<br>
        </p>
        <p align="center"><img border="0" src="images/wsc_sender_form.gif" width="460" height="310"></p>
        <p>Change the Name property of New Message, Send Message &#1080; Close buttons to
        cmdNew, cmdSend &#1080; cmdClose accordingly.<br>
        <br>
        Now open the code editor for frmSendMail and add this code:<br>
<FONT SIZE="2" FACE="Courier New">
<br>
<FONT COLOR="000080">Private Sub <FONT COLOR="000000">cmdNew_Click()<br>
<br>
&nbsp;&nbsp;&nbsp; txtRecipient = &quot;&quot;<br>
&nbsp;&nbsp;&nbsp; txtSubject = &quot;&quot;<br>
&nbsp;&nbsp;&nbsp; txtMessage = &quot;&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<br>
    
<FONT COLOR="000080">End Sub<br>
<br>
Private Sub <FONT COLOR="000000">cmdClose_Click()<br>
<br>
&nbsp;&nbsp;&nbsp; Unload Me<br>
&nbsp;&nbsp;&nbsp;&nbsp;<br>
    
<FONT COLOR="000080">End Sub
</font></font></font></font></font></font></p>
        <p>Well, all is set and we are ready to go on to the main topic -
        writing the code for sending a message.&nbsp;</p>
        <p>If you have already read the introduction to SMTP protocol you know about some commands
        that you have to use to send e-mail message. This commands must be sent in strict predefine sequence. In order to track the sequence we'll use special variable
        m_State, which stores the current state of SMTP
        session.&nbsp;</p>
        <p> You might think of SMTP session state as of state of waiting for server's reply to one of
        client's command. Therefore, the quantity of such states is equal to the quantity of SMTP commands.
        It is useless way to describe the value of SMTP session state with one
        of VB data types. That is why I suggest creating special data type
        &quot;SMTP_State&quot; by means of enumeration
        of all the required constants with VB keyword - Enum:
<FONT SIZE="2" FACE="Courier New">
<br>
<FONT COLOR="000080"><br>
</font></font>
<FONT COLOR="000080" face="Courier New">
Private Enum <FONT COLOR="000000">SMTP_State<br>
&nbsp;&nbsp;&nbsp; MAIL_CONNECT<br>
&nbsp;&nbsp;&nbsp; MAIL_HELO<br>
&nbsp;&nbsp;&nbsp; MAIL_FROM<br>
&nbsp;&nbsp;&nbsp; MAIL_RCPTTO<br>
&nbsp;&nbsp;&nbsp; MAIL_DATA<br>
&nbsp;&nbsp;&nbsp; MAIL_DOT<br>
&nbsp;&nbsp;&nbsp; MAIL_QUIT<br>
<FONT COLOR="000080">End Enum</font></font></font></p>
        <p>As you see the quantity of Enum's members is bigger then the quantity
        of required command. The reason you'll get to know soon. And now add
        this enumeration into code of frmSendMail. Define the variable m_State
        as well.</p>
        <p><font face="Courier New"><font color="#000080">Private</font> m_State
        <font color="#000080"> As</font> SMTP_State</font></p>
        <p>It's not difficult to guess that main events will happen after the
        pressing of Send Message button. We're going to add such a code into
        Click event.</p>
        <p><FONT COLOR="000080" face="Courier New">Private Sub <FONT COLOR="000000">cmdSend_Click()<br>
        <br>
        &nbsp;&nbsp;&nbsp; Winsock1.Connect Trim$(txtHost), 25<br>
        &nbsp;&nbsp;&nbsp; m_State = MAIL_CONNECT<br>
        &nbsp;&nbsp;&nbsp;&nbsp;<br>
    
<FONT COLOR="000080">End Sub</font></font></font></p><p>It's just two strings of
        code. The first one establishes connection to port number 25 (default
        SMTP port). And the second one makes assigning to m_State variable.
        &quot;Is that all ?&quot; you may ask. Yes. Currently it's all. We begin
        the communication between server and our application while establishing
        the link. We're going to manage this process by means of
        Winsock1_DataArrival events. This event will let us know about the
        server's response. According with the response we'll send the required
        command to the SMTP server. The skeleton of this algorithm looks like
        this:<br>
<FONT SIZE="2" FACE="Courier New">
<br>
        </font>

        <font face="Courier New">
<FONT COLOR="000080">Private Sub <FONT COLOR="000000">Winsock1_DataArrival(<FONT COLOR="000080">ByVal <FONT COLOR="000000">bytesTotal <FONT COLOR="000080">As
Long<FONT COLOR="000000">)<br>
<br>
&nbsp;&nbsp;&nbsp;

    <FONT COLOR="000080">Dim <FONT COLOR="000000">strServerResponse&nbsp;&nbsp; <FONT COLOR="000080">As
    String<FONT COLOR="000000">
    <br>
    &nbsp;&nbsp;&nbsp;
    <FONT COLOR="000080">Dim <FONT COLOR="000000">strResponseCode&nbsp;&nbsp;&nbsp;&nbsp;
    <FONT COLOR="000080">As String<FONT COLOR="000000">
    
    <br>
    &nbsp;&nbsp;&nbsp;&nbsp;<br>
    &nbsp;&nbsp;&nbsp; strResponseCode = Left(strServerResponse, 3)<br>
    &nbsp;&nbsp;&nbsp;&nbsp;<br>
    &nbsp;&nbsp;&nbsp;
    
    <FONT COLOR="000080">If <FONT COLOR="000000">strData = &quot;250&quot; <FONT COLOR="000080">Or <FONT COLOR="000000">_<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; strData = &quot;220&quot; <FONT COLOR="000080">Or <FONT COLOR="000000">_<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; strData = &quot;354&quot; <FONT COLOR="000080">Then<FONT COLOR="000000">
       
        <br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font><font color="#000080">Select
Case</font>
 m_State
<FONT COLOR="000080"><br>
</font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#000080">Case</font>
MAIL_CONNECT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#000080">Case</font>
MAIL_HELO<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#000080">Case</font>
MAIL_FROM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#000080">Case</font>
MAIL_RCPTTO<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#000080">Case</font>
MAIL_DATA<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#000080">Case</font>
MAIL_DOT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#000080">Case</font>
MAIL_QUIT
<FONT COLOR="000080"><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><font color="#000080">End
Select</font>
<FONT COLOR="000080"><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp; Else<FONT COLOR="000000">
        <br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MsgBox &quot;SMTP Error:
        &quot; &amp; strServerResponse, _<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        vbInformation, &quot;SMTP Error&quot;<br>
        &nbsp;&nbsp;&nbsp;
    <FONT COLOR="000080">End If<FONT COLOR="000000">
    
<br>
&nbsp;&nbsp;&nbsp;&nbsp;<br>
    
<FONT COLOR="000080">End Sub</font></font></font></font></font></font>
</p>

        <p>The first executing string of code figures out the server's response.
        The next IF/ELSE/ENDIF verifies whether the response is equal to one of
        the predefine values. This three code of response is in use by SMTP
        server while communication with the client. All these responses indicate
        the success of executing the command the server has received. Any other
        response indicates the error, which will be displayed via standard
        dialog MessageBox. This dialog appears any time we receive the response,
        which differs from those three appeared in IF/ELSE/ENDIF block. In case
        of the one of the success response the verified expression will be equal
        to True and the execution skips to Select Case block. Here is the
        complete Winsock1_DataArrival routine with the all required comments.<br>
<FONT SIZE="2" FACE="Courier New">
<br>
        </font><font face="Courier New">
<FONT COLOR="000080">Private Sub <FONT COLOR="000000">Winsock1_DataArrival(<FONT COLOR="000080">ByVal <FONT COLOR="000000">bytesTotal <FONT COLOR="000080">As
Long<FONT COLOR="000000">)<br>
<br>
&nbsp;&nbsp;&nbsp;

    <FONT COLOR="000080">Dim <FONT COLOR="000000">strServerResponse&nbsp;&nbsp; <FONT COLOR="000080">As
    String<FONT COLOR="000000">
    <br>
    &nbsp;&nbsp;&nbsp;
    <FONT COLOR="000080">Dim <FONT COLOR="000000">strResponseCode&nbsp;&nbsp;&nbsp;&nbsp;
    <FONT COLOR="000080">As String<FONT COLOR="000000">
    <br>
    &nbsp;&nbsp;&nbsp;
    <FONT COLOR="000080">Dim <FONT COLOR="000000">strDataToSend&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <FONT COLOR="000080">As String<FONT COLOR="000000">
    <br>
    &nbsp;&nbsp;&nbsp;
    <FONT COLOR="008000">'<FONT COLOR="000000">
    <br>
    &nbsp;&nbsp;&nbsp;
    <FONT COLOR="008000">'</font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font><font color="008000">Retrieve
<FONT COLOR="000080"> data from winsock buffer<FONT COLOR="000000">
    <br>
    &nbsp;&nbsp;&nbsp;
    <FONT COLOR="008000">'<FONT COLOR="000000">
    <br>
    &nbsp;&nbsp;&nbsp; Winsock1.GetData strServerResponse<br>
    &nbsp;&nbsp;&nbsp;
    <FONT COLOR="008000">'<FONT COLOR="000000">
    <br>
    &nbsp;&nbsp;&nbsp;
    <FONT COLOR="000080">Debug<FONT COLOR="000000">.<FONT COLOR="000080">Print <FONT COLOR="000000">strServerResponse<br>
    &nbsp;&nbsp;&nbsp;
    <FONT COLOR="008000">'<FONT COLOR="000000">
    <br>
    &nbsp;&nbsp;&nbsp;
    <FONT COLOR="008000">'Get server response code (first three symbols)<FONT COLOR="000000">
    <br>
    &nbsp;&nbsp;&nbsp;
    <FONT COLOR="008000">'<FONT COLOR="000000">
    <br>
    &nbsp;&nbsp;&nbsp; strResponseCode = Left(strServerResponse, 3)<br>
    &nbsp;&nbsp;&nbsp;
    <FONT COLOR="008000">'<FONT COLOR="000000">
    <br>
    &nbsp;&nbsp;&nbsp;
    <FONT COLOR="008000">'Only these three codes tell us that previous<FONT COLOR="000000">
    <br>
    &nbsp;&nbsp;&nbsp;
    <FONT COLOR="008000">'command accepted successfully and we can go on<FONT COLOR="000000">
    <br>
    &nbsp;&nbsp;&nbsp;
    <FONT COLOR="008000">'<FONT COLOR="000000">
    <br>
    &nbsp;&nbsp;&nbsp;
    <FONT COLOR="000080">If <FONT COLOR="000000">strResponseCode =
    &quot;250&quot; <FONT COLOR="000080">Or <FONT COLOR="000000">_<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; strResponseCode = &quot;220&quot; <FONT COLOR="000080">Or <FONT COLOR="000000">_<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; strResponseCode = &quot;354&quot; <FONT COLOR="000080">Then<FONT COLOR="000000">
       
        <br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Select Case m_State<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Case
        MAIL_CONNECT<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="008000">'Change current state of the session<FONT COLOR="000000">
                <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                m_State = MAIL_HELO<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="008000">'<FONT COLOR="000000">
                <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="008000">'Remove blank spaces<FONT COLOR="000000">
                <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                strDataToSend = Trim$(txtSender)<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="008000">'<FONT COLOR="000000">
                <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="008000">'Retrieve mailbox name from e-mail address<FONT COLOR="000000">
                <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                strDataToSend = Left$(strDataToSend, _<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                InStr(1, strDataToSend, </font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font><font color="000000">_<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</font>&quot;@&quot;) - 1)<font color="000000"><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="008000">'Send HELO command to the server<FONT COLOR="000000">
                <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                Winsock1.SendData &quot;HELO &quot; &amp; </font></font>_<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</font>strDataToSend &amp; vbCrLf<font color="000000"><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="008000">'<FONT COLOR="000000">
                <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="000080">Debug<FONT COLOR="000000">.<FONT COLOR="000080">Print <FONT COLOR="000000">&quot;HELO
                &quot; &amp; strDataToSend<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="008000">'<FONT COLOR="000000">
            <br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Case MAIL_HELO<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="008000">'<FONT COLOR="000000">
                <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="008000">'Change current state of the session<FONT COLOR="000000">
                <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                m_State = MAIL_FROM<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="008000">'<FONT COLOR="000000">
                <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="008000">'Send MAIL FROM command to the server<FONT COLOR="000000">
                <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                Winsock1.SendData &quot;MAIL FROM:&quot; &amp;</font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font>
_<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT COLOR="008000">
</font></font>Trim$(txtSender) &amp; vbCrLf<font color="000000"><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="008000">'<FONT COLOR="000000">
                <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="000080">Debug<FONT COLOR="000000">.<FONT COLOR="000080">Print <FONT COLOR="000000">&quot;MAIL
                FROM:&quot; &amp; Trim$(txtSender)<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="008000">'<FONT COLOR="000000">
            <br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Case MAIL_FROM<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="008000">'<FONT COLOR="000000">
                <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="008000">'Change current state of the session<FONT COLOR="000000">
                <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                m_State = MAIL_RCPTTO<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="008000">'<FONT COLOR="000000">
                <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="008000">'Send RCPT TO command to the server<FONT COLOR="000000">
                <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                Winsock1.SendData &quot;RCPT TO:&quot; &amp;</font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font>
_<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT COLOR="008000">
</font></font>Trim$(txtRecipient) &amp; vbCrLf<font color="000000"><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="008000">'<FONT COLOR="000000">
                <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="000080">Debug<FONT COLOR="000000">.<FONT COLOR="000080">Print <FONT COLOR="000000">&quot;RCPT
                TO:&quot; &amp; Trim$(txtRecipient)<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="008000">'<FONT COLOR="000000">
            <br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Case MAIL_RCPTTO<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="008000">'<FONT COLOR="000000">
                <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="008000">'Change current state of the session<FONT COLOR="000000">
                <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                m_State = MAIL_DATA<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="008000">'<FONT COLOR="000000">
                <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="008000">'Send DATA command to the server<FONT COLOR="000000">
                <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                Winsock1.SendData &quot;DATA&quot; &amp; vbCrLf<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="008000">'<FONT COLOR="000000">
                <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="000080">Debug<FONT COLOR="000000">.<FONT COLOR="000080">Print <FONT COLOR="000000">&quot;DATA&quot;<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="008000">'<FONT COLOR="000000">
            <br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Case MAIL_DATA<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="008000">'<FONT COLOR="000000">
                <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="008000">'Change current state of the session<FONT COLOR="000000">
                <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                m_State = MAIL_DOT<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="008000">'<FONT COLOR="000000">
                <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="008000">'So now we are sending a message body<FONT COLOR="000000">
                <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="008000">'Each line of text must be completed with<FONT COLOR="000000">
                <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="008000">'linefeed symbol (Chr$(10) or vbLf)&nbsp;<br>
                </font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font><font color="008000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
'</font><font color="#008000">not with vbCrLf</font><FONT COLOR="000000">
                <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="008000">'<FONT COLOR="000000">
                <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="008000">'Send Subject line<FONT COLOR="000000">
                <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                Winsock1.SendData &quot;Subject:&quot; &amp; txtSubject &amp;
                vbLf<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="008000">'<FONT COLOR="000000">
                <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="000080">Debug<FONT COLOR="000000">.<FONT COLOR="000080">Print <FONT COLOR="000000">&quot;Subject:&quot;
                &amp; txtSubject<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="008000">'<FONT COLOR="000000">
                <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="000080">Dim <FONT COLOR="000000">varLines&nbsp;&nbsp;&nbsp;
                <FONT COLOR="000080">As Variant<FONT COLOR="000000">
                <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="000080">Dim <FONT COLOR="000000">varLine&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="000080">As Variant<FONT COLOR="000000">
                <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="008000">'<FONT COLOR="000000">
                <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="008000">'Parse message to get lines (for VB6 only)<FONT COLOR="000000">
                <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                varLines = Split(txtMessage, vbCrLf)<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="008000">'<FONT COLOR="000000">
                <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="008000">'Send each line of the message<FONT COLOR="000000">
                <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="000080">For Each <FONT COLOR="000000">varLine <FONT COLOR="000080">In <FONT COLOR="000000">varLines<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                Winsock1.SendData CStr(varLine) &amp; vbLf<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    <FONT COLOR="008000">'<FONT COLOR="000000">
                    <br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    <FONT COLOR="000080">Debug<FONT COLOR="000000">.<FONT COLOR="000080">Print <FONT COLOR="000000">CStr(varLine)<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="000080">Next<FONT COLOR="000000">
                <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="008000">'<FONT COLOR="000000">
                <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="008000">'Send a dot symbol to inform server<FONT COLOR="000000">
                <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="008000">'that sending of message </font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font><font color="008000">completed<FONT COLOR="000000">
                <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                Winsock1.SendData &quot;.&quot; &amp; vbCrLf<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="008000">'<FONT COLOR="000000">
                <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="000080">Debug<FONT COLOR="000000">.<FONT COLOR="000080">Print <FONT COLOR="000000">&quot;.&quot;<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="008000">'<FONT COLOR="000000">
            <br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Case MAIL_DOT<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="008000">'Change current state of the session<FONT COLOR="000000">
                <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                m_State = MAIL_QUIT<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="008000">'<FONT COLOR="000000">
                <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="008000">'Send QUIT command to the server<FONT COLOR="000000">
                <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                Winsock1.SendData &quot;QUIT&quot; &amp; vbCrLf<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="008000">'<FONT COLOR="000000">
                <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="000080">Debug<FONT COLOR="000000">.<FONT COLOR="000080">Print <FONT COLOR="000000">&quot;QUIT&quot;<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                Case MAIL_QUIT<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="008000">'<FONT COLOR="000000">
                <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="008000">'Close connection<FONT COLOR="000000">
                <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                Winsock1.<FONT COLOR="000080">Close<FONT COLOR="000000">
                <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <FONT COLOR="008000">'<FONT COLOR="000000">
        <br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        <FONT COLOR="000080">End <FONT COLOR="000000">Select<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
        &nbsp;&nbsp;&nbsp;
       
    <FONT COLOR="000080">Else<FONT COLOR="000000">
        <br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        <FONT COLOR="008000">'<FONT COLOR="000000">
        <br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        <FONT COLOR="008000">'If we are here server replied with<FONT COLOR="000000">
        <br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        <FONT COLOR="008000">'unacceptable </font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font>response<FONT COLOR="000000">
                code therefore we need<FONT COLOR="000000">
        <br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        <FONT COLOR="008000">'close connection and inform user about problem<FONT COLOR="000000">
        <br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        <FONT COLOR="008000">'<FONT COLOR="000000">
        <br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Winsock1.<FONT COLOR="000080">Close<FONT COLOR="000000">
        <br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        <FONT COLOR="008000">'<FONT COLOR="000000">
        <br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MsgBox &quot;SMTP Error:
        &quot; &amp; strServerResponse, _<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        vbInformation, &quot;SMTP Error&quot;<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        <FONT COLOR="008000">'<FONT COLOR="000000">
    <br>
    &nbsp;&nbsp;&nbsp;
    <FONT COLOR="000080">End If<FONT COLOR="000000">
    
<br>
&nbsp;&nbsp;&nbsp;&nbsp;<br>
    
<FONT COLOR="000080">End Sub<FONT COLOR="000000">
<br>
</FONT>
</font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font>
<FONT SIZE="2" FACE="Courier New">
<br>
        </font>Please pay attention to the strings of the message we're going to
        send. They don't end with the vbCrLf. We're using vbLf instead. This
        rule applies to the header of the message (Subject) as well. Surely
        there are lots of another headers, which differ from Subject. But we're
        not going to discuss it here. Just remember that each one sends to the
        server ended by vbLf. Avoiding doing that results in server's
        misunderstanding the commands you are sending. The last thing you should
        make is to create the routine, which deals with the Windows Sockets
        errors.<br>
<FONT SIZE="2" FACE="Courier New">
<br>
        </font><font face="Courier New">
<FONT COLOR="000080">Private Sub <FONT COLOR="000000">Winsock1_Error(<FONT COLOR="000080">ByVal <FONT COLOR="000000">Number <FONT COLOR="000080">As
Integer<FONT COLOR="000000">, </font></font></font></font></font></font><font color="000000">_<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</font>Description<font color="000000"><FONT COLOR="000080"> <FONT COLOR="000080">As
String<FONT COLOR="000000">, </font></font></font>_<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="000080">ByVal <FONT COLOR="000000">Scode <FONT COLOR="000080">As
Long<FONT COLOR="000000">, </font></font></font></font>_<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="000080">ByVal <FONT COLOR="000000">Source <FONT COLOR="000080">As
String<FONT COLOR="000000">, </font></font></font></font>_<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="000080">ByVal <FONT COLOR="000000">HelpFile <FONT COLOR="000080">As
String<FONT COLOR="000000">, </font></font></font></font>_<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="000080">ByVal <FONT COLOR="000000">HelpContext <FONT COLOR="000080">As
Long<FONT COLOR="000000">, </font></font></font></font>_<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</font>CancelDisplay<font color="000000"> <FONT COLOR="000080">As Boolean<FONT COLOR="000000">)<br>
<br>
&nbsp;&nbsp;&nbsp; MsgBox &quot;Winsock Error number &quot; &amp; Number &amp;
vbCrLf &amp; _<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Description,
vbExclamation, &quot;Winsock Error&quot;<br>
<br>

<FONT COLOR="000080">End Sub
</font></font></font></font></font>
</p>
<p>        
    <hr noshade color="#FF9933">
    <table width="90%" align="center" border="0">
      <tr>
        <td width="25%">
          <img border="0" src="../../images/comments.gif">
        </td>
        <td width="75%">
          Please, post here only feedback for the article/tutorial/sample you
          have read above.<br>
          If you have any question and like to get an answer, post your messages in the <a href="http://www.vbip.com/forum/">Forum</a>.
        <td>
      </tr>
    </table>
    
    
			<p><b><font face="Arial" size="2" color="#800000"><a href="../../comment.asp?42">question </a></font></b><br>
			<i><font color="#808080" face="Times New Roman" size="2">Olga Tuesday, March 28, 2000</font></i>	
			</p>
			
			<p><b><font face="Arial" size="2" color="#800000"><a href="../../comment.asp?78">me@EXAMPLE.de, EXAMPLE.de is not the Host...</a></font></b><br>
			<i><font color="#808080" face="Times New Roman" size="2">Chris Wednesday, May 17, 2000</font></i>	
			</p>
			
			<p><b><font face="Arial" size="2" color="#800000"><a href="../../comment.asp?99">Language Problem!</a></font></b><br>
			<i><font color="#808080" face="Times New Roman" size="2">Gil Tuesday, June 20, 2000</font></i>	
			</p>
			
			<p><b><font face="Arial" size="2" color="#800000"><a href="../../comment.asp?180">How Can i send a mail to multiple recipients?</a></font></b><br>
			<i><font color="#808080" face="Times New Roman" size="2">Arnone Tuesday, October 17, 2000</font></i>	
			</p>
			
			<p><b><font face="Arial" size="2" color="#800000"><a href="../../comment.asp?189">Attachments with Mail Checker</a></font></b><br>
			<i><font color="#808080" face="Times New Roman" size="2">Andythe Monday, October 30, 2000</font></i>	
			</p>
			
			<p><b><font face="Arial" size="2" color="#800000"><a href="../../comment.asp?197">call to mail server fails when using a class.</a></font></b><br>
			<i><font color="#808080" face="Times New Roman" size="2">Chris Tuesday, November 07, 2000</font></i>	
			</p>
			
			<p><b><font face="Arial" size="2" color="#800000"><a href="../../comment.asp?219">I am having trouble sending mail with my prog</a></font></b><br>
			<i><font color="#808080" face="Times New Roman" size="2">jay [Lord Maximus] Tuesday, November 28, 2000</font></i>	
			</p>
			
			<p><b><font face="Arial" size="2" color="#800000"><a href="../../comment.asp?244">How to send to multiple recepient</a></font></b><br>
			<i><font color="#808080" face="Times New Roman" size="2">Sam Fernandez Wednesday, December 27, 2000</font></i>	
			</p>
			
			<p><b><font face="Arial" size="2" color="#800000"><a href="../../comment.asp?274">Problem with TCP Protocol(Error '40006' : )</a></font></b><br>
			<i><font color="#808080" face="Times New Roman" size="2">Ashirwad Juker Wednesday, January 31, 2001</font></i>	
			</p>
			
			<p><b><font face="Arial" size="2" color="#800000"><a href="../../comment.asp?275">Wrong protocol Error 40006</a></font></b><br>
			<i><font color="#808080" face="Times New Roman" size="2">Richard Slack Thursday, February 01, 2001</font></i>	
			</p>
			
			<p><b><font face="Arial" size="2" color="#800000"><a href="../../comment.asp?296">Attachments</a></font></b><br>
			<i><font color="#808080" face="Times New Roman" size="2">Richard griffiths Saturday, March 03, 2001</font></i>	
			</p>
			
			<p><b><font face="Arial" size="2" color="#800000"><a href="../../comment.asp?314">Mail Sender Sample</a></font></b><br>
			<i><font color="#808080" face="Times New Roman" size="2">Burkster Wednesday, April 04, 2001</font></i>	
			</p>
			
			<p><b><font face="Arial" size="2" color="#800000"><a href="../../comment.asp?409">Problem with m_state</a></font></b><br>
			<i><font color="#808080" face="Times New Roman" size="2">Braden Mcloughlin Saturday, July 07, 2001</font></i>	
			</p>
			
			<p><b><font face="Arial" size="2" color="#800000"><a href="../../comment.asp?517">vb5 and simple mail sender</a></font></b><br>
			<i><font color="#808080" face="Times New Roman" size="2">Anita Tuesday, September 11, 2001</font></i>	
			</p>
			
			<p><b><font face="Arial" size="2" color="#800000"><a href="../../comment.asp?585">Will not sent body of message</a></font></b><br>
			<i><font color="#808080" face="Times New Roman" size="2">Richard Tuesday, October 30, 2001</font></i>	
			</p>
			
			<p><b><font face="Arial" size="2" color="#800000"><a href="../../comment.asp?603">I loose the message's body</a></font></b><br>
			<i><font color="#808080" face="Times New Roman" size="2">Demian Thursday, November 08, 2001</font></i>	
			</p>
			
			<p><b><font face="Arial" size="2" color="#800000"><a href="../../comment.asp?633">How to send Attachments !</a></font></b><br>
			<i><font color="#808080" face="Times New Roman" size="2">Anand Monday, December 10, 2001</font></i>	
			</p>
			
			<p><b><font face="Arial" size="2" color="#800000"><a href="../../comment.asp?634">How can I include BCC, CC lists?</a></font></b><br>
			<i><font color="#808080" face="Times New Roman" size="2">Anand Monday, December 10, 2001</font></i>	
			</p>
			
			<p><b><font face="Arial" size="2" color="#800000"><a href="../../comment.asp?637">some answers and a Question.</a></font></b><br>
			<i><font color="#808080" face="Times New Roman" size="2">Levani Tuesday, December 11, 2001</font></i>	
			</p>
			
			<p><b><font face="Arial" size="2" color="#800000"><a href="../../comment.asp?701">SMTP Error 501</a></font></b><br>
			<i><font color="#808080" face="Times New Roman" size="2">grandeben Monday, January 14, 2002</font></i>	
			</p>
			
        <p>
        <form name="newcomm" method="POST" action="../../add_comments.asp">
          <p><input align="right" border="0" src="../../images/addyours2.gif" name="I1" type="image"></p>
          <input type="hidden" name="page" value="/winsock/winsock_simple_sender.asp">
          <input type="hidden" name="title">
	  <input type="hidden" name="actionID" value="add">
        </form>
        <SCRIPT LANGUAGE="JavaScript">
        	{document.newcomm.title.value = document.title}
        </SCRIPT>
	<br>
        <p>
        <hr noshade color="#FF9933">
</p>
      </blockquote>
<br>        
<p><center>
<!-- start BITS ad HTML -- bottom of page 468x60 banner www.bitsonthewire.com         --> 
  <iframe src="http://ads.bitsonthewire.com/admgriframe.asp?siteid=1126&ad_type=2" width=468 height=60 marginwidth=0 marginheight=0 hspace=0 vspace=0 frameborder=0 scrolling=no> 
    <a href="http://ads.bitsonthewire.com/adrdrmanager.asp?loc=2">
      <p>
      <img border="0" src="http://ads.bitsonthewire.com/admanager.asp?loc=2&siteid=1126&ad_type=2">
    </a>
  </iframe> 
<!-- stop BITS ad HTML -- bottom of page 468x60 banner                                --> 
</center></p>
    </td>
</table>
<table border="1" width="100%" cellspacing="1" cellpadding="2" bordercolor="#800000">
  <tr>
    <td width="100%" bgcolor="#FF9933">
      <font color="#FFFFCC">
      <table border="0" width="100%" cellspacing="0" cellpadding="0">
        <tr>
          <td width="37%"></td>
          <td width="63%">
            <p align="right" class="tbcaption"><a href="../default.asp" class="tbcaption">Home</a> -
            <a href="../tools.asp" class="tbcaption">Tools&amp;Technologies</a> -
            <a href="index.asp" class="tbcaption"> MS Winsock Control</a>
            - Simple Mail Sender Sample
          </td>
        </tr>
      </table>
      </font>
    </td>
  </tr>
</table>
&nbsp;<table border="0" width="100%" cellspacing="0" cellpadding="0">
  <tr>
    <td width="121" valign="top">
<!-- START OF WEBTRENDS LIVE TAG -->
<!-- Copyright 2001 NetIQ Corporation -->
<!--  For privacy concerns, check our Privacy Policy at http://www.webtrendslive.com/privacy_policy.htm -->
<SCRIPT LANGUAGE="JavaScript">
<!--
// Modification of this code is not allowed and will permanently disable your account!
// SiteName:  Visual Basic Internet Programming
function wtl_Tag4_27048()
{
	function D8( d)
	{
		var fwd=1, seed= new Date('01/01/2000'), key= "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";
		var s= key.charAt( d.getFullYear()-2000)+key.charAt( d.getMonth()+1)+key.charAt( d.getDate());
		s+= key.charAt( d.getHours())+key.charAt( d.getMinutes())+key.charAt( d.getSeconds());
		while( seed.getDay()!=fwd) seed= new Date(seed.getTime() + 86400000);
		var w= Math.floor( (d.getTime()-(seed.getTime()+86400000)) / 604800000 );
		s+= key.charAt( (w-(w%16))/16 );
		s+= key.charAt( w%16);
		return s;
	}

	var t = new Date();
	var W="tagver=4&si=27048&fw=1&bn=13";
	W+="&tz="+escape(t.getTimezoneOffset());
	W+="&ch="+escape(t.getHours());
	W+="&cl="+escape(D8(t));
	W+="&ti="+escape(document.title);
	W+="&url="+escape(window.document.URL);
	W+="&rf="+escape(window.document.referrer);
	W+="&js=Yes";
	W+="&ul="+(navigator.appName=="Netscape"?navigator.language:navigator.userLanguage);
	if(typeof(screen)=="object")
	{
	W+="&sr="+screen.width+"x"+screen.height;
	W+="&cd="+screen.colorDepth;
	W+="&jo="+(navigator.javaEnabled()?"Yes":"No");
	}
	
	
	document.write('<A TARGET="_blank" HREF="http://www.webtrendslive.com/redirect.asp?siteID=27048">');
	document.write('<IMG ID="WTL_TAG" BORDER="0" WIDTH="100" HEIGHT="30" ALT="This Site Tracked by WebTrendsLive." SRC="http://p.wtlive.com/S003-00-9-14-186109-27048/button4.asp?'+W+'">');
	document.write('</A>');
	
}	

wtl_Tag4_27048();
//-->
</SCRIPT>


<NOSCRIPT>
<A TARGET="_blank" HREF="http://www.webtrendslive.com/redirect.asp?siteID=27048">
<IMG BORDER="0" WIDTH="100" HEIGHT="30" ALT="This Site Tracked by WebTrendsLive." SRC="http://p.wtlive.com/S003-00-9-14-186109-27048/button4.asp?tagver=4&si=27048&fw=1&bn=13&js=No&"></A></NOSCRIPT>


<!-- END OF WEBTRENDS LIVE TAG -->

     
      </td>
    <td>
<p align="center" class="barsidecaption"><a href="../default.asp">Home</a> | <a href="../whatsnew.asp">What's
New</a> | <a href="../tools.asp"> Tools
&amp; Technologies</a> | <a href="../resources.asp">Resources</a> | <a href="../resources/books/default.asp">Books</a>
 | <a href="../forum/">Forum</a></p>
<p align="center" class="barsidecaption">Report about any problems and errors to <a href="mailto:webmaster@vbip.com">webmaster@vbip.com</a><br>
Copyright  1998 - 2002 by <a href="mailto:oleg@vbip.com"> Oleg Gdalevich</a></p>
    </td>
    <td valign="top" width="140">
<p align="center">
<a target="_blank" href="http://www.amazon.com/exec/obidos/ASIN/B00005AFI2/vbipvisualbasici">
<img border="0" src="../images/frontpage_button.gif" align="right" width="100" height="38"></a>
    </td>
  </tr>
</table>
</body>

</html>

