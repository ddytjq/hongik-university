ID=F0170
URL=http://www.vbip.com/winsock-api/socket-protocol-info/socket-protocol-info-01.asp
SIZE=51209
DATE=09/07/2002
TIME=13:16:04
DATASET=Visual Basic
HTML=
<html>

<head>
<title>Visual Basic and Winsock API - Socket's transport protocol and other options</title>
<meta name="description" content="All we know about the socket, at this moment, is only its handle - integer value that is used by the Winsock service and our application just to recognize it. But the socket is not just an integer value - some memory, system resources are allocated for it, and many properties of the socket are initializing with default values as you call the socket Winsock API function. Since a new socket is created, you can retrieve and set socket's options using the getsockopt and setsockopt Winsock API functions. ">
<meta name="GENERATOR" content="Microsoft FrontPage 5.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<meta name="ROBOTS" content="INDEX,FOLLOW">

	<link rel="stylesheet" type="text/css" href="../../../vbip_nn.css">

</head>

<body bgcolor="#FFFFFF">
<form name="GlobalForm" ID="GlobalForm">
<table border="0" width="100%" cellspacing="0" cellpadding="0">
  <tr>
    <td width="100%">
      <table border="0" width="100%" cellspacing="0" cellpadding="0">
        <tr>
          <td width="120"><img border="0" src="../../_borders/vbip_logo3.gif" width="132" height="50"></td>
          <td valign="middle">
				<p align="center">
              <!-- start BITS ad HTML -- top of page -- 468x60 banner www.bitsonthewire.com         --> 
               <iframe src="http://ads.bitsonthewire.com/admgriframe.asp?siteid=1126&ad_type=0" width=468 height=60 marginwidth=0 marginheight=0 hspace=0 vspace=0 frameborder=0 scrolling=no> 
                 <a href="http://ads.bitsonthewire.com/adrdrmanager.asp?loc=1">
                   <img border="0" src="http://ads.bitsonthewire.com/admanager.asp?loc=1&siteid=1126&ad_type=0">
                 </a></iframe> 
              <!-- stop BITS ad HTML -- top of page -- 468x60 banner                                --> 
				&nbsp;
              <a href="http://www.amazon.com/exec/obidos/redirect-home/vbipvisualbasici">
              <img border="0" src="../../images/gnused120x60.gif" width="120" height="60"></a></p>
          </td>
        </tr>
      </table>
    </td>
  </tr>
  <tr>
    <td width="100%" height="1" valign="top">
      <hr noshade color="#FF9933">
    </td>
  </tr>
  <tr>
    <td width="100%" height="1" valign="top">
    <p class="barsidecaption">
    	<a href="../../default.asp">Home</a> -
      	<a href="../../whatsnew.asp"> What's New</a> - <a href="../../tools.asp"> Tools&amp;Technologies</a> -
      	<a href="../../resources.asp"> Resources</a> - <a href="../../resources/books/default.asp">Books</a>
        - <a href="../../forum/">Forum</a>
    </p>
    </td>
  </tr>
  <tr>
    <td width="100%" height="1" valign="top">
      <hr noshade color="#FF9933">
    </td>
  </tr>
</table>

<table width="100%" cellspacing="1" cellpadding="2" bordercolor="#800000" border="1">
  <tr>
    <td width="100%" bgcolor="#FF9933">
      <font color="#FFFFCC">
      <table border="0" width="100%" cellspacing="0" cellpadding="0">
        <tr>
          <td width="37%">
          <SCRIPT LANGUAGE=javascript>
          <!--
          if(navigator.appName.indexOf('Microsoft')>=0)
          {
          document.write('<a HREF="javascript:void(0);" class="tbcaption" onClick="window.external.AddFavorite(location.href, document.title);">Add to Favorites</a>');
          }
          // -->
          </SCRIPT>
          </td>
          <td width="63%">
            <p align="right" class="tbcaption"><a href="../../default.asp" class="tbcaption">Home</a> -
            <a href="../../tools.asp" class="tbcaption">Tools&amp;Technologies</a> -
            <a href="../default.asp" class="tbcaption">Winsock API</a> - 
            Socket's transport protocol and other options</td>
        </tr>
      </table>
      </font>
    </td>
  </tr>
</table>
<table border="0" width="100%" cellspacing="0" cellpadding="0">

<!--table-->
    <td width="125" valign="top"  style="border-left: 1px solid #800000; border-right: 1px solid #800000; " bgcolor="#FF9933">

    <table border="0" width="100%">
     <tr>
        <td width="100%" bgcolor="#FFCC00" style="border-left: 1px solid #800000; border-right: 1px solid #FFFFCC; border-top: 1px solid #800000; border-bottom: 1px solid #FFFFCC; " height="20">
          <p align="center" class="barsidecaption">[Advertisement]</td>
      </tr>
      <tr>
        <td width="100%" style="border: 1px solid #800000; " height="120">
<!-- start BITS ad HTML -- first 125x125 banner www.bitsonthewire.com                 --> 
<iframe src="http://ads.bitsonthewire.com/admgriframe.asp?siteid=1126&ad_type=-6" width=125 height=125 marginwidth=0 marginheight=0 hspace=0 vspace=0 frameborder=0 scrolling=no>
<a href="http://ads.bitsonthewire.com/adrdrmanager.asp?loc=3"><img border="0" src="http://ads.bitsonthewire.com/admanager.asp?loc=3&siteid=1126&ad_type=-6"></a></iframe> 
<!-- stop BITS ad HTML -- 125x125 banner                                             --> 	
        </td>
      </tr>
         
      <tr>
        <td width="100%" style="border-left: 1px solid #800000; border-right: 1px solid #FFFFCC; border-top: 1px solid #800000; border-bottom: 1px solid #FFFFCC; " bgcolor="#FFCC00" height="21">
          <p align="center" class="barsidecaption">[Search vbip.com]</td>
      </tr>
      <tr>
      
        <td valign="top" width="100%" height="21">
        
			<input type="text" size="7" name="search_site">&nbsp;
			<input type="button"  value="Go" onclick='location.href="http://www.vbip.com/search2/search.asp?Realm=vbip.com&Match=1&Terms="+document.GlobalForm.search_site.value;'>	
		
        </td>
      </tr>
         
      <tr>
        <td width="100%" style="border-left: 1px solid #800000; border-right: 1px solid #FFFFCC; border-top: 1px solid #800000; border-bottom: 1px solid #FFFFCC; " bgcolor="#FFCC00" height="21">
          <p align="center" class="barsidecaption">[Search other VB sites]</td>
      </tr>
      <tr>
        <td valign="top" width="100%" height="21">
        
			<input type="text" size="7" name="search_web">&nbsp;
			<input type="button"  value="Go" onclick='location.href="http://www.vbip.com/search2/search.asp?Realm=Other+VB+Websites&Match=1&Terms="+document.GlobalForm.search_web.value;'>	
		      
      </tr>
     
      <tr>
        <td width="100%" style="border-left: 1px solid #800000; border-right: 1px solid #FFFFCC; border-top: 1px solid #800000; border-bottom: 1px solid #FFFFCC; " bgcolor="#FFCC00" height="21">
          <p align="center" class="barsidecaption">[Featured Book]</td>
      </tr>
      <tr>
        <td valign="top" width="100%" height="21">
<center><script src="http://rcm.amazon.com/e/cm?t=vbipvisualbasici&l=st1&search=programming%20tcp/ip%20&mode=books&p=8&o=1" type="text/JavaScript"></script><noscript>
<MAP NAME="boxmap"><AREA SHAPE="RECT" COORDS="14, 200, 103, 207" HREF="http://rcm.amazon.com/e/cm/privacy-policy.html?o=1"><AREA COORDS="0,0,10000,10000" HREF="http://www.amazon.com/exec/obidos/redirect-home/vbipvisualbasici"></MAP><img src="http://rcm-images.amazon.com/images/G/01/rcm/120x240.gif" width="120" height="240" border="0" usemap="#boxmap" alt="Shop at Amazon.com">

</noscript>

</center>
        </td>
      </tr>
     
      <tr>
        <td width="100%" style="border-left: 1px solid #800000; border-right: 1px solid #FFFFCC; border-top: 1px solid #800000; border-bottom: 1px solid #FFFFCC; " bgcolor="#FFCC00" height="21">
          <p align="center" class="barsidecaption">[Newsletter]</td>
      </tr>
      <tr>
        <td width="100%" height="56">
          <form method="POST" action="../../sub.asp" onSubmit="">
            <table border="0" width="100%" cellspacing="0">
              <tr>
                <td width="84%">
                <input type="text" name="T1" size="8" style="font-family: Tahoma; color: #800000; font-size: 8pt; background-color: #FFCC99; border-left: 1px solid #800000; border-right: 1px solid #FFFFCC; border-top: 1px solid #800000; border-bottom: 1px solid #FFFFCC; " value="your e-mail"></td>
                <td width="16%"><input type="submit" value="Sub" name="B1" style="font-family: Tahoma; font-size: 8pt; color: #800000"></td>
              </tr>
              <tr>
                <td width="100%" colspan="2"><input type="radio" value="V1" checked name="R1"><span class="barsidecaption">HTML</span>
                  <input type="radio" name="R1" value="V2"><span class="barsidecaption">Text</span></td>
              </tr>
            </table>
          </form>
        </td>
      </tr>

      <tr>
        <td width="100%" style="border-left: 1px solid #800000; border-right: 1px solid #FFFFCC; border-top: 1px solid #800000; border-bottom: 1px solid #FFFFCC; " bgcolor="#FFCC00" height="21">
      <p align="center" class="barsidecaption">
      [Partners]
      </tr>
	
  <tr>
        <td width="100%" height="22">
      <p align="center"><a href="http://www.vbcity.com" target="_blank"><img border="0" src="../..//images/vbcity2_100x30.gif" width="100" height="30"></a>
  </tr>
  <tr>
        <td width="100%" height="22">
      <p align="center"><a href="http://www.vbweb.co.uk/" target="_blank"><img border="0" src="../..//images/vbweb_button.gif" width="100" height="30"></a>
  </tr>  
      <tr>
        <td width="100%" height="12" align="center">
      <a href="http://www.vbwire.com" target="_blank"><img border="0" src="../..//images/VBWire-btn.gif" width="100" height="30"></a>
      </tr>

  <tr>
        <td width="100%" height="22">
      <p align="center"><a href="http://www.developersdex.com/vb" target="_blank"><img border="0" src="../..//images/vbdex.gif" width="100" height="30"></a>
  </tr>  
  <tr>
        <td width="100%" height="3">
        <center>
        <!-- BEGIN ACKY CODE -->
		<a href="http://www.acky.net" target="_blank"><img
		src="http://www.acky.net/banners/ackbut3.gif" width="88" height="31"
		border="0" alt="Acky.net is your one stop shop for all of your web
		developing needs"></a>
		<!-- END ACKY CODE -->
		</center>
  </tr>
    </table>

    </td>
    <td valign="top" bgcolor="#FFFFFF">
      <blockquote>
        <p><b><font face="Arial"><a href="../../winsock_control.asp"><br>
        </a><img border="0" src="../winsock-api-banner.gif">
        </font></b></p>
        <p class="ChapterTitle"><span lang="en-us">Socket's transport protocol 
        and other options</span></p>
        <div align="center">
          <center>
          <table border="0" width="90%" cellspacing="0" cellpadding="0" height="44">
            <tr>
              <td width="100%" height="15" colspan="3">
        <hr noshade size="1" color="#FF9933">
              </td>
            </tr>
            <tr>
              <td width="16" bgcolor="#FFFFCC" height="21" valign="top" style="border: 1px solid #FF9933" class="tbcaption">
                <p align="center">
                <a href="TestBench-03.zip">
                <img border="0" src="../../images/download-icon4.gif" align="right"></a></td>
              <td width="40%" bgcolor="#FF9933" height="21" class="tbcaption">
                <p>&nbsp;<a class="tbcaption" href="TestBench-03.zip">Download 
                 
                Winsock API Test Bench<span lang="en-us"> 3</span> project</a></td>
              <td width="57%" bgcolor="#FF9933" height="21" class="tbcaption">
              <p align="right">
              &nbsp;</td>
            </tr>
            <tr>
              <td width="100%" height="15" colspan="3">
        <hr noshade size="1" color="#FF9933">
              </td>
            </tr>
          </table>
          </center>
        </div>
        <blockquote>
        <p>In <a href="../create-close-socket/create-close-socket-01.asp">the previous article</a> we have learned how to create and close 
        socket<span lang="en-us">s</span>. All we know about the socket, at this moment, is only its handle 
        - integer value that is used by the Winsock service and our application 
        just to recognize it. But the socket is not just an integer value - some 
        memory, system resources are allocated for it, and many properties of 
        the socket are initializing with default values as you call the
        <font face="Courier New">socket</font> 
        Winsock API function. Since a new socket is created, you can retrieve 
        and set socket's options using the <font face="Courier New"> 
        <a target="_blank" href="http://msdn.microsoft.com/library/en-us/winsock/wsapiref_8qcy.asp">getsockopt</a></font> and
        <font face="Courier New"> 
        <a target="_blank" href="http://msdn.microsoft.com/library/en-us/winsock/wsapiref_94aa.asp">setsockopt</a></font> Winsock API 
        functions. </p>
        <p>The strange thing is that those functions are not even included in 
        the <font face="Courier New">modWinsock<span lang="en-us">API</span></font> code module which holds all the API's declarations for 
        this project. Anyway, we'll use one of them - <font face="Courier New"> 
        <a target="_blank" href="http://msdn.microsoft.com/library/en-us/winsock/wsapiref_8qcy.asp">getsockopt</a></font>, in order to 
        determine which transport protocol is used by a given socket. But before 
        to go on I advise you to take a look at the article from the <i>MS 
        Knowledge Base</i> that illustrates how to use those functions:</p>
        <p>
    <a href="http://support.microsoft.com/support/kb/articles/Q237/6/88.ASP" target="_blank">HOWTO:
    Using getsockopt() and setsockopt() in Visual Basic</a></p>
        <p>That example doesn't show how to retrieve the information about a 
        transport protocol and I'm going to show you how to do that. Moreover 
        our sample application needs that info.</p>
        <p>If you have not read the <span lang="en-us">
        <a href="../enumprotocols/enumprotocols-01.asp">Enumerating transport 
        protocols</a> article from the first part of the tutorial, please do it 
        before to go ahead, as we'll use here some code from the example that can 
        be downloaded at that page, and I'm not going to repeat the things I 
        had already been talking about.</span></p>
        </blockquote>
        <p class="ArticleH2"><span lang="en-us">The <i>getsockopt</i> Winsock API 
        function</span></p>
        <blockquote>
        <p>The Windows Sockets <font face="Courier New"> 
        <a target="_blank" href="http://msdn.microsoft.com/library/en-us/winsock/wsapiref_94aa.asp">setsockopt</a><span lang="en-us">
        </span></font>function retrieves a socket option.</p>
        <p class="code"><font color="#000080">Declare Function</font> getsockopt
        <span lang="en-us">_<br>
        </span><font color="#000080">Lib</font> &quot;ws2_32.dll&quot; (<font color="#000080">ByVal</font> 
        s <font color="#000080">As Long</font>, <span lang="en-us">_<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        </span><font color="#000080">ByVal</font> level <font color="#000080">As 
        Long</font>, <span lang="en-us">_<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        </span><font color="#000080">ByVal</font> optname <font color="#000080">
        As Long</font>, <span lang="en-us">_<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        </span><font color="#000080">ByRef</font> optval <font color="#000080">
        As Any</font>, <span lang="en-us">_<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        </span><font color="#000080">ByRef</font> optlen <font color="#000080">
        As Long</font>) <font color="#000080">As Long</font></p>
        <p><span lang="en-us">For more info about the function see the
        <a target="_blank" href="http://msdn.microsoft.com/library/en-us/winsock/wsapiref_8qcy.asp">
        Winsock API documentation</a>.</span></p>
        <p><span lang="en-us">In order to retrieve the information about 
        transport protocol by socket's handle we can use the function as 
        follows:</span></p>
        <table border='0' width='80%' bgcolor='#F8F8F8' cellspacing='0' cellpadding='2'>
  <tr>
    <td width='100%'>
      <pre>    
<font color="#008000"><span lang="en-us">    '
    'the lngSocket variable is a socket handle
    'the SOL_SOCKET constant defines the socket option level
    'the SO_PROTOCOL_INFO constant force the getsockopt function
    'to retrieve the transport protocol information
    '</span></font>
<span lang="en-us">    </span><font color="#000080">Dim</font> lngRetValue <span lang="en-us">    </span><font color="#000080">As Long</font>
    <font color="#000080">Dim</font> udtProtocolInfo <font color="#000080">As</font> WSAPROTOCOL_INFO
    <font color="#000080">Dim</font> lngBufferSize <span lang="en-us">  </span><font color="#000080">As Long</font>
    <font color="#008000">'</font>
    lngBufferSize = LenB(udtProtocolInfo)
    <font color="#008000">'</font>
    lngRetValue = getsockopt(lngSocket, SOL_SOCKET, SO_PROTOCOL_INFO, <span lang="en-us">_
                             </span>udtProtocolInfo, lngBufferSize)
    <font color="#008000">'</font>
    <font color="#000080">If</font> lngRetValue = 0 <font color="#000080">Then</font>
<span lang="en-us"><font color="#008000">        'If no error occurs, getsockopt returns zero.
        'The udtProtocolInfo structure contains info about the protocol</font>
    <font color="#000080">End If</font></span></pre>
    </td>
  </tr>
</table>
        <p><span lang="en-us">That's it - nothing special. Now let's enhance the 
        sample application with a new feature.</span></p>
        </blockquote>
        <p class="ArticleH2"><span lang="en-us">Modifying the sample application</span></p>
        <blockquote>
        <p><span lang="en-us">The
        <a target="_blank" href="http://msdn.microsoft.com/library/en-us/winsock/strucetc_4cfm.asp">
        WSAPROTOCOL_INFO</a> structure holds all the information about a given 
        transport protocol. Some members of the structure contain single values, 
        others - multiple values as a combination of bits (bitmask). For 
        example, the <font face="Courier New">dwServiceFlags1</font> member handles values for 20 parameters of 
        the protocol. To ease my life I have decided to create
        <font face="Courier New">CProtocol</font> class 
        (see</span> the <span lang="en-us">
        <a href="../enumprotocols/enumprotocols-01.asp">Enumerating transport 
        protocols</a> article) that just holds the same data and is much easer 
        to use than to deal with the structure members.</span></p>
        <p><span lang="en-us">Add the <font face="Courier New">CProtocol</font> class module into the project. 
        You may include that file from the <font face="Courier New">TransportProtocols</font> project or create 
        a new one. And type in the following code that is the 
        <font face="Courier New">GetBySocketHandle</font> 
        method which does make a call of the  </span><font face="Courier New"> 
        <a target="_blank" href="http://msdn.microsoft.com/library/en-us/winsock/wsapiref_94aa.asp">setsockopt</a><span lang="en-us">
        </span></font><span lang="en-us">function and initializes 
        class' properties.</span></p>
        <table border='0' width='80%' bgcolor='#F8F8F8' cellspacing='0' cellpadding='2'>
  <tr>
    <td width='100%'>
      <pre><font color="#000080">Public Function</font> GetBySocketHandle(lngSocket <font color="#000080">As Long</font>) <font color="#000080">As Boolean</font>
    <font color="#008000">'</font>
    <font color="#000080">Dim</font> lngRetValue     <font color="#000080">As Long</font>
    <font color="#000080">Dim</font> udtProtocolInfo <font color="#000080">As</font> WSAPROTOCOL_INFO
    <font color="#000080">Dim</font> lngBufferSize   <font color="#000080">As Long</font>
    <font color="#008000">'</font>
    lngBufferSize = LenB(udtProtocolInfo)
    <font color="#008000">'</font>
    lngRetValue = getsockopt(lngSocket, SOL_SOCKET, SO_PROTOCOL_INFO, _
                             udtProtocolInfo, lngBufferSize)
    <font color="#008000">'</font>
    <font color="#000080">If</font> lngRetValue = 0 <font color="#000080">Then</font>
        <font color="#008000">'</font>
        <font color="#000080">With</font> udtProtocolInfo
            <font color="#008000">'</font>
            mvarConnectionless = .dwServiceFlags1 <font color="#000080">And</font> XP1_CONNECTIONLESS
            mvarGuaranteedDelivery = .dwServiceFlags1 <font color="#000080">And</font> XP1_GUARANTEED_DELIVERY
            mvarGuaranteedOrder = .dwServiceFlags1 <font color="#000080">And</font> XP1_GUARANTEED_ORDER
            mvarMessageOriented = .dwServiceFlags1 <font color="#000080">And</font> XP1_MESSAGE_ORIENTED
            mvarPseudoStream = .dwServiceFlags1 <font color="#000080">And</font> XP1_PSEUDO_STREAM
            mvarGracefulClose = .dwServiceFlags1 <font color="#000080">And</font> XP1_GRACEFUL_CLOSE
            mvarExpeditedData = .dwServiceFlags1 <font color="#000080">And</font> XP1_EXPEDITED_DATA
            mvarConnectData = .dwServiceFlags1 <font color="#000080">And</font> XP1_CONNECT_DATA
            mvarDisconnectData = .dwServiceFlags1 <font color="#000080">And</font> XP1_DISCONNECT_DATA
            mvarSupportBroadcast = .dwServiceFlags1 <font color="#000080">And</font> XP1_SUPPORT_BROADCAST
            mvarSupportMultipoint = .dwServiceFlags1 <font color="#000080">And</font> XP1_SUPPORT_MULTIPOINT
            mvarMultipointControlPlane = .dwServiceFlags1 <font color="#000080">And</font> XP1_MULTIPOINT_CONTROL_PLANE
            mvarMultipointDataPlane = .dwServiceFlags1 <font color="#000080">And</font> XP1_MULTIPOINT_DATA_PLANE
            mvarQoSSupport = .dwServiceFlags1 <font color="#000080">And</font> XP1_QOS_SUPPORTED
            mvarUniSend = .dwServiceFlags1 <font color="#000080">And</font> XP1_UNI_SEND
            mvarUniRecv = .dwServiceFlags1 <font color="#000080">And</font> XP1_UNI_RECV
            mvarIFSHandles = .dwServiceFlags1 <font color="#000080">And</font> XP1_IFS_HANDLES
            mvarPartialMessage = .dwServiceFlags1 <font color="#000080">And</font> XP1_PARTIAL_MESSAGE
            mvarMultipleProtoEntries = .dwProviderFlags <font color="#000080">And</font> PFL_MULTIPLE_PROTO_ENTRIES
            mvarRecommendedProtoEntry = .dwProviderFlags <font color="#000080">And</font> PFL_RECOMMENDED_PROTO_ENTRY
            mvarMatchesProtocolZero = .dwProviderFlags <font color="#000080">And</font> PFL_MATCHES_PROTOCOL_ZERO
            mvarProviderId = GuidToString(.ProviderId)
            mvarCatalogEntryId = .dwCatalogEntryId
            mvarVersion = .iVersion
            mvarAddressFamily = .iAddressFamily
            mvarMaxSockAddr = .iMaxSockAddr
            mvarMinSockAddr = .iMinSockAddr
            mvarSocketType = .iSocketType
            mvarProtocol = .iProtocol
            mvarProtocolMaxOffset = .iProtocolMaxOffset
            mvarNetworkByteOrder = .iNetworkByteOrder
            mvarSecurityScheme = .iSecurityScheme
            mvarMessageSize = .dwMessageSize
            mvarProtocolName = .szProtocol
            <font color="#008000">'</font>
        <font color="#000080">End With</font>
        <font color="#008000">'</font>
        GetBySocketHandle = <font color="#000080">True</font>
        <font color="#008000">'</font>
    <font color="#000080">End If</font>
    <font color="#008000">'</font>
<font color="#000080">End Function</font></pre>
    </td>
  </tr>
</table>
        <p><span lang="en-us">As you may notice this code does have some 
        dependencies. We need to include API's declaration for the </span>
        <font face="Courier New"> 
        <a target="_blank" href="http://msdn.microsoft.com/library/en-us/winsock/wsapiref_94aa.asp">setsockopt</a><span lang="en-us">
        </span></font><span lang="en-us">function and the constants. Also the </span>
        <font face="Courier New">GuidToString</font><span lang="en-us"> 
        function is used to retrieve the <font face="Courier New">ProviderID</font> value. Insert the following 
        code into the <font face="Courier New">CProtocol</font> class module as well:</span></p>
        <table border='0' width='80%' bgcolor='#F8F8F8' cellspacing='0' cellpadding='2'>
  <tr>
    <td width='100%'>
      <pre><font color="#000080">Private Const</font> BASE_PROTOCOL = 1
<font color="#000080">Private Const</font> LAYERED_PROTOCOL = 0

<font color="#008000">'/* Flag bit definitions for dwProviderFlags */</font>
<font color="#000080">Private Const</font> PFL_MULTIPLE_PROTO_ENTRIES = &amp;H1
<font color="#000080">Private Const</font> PFL_RECOMMENDED_PROTO_ENTRY = &amp;H2
<font color="#000080">Private Const</font> PFL_HIDDEN = &amp;H4
<font color="#000080">Private Const</font> PFL_MATCHES_PROTOCOL_ZERO = &amp;H8

<font color="#008000">'/* Flag bit definitions for dwServiceFlags1 */</font>
<font color="#000080">Private Const</font> XP1_CONNECTIONLESS = &amp;H1
<font color="#000080">Private Const</font> XP1_GUARANTEED_DELIVERY = &amp;H2
<font color="#000080">Private Const</font> XP1_GUARANTEED_ORDER = &amp;H4
<font color="#000080">Private Const</font> XP1_MESSAGE_ORIENTED = &amp;H8
<font color="#000080">Private Const</font> XP1_PSEUDO_STREAM = &amp;H10
<font color="#000080">Private Const</font> XP1_GRACEFUL_CLOSE = &amp;H20
<font color="#000080">Private Const</font> XP1_EXPEDITED_DATA = &amp;H40
<font color="#000080">Private Const</font> XP1_CONNECT_DATA = &amp;H80
<font color="#000080">Private Const</font> XP1_DISCONNECT_DATA = &amp;H100
<font color="#000080">Private Const</font> XP1_SUPPORT_BROADCAST = &amp;H200
<font color="#000080">Private Const</font> XP1_SUPPORT_MULTIPOINT = &amp;H400
<font color="#000080">Private Const</font> XP1_MULTIPOINT_CONTROL_PLANE = &amp;H800
<font color="#000080">Private Const</font> XP1_MULTIPOINT_DATA_PLANE = &amp;H1000
<font color="#000080">Private Const</font> XP1_QOS_SUPPORTED = &amp;H2000
<font color="#000080">Private Const</font> XP1_INTERRUPT = &amp;H4000
<font color="#000080">Private Const</font> XP1_UNI_SEND = &amp;H8000
<font color="#000080">Private Const</font> XP1_UNI_RECV = &amp;H10000
<font color="#000080">Private Const</font> XP1_IFS_HANDLES = &amp;H20000
<font color="#000080">Private Const</font> XP1_PARTIAL_MESSAGE = &amp;H40000

<font color="#000080">Private Const</font> BIGENDIAN = &amp;H0
<font color="#000080">Private Const</font> LITTLEENDIAN = &amp;H1

<font color="#000080">Private Const</font> SECURITY_PROTOCOL_NONE = &amp;H0

<font color="#000080">Private Const</font> MAX_PROTOCOL_CHAIN = 6

<font color="#000080">Private Type</font> WSAPROTOCOLCHAIN
  ChainLen <font color="#000080">As Long</font>
  ChainEntries(MAX_PROTOCOL_CHAIN) <font color="#000080">As Long</font>
<font color="#000080">End Type</font>

<font color="#000080">Private Type</font> Guid
    Data1 <font color="#000080">As Long</font>
    Data2 <font color="#000080">As Integer</font>
    Data3 <font color="#000080">As Integer</font>
    Data4(0 <font color="#000080">To</font> 7) <font color="#000080">As Byte</font>
<font color="#000080">End Type</font>

<font color="#000080">Private Declare Function</font> StringFromGUID2 <span lang="en-us">_
</span><font color="#000080">Lib</font> &quot;ole32.dll&quot; (rguid <font color="#000080">As Any</font>, <span lang="en-us">_
                 </span><font color="#000080">ByVal</font> lpsz <font color="#000080">As String</font>, <span lang="en-us">_</span>
<span lang="en-us">                 </span><font color="#000080">ByVal</font> cchMax <font color="#000080">As Long</font>) <font color="#000080">As Long</font>

<font color="#000080">Private Const</font> WSAPROTOCOL_LEN = 256

<font color="#000080">Private Type</font> WSAPROTOCOL_INFO
    dwServiceFlags1 <font color="#000080">As Long</font>
    dwServiceFlags2 <font color="#000080">As Long</font>
    dwServiceFlags3 <font color="#000080">As Long</font>
    dwServiceFlags4 <font color="#000080">As Long</font>
    dwProviderFlags <font color="#000080">As Long</font>
    ProviderId <font color="#000080">As</font> Guid
    dwCatalogEntryId <font color="#000080">As Long</font>
    ProtocolChain <font color="#000080">As</font> WSAPROTOCOLCHAIN
    iVersion <font color="#000080">As Long</font>
    iAddressFamily <font color="#000080">As Long</font>
    iMaxSockAddr <font color="#000080">As Long</font>
    iMinSockAddr <font color="#000080">As Long</font>
    iSocketType <font color="#000080">As Long</font>
    iProtocol <font color="#000080">As Long</font>
    iProtocolMaxOffset <font color="#000080">As Long</font>
    iNetworkByteOrder <font color="#000080">As Long</font>
    iSecurityScheme <font color="#000080">As Long</font>
    dwMessageSize <font color="#000080">As Long</font>
    dwProviderReserved <font color="#000080">As Long</font>
    szProtocol <font color="#000080">As String</font> * WSAPROTOCOL_LEN
<font color="#000080">End Type</font>

<font color="#000080">Private Declare Function</font> WSAEnumProtocols <span lang="en-us">_
</span><font color="#000080">Lib</font> &quot;ws2_32.dll&quot; <font color="#000080">Alias</font> &quot;WSAEnumProtocolsA&quot; (<font color="#000080">ByVal</font> lpiProtocols <font color="#000080">As Long</font>, <span lang="en-us">_
                                            </span>lpProtocolBuffer <font color="#000080">As Any</font>, <span lang="en-us">_
                                            </span>lpdwBufferLength <font color="#000080">As Long</font>) <font color="#000080">As Long</font>

<font color="#000080">Private Const</font> SOL_SOCKET = 65535
<font color="#000080">Private Const</font> SO_PROTOCOL_INFO = &amp;H2004

<font color="#000080">Private Declare Function</font> getsockopt <span lang="en-us">_
</span><font color="#000080">Lib</font> &quot;ws2_32.dll&quot; (<font color="#000080">ByVal</font> s <font color="#000080">As Long</font>, <span lang="en-us">_</span>
<span lang="en-us">                  </span><font color="#000080">ByVal</font> level <font color="#000080">As Long</font>, <span lang="en-us">_
                  </span><font color="#000080">ByVal</font> optname <font color="#000080">As Long</font>, <span lang="en-us">_
                  </span><font color="#000080">ByRef</font> optval <font color="#000080">As Any</font>, <span lang="en-us">_
                  </span><font color="#000080">ByRef</font> optlen <font color="#000080">As Long</font>) <font color="#000080">As Long</font></pre>
      <pre><font color="#000080">Private Function</font> GuidToString(udtGuid <font color="#000080">As</font> Guid) <font color="#000080">As String</font>
    <font color="#008000">'</font>
    <font color="#000080">Dim</font> strGuid <font color="#000080">As String</font>
    <font color="#000080">Dim</font> lngRetVal <font color="#000080">As Long</font>
    <font color="#008000">'</font>
    strGuid = String(80, Chr(0))
    <font color="#008000">'</font>
    lngRetVal = StringFromGUID2(udtGuid, strGuid, 80&amp;)
    <font color="#008000">'</font>
    <font color="#000080">If</font> lngRetVal &gt; 0 <font color="#000080">Then</font>
        GuidToString = StrConv(strGuid, vbFromUnicode)
    <font color="#000080">End If</font>
    <font color="#008000">'</font>
<font color="#000080">End Function</font></pre>
    </td>
  </tr>
</table>
        <p><span lang="en-us">It seems that the <font face="Courier New">CProtocol</font> class is able now to 
        provide us with the objects that can retrieve the transport protocol info 
        for a particular socket. Let's test the class module. Open the code 
        editor for the <font face="Courier New">frmMain</font> form and type the following code in the 
        <font face="Courier New">cmdProtocol_Click</font> event procedure that will print a couple of values of the 
        object properties.</span></p>
        <table border='0' width='80%' bgcolor='#F8F8F8' cellspacing='0' cellpadding='2'>
  <tr>
    <td width='100%'>
      <pre><font color="#000080">Private Sub</font> cmdProtocol_Click()
    <font color="#008000">'</font>
    <font color="#000080">Dim</font> objProtocol <font color="#000080">As</font> CProtocol
    <font color="#000080">Dim</font> lngSocket   <font color="#000080">As Long</font>
    <font color="#008000">'</font>
    <font color="#000080">If Not</font> lvSockets.SelectedItem <font color="#000080">Is Nothing Then</font>
        <font color="#008000">'</font>
        <font color="#000080">Set</font> objProtocol = <font color="#000080">New</font> CProtocol
        lngSocket = <font color="#000080">CLng</font>(lvSockets.SelectedItem.Text)
        <font color="#008000">'</font>
        <font color="#000080">If</font> objProtocol.GetBySocketHandle(lngSocket) <font color="#000080">Then</font>
            <font color="#008000">'</font>
            <font color="#000080">Debug.Print</font> objProtocol.ProtocolName
            <font color="#000080">Debug.Print</font> objProtocol.ProviderId
            <font color="#008000">'</font>
        <font color="#000080">End If</font>
        <font color="#008000">'</font>
        <font color="#000080">Set</font> objProtocol = <font color="#000080">Nothing</font>
        <font color="#008000">'</font>
    <font color="#000080">End If</font>
    <font color="#008000">'</font>
<font color="#000080">End Sub</font></pre>
    </td>
  </tr>
</table>
        <p><span lang="en-us">Press F5 to run the application. Cerate new socket 
        with parameters shown in the table below:</span></p>
        <p>
        <table border="0" cellpadding="3" cellspacing="3" style="border-collapse: collapse" bordercolor="#111111" width="296" id="AutoNumber2">
          <tr>
            <td width="136"><b><span lang="en-us">Combobox control</span></b></td>
            <td width="139"><b><span lang="en-us">Item </span></b></td>
          </tr>
          <tr>
            <td width="136"><span lang="en-us">Address family</span></td>
            <td width="139"><span lang="en-us">AF_INET</span></td>
          </tr>
          <tr>
            <td width="136"><span lang="en-us">Socket type</span></td>
            <td width="139"><span lang="en-us">SOCK_STREAM</span></td>
          </tr>
          <tr>
            <td width="136"><span lang="en-us">Protocol</span></td>
            <td width="139"><span lang="en-us">IPPROTO_TCP</span></td>
          </tr>
        </table>        
        </p>
        <p>Then click the Protocol Info button. What do you have in the 
        <i>Immediate</i> window? I have got the following lines as output:</p>
        <p class="code">MS.w95.spi.tcp <br>
        {FF017DE0-CAE9-11CF-8A99-00AA0062C609}</p>
        <p>It works! But it is not so cool to see how it works only in design 
        time. We can enhance our sample with a very little effort, so we can see 
        the protocol info data in run time. Do you still remember the
        <a href="../enumprotocols/enumprotocols-01.asp">TransportProtocols 
        project</a>? Let's attach the form used in that project to the current 
        one.</p>
        <p align="center">
        <img border="0" src="../enumprotocols/enumprotocols-01.gif"></p>
        <table align='center' border='1' width='80%' bgcolor='#F8F8F8' cellspacing='0' cellpadding='4'>
  <tr>
    <td width='100%'>
      <p>It is not so easy as it might be at the first sight. The problem is 
      that this form, in the TransortProtocols project, has the same name - 
      frmMain, and the current project doesn't accept that form as we already 
      have the frmMain form in the project. This <span lang="en-us">is </span>just a disadvantage of writing 
      <span lang="en-us">of </span>a technical saga for the web. Sometimes I develop a sample and don't know 
      what I'll do tomo<span lang="en-us">r</span>row. I'm sorry for that. But let's keep it simple, there 
      is a trick. Just rename the frmMain form to frmMainX, for example, add to 
      the project another frmMain, name it as frmProtocol. And finally, rename 
      frmMainX <span lang="en-us">to</span> frmMain. There is another tip! Just download the sample at 
      this page :).</table>
        <p>The idea of the reusing of the form is very simple. We'll add new 
        property to the form - <font face="Courier New">Protocol</font>, which needs to be initialized before 
        the form will be loaded. Code in the <font face="Courier New">Form_Load</font> event procedure will 
        check the <font face="Courier New">Protocol</font> property value; if that value is an instance of the
        <font face="Courier New">CProtocol</font> class, data from that object will be used to display. If the 
        <font face="Courier New">Protocol</font> property has no any value (object), then the form will work as 
        supposed to work in the <font face="Courier New">TransportProtocols</font> project. So the things we 
        need to do are:</p>
        <ol>
          <li>Create a new property.<br>
&nbsp;</li>
          <li>Modify the <font face="Courier New">Form_Load</font> event procedure<br>
&nbsp;</li>
          <li>Modify the <font face="Courier New">UpdateListViews</font> procedure in the form. That procedure 
          is responsible for display of the protocol parameters in the listview 
          controls.</li>
        </ol>
        <p>1. Create the <font face="Courier New">Protocol</font> property:</p>
        <table border='0' width='80%' bgcolor='#F8F8F8' cellspacing='0' cellpadding='2'>
  <tr>
    <td width='100%'>
      <pre><font color="#008000">'Private m_colProtocols As CProtocols</font><font color="#000080">
Private</font> m_objProtocol <font color="#000080">As</font> CProtocol
'

<font color="#000080">Public Property Set</font> Protocol(objProtocol <font color="#000080">As</font> CProtocol)
    '
    <font color="#000080">If Not</font> objProtocol <font color="#000080">Is Nothing Then</font>
        <font color="#000080">Set</font> m_objProtocol = objProtocol
    <font color="#000080">End If</font>
    '
<font color="#000080">End Property</font></pre>
    </td>
  </tr>
</table>
        <p>2. Modify the <font face="Courier New">Load_Form</font> event procedure:</p>
        <table border='0' width='80%' cellspacing='0' cellpadding='2'>  <tr>
    <td width='100%'  class='code'>
    <pre><font color="#000080">Private Sub</font> Form_Load()
    '
    <font color="#000080">Dim</font> i             <font color="#000080">As Integer
    Dim</font> objProtocol   <font color="#000080">As</font> CProtocol
    '
    <font color="#000080">Call</font> InitListViews
    '
    <font color="#000080">With</font> TabStrip1
        '
        <font color="#000080">For</font> i = 0 <font color="#000080">To</font> 2
            '
            ListView1(i).Move .ClientLeft, .ClientTop, .ClientWidth, .ClientHeight
            '
        <font color="#000080">Next</font> i
        '
    <font color="#000080">End With</font>
    '
    ListView1(0).ZOrder 0
    '</pre>
    </td>
  </tr>
  <tr>
    <td width='100%' bgcolor='#F8F8F8' class='code'>&nbsp;&nbsp;&nbsp;
    <font color="#000080">If</font> m_objProtocol <font color="#000080">Is 
    Nothing Then</font></td>
  </tr>
  <tr>
    <td width='100%'  class='code'>
    <pre>        '
        <font color="#000080">Set</font> m_colProtocols = <font color="#000080">New</font> CProtocols
        '
        <font color="#000080">If</font> m_colProtocols.Count &gt; 0 <font color="#000080">Then</font>
            '
            <font color="#000080">For Each</font> objProtocol <font color="#000080">In</font> m_colProtocols
                '
                Combo1.AddItem objProtocol.ProtocolName
                '
            <font color="#000080">Next</font>
            '
            Combo1.ListIndex = 0
            '
        <font color="#000080">End If</font>
        '</pre>
    </td>
  </tr>
  <tr>
    <td width='100%' bgcolor='#F8F8F8' class='code'>
    <pre>    <font color="#000080">Else</font>
        '
        <font color="#000080">Call</font> UpdateListViews(0)
        '
    <font color="#000080">End If</font></pre>
    </td>
  </tr>
  <tr>
    <td width='100%'  class='code'>
    <pre>    '
<font color="#000080">End Sub</font></pre>
    </td>
  </tr>
</table>
        <p>3. Modify the <font face="Courier New">UpdateListViews</font> procedure:</p>
        <table border='0' width='80%' cellspacing='0' cellpadding='2'>  <tr>
    <td width='100%'  class='code'><font color="#000080">Private Sub</font> 
    UpdateListViews(Index <font color="#000080">As Integer</font>) <br>
&nbsp;&nbsp;&nbsp; <font color="#008000">'</font> <br>
&nbsp;&nbsp;&nbsp; <font color="#000080">Dim</font> strTemp&nbsp;&nbsp;&nbsp;&nbsp;
    <font color="#000080">As String</font></td>
  </tr>
  <tr>
    <td width='100%' bgcolor='#F8F8F8' class='code'>&nbsp;&nbsp;&nbsp;
    <font color="#000080">Dim</font> objProtocol <font color="#000080">As</font> 
    CProtocol <br>
&nbsp;&nbsp;&nbsp; <font color="#008000">' </font><br>
&nbsp;&nbsp;&nbsp; <font color="#000080">If</font> m_objProtocol
    <font color="#000080">Is Nothing Then </font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#000080">Set</font> 
    objProtocol = m_colProtocols(Index) <br>
&nbsp;&nbsp;&nbsp; <font color="#000080">Else</font> <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#000080">Set</font> 
    objProtocol = m_objProtocol <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Combo1.AddItem 
    objProtocol.ProtocolName <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Combo1.ListIndex = 0 <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Combo1.Enabled =
    <font color="#000080">False</font> <br>
&nbsp;&nbsp;&nbsp; <font color="#000080">End If </font><br>
&nbsp;&nbsp;&nbsp; <font color="#008000">'</font> <br>
&nbsp;&nbsp;&nbsp; <font color="#000080">With</font> objProtocol</td>
  </tr>
  <tr>
    <td width='100%'  class='code'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <font color="#008000">' </font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ListView1(0).ListItems(1).SubItems(1) 
    = .ProtocolName<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ...<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ...</td>
  </tr>
</table>
        <p>Now let's change source code of the <font face="Courier New">cmdProtocol_Click</font> event procedure 
        of the main form.</p>
        <table border='0' width='80%' cellspacing='0' cellpadding='2'>  <tr>
    <td width='100%'  class='code'><font color="#000080">Private Sub</font> 
    cmdProtocol_Click() <br>
&nbsp;&nbsp;&nbsp; ' <br>
&nbsp;&nbsp;&nbsp; <font color="#000080">Dim</font> objProtocol
    <font color="#000080">As</font> CProtocol <br>
&nbsp;&nbsp;&nbsp; <font color="#000080">Dim</font> lngSocket&nbsp;&nbsp;
    <font color="#000080">As Long</font></td>
  </tr>
  <tr>
    <td width='100%' bgcolor='#F8F8F8' class='code'>&nbsp;&nbsp;&nbsp;
    <font color="#000080">Dim</font> frm&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <font color="#000080">As</font> frmProtocol</td>
  </tr>
  <tr>
    <td width='100%'  class='code'>&nbsp;&nbsp;&nbsp; ' <br>
&nbsp;&nbsp;&nbsp; <font color="#000080">If Not</font> lvSockets.SelectedItem
    <font color="#000080">Is Nothing Then </font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#000080">Set</font> 
    objProtocol = <font color="#000080">New</font> CProtocol <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lngSocket = <font color="#000080">
    CLng</font>(lvSockets.SelectedItem.Text) <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#000080">If</font> 
    objProtocol.GetBySocketHandle(lngSocket) <font color="#000080">Then</font>
    <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; '</td>
  </tr>
  <tr>
    <td width='100%' bgcolor='#F8F8F8' class='code'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <font color="#000080">Set</font> frm = <font color="#000080">New</font> 
    frmProtocol<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <font color="#000080">Set</font> frm.Protocol = objProtocol<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; frm.Show 
    vbModal</td>
  </tr>
  <tr>
    <td width='100%'  class='code'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    ' <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#000080">End If </font>
    <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#000080">Set</font> 
    objProtocol = <font color="#000080">Nothing</font> <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' <br>
&nbsp;&nbsp;&nbsp; <font color="#000080">End If</font> <br>
&nbsp;&nbsp;&nbsp; ' <br>
    <font color="#000080">End Sub</font></td>
  </tr>
</table>
        <p>Now is the show time! Press F5 to run the sample, create a new 
        socket, and click the Protocol Info button. </p>
        <p>Cool! Isn't it?</p>
        </blockquote>
        <p class="ArticleH2"><span lang="en-us">Conclusion</span></p>
        <blockquote>
        <p><span lang="en-us">You might expect that I'll explain here the reason 
        of that we pay attention to the transport protocol stuff at all. But I'm 
        not going to do that - sorry, you'll see and understand that in the 
        following articles. Maybe you'll find out that today's work is wasting 
        of time, it's all about a given program design, and I decided to put 
        that stuff in my arsenal. The next step is about how to establish 
        connection to the remote host and you'll see how the 
        <font face="Courier New">CProtocol</font> class is 
        used for that operation.</span></p>
        </blockquote>
        <p>
<p>        
    <hr noshade color="#FF9933">
    <table width="90%" align="center" border="0">
      <tr>
        <td width="25%">
          <img border="0" src="../../../images/comments.gif">
        </td>
        <td width="75%">
          Please, post here only feedback for the article/tutorial/sample you
          have read above.<br>
          If you have any question and like to get an answer, post your messages in the <a href="http://www.vbip.com/forum/">Forum</a>.
        <td>
      </tr>
    </table>
    
    
			<p><b><font face="Arial" size="2" color="#800000"><a href="../../../comment.asp?654">Error</a></font></b><br>
			<i><font color="#808080" face="Times New Roman" size="2">Manfred Thursday, December 20, 2001</font></i>	
			</p>
			
			<p><b><font face="Arial" size="2" color="#800000"><a href="../../../comment.asp?724">Top banana</a></font></b><br>
			<i><font color="#808080" face="Times New Roman" size="2">Mark Saturday, February 02, 2002</font></i>	
			</p>
			
			<p><b><font face="Arial" size="2" color="#800000"><a href="../../../comment.asp?926">Error ++</a></font></b><br>
			<i><font color="#808080" face="Times New Roman" size="2">Craig Krause Saturday, June 15, 2002</font></i>	
			</p>
			
        <p>
        <form name="newcomm" method="POST" action="../../../add_comments.asp">
          <p><input align="right" border="0" src="../../../images/addyours2.gif" name="I1" type="image"></p>
          <input type="hidden" name="page" value="/winsock-api/socket-protocol-info/socket-protocol-info-01.asp">
          <input type="hidden" name="title">
	  <input type="hidden" name="actionID" value="add">
        </form>
        <SCRIPT LANGUAGE="JavaScript">
        	{document.newcomm.title.value = document.title}
        </SCRIPT>
	<br>
        <p>
        <hr noshade color="#FF9933">
</p>     
        </p>
      </blockquote>
<p><center>
<!-- start BITS ad HTML -- bottom of page 468x60 banner www.bitsonthewire.com         --> 
  <iframe src="http://ads.bitsonthewire.com/admgriframe.asp?siteid=1126&ad_type=2" width=468 height=60 marginwidth=0 marginheight=0 hspace=0 vspace=0 frameborder=0 scrolling=no> 
    <a href="http://ads.bitsonthewire.com/adrdrmanager.asp?loc=2">
      <p>
      <img border="0" src="http://ads.bitsonthewire.com/admanager.asp?loc=2&siteid=1126&ad_type=2">
    </a>
  </iframe> 
<!-- stop BITS ad HTML -- bottom of page 468x60 banner                                --> 
</center></p>
    </td>
</table>
<table border="1" width="100%" cellspacing="1" cellpadding="2" bordercolor="#800000">
  <tr>
    <td width="100%" bgcolor="#FF9933">
      <font color="#FFFFCC">
      <table border="0" width="100%" cellspacing="0" cellpadding="0">
        <tr>
          <td width="37%"></td>
          <td width="63%">
            <p align="right" class="tbcaption"><a href="../../default.asp" class="tbcaption">Home</a> -
            <a href="../../tools.asp" class="tbcaption">Tools&amp;Technologies</a> -
            <a href="../default.asp" class="tbcaption">Winsock API</a> - 
            Socket's transport protocol and other options</td>
        </tr>
      </table>
      </font>
    </td>
  </tr>
</table>
&nbsp;<table border="0" width="100%" cellspacing="0" cellpadding="0">
  <tr>
    <td width="121" valign="top">
<!-- START OF WEBTRENDS LIVE TAG -->
<!-- Copyright 2001 NetIQ Corporation -->
<!--  For privacy concerns, check our Privacy Policy at http://www.webtrendslive.com/privacy_policy.htm -->
<SCRIPT LANGUAGE="JavaScript">
<!--
// Modification of this code is not allowed and will permanently disable your account!
// SiteName:  Visual Basic Internet Programming
function wtl_Tag4_27048()
{
	function D8( d)
	{
		var fwd=1, seed= new Date('01/01/2000'), key= "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";
		var s= key.charAt( d.getFullYear()-2000)+key.charAt( d.getMonth()+1)+key.charAt( d.getDate());
		s+= key.charAt( d.getHours())+key.charAt( d.getMinutes())+key.charAt( d.getSeconds());
		while( seed.getDay()!=fwd) seed= new Date(seed.getTime() + 86400000);
		var w= Math.floor( (d.getTime()-(seed.getTime()+86400000)) / 604800000 );
		s+= key.charAt( (w-(w%16))/16 );
		s+= key.charAt( w%16);
		return s;
	}

	var t = new Date();
	var W="tagver=4&si=27048&fw=1&bn=13";
	W+="&tz="+escape(t.getTimezoneOffset());
	W+="&ch="+escape(t.getHours());
	W+="&cl="+escape(D8(t));
	W+="&ti="+escape(document.title);
	W+="&url="+escape(window.document.URL);
	W+="&rf="+escape(window.document.referrer);
	W+="&js=Yes";
	W+="&ul="+(navigator.appName=="Netscape"?navigator.language:navigator.userLanguage);
	if(typeof(screen)=="object")
	{
	W+="&sr="+screen.width+"x"+screen.height;
	W+="&cd="+screen.colorDepth;
	W+="&jo="+(navigator.javaEnabled()?"Yes":"No");
	}
	
	
	document.write('<A TARGET="_blank" HREF="http://www.webtrendslive.com/redirect.asp?siteID=27048">');
	document.write('<IMG ID="WTL_TAG" BORDER="0" WIDTH="100" HEIGHT="30" ALT="This Site Tracked by WebTrendsLive." SRC="http://p.wtlive.com/S003-00-9-14-186109-27048/button4.asp?'+W+'">');
	document.write('</A>');
	
}	

wtl_Tag4_27048();
//-->
</SCRIPT>


<NOSCRIPT>
<A TARGET="_blank" HREF="http://www.webtrendslive.com/redirect.asp?siteID=27048">
<IMG BORDER="0" WIDTH="100" HEIGHT="30" ALT="This Site Tracked by WebTrendsLive." SRC="http://p.wtlive.com/S003-00-9-14-186109-27048/button4.asp?tagver=4&si=27048&fw=1&bn=13&js=No&"></A></NOSCRIPT>


<!-- END OF WEBTRENDS LIVE TAG -->

     
      </td>
    <td>
<p align="center" class="barsidecaption"><a href="../../default.asp">Home</a> | <a href="../../whatsnew.asp">What's
New</a> | <a href="../../tools.asp"> Tools
&amp; Technologies</a> | <a href="../../resources.asp">Resources</a> | <a href="../../resources/books/default.asp">Books</a>
 | <a href="../../forum/">Forum</a></p>
<p align="center" class="barsidecaption">Report about any problems and errors to <a href="mailto:webmaster@vbip.com">webmaster@vbip.com</a><br>
Copyright  1998 - 2002 by <a href="mailto:oleg@vbip.com"> Oleg Gdalevich</a></p>
    </td>
    <td valign="top" width="140">
<p align="center">
<a target="_blank" href="http://www.amazon.com/exec/obidos/ASIN/B00005AFI2/vbipvisualbasici">
<img border="0" src="../../images/frontpage_button.gif" align="right" width="100" height="38"></a>
    </td>
  </tr>
</table>
</body>

</html>
