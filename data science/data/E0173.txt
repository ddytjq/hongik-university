ID=E0173
URL=http://msdn.microsoft.com/visualc/productinfo/previous/vc6/tips/default.asp
SIZE=51913
DATE=12/07/02
TIME=19:18:20
DATASET=C
HTML=
<html>
<head>
<title>Tips and Tricks</title>
<meta name="KEYWORDS" content="technical articles, whitepapers" />
<meta name="DESCRIPTION" content="Get tips for using Visual C++ 6.0. " />
<meta name="MS.LOCALE" content="EN-US" />
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1" />
<meta name="DTC_TEMPLATE" content="TEMPLATE=endnode" />

		          <link rel="stylesheet" href="/visualc/css.asp?template=EP" type="text/css" />
          

     <meta http-equiv="PICS-Label" CONTENT='(PICS-1.1 "http://www.rsac.org/ratingsv01.html" l comment "RSACi North America Server" by "inet@microsoft.com" r (n 0 s 0 v 0 l 0))' />
     <script src="/products/shared/global.js" type="text/javascript"></script>
     
<link rel="stylesheet" type="text/css" href="/library/flyoutmenu/default.css" />


	
	<script type="text/javascript"><!--
	
	sImgDefaultArrow = "/products/shared/images/imgArrwUp_VS.gif";
	sImgExpandedArrow = "/products/shared/images/imgArrwDwn_VS.gif";

	if (sImgDefaultArrow == ""){
		sImgDefaultArrow = "/products/shared/images/arrow_default.gif";
	}
	if (sImgExpandedArrow == ""){
		sImgExpandedArrow = "/products/shared/images/arrow_expand.gif";
	}
	
	//-->
	</script>
   
</head>
<body bgcolor="#ffffff" topmargin="0" leftmargin="0" marginheight="0" marginwidth="0">	


          <span id="donotprint">
<!-- Start: ToolBar V2.0-->
<script type="text/javascript" language="JavaScript" src="/library/toolbar/toolbar.js"></script>
<script type="text/javascript" language="JavaScript" src="/library/toolbar/en-us/globalMNP.js"></script>
<script type="text/javascript" language="JavaScript" src="/products/shared/toolbar_vstudio.js"></script>
<!-- Start: ToolBar for down-level browsers-->
<span id="TBDownLevelDiv">
	<table width="100%" cellpadding="0" cellspacing="0" border="0" bgcolor="#6699CC">
		<tr>
			<td bgcolor="#6699CC" valign="top" width="250" rowspan="2"><a href="/visualc/" target="_top"><img src="/products/shared/images/bnr_VisualStudio.gif" alt="Visual C++ Home" border="0" /></a></td>
			<td bgcolor="#6699CC" valign="top" height="20" width="19" align="right"><img src="/library/toolbar/images/curve.gif" /></td>
			<td bgcolor="#000000" valign="middle" height="20" align="right" nowrap colspan="2"><font color="#ffffff" face="Verdana, Arial, Helvetica" size="1">
					&nbsp;&nbsp;<a style="color:#ffffff;text-decoration:none;" href="http://www.microsoft.com/products/" target="_top"><font color="#ffffff">All Products</font></a>&nbsp;&nbsp;<font color="#ffffff">|</font>
					&nbsp;&nbsp;<a style="color:#ffffff;text-decoration:none;" href="http://www.microsoft.com/support/" target="_top"><font color="#ffffff">Support</font></a>&nbsp;&nbsp;<font color="#ffffff">|</font>
					&nbsp;&nbsp;<a style="color:#ffffff;text-decoration:none;" href="http://search.microsoft.com/" target="_top"><font color="#ffffff">Search</font></a>&nbsp;&nbsp;<font color="#ffffff">|</font>
					&nbsp;&nbsp;<a style="color:#ffffff;text-decoration:none;" href="http://www.microsoft.com/" target="_top"><font color="#ffffff">microsoft.com Guide</font></a>&nbsp;&nbsp;</font></td>
		</tr>
		<tr>
			<td bgcolor="#6699CC" valign="top" height="40" width="19"><img src="/library/Images/Gifs/General/Trans.gif" width="1" height="1" border="0" alt></td>
			<td valign="top" height="40" align="right" nowrap colspan="2"><a href="/isapi/gomscom.asp?target=/" target="_top"><img src="/library/toolbar/images/mslogo6699CC.gif" width="112" height="40" alt="microsoft.com home" border="0"></a></td>
		</tr>
		<tr>
	<!-- Start: Local menus -->
		<td bgcolor="#6699CC" height="20" VALIGN="MIDDLE" NOWRAP COLSPAN="4">
			<font color="#FFFFFF" class="fontSize1"><b>
				&nbsp;&nbsp;<a style="color:#FFFFFF;text-decoration:none;" href="/visualc/" target="_top"><font color="#FFFFFF">Visual C++ Home</font></a>&nbsp;&nbsp;<font color="#FFFFFF">|</font>
		
			</b></font>
		</td>
	<!-- End: Local menus -->
		</tr>
	</table>
</span>
<!-- End: ToolBar for old browsers-->

<script language="JavaScript" type="text/javascript">
<!--// Hide from old browsers

var ToolBar_Supported = ToolBar_Supported;
if (ToolBar_Supported != null && ToolBar_Supported == true && (navigator.platform=="Win32"))
{
	TBDownLevelDiv.style.display ='none';
	drawToolbar();
	var fBrowserOK = true;
}

//-->
</script>
<!-- End: ToolBar V2.0-->



</span>
          <a name="top"></a>
          <table border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td bgcolor="#ffffff" height="1"><img src="/products/shared/images/ts.gif" height="1" width="1" /></td>
			</tr>
		</table>
          <table cellpadding="0" cellspacing="0" border="0" width="100%">
               <tr valign="top">
                    <td valign="top">
                         <table cellpadding="0" cellspacing="0" border="0" width="100%">
                              <tr valign="top">
                                   <td width="178" valign="top" id="donotprint" > 

									<!-- start leftnav And search code -->
										<table border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#6699CC">
											<tr height="38">
												<td bgcolor="#6699CC" align="center">
													<!-- quick search-->
													<table cellpadding="0" cellspacing="0" border="0" width="179">
													
													<form action="http://search.microsoft.com/us/products/vs/visualc/advanced_search.asp" method="GET" id="form1" name="form1">
													
														<tr>
															<td><img src="/products/shared/images/Trans.gif" height="1" width="5"></td>
															<td>
														<!--[if IE ]><span class="fontSize1" style="color:#FFFFFF">Search This Site</span><br>														<input type="hidden" name="IntCat" value="0" />														<input type="hidden" name="Boolean" value="ALL" />																													<input type="hidden" name="Nq" value="new" />																													<input type="text" name="qu" size="14" maxlength="255" style="height:20 px; width: 125 px;" />																													<img src="/products/shared/images/trans.gif" height="1" width="2" border="0" />															<input alt="go" type="submit" name="finish" value="Go" class="btnSearch">														<![endif]-->
														<![if ! ie ]>
															<span class="fontSize1" style="color:#FFFFFF">Search This Site<br>
															<input type="HIDDEN" name="IntCat" value="0" />
															<input type="HIDDEN" name="Boolean" value="ALL" />
															<input type="HIDDEN" name="Nq" value="NEW" />
															<input type="TEXT" name="qu" size="10" maxlength="255" />
															<input alt="Go" type="SUBMIT" name="FINISH" value="Go" />
															</span>
														<![endif]>
														</td>
														</tr>
										      		</form>
													</table>
													<!--end quick search -->
												</td>
												<td width="1" bgcolor="#6699CC"><img src="/products/shared/images/Trans.gif" alt height="0" width="1" border="0"></td>
											</tr>
											<tr>
												<td>
													<table cellpadding="0" cellspacing="0" border="0" width="100%" bgcolor="#6699CC">
														<tr>
															<td><img src="/products/shared/images/Trans.gif" height="1" width="3"></td>
															<td VALIGN="TOP" class="AdvSearch"><a HREF="http://search.microsoft.com/us/products/vs/visualc/advanced_search.asp?IntCat=0">Advanced Search</a></td>
														</tr>
													</table>
												</td>
											</tr>
										</table>
										<table border="0" cellpadding="0" cellspacing="0" width="100%" onmouseover="if(document.readyState=='complete'&amp;&amp;fBrowserOK)delayRemove();" onmouseout="if (document.readyState=='complete'&amp;&amp;fBrowserOK)cancelDelay();">
										<tr>
										<td bgcolor="#6699CC"><img src="/products/shared/images/Trans.gif" alt height="9" width="179"></td>
										<td width="1" bgcolor="#6699CC"><img src="/products/shared/images/Trans.gif" alt height="0" width="1" border="0"></td>
										</tr>
										</table>

										<table cellpadding="0" cellspacing="0" border="0" width="100%">
										    <tr>
										         <td>
										         
<table class="flyoutMenu" menudata="/visualc/inc/MnpXmlDataGen.asp?subroot=productinfo" width="180" cellpadding="2" cellspacing="0" border="0" >
	<tr>
		<td>

			<table width="175" cellpadding="0" cellspacing="0" border="0">
				<tr>
				
					<td class="flyoutLink" ><a href="/vstudio/default.asp">Visual Studio Home</a></td>
				
				</tr>
			</table>

			<table width="175" cellpadding="0" cellspacing="0" border="0">
				<tr>
				
					<td class="flyoutLink" ><a href="/visualc/default.asp">Visual C++ Home</a></td>
				
				</tr>
			</table>

			<table width="175" cellpadding="0" cellspacing="0" border="0">
				<tr>
				
					<td class="flyoutLink" handle="1001"><a href="/visualc/productinfo/default.asp">Product Information</a></td>
				
				</tr>
			</table>

			<table width="175" cellpadding="0" cellspacing="0" border="0">
				<tr>
				
					<td class="flyoutLink" handle="1074"><a href="/visualc/howtobuy/default.asp">How to Buy</a></td>
				
				</tr>
			</table>

			<table width="175" cellpadding="0" cellspacing="0" border="0">
				<tr>
				
					<td class="flyoutLink" handle="1078"><a href="/visualc/techinfo/default.asp">Technical Resources</a></td>
				
				</tr>
			</table>

			<table width="175" cellpadding="0" cellspacing="0" border="0">
				<tr>
				
					<td class="flyoutLink" handle="1084"><a href="/visualc/downloads/default.asp">Downloads</a></td>
				
				</tr>
			</table>

			<table width="175" cellpadding="0" cellspacing="0" border="0">
				<tr>
				
					<td class="flyoutLink" handle="1082"><a href="/visualc/support/default.asp">Support</a></td>
				
				</tr>
			</table>

			<table width="175" cellpadding="0" cellspacing="0" border="0">
				<tr>
				
					<td class="flyoutLink" handle="1142"><a href="/visualc/community/default.asp">Community</a></td>
				
				</tr>
			</table>
			
		</td>
	</tr>
</table>

<table class="flyoutMenu" menudata="/vstudio/templateMembers.xml" width="180" cellpadding="2" cellspacing="0" border="0" >
	<tr>
		<td>

			<table width="175" cellpadding="0" cellspacing="0" border="0">
				<tr>
				
					<td class="flyoutLink" handle="0420"><a href="/vstudio/">Developer Tools</a></td>
				
				</tr>
			</table>


<html>
<head>
<!--TOOLBAR_START-->
<!--TOOLBAR_EXEMPT-->
<!--TOOLBAR_END-->
</head>
<body>
</body>
</html>			
		</td>
	</tr>
</table>

												</td>
												</tr>
											</table>
										<!-- end leftnav And search code -->
									<table cellpadding="0" cellspacing="0" border="0" width="100%">
									    <tr>
									         <td><br>

     <!-- -->

		
                                                  </td>
                                             </tr>
                                        </table>
                                   </td>
                                   <td width="100%"> 
								<table cellpadding="20" cellspacing="0" border="0" width="100%">
                                             <tr>
                                                  <td style="padding: 11px 20px 20px 20px;">
<!-- -->

                              <table cellpadding="0" cellspacing="0" border="0" width="100%">
		                         <tr>
		                    		<td><span id="donotprint" class="fontSize1" style="color: #0066cc;"><a href="/visualc/productinfo/default.asp" class="eyebrow" TARGET="_top">Visual C++ .NET Product Information</a>
			
			&nbsp;&gt;&nbsp;<a href="/visualc/productinfo/previous/default.asp" class="eyebrow" TARGET="_top">Visual C++ 6.0</a>
			
			</span></td>
		                    	</tr>
		                    	<tr>
		                    		<td><span id="donotprint"><img src="/products/shared/images/ts.gif" width="1" height="5" alt=""></span></td>
		                     	</tr>
		                    	<tr>
		                    		<td><h1>Tips and Tricks</h1></td>
		                    	</tr>
		                     	<tr>
		                     		<td><h2 class="Subtitle"></h2></td>
		                     	</tr>
		                     	<tr>
		                    		<td><img src="/products/shared/images/ts.gif" width="1" height="5" alt=""></td>
		                     	</tr>
		                     	<tr>
		                    		<td height="1" bgcolor="#cccccc" width="100%"><img src="/products/shared/images/ts.gif" width="1" height="1" alt=""></td>
		                    	</tr>
		                    	<tr>
		                    		<td>
		                    			<table cellpadding="0" cellspacing="0" border="0" width="100%">
		                    				<tr>
		                    					<td align="left">
		                    						<table cellpadding="0" cellspacing="0" border="0">
		                    							<tr>
		                    								
		                    								<td><img src="/products/shared/images/ts.gif" width="28" height="20" alt=""></td>
		                    							</tr>
		                    						</table>		
		                    					</td>							 
		                    					<td align="right" >
		                    						
		                    					</td>
		                    				</tr>
		                    			</table>
		                    		</td>						
		                    	</tr>
		                     	<tr>
		                    		<td height="1" bgcolor="#CCCCCC" width="100%"><img src="/products/shared/images/ts.gif" width="1" height="1" alt=""></td>
		                    	</tr>
		                    </table>
		                    <table cellspacing="0" cellpadding="0" border="0" width="100%">
		                    	<tr>
		                    		<td><img src="/products/shared/images/ts.gif" height="10" width="1" alt=""></td>
		                    	</tr>
		                    </table>
                                                       <table cellpadding="0" cellspacing="0" border="0" width="100%">
                                                            <tr>
                                                                 <td align="left" valign="top">		                    
	                                                             		                    	                                           
<!-- -->

<!-- Main Content Area START -->

     <table id="donotprint" align="right" cellpadding="0" cellspacing="0" border="0" width="175">
          <tr><td><img src="/products/shared/images/ts.gif" width="1" height="4" alt></td><td><img src="/products/shared/images/ts.gif" width="1" height="1" alt></td></tr>
          <tr>
               <td><img src="/products/shared/images/ts.gif" width="10" height="1" alt></td>
               <td>


			<span id="donotprint">
			<table cellpadding="0" cellspacing="0" border="0 " width="175">
				<tr valign="top" align="left">
					<td>
						<table id="headeridArticle" cellpadding="0" cellspacing="0" border="0" width="175" class="componentBorder" onmouseover="if (fBrowserOK) chngColour('idArticle')" onmouseout="if (fBrowserOK) chngColour('idArticle')">
							<tr>								
								<td id="articleidArticle" class="componentHeader" width="175"><img src="/products/shared/images/ts.gif" width="6" border="0">On this page</td>
                                <script language="javascript" type="text/javascript">
								<!--	
								if (fBrowserOK) {
                                document.write("<td style=\"width:1px;background-color:#999999;\"></td>")
								document.write("<td id=\"arrowColidArticle\" bgcolor=\"#6699CC\" width=\"21\" height=\"17\"><img id=\"ImgArrowidArticle\" src=" + sImgDefaultArrow + " alt=\"collapse menu\" border=\"0\" style=\"cursor:hand;\" onclick=\"change_display\(\'headingidArticle\'\)\"></td>")
								} 
								//-->
								</script>								
							</tr>
						</table>
					</td>
				</tr>
			</table>
			<div id="headingidArticle" style="display:visible">
          	<table id="mainidArticle" cellpadding="8" cellspacing="0" border="0" width="175" class="componentBorder" style="border-top:0px;">
				<tr valign="top" align="left">
					<td width="100%">

						<table cellpadding="0" cellspacing="0" border="0" width="100%">
							<tr>
								<td valign="top" class="componentBodyText"><img src="/products/shared/images/jump2.gif" width="11" border="0" height="11"></td>
								<td class="componentBodyText" align="left" width="100%"><a href="#uncover">Uncover Masked Exceptions</a></td>
							</tr>
							<tr>
								<td><img src="/products/shared/images/ts.gif" width="1" border="0" height="10"></td>
								<td><img src="/products/shared/images/ts.gif" width="1" border="0" height="10"></td>
							</tr>
						</table>

						<table cellpadding="0" cellspacing="0" border="0" width="100%">
							<tr>
								<td valign="top" class="componentBodyText"><img src="/products/shared/images/jump2.gif" width="11" border="0" height="11"></td>
								<td class="componentBodyText" align="left" width="100%"><a href="#win32api">Checking the Return Code of Win32 APIs</a></td>
							</tr>
							<tr>
								<td><img src="/products/shared/images/ts.gif" width="1" border="0" height="10"></td>
								<td><img src="/products/shared/images/ts.gif" width="1" border="0" height="10"></td>
							</tr>
						</table>

						<table cellpadding="0" cellspacing="0" border="0" width="100%">
							<tr>
								<td valign="top" class="componentBodyText"><img src="/products/shared/images/jump2.gif" width="11" border="0" height="11"></td>
								<td class="componentBodyText" align="left" width="100%"><a href="#batching">Avoiding Batching Problems with the IDirect3DDevice2: :DrawPrimitive</a></td>
							</tr>
							<tr>
								<td><img src="/products/shared/images/ts.gif" width="1" border="0" height="10"></td>
								<td><img src="/products/shared/images/ts.gif" width="1" border="0" height="10"></td>
							</tr>
						</table>

						<table cellpadding="0" cellspacing="0" border="0" width="100%">
							<tr>
								<td valign="top" class="componentBodyText"><img src="/products/shared/images/jump2.gif" width="11" border="0" height="11"></td>
								<td class="componentBodyText" align="left" width="100%"><a href="#registrar">Invoking the ATL Registrar for Custom Registry Entries</a></td>
							</tr>
							<tr>
								<td><img src="/products/shared/images/ts.gif" width="1" border="0" height="10"></td>
								<td><img src="/products/shared/images/ts.gif" width="1" border="0" height="10"></td>
							</tr>
						</table>

						<table cellpadding="0" cellspacing="0" border="0" width="100%">
							<tr>
								<td valign="top" class="componentBodyText"><img src="/products/shared/images/jump2.gif" width="11" border="0" height="11"></td>
								<td class="componentBodyText" align="left" width="100%"><a href="#registry">Using Registry Keys to Store User Program Information</a></td>
							</tr>
							<tr>
								<td><img src="/products/shared/images/ts.gif" width="1" border="0" height="10"></td>
								<td><img src="/products/shared/images/ts.gif" width="1" border="0" height="10"></td>
							</tr>
						</table>

						<table cellpadding="0" cellspacing="0" border="0" width="100%">
							<tr>
								<td valign="top" class="componentBodyText"><img src="/products/shared/images/jump2.gif" width="11" border="0" height="11"></td>
								<td class="componentBodyText" align="left" width="100%"><a href="#ATL_Debug">Debugging Reference-Count Problems in Your ATL Components</a></td>
							</tr>
							<tr>
								<td><img src="/products/shared/images/ts.gif" width="1" border="0" height="10"></td>
								<td><img src="/products/shared/images/ts.gif" width="1" border="0" height="10"></td>
							</tr>
						</table>

						<table cellpadding="0" cellspacing="0" border="0" width="100%">
							<tr>
								<td valign="top" class="componentBodyText"><img src="/products/shared/images/jump2.gif" width="11" border="0" height="11"></td>
								<td class="componentBodyText" align="left" width="100%"><a href="#ATL">Overcoming Ambiguous Interface Derivations in ATL</a></td>
							</tr>
							<tr>
								<td><img src="/products/shared/images/ts.gif" width="1" border="0" height="10"></td>
								<td><img src="/products/shared/images/ts.gif" width="1" border="0" height="10"></td>
							</tr>
						</table>

						<table cellpadding="0" cellspacing="0" border="0" width="100%">
							<tr>
								<td valign="top" class="componentBodyText"><img src="/products/shared/images/jump2.gif" width="11" border="0" height="11"></td>
								<td class="componentBodyText" align="left" width="100%"><a href="#Direct3D">Creating Dark Lights in Direct3D for Special Effects</a></td>
							</tr>
							<tr>
								<td><img src="/products/shared/images/ts.gif" width="1" border="0" height="10"></td>
								<td><img src="/products/shared/images/ts.gif" width="1" border="0" height="10"></td>
							</tr>
						</table>

						<table cellpadding="0" cellspacing="0" border="0" width="100%">
							<tr>
								<td valign="top" class="componentBodyText"><img src="/products/shared/images/jump2.gif" width="11" border="0" height="11"></td>
								<td class="componentBodyText" align="left" width="100%"><a href="#STL">Function Pointers as Function Objects</a></td>
							</tr>
							<tr>
								<td><img src="/products/shared/images/ts.gif" width="1" border="0" height="10"></td>
								<td><img src="/products/shared/images/ts.gif" width="1" border="0" height="10"></td>
							</tr>
						</table>

						<table cellpadding="0" cellspacing="0" border="0" width="100%">
							<tr>
								<td valign="top" class="componentBodyText"><img src="/products/shared/images/jump2.gif" width="11" border="0" height="11"></td>
								<td class="componentBodyText" align="left" width="100%"><a href="#MFC">Using MFC to Subclass a Windows Common Dialog</a></td>
							</tr>
							<tr>
								<td><img src="/products/shared/images/ts.gif" width="1" border="0" height="10"></td>
								<td><img src="/products/shared/images/ts.gif" width="1" border="0" height="10"></td>
							</tr>
						</table>

						<table cellpadding="0" cellspacing="0" border="0" width="100%">
							<tr>
								<td valign="top" class="componentBodyText"><img src="/products/shared/images/jump2.gif" width="11" border="0" height="11"></td>
								<td class="componentBodyText" align="left" width="100%"><a href="#parsing">Parsing Compound Strings with AfxExtractSubString()</a></td>
							</tr>
							<tr>
								<td><img src="/products/shared/images/ts.gif" width="1" border="0" height="10"></td>
								<td><img src="/products/shared/images/ts.gif" width="1" border="0" height="10"></td>
							</tr>
						</table>

					</td>
				</tr>
			</table>
			</div><br>
			</span>

      
               </td>
               <td><img src="/products/shared/images/ts.gif" width="10" height="1" alt></td>
          </tr>
          <tr><td><img src="/products/shared/images/ts.gif" width="1" height="4" alt></td><td><img src="/products/shared/images/ts.gif" width="1" height="1" alt></td></tr>          
     </table>



<p><a href="http://www.vcdj.com"><img SRC="/visualc/art/vcdj_tip_logo.gif" align="right" border="0" alt="Tips and Tricks provided by the Visual C++ Developer's Journal (VCDJ). Visit them at www.vcdj.com"></a>

<p>You can quickly navigate through our inventory of Visual C++ tips, provided by the <a href="http://www.vcdj.com/">Visual C++ Developers Journal</a>. Request your <a HREF="http://www.vcdj.com/"> subscription</a> today!</p>
<br>
<a name="uncover"></a>
<h2>VCDJ Tip: Uncover Masked Exceptions</h2>
<p><i>By Glenn Carr</i></p>

<p>System Requirements: Visual C++ 5.0 or greater</p>

<p>If your code uses exceptions extensively for error reporting, you may have some necessary &#147;catch (...)&#148; blocks that mask real errors such as access violations.  In order to catch these types of bugs, you'll need to change the default debugger actions for these exceptions.</p>

<p>While the debugger is active, select &quot;Debug-&gt;Exceptions...&quot;  In the listbox containing the different types of exceptions, select all the items in the list. Next, set the Action to &#147;Stop always,&#148; then press OK. This will cause the debugger to break at any unexpected exception such as an access violation or a division by zero, instead of at the lowest &#147;catch (...)&#148; in the execution context.</p>

				<table cellpadding="0" cellspacing="0" border="0" id="donotprint">
					<tr valign="bottom">
						<td align="left"><a href="/visualc/productinfo/previous/vc6/tips/default.asp#top"><img src="/products/shared/images/top_v1.gif" width="40" height="20" alt="To top of page" border="0" /></a></td>
					</tr>
				</table>

<hr>


<a name="win32api"></a>
<h2>Checking the Return Code of Win32 APIs</h2>
<p><i>Davide Marcato</i></p>

<p>System requirements: Win32 SDK</p>

<p>It's wise to always check function return codes after every function call. This provides immediate error detection and the opportunity to handle the error. In Win32 programming, after a function return code indicates an error condition, call the GetLastError() function to get details on the error. The Microsoft Platform SDK documentation, found on <a HREF="/default.asp">MSDN Online</a>, states that when a function fails it always returns 0, and when it succeeds, a non-zero. The most efficient way to implement API error checking in your code is:</p>  

<pre><code>
BOOL SomeFunction() 
{ 
        if (!TextOut(...)) 
              return FALSE; 

        DoSomethingAfterText(...); 
} 
</code></pre>

<p>The preceding code should look familiar to all Windows developers. It is so familiar, in fact, that programmers occasionally forget the precise semantics of the return value in Win32 and write incorrect error-checking code because they have a tendency to think of such code as a Boolean value, i.e., if it equals FALSE there has been an error, if it equals TRUE everything worked fine. This does not match the official specification and can lead to nasty bugs, because the only guaranteed numeric return code when there has been a failure is 0 (which effectively equals the FALSE and NULL constants). The absence of errors can legally be represented by any other value, not necessarily 1, -1 or TRUE. Consequently:</p> 

<pre><code>
if (!TextOut(...))     // OK 

if (TextOut(...) == FALSE)     // OK 

if (TextOut(...) != NULL)     // OK 

if (TextOut(...) != TRUE)    // Unreliable! 

if (!(TextOut(...) == TRUE))    // Unreliable! 
</code></pre>

<p>To be safe in Win32, always check for errors, never for success.</p>


				<table cellpadding="0" cellspacing="0" border="0" id="donotprint">
					<tr valign="bottom">
						<td align="left"><a href="/visualc/productinfo/previous/vc6/tips/default.asp#top"><img src="/products/shared/images/top_v1.gif" width="40" height="20" alt="To top of page" border="0" /></a></td>
					</tr>
				</table>

<hr>

<a name="batching"></a>
<h2>Avoiding Batching Problems with the IDirect3DDevice2::DrawPrimitive Method</h2>
<p><i>By Peter Kovach</i></p>

<p>System requirements:</p>
<ul>
<li>Windows 95 or 98</li>
<li>Visual C++ 6.0 (or 5.0) compiler </li>
<li>DirectX 6 or 7 installed </li>
</ul>

<p>In Direct3D, when rendering with texture handles using the <b>IDirect3DDevice2</b> interface, if we call the <b>IDirect3DDevice2::DrawPrimitive()</b> or <b>IDirect3DDevice2::DrawIndexedPrimitive()</b> methods within our scene, they will be <b><i>batched</i></b>.</p>
  
<p>While batching improves the performance of Direct3D, it can pose some problems.  When either of these two methods are batched, DirectX buffers them together and passes them to the Direct3D device driver in one call.  If we make changes to the rendering states within our scene, these will be buffered as well. The contents of the buffer will be passed to the device driver as soon as the buffer is full or when we call the <b>IDirect3DDevice2::EndScene()</b> method. If we make changes to our scene that <i>are not</i> changes to the rendering state, they may be performed out of order with our code layout.</p>
 
<p>For example, if we change the contents of one of our textures between calls to <b>IDirect3DDevice2::DrawPrimitive or IDirect3DDevice2::DrawIndexedPrimitive</b>, both of the primitives may be drawn with the new texture.</p>
 
<p>This problem can be avoided by flushing the <i>batching buffer</i> prior to making changes to our scene which are not changes to our rendering state.  To flush the batching buffer, use the <b>IDirect3DDevice2::SetRenderState()</b> method and pass the enumerated value <b>D3DRENDERSTATE_FLUSHBATCH</b> as the first parameter. Note that the second parameter should always be set to zero.</p>


				<table cellpadding="0" cellspacing="0" border="0" id="donotprint">
					<tr valign="bottom">
						<td align="left"><a href="/visualc/productinfo/previous/vc6/tips/default.asp#top"><img src="/products/shared/images/top_v1.gif" width="40" height="20" alt="To top of page" border="0" /></a></td>
					</tr>
				</table>

<hr>

<a name="registrar"></a>
<h2>Invoking the ATL Registrar for Custom Registry Entries</h2>
<p><i>By Glenn Carr</i></p>

<p>Occasionally, you may want to add or remove keys in the registry using a separate, custom registrar script that doesn&#146;t rely on the default ATL <b>_Module.RegisterServer()</b> and <b>_Module.UnregisterServer()</b> invocations.</p> 

<p>Normally, each coclass is registered when these ATL-provided functions traverse the list of objects defined in the object map for the module, and edit the appropriate registry entries. The DECLARE_REGISTRY_RESOURCEID macro then defines a static method, <b>UpdateRegistry()</b>, within each class, which gets called by the registration routine and invokes <b>_Module.UpdateRegistryFromResource()</b> itself for the registrar script resource.</p>

<p>But it is also possible to program the ATL registrar entries independent of the <b>_Module.[Un]RegisterServer()</b> calls. To do so, you will need to:</p>

<ul>
<li>insert a new &quot;REGISTRY&quot; resource type;</li>
<li>specify a new .rgs external file for the resource (Properties|File name);</li>
<li>add the new registrar script to the new .rgs file;</li>
<li>call <b>CComModule::UpdateRegistryFromResource</b> to add or remove the registry entries specified in your new registrar script (.rgs file).  For example: 
<pre><code>
HRESULT hr = _Module.UpdateRegistryFromResource(IDR_MyRegistryEntries,
 TRUE);
_ASSERTE(SUCCEEDED(hr));
</code></pre>
</li>
</ul>

<p>The last argument indicates whether to add entries (TRUE) or remove entries (FALSE). Be sure to specify the &#147;NoRemove&#148; qualifier on any shared keys in the script so that unregistering your entries will remove only the entries you've added.  <b>UpdateRegistryFromResource()</b> is actually a macro that is defined as <b>UpdateRegistryFromResourceS()</b> if you've defined _ATL_STATIC_REGISTRY (registrar linked in statically), or <b>UpdateRegistryFromResourceD()</b> if not (registrar code linked dynamically through ATL.DLL).</p>


				<table cellpadding="0" cellspacing="0" border="0" id="donotprint">
					<tr valign="bottom">
						<td align="left"><a href="/visualc/productinfo/previous/vc6/tips/default.asp#top"><img src="/products/shared/images/top_v1.gif" width="40" height="20" alt="To top of page" border="0" /></a></td>
					</tr>
				</table>

<hr>

<a name="registry"></a>
<h2>Using Registry Keys to Store User Program Information</h2>
<p><i>By Brian Noyes</i></p>

<p>An important part of making your program user friendly is having it remember user settings and preferences between sessions. Saving these settings in the registry is also a requirement for the Windows Logo program.</p>

<p>The process to do so simply involves making sure your program is aware of where in the registry it is supposed to store this information, and then using some MFC functions to do the reading and the writing when necessary. The convention for persisting user preferences and settings between application sessions is to store these settings under the HKEY_CURRENT_USER\Software key in the registry. The convention also includes using sub-keys to the above with a hierarchy that starts with the name of the company who developed the software, followed by the application name the settings are for, and then any sub-keys and values you want to add for categorizing and saving your settings. For example, HKEY_CURRENT_USER\Software\DomeWorks\DeskShow holds the registry keys and values for my DeskShow program.</p>

<p>The code to accomplish the above is simple. To set your company name, use the CWinApp::SetRegistryKey() function in your InitInstance() function. For example:</p>
<pre><code>
BOOL MyApp::InitInstance()
{
SetRegistryKey(_T(&quot;DomeWorks&quot;));
&#133;
}
</code></pre>
<p>If you desire the next sub-key to be the name of the project, then nothing further is required prior to reading and writing values to the registry. MFC will set the project name as the profile name by default. However, if you want to modify it, perhaps because this project is a sub-project of the main application, simply follow the code above with code like this:</p>
<pre><code>
free((void *)m_pszProfileName);
m_pszProfileName = _tcsdup(_T(&quot;DeskShow&quot;));
</code></pre>
<p>Now all you have to do is use the CWinApp functions GetProfileString(), GetProfileInt(), GetProfileBinary(), WriteProfileString(), WriteProfileInt(), and WriteProfileBinary() wherever you need to to get and set values to the registry. For example:</p>
<pre><code>
void MyClass::MyFunction() 
{
CString lastfilename = AfxGetApp()-&gt;GetProfileString(_T(&quot;Initialize&quot;),
 _T(&quot;LoadFile&quot;), _T(&quot;&quot;));
AfxGetApp()-&gt;WriteProfileInt(_T(&quot;Epochs&quot;), T(&quot;CurrentTime&quot;),
 m_currtime);
&#133;
}
</code></pre>
<p>The first call will retrieve the LoadFile value from registry key HKEY_CURRENT_USER\Software\DomeWorks\DeskShow\Initialize, and will return an empty string if the value is not found. The second will write the member variable m_currtime to the CurrentTime value under the Epochs sub-key to DeskShow.</p>

<p>These features make using the registry for program settings a piece of cake.</p>


				<table cellpadding="0" cellspacing="0" border="0" id="donotprint">
					<tr valign="bottom">
						<td align="left"><a href="/visualc/productinfo/previous/vc6/tips/default.asp#top"><img src="/products/shared/images/top_v1.gif" width="40" height="20" alt="To top of page" border="0" /></a></td>
					</tr>
				</table>

<hr>

<a name="ATL_Debug"></a>
<h2>Debugging Reference-Count Problems in your ATL Components</h2>
<p><i>By Steve Wampler</i></p>

<p><b>This Tip assumes you are familiar with Microsoft Visual C++®, the Component Object Model (COM), and the Active Template Library (ATL).</b></p>

<p>Once you suspect you have a COM reference counting problem, the best action to take is to find the code that's causing the problem. A good place to start is to trace all of the calls to your component's AddRef() and Release() methods and examine the results. What you're looking for are mismatched calls to AddRef() and Release().</p>

<p>It's also helpful to set breakpoints in those methods, so that each time your application hits one of them, you can examine the call stack to determine who's making the call.</p>

<p>To trace such calls, insert the following OuterAddRef(), OuterRelease(), InternalAddRef(), and InternalRelease() functions into your component's class declaration:</p>
<pre><code>
class ATL_NO_VTABLE CFoo : 
  public CComObjectRootEx<ccomsinglethreadmodel>,
  public CComCoClass<cfoo, &CLSID_Foo>,
  public IDispatchImpl<ifoo, &IID_IFoo, &LIBID_FOOLib>
{
public:
  [...]
  ULONG OuterAddRef()
  {
    ULONG ulReturn =
      CComObjectRootEx<ccomobjectthreadmodel>::OuterAddRef();
    ATLTRACE(_T(&quot;++++AddRef()  CFoo::%p  refcount = %d\n&quot;),
      this, m_dwRef);
    return ulReturn;
  }

  ULONG OuterRelease()
  {
    ULONG ulReturn =
      CComObjectRootEx<ccomobjectthreadmodel>::OuterRelease();
    ATLTRACE(_T(&quot;~~~~Release() CFoo::%p  refcount = %d\n&quot;),
      this, m_dwRef);
    return ulReturn;
  }

  ULONG InternalAddRef()
  {
    ULONG ulReturn =
      CComObjectRootEx<ccomobjectthreadmodel>::InternalAddRef();
    ATLTRACE(_T(&quot;++++AddRef()  CFoo::%p  refcount = %d\n&quot;),
      this, m_dwRef);
    return ulReturn;
  }

  ULONG InternalRelease()
  {
    ULONG ulReturn =
      CComObjectRootEx<ccomobjectthreadmodel>::InternalRelease();
    ATLTRACE(_T(&quot;~~~~Release() CFoo::%p  refcount = %d\n&quot;),
      this, m_dwRef);
    return ulReturn;
  }
  &#133;
};
</code></pre>
<p>These methods override the corresponding methods in ATL's CComObjectRootEx. ATL calls the &quot;outer&quot; version of these methods when your component is aggregated, and the &quot;internal&quot; versions otherwise. The output to DevStudio's debug window looks something like this:</p>
<pre><code>
++++AddRef()  CFoo::04540600  refcount = 1
++++AddRef()  CFoo::04540600  refcount = 2
~~~~Release() CFoo::04540600  refcount = 1
++++AddRef()  CFoo::04540600  refcount = 2
++++AddRef()  CFoo::04540600  refcount = 3
~~~~Release() CFoo::04540600  refcount = 2
~~~~Release() CFoo::04540600  refcount = 1
~~~~Release() CFoo::04540600  refcount = 0
</code></pre>
<p><b>Note:</b> The value of the object's &quot;this&quot; pointer is printed after the class name to help you differentiate between different objects of the same class</p>


				<table cellpadding="0" cellspacing="0" border="0" id="donotprint">
					<tr valign="bottom">
						<td align="left"><a href="/visualc/productinfo/previous/vc6/tips/default.asp#top"><img src="/products/shared/images/top_v1.gif" width="40" height="20" alt="To top of page" border="0" /></a></td>
					</tr>
				</table>


<hr>

<a name="ATL"></a>
<h2>Overcoming Ambiguous Interface Derivations in ATL</h2>
<p><i>By Davide Marcato</i></p>

<p>
The typical way to add support for a COM interface to an ATL class involves
two steps. First you derive the class from the interface (or from another
class which in turn implements its methods), then you add an interface
entry macro to the class's COM map to enable discovery through
QueryInterface():</p>
<pre><code>
BEGIN_COM_MAP(CCoClass)
	COM_INTERFACE_ENTRY(IInterface)
END_COM_MAP()
</code></pre>
<p>
It's very common for the coclass to inherit from several different
interfaces through multiple inheritance, but what happens if the hierarchy gets complicated and one interface ends up inherited more than once? Typically a coclass derives from more than one dual interface and thus ends up with duplicate IDispatch&#146;s. The compiler will not know what inheritance path to walk to reach the methods and produce an error. The solution is to change the macro name to COM_INTERFACE_ENTRY2 and pass the explicit ancestor through which the QueryInterface() mechanism should obtain the interface as a second parameter:
</p>
<pre><code>
COM_INTERFACE_ENTRY2(IDispatch, IBranchToChoose)
</code></pre>


				<table cellpadding="0" cellspacing="0" border="0" id="donotprint">
					<tr valign="bottom">
						<td align="left"><a href="/visualc/productinfo/previous/vc6/tips/default.asp#top"><img src="/products/shared/images/top_v1.gif" width="40" height="20" alt="To top of page" border="0" /></a></td>
					</tr>
				</table>

<hr>

<a name="Direct3D"></a>
<h2>Creating dark lights in Direct3D for special effects</h2>
<p><i>By Peter Kovach</i></p>

<p>To define a color for a material assigned to an object in Direct3D Immediate Mode, the color component values define the amount of each light component that is reflected by the surface using that material. If we set a material to have RGB values of <b>(1.0, 1.0, 1.0)</b>, it will reflect all of the light that hits it. If we set a material to have RGB values of <b>(0.0, 0.0, 0.0)</b>, it will reflect no light at all.</p>
  
<p>Beyond the <b>normal</b> range of 0.0-1.0, Direct3D allows us to specify negative values for our light&#146;s component values as well as values <b>above</b> 1.0. If you use negative values, Direct3D will treat the resulting light as a <b>dark light </b>that will <b>remove</b> light from our scene.</p>
  
<p>We can also specify values <b>greater</b> than 1.0, and Direct3D will generate lighting that is especially <b>bright</b>.</p>

<p>Dark lights can have a very unique effect on a rendered 3D scene in our animated world. With them, we can set the surrounding area (such as an entire room) to have a &quot;normal&quot; ambient light level, and an area within this area to have a &quot;darkened&quot; look. We can do this to create areas in 3D fantasy games such as that surrounding a talisman on a table we want to be seen as creating a <i>dark spell</i>.</p>

<p>To create a light object, we call the <b>IDirect3D3::CreateLight</b> method. We pass the first parameter as the address of a variable we wish filled with a valid <b>IDirect3DLight</b> interface pointer when the call succeeds. The second parameter must be set to NULL.</p> 

<p>Once the light object is created, we can set the light&#146;s properties by setting up a <b>D3DLIGHT2</b> structure and calling the <b>IDirect3DLight::SetLight</b> method with the address of the <b>D3DLIGHT2</b> structure as its parameter. After our light is created, we can call <b>IDirect3Dlight::SetLight</b> again with new information whenever we wish to update our light&#146;s illumination properties.</p>

<p>The following code shows how to create a light and set it as a <b>dark light</b>:
<pre><code>
    //
    // g_lpD3D3 holds the address of an IDirect3D3 interface
    //
    LPDIRECT3DLIGHT g_lpD3DLight;
    HRESULT   hr;
 
    hr = g_lpD3D3-&gt;CreateLight (&amp;g_lpD3DLight, NULL);
    if (SUCCEEDED(hr))
    {
	//
     	// g_lpD3DLight variable is a valid pointer to an 
	   IDirect3D3 interface.
     	//
    	D3DLIGHT2 g_light;
    HRESULT   hr;
    //
    // Initialize the structure
    //
    ZeroMemory(&amp;g_light, sizeof(D3DLIGHT2));
    g_light.dwSize = sizeof(D3DLIGHT2);  // MUST set the size!
    //
    // Create our Dark point light.
    //
    g_light.dltType = D3DLIGHT_POINT;
    g_light.dcvColor.r = -0.5f;
    g_light.dcvColor.g = -0.5f;
    g_light.dcvColor.b = -0.5f;
    //
    // Position the light high in the scene, and behind the viewer.
    // These coordinates are in world space, so
    // the viewer could be anywhere in world space. 
    // For this example, the viewer is at the origin of world space.
    //
    g_light.dvPosition.x = 0.0f;
    g_light.dvPosition.y = 1000.0f;
    g_light.dvPosition.z = -100.0f;
    //
// Don't attenuate
//
g_light.dvAttenuation0 = 1.0f; 
g_light.dvRange = D3DLIGHT_RANGE_MAX;
    //
// Make the light active light.
//
g_light.dwFlags = D3DLIGHT_ACTIVE;
    //
// Set the property info for this light.
// We have to cast the LPD3DLIGHT2 to be 
// an LPD3DLIGHT.
//
hr = g_lpD3DLight-&gt;SetLight((LPD3DLIGHT)&amp;g_light);
if (SUCCEEDED(hr))
{
    //
    // Add the light to the viewport here.
    //
}
else
    return hr;
}
else
    return hr;
</code></pre>


				<table cellpadding="0" cellspacing="0" border="0" id="donotprint">
					<tr valign="bottom">
						<td align="left"><a href="/visualc/productinfo/previous/vc6/tips/default.asp#top"><img src="/products/shared/images/top_v1.gif" width="40" height="20" alt="To top of page" border="0" /></a></td>
					</tr>
				</table>

<hr>


<a name="STL"></a>
<h2>Tip: Function pointers as function objects</h2>
<p><i>By Bill Wagner</i></p>

<p>Function pointers can be used as function objects anytime an STL algorithm requests a function object (also known as a functor). This is important both as a useful idea and as a way to understand how functors work.  A functor is a way to pass a function pointer into an STL algorithm. The difference is that the function pointer may be a class, or any object that supports the function call operator. The function call operator is defined as:</p>
<pre><code>
operator () () 
{
};
</code></pre>
<p>The address of a C-function works correctly:</p>  
<pre><code>
float cosTheta [32];
float sinTheta [32];

// Assume Theta [] is an array with angles stored in it.
std::transform (&amp;Theta[0], Theta.end (), &amp;cosTheta[0], cos);
std::transform (&amp;Theta[0], Theta.end (), &amp;sinTheta[0], sin);
</code></pre>


				<table cellpadding="0" cellspacing="0" border="0" id="donotprint">
					<tr valign="bottom">
						<td align="left"><a href="/visualc/productinfo/previous/vc6/tips/default.asp#top"><img src="/products/shared/images/top_v1.gif" width="40" height="20" alt="To top of page" border="0" /></a></td>
					</tr>
				</table>

<hr>

<a name="MFC"></a>
<h2>Tip: Using MFC and ClassWizard to Subclass a Windows Common Dialog</h2>
<p><i>By Eduard Koller</i></p>

<p>To subclass a Windows common dialog (for example, a CFileDialog) you need to create a &quot;child dialog template&quot; and then attach the template to your CFileDialog-derived class. This template must contain only the controls that you are adding to the dialog.</p>

<p>In the well-known MFC FAQ, Scot Wingo wrote:
&quot;Note that since the system puts your dialog template on top of the normal dialog, MFC message routing won't get to your controls, so you can't code them through a message map in your CFileDialog derivative. If anybody has found a way around this, I'd love to hear it!&quot;</p>

<p>In Microsoft Visual C++ Version 6.0 the problem is partially solved: MFC message routing works fine, but you can't use ClassWizard to add handlers and member variables. Also, if you try to derive a class from CFileDialog using ClassWizard, it disables the &quot;Dialog ID&quot; box, and no code is added for the dialog.</p>

<p>To solve this problem use the following trick:<br>
Using ClassWizard derive your class from CDialog (instead of CFileDialog).Then modify the base class and constructor of the generated class. Thus, your class will be derived from CFileDialog, and ClassWizard will be still able to handle your added controls.</p>

<p>The following steps show how to perform this trick:</p>
<ol>
<li>Create the template.
<li>Attach a CDialog-derived class, using ClassWizard (for example, named CMyFileDialog).
<li>In the header (.h) file, in the definition of CMyFileDialog, insert the line:
<pre><code>
DECLARE_DYNAMIC(CMyFileDialog)
</code></pre>
and modify the constructor declaration:
<pre><code>
CMyFileDialog(BOOL bOpenFileDialog, LPCTSTR lpszDefExt = NULL,
LPCTSTR lpszFileName = NULL,
DWORD dwFlags = OFN_HIDEREADONLY | OFN_OVERWRITEPROMPT,
LPCTSTR lpszFilter = NULL, CWnd* pParentWnd = NULL);
</code></pre>
<li>In the implementation (.cpp) file, insert the line:
<pre><code>
IMPLEMENT_DYNAMIC(CMyFileDialog, CFileDialog)
</code></pre>
then modify the constructor definition:
<pre><code>
CMyFileDialog::CMyFileDialog(BOOL bOpenFileDialog, 
LPCTSTR lpszDefExt, LPCTSTR lpszFileName,
DWORD dwFlags, LPCTSTR lpszFilter, CWnd* pParentWnd) :
CFileDialog(bOpenFileDialog, lpszDefExt, lpszFileName, 
dwFlags, lpszFilter, pParentWnd)
{
m_ofn.Flags |= OFN_ENABLETEMPLATE | OFN_PATHMUSTEXIST | 
OFN_FILEMUSTEXIST | OFN_SHAREAWARE | OFN_ALLOWMULTISELECT;
m_ofn.lpTemplateName = MAKEINTRESOURCE(IDD_ABOUTBOX1);
}
</code></pre>
<li>Finally, replace in both header and implementation files any reference to CDialog with CFileDialog.</p>
</ol>


				<table cellpadding="0" cellspacing="0" border="0" id="donotprint">
					<tr valign="bottom">
						<td align="left"><a href="/visualc/productinfo/previous/vc6/tips/default.asp#top"><img src="/products/shared/images/top_v1.gif" width="40" height="20" alt="To top of page" border="0" /></a></td>
					</tr>
				</table>

<hr>

<a name="parsing"></a>
<h2>Tip: Parsing Compound Strings with AfxExtractSubString()</h2>
<p><i>By Brian Noyes</i></p>

<p>Microsoft Foundation Classes (MFC) has a few undocumented functions that can be useful at times &#150; including, AfxExtractSubString(). You won&#146;t find any documentation on it in the Visual C++ 6.0 help files, but if you search through the MFC samples, you&#146;ll find it used in several places. Simply put, this function allows you to easily extract sub-strings in a string that has other strings embedded and delimited by characters like NULL or linefeed.</p>

<p>This is useful for parsing out sub-strings of a string table resource, or for parsing-out strings from Microsoft Windows controls such as the standard File Open dialogs that use these types of strings for some of their underlying data items (i.e. the file name for multiple selection File Open dialogs).</p>

<p>For example, MFC AppWizard projects create a string resource named IDR_MAINFRAME by default which holds some useful information like the name of the application, the name of the document type, or the file extension profile for the default document type &#150; used for standard File Open/Save dialogs. An example of parsing-out information like this using AfxExtractSubString is below:</p>
<pre><code>
	Cstring fullstring, appname, fileext;
	Fullstring.LoadString(IDR_MAINFRAME); 
	 //Get the full delimited string
	AfxExtractSubString(appname, fullstring, 0, &#145;\n&#146;); 	
	 //Pull out the first substring
	AfxExtractSubString(fileext, fullstring, 4, &#145;\n&#146;); 	
	 //Pull out the fifth substring
</code></pre>
<p>The above MFC function can save you from writing error-prone parsing code.</p>


<!-- Main Content Area END -->


													</td>
                                                            </tr>
                                                            <tr>
                                                                 <td>				
				<br>
				<table cellpadding="0" cellspacing="0" border="0" width="100%" id="donotprint">
					<tr valign="bottom">
						<td align="left"><a href="#top"><img src="/products/shared/images/top_v1.gif" width="40" height="20" alt="To top of page" border="0" /></a></td>
						<td align="right">	
										
						</td>
					</tr>
				</table>
                                                                 </td>
                                                            </tr>  
                                                       </table>					

										</td>
                                             </tr>
                                        </table>
     
                                   </td> 
                              </tr>
                         </table>
                    </td>
               </tr>
               <tr valign="top">
                    <td>
                         <table border="0" cellpadding="0" cellspacing="0" width="100%">
                              <tr>
                                   <td width="100%">
                                        <span id="donotprint">
	<span id="pgFooter">

		<table cellpadding="0" cellspacing="0" width="100%" height="20" border="0" class="FooterBranding">
			<tr>
				<td align="left">
					<table cellpadding="0" cellspacing="0" border="0" height="100%">
						<tr class="MNPFooterRow1">
							<td width="10">&nbsp;&nbsp;</td>

							<td nowrap><a href="/isapi/goregwiz.asp?target=/contactus30/contactus.asp?domain=devtools/vc" target="_top">Contact Us</a></td>
							<td width="10">&nbsp;&nbsp;</td>

						<script language="javascript"  type="text/javascript">
							var sItemURL = "mailto:?subject=A link from Microsoft&body=This link is from the Visual C++ Web site" + " "  + top.parent.location.href
							document.write('<td nowrap><a href="' + sItemURL + '"  target=>E-Mail This Page</a></td>')
							document.write ('<td>&nbsp;&nbsp;</td>')
						</script>
	
						</tr>
					</table>
				</td>
			</tr>
		</table>

		<table cellpadding="0" cellspacing="0" width="100%" height="30" border="0" class="FooterBranding">
			<tr>
				<td align="left">
					<table cellpadding="0" cellspacing="0" border="0" height="100%">
						<tr class="MNPFooterRow2">
							<td width="10">&nbsp;&nbsp;</td>

							<td nowrap><a href="http://www.microsoft.com/info/cpyright.htm" target="_top">© 2002 Microsoft Corporation. All rights reserved.  Terms of Use.</a></td>
							<td width="10">&nbsp;&nbsp;</td>

							<td nowrap><a href="http://www.microsoft.com/info/privacy.htm" target="_top">Privacy Statement</a></td>
							<td width="10">&nbsp;&nbsp;</td>

							<td nowrap><a href="http://www.microsoft.com/enable/" target="_top">Accessibility</a></td>
							<td width="10">&nbsp;&nbsp;</td>

						</tr>
					</table>
				</td>
			</tr>
		</table>

	</span>
</span>
                                   </td>
                              </tr>
                         </table>
                    </td>
               </tr>
          </table>     
     

</body>
</html>

